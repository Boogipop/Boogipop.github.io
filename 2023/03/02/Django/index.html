<!DOCTYPE html>
<html lang="zh-CN">
    <head prefix="og: https://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="referrer" content="no-referrer" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>Django - Boogiepop Doesn&#39;t Laugh</title>
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
  
  
  <meta property="og:title" content="Django - Boogiepop Doesn&#39;t Laugh" />
  
  <meta property="og:type" content="article" />
  
  <meta property="og:url" content="http://boogipop.com/2023/03/02/Django/index.html" />
  
  <meta property="og:image" content="/favicon.png" />
  
  <meta property="og:article:published_time" content="2023-03-02T10:24:22.000Z" />
  
  <meta property="og:article:author" content="Boogipop" />
  
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
<link rel="stylesheet" href="/css/giscus.css">

  
  
<link rel="stylesheet" href="/css/rainbow-banner.css">

  
  
  
<link rel="stylesheet" href="/css/toc.css">

  
  
    
<link rel="stylesheet" href="/css/giscus.css">

  
  
  
  
<link rel="stylesheet" href="/css/post.css">

  
  
  
  
  

  
<meta name="generator" content="Hexo 6.3.0"></head>
    <body
        data-color-scheme="auto"
        data-uppercase-categories="true"
        
        data-rainbow-banner="true"
        data-rainbow-banner-shown="auto"
        data-rainbow-banner-month="6"
        data-rainbow-banner-colors="#e50000,#ff8d00,#ffee00,#008121,#004cff,#760188"
        
        data-config-root="/"
        
        data-toc="true"
        data-toc-max-depth="2"
        
        
    >
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">Blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">Home</a>
            
            
            <a class="nav-item" href="/archives">Archives</a>
            
            
            
            <a class="nav-item" href="/friends">Friends</a>
            
            
            
            <a class="nav-item" href="/about">About</a>
            
            
            
            <a class="nav-item" href="/categories">Categories</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/MrWillCom" target="_blank" aria-label="GitHub">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-codepen nav-item-icon" href="https://codepen.io/mrwillcom" target="_blank" aria-label="CodePen">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-patreon nav-item-icon" href="https://www.patreon.com/MrWillCom" target="_blank" aria-label="Patreon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-mastodon nav-item-icon" href="https://noc.social/@MrWillCom" target="_blank" aria-label="Mastodon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-discord nav-item-icon" href="https://discord.gg/UKuFDjcfY8" target="_blank" aria-label="Discord">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-search nav-item-icon" href="/search" target="_blank" aria-label="Search">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        
<article class="post">
    <div class="meta">
        
        <div class="categories text-uppercase">
        
            <a href="/categories/Development/">Development</a>
        
        </div>
        

        
        <div class="date" id="date">
            <span>March</span>
            <span>2,</span>
            <span>2023</span>
        </div>
        

        <h2 class="title">Django</h2>
    </div>

    <div class="divider"></div>

    <div class="content">
        <h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p><code>pip install django</code>，这是命令行安装<br>pycharm中直接在setting里安装<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665842730640-aedf329f-3ca4-42b2-9952-a4ec4efeed9c.png#averageHue=%233f4449&clientId=u93d1edd7-15d0-4&errorMessage=unknown%20error&from=paste&height=250&id=u22c088c5&name=image.png&originHeight=312&originWidth=1777&originalType=binary&ratio=1&rotation=0&showTitle=false&size=64098&status=error&style=none&taskId=u8cec37a1-0769-4207-853c-5863c92eda9&title=&width=1421.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665842858623-b35b022e-d63f-489d-8c67-1ad045ac9c2a.png#averageHue=%23f4f4f4&clientId=u93d1edd7-15d0-4&errorMessage=unknown%20error&from=paste&height=361&id=ue8ae9995&name=image.png&originHeight=451&originWidth=1101&originalType=binary&ratio=1&rotation=0&showTitle=false&size=79508&status=error&style=none&taskId=uecebb925-2482-41d3-a67e-d92000bef9b&title=&width=880.8" alt="image.png"></p>
<h2 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h2><ul>
<li>在终端：</li>
</ul>
<p>先进入一个指定的目录，在执行命令：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665843122575-d9fc041b-12c8-42d5-9e89-927390f9ece9.png#averageHue=%23f1f1f0&clientId=u93d1edd7-15d0-4&errorMessage=unknown%20error&from=paste&height=62&id=uc4eab0dd&name=image.png&originHeight=77&originWidth=874&originalType=binary&ratio=1&rotation=0&showTitle=false&size=28162&status=error&style=none&taskId=ud2bd9fed-dea5-4555-8e20-db189b4b7e2&title=&width=699.2" alt="image.png"><br>这边是python的安装目录下，在安装django后会有一个django-admin.exe</p>
<ul>
<li>pycharm：</li>
</ul>
<p>左上角点File再点New Project：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665848345557-2c1d2a2c-f34c-43db-968c-5199e0cb20e5.png#averageHue=%233c4042&clientId=u93d1edd7-15d0-4&errorMessage=unknown%20error&from=paste&height=441&id=u7c279430&name=image.png&originHeight=551&originWidth=978&originalType=binary&ratio=1&rotation=0&showTitle=false&size=37454&status=error&style=none&taskId=u6f89eb9f-8145-40f2-b457-4a2d9ecc9d6&title=&width=782.4" alt="image.png"><br>选第二个django，然后选择项目创建在哪儿即可<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665854131028-bcc7ed3b-9095-4e9e-9951-ad15cff8ad43.png#averageHue=%23547645&clientId=u93d1edd7-15d0-4&errorMessage=unknown%20error&from=paste&height=470&id=u8c4c00c6&name=image.png&originHeight=587&originWidth=1764&originalType=binary&ratio=1&rotation=0&showTitle=false&size=107398&status=error&style=none&taskId=u395109bc-36a3-4202-9f87-f303a679f89&title=&width=1411.2" alt="image.png"></p>
<ul>
<li>两种方式的区别：</li>
</ul>
<p>pycharm创建出来的会多一个template目录<br>settings文件开头也有点不同：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665915694308-baf9baeb-e85a-4e61-9ff5-2748f0167ab3.png#averageHue=%23384147&clientId=u6bc2a433-7048-4&errorMessage=unknown%20error&from=paste&height=325&id=u445809ec&name=image.png&originHeight=406&originWidth=1747&originalType=binary&ratio=1&rotation=0&showTitle=false&size=430157&status=error&style=none&taskId=u3ba225af-67ed-437b-a1e4-e717c5173f1&title=&width=1397.6" alt="image.png"></p>
<h2 id="默认文件介绍"><a href="#默认文件介绍" class="headerlink" title="默认文件介绍"></a>默认文件介绍</h2><p>默认项目里的文件有以下6个：<br>template是空的，暂时不管<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665916694475-13bf559a-a22c-4dc9-afba-0063eb992b0c.png#averageHue=%233d4144&clientId=u6bc2a433-7048-4&errorMessage=unknown%20error&from=paste&height=161&id=u54b67956&name=image.png&originHeight=201&originWidth=330&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10887&status=error&style=none&taskId=ua69237df-0e2f-4ad1-899b-309298f229b&title=&width=264" alt="image.png"></p>
<ul>
<li><p>manage.py<br>该文件做的事项目的管理，启动，创建app，数据库管理等等都是基于该文件，这文件十分的重要</p>
</li>
<li><p>asgi.py</p>
</li>
</ul>
<p>接受网络信息的文件，头部请求，不需要动</p>
<ul>
<li>wsgi.py</li>
</ul>
<p>也是接受网络请求，异步请求，不需要动</p>
<ul>
<li>settings.py</li>
</ul>
<p>项目配置文件</p>
<ul>
<li>urls.py</li>
</ul>
<p>路由设置</p>
<h2 id="app的创建和说明"><a href="#app的创建和说明" class="headerlink" title="app的创建和说明"></a>app的创建和说明</h2><p>每一个大项目有很多小功能，这些小功能拆分开来就是app了<br>通过manage.py去创建app<br>在pycharm的终端输入：<br><code>python manage.py startapp app01</code>:<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665929390918-37894d13-145c-455c-b808-aab3c0ca939c.png#averageHue=%233e4651&clientId=u6bc2a433-7048-4&errorMessage=unknown%20error&from=paste&height=130&id=u75229cef&name=image.png&originHeight=163&originWidth=695&originalType=binary&ratio=1&rotation=0&showTitle=false&size=14070&status=error&style=none&taskId=uafed9f7a-68d0-4424-a38f-d916cecb063&title=&width=556" alt="image.png"><br>这边假如报错：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665929399353-cbcf576c-72f0-462a-93b9-d8dbb60da735.png#averageHue=%23312f2e&clientId=u6bc2a433-7048-4&errorMessage=unknown%20error&from=paste&height=103&id=u88dd8eac&name=image.png&originHeight=129&originWidth=724&originalType=binary&ratio=1&rotation=0&showTitle=false&size=22534&status=error&style=none&taskId=u63deac3d-f900-41c8-822b-c13f317e77e&title=&width=579.2" alt="image.png"><br>在settings.py里添加：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665929413788-0f2c38c7-e163-4db2-9639-ae987e684b83.png#averageHue=%23302e2d&clientId=u6bc2a433-7048-4&errorMessage=unknown%20error&from=paste&height=62&id=u3fc28a1d&name=image.png&originHeight=78&originWidth=436&originalType=binary&ratio=1&rotation=0&showTitle=false&size=6968&status=error&style=none&taskId=ub892693d-8500-4d35-b789-056b05397cb&title=&width=348.8" alt="image.png"></p>
<p>app里会自动创建一些文件：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665929447616-ec504e86-9094-456b-818c-9aecee726d88.png#averageHue=%233e454e&clientId=u6bc2a433-7048-4&errorMessage=unknown%20error&from=paste&height=186&id=u35d8cfd1&name=image.png&originHeight=233&originWidth=649&originalType=binary&ratio=1&rotation=0&showTitle=false&size=15321&status=error&style=none&taskId=ub3555de9-7912-45b6-8bd6-5fef85d4fdb&title=&width=519.2" alt="image.png"></p>
<ul>
<li>apps.py</li>
</ul>
<p>这个固定不动</p>
<ul>
<li>tests.py</li>
</ul>
<p>单元测试的，固定不动</p>
<ul>
<li>migrations&#x2F;<strong>init</strong>.py</li>
</ul>
<p>固定不动，数据库字段变更</p>
<ul>
<li>admin.py</li>
</ul>
<p>django默认提供了amdin后台管理，固定不动</p>
<ul>
<li>views.py</li>
</ul>
<p>重要内容，和函数有关</p>
<ul>
<li>models.py</li>
</ul>
<p>重要内容，对数据库进行操作</p>
<h2 id="启动运行django"><a href="#启动运行django" class="headerlink" title="启动运行django"></a>启动运行django</h2><p>首先确保app注册，上面只是创建了app，并没注册，找到settings.py:<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665929862775-1bb3239a-0bc2-4ba8-b861-c7084f089906.png#averageHue=%232c2c2b&clientId=u6bc2a433-7048-4&errorMessage=unknown%20error&from=paste&height=218&id=udb95e1c2&name=image.png&originHeight=272&originWidth=495&originalType=binary&ratio=1&rotation=0&showTitle=false&size=25168&status=error&style=none&taskId=uf5146a1f-e740-46cd-9c0e-7e76a896863&title=&width=396" alt="image.png"><br>在末尾加上一句就注册成功了<br>接下来编写url和视图函数对应关系，在urls.py去编写：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665929953762-08465285-afae-4728-bf36-b1d0fd6ee9fe.png#averageHue=%23323130&clientId=u6bc2a433-7048-4&errorMessage=unknown%20error&from=paste&height=33&id=u04787aee&name=image.png&originHeight=41&originWidth=456&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4472&status=error&style=none&taskId=u8656b21e-7cdd-4f5d-9fa1-792610de94c&title=&width=364.8" alt="image.png"><br>这一句话是默认的，我们注释掉<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665929976399-e9b92a9a-3955-4823-a3a9-8980a3447afb.png#averageHue=%232f2f2e&clientId=u6bc2a433-7048-4&errorMessage=unknown%20error&from=paste&height=103&id=uddd57dda&name=image.png&originHeight=129&originWidth=483&originalType=binary&ratio=1&rotation=0&showTitle=false&size=12337&status=error&style=none&taskId=u3ab4243b-4503-422b-85fa-1ca917a9db0&title=&width=386.4" alt="image.png"><br>表示如果用户<code>URL+/index</code>之后就会请求后面的函数<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665930072072-07eeee88-6475-4be7-b58b-434d6c9282c5.png#averageHue=%232f2c2b&clientId=u6bc2a433-7048-4&errorMessage=unknown%20error&from=paste&height=200&id=u323f1224&name=image.png&originHeight=250&originWidth=741&originalType=binary&ratio=1&rotation=0&showTitle=false&size=27473&status=error&style=none&taskId=u60d70bc3-6e15-4942-a23e-7509772bdbc&title=&width=592.8" alt="image.png"><br>导入app01下的views.py后，访问index就是去请求views.py里面的index函数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts import render,HttpResponse</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create your views here.</span></span><br><span class="line">def <span class="title function_ invoke__">index</span>(request):<span class="comment">#默认需要这个参数</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">HttpResponse</span>(<span class="string">&quot;欢迎使用&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>index函数就这样做好了<br>接下来启动django程序：<br>可以<strong>通过命令行</strong>或者<strong>pycharm启动</strong><br>命令行：<code>python manage.py runserver</code></p>
<p>pycharm:<img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665930403476-7eaaeaae-50c2-4d9c-8eea-31779c145e7a.png#averageHue=%233e4143&clientId=u6bc2a433-7048-4&errorMessage=unknown%20error&from=paste&height=67&id=u0e91a11c&name=image.png&originHeight=84&originWidth=425&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4944&status=error&style=none&taskId=u9a2da5d3-4ef9-48d7-a4f2-addbb4ffc5a&title=&width=340" alt="image.png"><br>点击运行文件即可<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665930351838-5ba208a2-8d4b-4e8b-986c-70ebfeb068b9.png#averageHue=%233d4144&clientId=u6bc2a433-7048-4&errorMessage=unknown%20error&from=paste&height=677&id=u60a5d27e&name=image.png&originHeight=846&originWidth=1356&originalType=binary&ratio=1&rotation=0&showTitle=false&size=67369&status=error&style=none&taskId=ucf7ab0e1-d347-4bea-919a-3e369574272&title=&width=1084.8" alt="image.png"><br>点Django进去可以配置，8000端口<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665930429200-5c8731c9-c220-4bdd-98fd-2e71a70d08e0.png#averageHue=%232e2d2d&clientId=u6bc2a433-7048-4&errorMessage=unknown%20error&from=paste&height=179&id=u0d90311f&name=image.png&originHeight=224&originWidth=1732&originalType=binary&ratio=1&rotation=0&showTitle=false&size=42610&status=error&style=none&taskId=uc671b4fd-9db1-4412-adfb-b67b4f7903c&title=&width=1385.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665930444671-1814a2e9-3cf3-4e19-89ad-1f3988eb0780.png#averageHue=%23e0be8a&clientId=u6bc2a433-7048-4&errorMessage=unknown%20error&from=paste&height=107&id=uc951a140&name=image.png&originHeight=134&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13985&status=error&style=none&taskId=ucc50f7f2-95d1-4700-886b-bc03a538293&title=&width=1536" alt="image.png"><br>这样就直接给我们返回了函数</p>
<h2 id="模板和静态文件"><a href="#模板和静态文件" class="headerlink" title="模板和静态文件"></a>模板和静态文件</h2><p>如果我们想要返回一个字符串用httpresponse即可，但是如果我们想要给用户返回一个html文件，那咱们就得用template目录了<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665950879396-29bee668-f7d2-4b61-aac6-a53bd6abcf29.png#averageHue=%2331302d&clientId=u9308e2b1-9691-4&errorMessage=unknown%20error&from=paste&height=86&id=u81b2ca17&name=image.png&originHeight=107&originWidth=663&originalType=binary&ratio=1&rotation=0&showTitle=false&size=11708&status=error&style=none&taskId=uc6d082c4-c8e6-4cf2-a6ed-a3a87faa08b&title=&width=530.4" alt="image.png"><br>大概就如上<br>在template文件夹下放这个html文件<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665951024145-0423e1f3-dda9-4b1a-9c0e-5a3758d97631.png#averageHue=%23819668&clientId=u9308e2b1-9691-4&errorMessage=unknown%20error&from=paste&height=400&id=u2e7aea9b&name=image.png&originHeight=500&originWidth=1591&originalType=binary&ratio=1&rotation=0&showTitle=false&size=65864&status=error&style=none&taskId=u52cc951e-d244-4f0a-b049-4253d1d3f84&title=&width=1272.8" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665951148164-61e2591e-f483-4158-8f83-4a4773381105.png#averageHue=%23d5bfa3&clientId=u9308e2b1-9691-4&errorMessage=unknown%20error&from=paste&height=190&id=u0a83e0dd&name=image.png&originHeight=237&originWidth=1465&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7355&status=error&style=none&taskId=ucc260fe5-1037-4b2a-851b-877f20a1c13&title=&width=1172" alt="image.png"><br>这边查找到html文件的顺序为，如果app01注册了，那就在app01目录下去找template，如果没有找到就在下一个app里的template找，如果都找不到就在上一级目录里的template去找<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665951304944-322b1eb6-92d9-4db8-9224-2581efe85413.png#averageHue=%232b2b2b&clientId=u9308e2b1-9691-4&errorMessage=unknown%20error&from=paste&height=118&id=ufe56da40&name=image.png&originHeight=148&originWidth=794&originalType=binary&ratio=1&rotation=0&showTitle=false&size=15805&status=error&style=none&taskId=ufaf6adba-8797-4138-af39-60eb0a535b5&title=&width=635.2" alt="image.png"><br>这是因为上面的DIRS的效果，如果删除了那就是去根据app的注册顺序去查找！</p>
<p><strong>静态文件：</strong><br>静态文件指的就是js，css，图片这些，这些文件也有讲究，不能乱放<br>静态文件要放在static文件夹下！<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665952734093-11d0b78c-354b-4610-b6dd-ddba32b8461a.png#averageHue=%232c2c2b&clientId=u9308e2b1-9691-4&errorMessage=unknown%20error&from=paste&height=77&id=ub4e180df&name=image.png&originHeight=96&originWidth=461&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7711&status=error&style=none&taskId=udf0f8be7-e83f-4552-bac7-ef78a298929&title=&width=368.8" alt="image.png"><br>这是在settings的这里设置的<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665951637905-561d3b9f-ab48-4dc6-9c80-5a2685b6cc8a.png#averageHue=%236a8b55&clientId=u9308e2b1-9691-4&errorMessage=unknown%20error&from=paste&height=258&id=u67d084c6&name=image.png&originHeight=323&originWidth=1348&originalType=binary&ratio=1&rotation=0&showTitle=false&size=55746&status=error&style=none&taskId=u38ac6bf2-278b-4f5b-a159-bf71e273801&title=&width=1078.4" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665951922978-1de11e3a-d32c-4568-83d3-25b4b1c83c63.png#averageHue=%237c975f&clientId=u9308e2b1-9691-4&errorMessage=unknown%20error&from=paste&height=337&id=ubde27cb5&name=image.png&originHeight=421&originWidth=1781&originalType=binary&ratio=1&rotation=0&showTitle=false&size=74314&status=error&style=none&taskId=u761a7efd-d83c-4ee4-a93b-7ec7a0cafbe&title=&width=1424.8" alt="image.png">这个static文件夹放在app或者是外面都可以，最好还是app下面，更整洁<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665951976329-fa92c912-d007-4804-8f30-e682644d830a.png#averageHue=%238d9280&clientId=u9308e2b1-9691-4&errorMessage=unknown%20error&from=paste&height=613&id=uc3a0dc44&name=image.png&originHeight=766&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=221504&status=error&style=none&taskId=u21bfb270-ffd0-4645-a5d9-98981a53926&title=&width=1536" alt="image.png"><br>接下来我们把js和css等等都创建：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665952084544-2f586b0d-76b2-4dab-ad16-7d3202c05fa2.png#averageHue=%23404958&clientId=u9308e2b1-9691-4&errorMessage=unknown%20error&from=paste&height=102&id=uca49cf4a&name=image.png&originHeight=128&originWidth=566&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4193&status=error&style=none&taskId=u9dbaa5f3-06db-49a3-a39b-27948b90924&title=&width=452.8" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665952635842-9d4d2581-2e02-4f56-98c7-52546b897dcc.png#averageHue=%232d2c2b&clientId=u9308e2b1-9691-4&errorMessage=unknown%20error&from=paste&height=337&id=u62423742&name=image.png&originHeight=421&originWidth=1121&originalType=binary&ratio=1&rotation=0&showTitle=false&size=60693&status=error&style=none&taskId=uffa9ce48-e8e8-4288-858f-3cd5e64b1d4&title=&width=896.8" alt="image.png"><br>用如上的方式去引入文件<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665952862890-0efdfc51-3c7b-4e33-8679-c6d070ecd269.png#averageHue=%23ddc09a&clientId=u9308e2b1-9691-4&errorMessage=unknown%20error&from=paste&height=201&id=u676b9e30&name=image.png&originHeight=251&originWidth=1780&originalType=binary&ratio=1&rotation=0&showTitle=false&size=17690&status=error&style=none&taskId=uec5741b8-a90c-453a-8215-fc39a08852a&title=&width=1424" alt="image.png"></p>
<h2 id="Django模板语法"><a href="#Django模板语法" class="headerlink" title="Django模板语法"></a>Django模板语法</h2><h3 id="引用变量"><a href="#引用变量" class="headerlink" title="引用变量"></a>引用变量</h3><p>新建一个tpl函数和tpl.html<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665988825561-60790e70-99da-46df-82a8-89f41a1610fa.png#averageHue=%23a6894e&clientId=u77920178-75a3-4&from=paste&height=308&id=ue00105e5&name=image.png&originHeight=385&originWidth=937&originalType=binary&ratio=1&rotation=0&showTitle=false&size=31347&status=done&style=none&taskId=u0782f915-721d-4131-9d84-a58fedd6c83&title=&width=749.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665988935549-1e7861be-d012-4b88-9dcd-e399066f3c77.png#averageHue=%232d2c2b&clientId=u77920178-75a3-4&from=paste&height=93&id=u063a4d5f&name=image.png&originHeight=116&originWidth=409&originalType=binary&ratio=1&rotation=0&showTitle=false&size=11047&status=done&style=none&taskId=u8cab0074-e41b-4788-ade7-94669eef8f4&title=&width=327.2" alt="image.png"><br>我们在函数内定义了一个变量，那我们怎么把这个变量放在页面里呢？<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665989089650-ac3027e1-b75f-4fb2-b46d-d296e14a349a.png#averageHue=%232f2e2d&clientId=u77920178-75a3-4&from=paste&height=63&id=u97f26ee4&name=image.png&originHeight=79&originWidth=577&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7955&status=done&style=none&taskId=ufe67050b-15d8-446b-bf06-9f18838ada6&title=&width=461.6" alt="image.png"><br>后面跟一个字典，然后再html中：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665989492764-770e783c-ae8b-4401-9fe0-78c801c8eae8.png#averageHue=%23312f2d&clientId=u77920178-75a3-4&from=paste&height=78&id=u42bdc4e9&name=image.png&originHeight=98&originWidth=365&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7531&status=done&style=none&taskId=u33ab2e64-e39e-49de-9d13-d7ea4ff84c3&title=&width=292" alt="image.png"><br>2个花括号就是引用：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665989513318-1e64352d-3291-409b-9667-f5f580b92a65.png#averageHue=%23cbb68a&clientId=u77920178-75a3-4&from=paste&height=142&id=u387304fe&name=image.png&originHeight=178&originWidth=594&originalType=binary&ratio=1&rotation=0&showTitle=false&size=14148&status=done&style=none&taskId=u92dedc7f-9f36-4e21-bb89-98be722c854&title=&width=475.2" alt="image.png"><br>这里面也可以放列表,字典<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665989841200-38e55e47-13ff-4161-9952-3bad9e8ca2f2.png#averageHue=%232c2c2b&clientId=u77920178-75a3-4&from=paste&height=78&id=u2f87e0bb&name=image.png&originHeight=98&originWidth=625&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13517&status=done&style=none&taskId=u6bdab755-6634-4a02-9b62-da6eb75c66b&title=&width=500" alt="image.png"><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665989844178-e796a428-d9ab-4fee-8dcf-3ced453b4402.png#averageHue=%232e2d2c&clientId=u77920178-75a3-4&from=paste&height=121&id=ua8ed7d2d&name=image.png&originHeight=151&originWidth=486&originalType=binary&ratio=1&rotation=0&showTitle=false&size=11647&status=done&style=none&taskId=ua16eb1c1-9094-4b8f-a975-b69cf7037a5&title=&width=388.8" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665989855063-5fbf031b-9f2f-4e91-aee4-229cc2970e1f.png#averageHue=%23fafaf9&clientId=u77920178-75a3-4&from=paste&height=312&id=u61f6ee76&name=image.png&originHeight=390&originWidth=425&originalType=binary&ratio=1&rotation=0&showTitle=false&size=12283&status=done&style=none&taskId=ueda83bf4-b82d-411a-b34f-8e6fdc0a60d&title=&width=340" alt="image.png"></p>
<h3 id="语句"><a href="#语句" class="headerlink" title="语句"></a>语句</h3><p>在<code>&#123;%%&#125;</code>中可以写判断和循环语句</p>
<h4 id="循环语句"><a href="#循环语句" class="headerlink" title="循环语句"></a>循环语句</h4><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665990019280-d92ab8ff-a0a5-409b-80fc-608cba4fad40.png#averageHue=%232f2e2d&clientId=u77920178-75a3-4&from=paste&height=110&id=ubc2c7508&name=image.png&originHeight=137&originWidth=655&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16030&status=done&style=none&taskId=ua30c006e-2670-4718-bbff-481af79e5dd&title=&width=524" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665990026801-b6ae6be5-a579-49fa-9428-d1723060ed5a.png#averageHue=%23fefefd&clientId=u77920178-75a3-4&from=paste&height=194&id=u2ac09c54&name=image.png&originHeight=242&originWidth=540&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3545&status=done&style=none&taskId=uf49d2d56-5c26-462b-a86a-d93d40d9fe2&title=&width=432" alt="image.png"><br>endfor表示结束循环</p>
<ul>
<li>字典和列表结合</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665990568191-7f5cd313-57c7-4945-b5d4-cfe8ca5445bf.png#averageHue=%232f2e2d&clientId=u77920178-75a3-4&from=paste&height=124&id=u7440f2e0&name=image.png&originHeight=155&originWidth=523&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13262&status=done&style=none&taskId=udc672aa6-9460-4a72-b4cc-2dc1c6c6869&title=&width=418.4" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665990573361-96fe7cf2-f4f4-4696-bea5-0b17676f9c40.png#averageHue=%23fafaf9&clientId=u77920178-75a3-4&from=paste&height=126&id=u5bd42b56&name=image.png&originHeight=157&originWidth=332&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3769&status=done&style=none&taskId=u455185e9-f4c9-48c3-b881-22d2ec33dd0&title=&width=265.6" alt="image.png"><br>列表内套用字典形式大概就像<code>n4.0.name</code>或者是<code>n4.0.itmes</code>之类的，都一样用的</p>
<h4 id="条件语句"><a href="#条件语句" class="headerlink" title="条件语句"></a>条件语句</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="keyword">if</span> n1 == <span class="string">&quot;Boogipop&quot;</span> %&#125;</span><br><span class="line">        &lt;h3&gt;嘻嘻&lt;/h3&gt;</span><br><span class="line">&#123;% <span class="keyword">else</span> %&#125;</span><br><span class="line">        &lt;h3&gt;嘿嘿&lt;/h3&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665991522794-3bacb5a4-f785-4e9b-85af-664193444166.png#averageHue=%23fcfcfb&clientId=u77920178-75a3-4&from=paste&height=237&id=ua24ced7d&name=image.png&originHeight=296&originWidth=1323&originalType=binary&ratio=1&rotation=0&showTitle=false&size=17196&status=done&style=none&taskId=ud53b6422-0b8e-46c8-ad6c-a5c39ec3d69&title=&width=1058.4" alt="image.png"></p>
<h2 id="请求和响应"><a href="#请求和响应" class="headerlink" title="请求和响应"></a>请求和响应</h2><h3 id="请求"><a href="#请求" class="headerlink" title="请求"></a>请求</h3><p>先定义一个函数request来演示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">request</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="comment">#request是一个对象，封装了用户发送过来的所有请求</span></span><br><span class="line">    <span class="comment"># 1.获取请求方式GET/POST</span></span><br><span class="line">    <span class="built_in">print</span>(request.method)</span><br><span class="line">    <span class="comment"># 2.获取URL上的GET参数,大小写要区分一下</span></span><br><span class="line">    <span class="built_in">print</span>(request.GET)</span><br><span class="line">    <span class="comment"># 3.获得POST参数</span></span><br><span class="line">    <span class="built_in">print</span>(request.POST)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">&quot;返回数据&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>request.method:<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665998313617-1ae7f01e-f76e-4d36-87e6-67dad9fc4eef.png#averageHue=%23302d2c&clientId=u77920178-75a3-4&from=paste&height=26&id=uea177b4b&name=image.png&originHeight=32&originWidth=335&originalType=binary&ratio=1&rotation=0&showTitle=false&size=2235&status=done&style=none&taskId=u6671e9cd-53b1-4536-888a-ce0c425fc3d&title=&width=268" alt="image.png"><br>request.GET:<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665998331098-c010e282-105e-41ec-991d-686e1e11873a.png#averageHue=%23d0c292&clientId=u77920178-75a3-4&from=paste&height=103&id=u7111e44d&name=image.png&originHeight=129&originWidth=655&originalType=binary&ratio=1&rotation=0&showTitle=false&size=11634&status=done&style=none&taskId=u26830735-f26d-460a-9870-bd05e5ff191&title=&width=524" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665998343731-7a880b05-1212-4b07-aad8-7c8d185e5bc4.png#averageHue=%232d2d2c&clientId=u77920178-75a3-4&from=paste&height=31&id=uc6730ac4&name=image.png&originHeight=39&originWidth=617&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4876&status=done&style=none&taskId=uc36875f7-14b9-4b84-9b39-d575f95f85b&title=&width=493.6" alt="image.png"><br>request.POST：<br>目前没办法，因为有些东西没设置，所以没法演示，和GET一样的其实是</p>
<h3 id="响应"><a href="#响应" class="headerlink" title="响应"></a>响应</h3><p>这边演示一个重定向：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665998899508-8502409e-445f-47f5-bd6e-53e07e67b8a7.png#averageHue=%232e2d2d&clientId=u77920178-75a3-4&from=paste&height=74&id=u01ef17a5&name=image.png&originHeight=93&originWidth=625&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8262&status=done&style=none&taskId=ub238717b-b9c3-493f-bf1e-04a94d84d53&title=&width=500" alt="image.png"><br>这里要导入一下redirect模块：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665998910999-12bbf123-2993-4351-ba82-1e6137f9be3c.png#averageHue=%238b7e52&clientId=u77920178-75a3-4&from=paste&height=42&id=u1c4fee7b&name=image.png&originHeight=53&originWidth=686&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7919&status=done&style=none&taskId=u177c0083-284e-4d4e-a99c-e473192e81c&title=&width=548.8" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1665998937634-22f0cc20-2c4b-4cdf-b867-36a24e7d4fe6.png#averageHue=%23fdf9f7&clientId=u77920178-75a3-4&from=paste&height=438&id=u7e3f1a16&name=image.png&originHeight=548&originWidth=1740&originalType=binary&ratio=1&rotation=0&showTitle=false&size=103124&status=done&style=none&taskId=u1f34e995-675d-4508-988b-2cfb5621c41&title=&width=1392" alt="image.png"><br>访问之后就过来了，这边处理方式为：<br>浏览器-&gt;Django，然后让浏览器自己去访问百度：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666000130429-1c9226a5-dd50-49f1-a385-3e9f15c8aca5.png#averageHue=%23fcfcfc&clientId=u243fe364-b58d-4&from=paste&height=434&id=ud0106232&name=image.png&originHeight=542&originWidth=1300&originalType=binary&ratio=1&rotation=0&showTitle=false&size=94601&status=done&style=none&taskId=uc928cf7a-64c9-42f8-853a-3cd9eea0bc0&title=&width=1040" alt="image.png"><br>为第二种方式</p>
<h3 id="小案例：用户登录"><a href="#小案例：用户登录" class="headerlink" title="小案例：用户登录"></a>小案例：用户登录</h3><p>概况如下：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666003538494-ab4d4a36-d460-4a8a-99f8-88d756e68fc0.png#averageHue=%23302e2d&clientId=u243fe364-b58d-4&from=paste&height=370&id=u8d765e94&name=image.png&originHeight=462&originWidth=1140&originalType=binary&ratio=1&rotation=0&showTitle=false&size=115714&status=done&style=none&taskId=uf81c77f3-c539-44f8-8ad4-8346d10e682&title=&width=912" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666003546208-4fd5822b-54ba-40b8-b47c-2c30aac9a033.png#averageHue=%232f2e2c&clientId=u243fe364-b58d-4&from=paste&height=362&id=u85fb386e&name=image.png&originHeight=452&originWidth=857&originalType=binary&ratio=1&rotation=0&showTitle=false&size=67586&status=done&style=none&taskId=uc25ca235-b3e8-457c-b746-bb2e001b9e5&title=&width=685.6" alt="image.png"><br>代码分别为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method==<span class="string">&quot;GET&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> render(request,<span class="string">&quot;login.html&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment">#如果是POST请求，获取提交的数据</span></span><br><span class="line">        username=request.POST.get(<span class="string">&quot;user&quot;</span>)</span><br><span class="line">        password=request.POST.get(<span class="string">&quot;pwd&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;用户名:%s,密码:%s&quot;</span>%(username,password))</span><br><span class="line">        <span class="keyword">if</span> username==<span class="string">&quot;root&quot;</span> <span class="keyword">and</span> password==<span class="string">&quot;root&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> redirect(<span class="string">&quot;http://43.140.251.169/&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> render(request,<span class="string">&#x27;login.html&#x27;</span>,&#123;<span class="string">&quot;error_msg&quot;</span>:<span class="string">&quot;用户名或密码错误&quot;</span>&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>用户登入<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">action</span>=<span class="string">&quot;/login/&quot;</span>&gt;</span></span><br><span class="line">      &#123;% csrf_token %&#125; <span class="comment">&lt;!--设置这个csrftoken为了防止非法访问--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;用户名&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;pwd&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;密码&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;提交&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;color: blue&quot;</span>&gt;</span>&#123;&#123; error_msg &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这样就完成了一个简单的登录页面：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666003595838-7a4af5d2-6ce0-470e-b777-10a84e9a0a57.png#averageHue=%23d8d2af&clientId=u243fe364-b58d-4&from=paste&height=98&id=u72c259d6&name=image.png&originHeight=122&originWidth=766&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10174&status=done&style=none&taskId=u3c5166d4-6491-4e04-8104-e0d20de7319&title=&width=612.8" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666003606142-056713e3-c369-4cbf-a75b-9b10b519913a.png#averageHue=%23f8f7f6&clientId=u243fe364-b58d-4&from=paste&height=350&id=u71dc154d&name=image.png&originHeight=438&originWidth=801&originalType=binary&ratio=1&rotation=0&showTitle=false&size=66154&status=done&style=none&taskId=u6fbe9da3-cf11-46c6-b944-13c0fb82d7f&title=&width=640.8" alt="image.png"><br>后台会显示输入了什么：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666003721657-6eb69512-59db-4f8a-af85-7d0d91f5707f.png#averageHue=%23322f2e&clientId=u243fe364-b58d-4&from=paste&height=103&id=ucb7b2c38&name=image.png&originHeight=129&originWidth=675&originalType=binary&ratio=1&rotation=0&showTitle=false&size=20544&status=done&style=none&taskId=ua016c707-7c05-4cec-9e24-3e025e763ab&title=&width=540" alt="image.png"></p>
<h2 id="ORM-连接mysql的模块"><a href="#ORM-连接mysql的模块" class="headerlink" title="ORM-连接mysql的模块"></a>ORM-连接mysql的模块</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666023328401-ea03e350-7eb7-40d1-a46c-d83cd88b2de9.png#averageHue=%23fafafa&clientId=ua6ab0993-f51f-4&from=paste&height=374&id=ue65142cb&name=image.png&originHeight=467&originWidth=1205&originalType=binary&ratio=1&rotation=0&showTitle=false&size=89984&status=done&style=none&taskId=u22c64b7b-cd32-4cd1-ac78-9b36383973e&title=&width=964" alt="image.png"><br>orm比pymysql更加的简洁<br>先要安装mysqlclient：<br>由于我是python3.7然后pycharm又是2020版本的，所以安装不到最新版，好像是这么一回事，安装了一个2.1版本，安装方法也有点不同<br>参考：<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/cn_1937/article/details/81533544">https://blog.csdn.net/cn_1937&#x2F;article&#x2F;details&#x2F;81533544</a><br>安装包：<br><a target="_blank" rel="noopener" href="https://pypi.org/project/mysqlclient/2.1.0/#files">https://pypi.org/project/mysqlclient/2.1.0/#files</a><br>安装完后即可，用<code>pip install 下载的文件名</code></p>
<h2 id="ORM-创建数据库"><a href="#ORM-创建数据库" class="headerlink" title="ORM-创建数据库"></a>ORM-创建数据库</h2><p>orm可以帮助我们做两件事情</p>
<ul>
<li>创建，修改，删除数据库中的表【无法创建数据库】</li>
<li>操作表中的数据</li>
</ul>
<h3 id="1-自己创建数据库"><a href="#1-自己创建数据库" class="headerlink" title="1.自己创建数据库"></a>1.自己创建数据库</h3><p>现在windows下载一下mysql：</p>
<p>遇到的问题：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysqld.exe --initialize --console          // 初始化</span><br><span class="line">mysqld.exe install mysql                     // 安装服务</span><br><span class="line">net start mysql                                    // 启动服务</span><br><span class="line">net stop mysql                                   // 停止命令</span><br></pre></td></tr></table></figure>
<p><code>create databse boogipop</code>:<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666025949866-fd4c40d4-cf41-497e-aa94-c38c11bde991.png#averageHue=%23131212&clientId=ua6ab0993-f51f-4&from=paste&height=264&id=u8c101761&name=image.png&originHeight=330&originWidth=1042&originalType=binary&ratio=1&rotation=0&showTitle=false&size=22003&status=done&style=none&taskId=ucd839b44-17ce-4236-940c-4a517be10ce&title=&width=833.6" alt="image.png"></p>
<h2 id="orm-连接mysql"><a href="#orm-连接mysql" class="headerlink" title="orm-连接mysql"></a>orm-连接mysql</h2><p>在settings如下设置：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">DATABASES = &#123;</span><br><span class="line">    <span class="string">&#x27;default&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;ENGINE&#x27;</span>: <span class="string">&#x27;django.db.backends.mysql&#x27;</span>,<span class="comment">#数据库文件</span></span><br><span class="line">        <span class="string">&#x27;NAME&#x27;</span>: <span class="string">&#x27;boogipop&#x27;</span>,<span class="comment">#数据库名称</span></span><br><span class="line">        <span class="string">&#x27;USER&#x27;</span>:<span class="string">&#x27;root&#x27;</span>,<span class="comment">#用户名</span></span><br><span class="line">        <span class="string">&#x27;PASSWORD&#x27;</span>:<span class="string">&#x27;jiayou357753&#x27;</span>,<span class="comment">#密码</span></span><br><span class="line">        <span class="string">&#x27;HOST&#x27;</span>:<span class="string">&#x27;127.0.0.1&#x27;</span>,<span class="comment">#数据库地址</span></span><br><span class="line">        <span class="string">&#x27;PORT&#x27;</span>:<span class="number">3306</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="orm-操作表"><a href="#orm-操作表" class="headerlink" title="orm-操作表"></a>orm-操作表</h2><p>接下来的操作就是在models.py里了，之前也说了这是对数据库进行操作的py文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Userinfo</span>(models.Model): <span class="comment">#新建了一个类，相当于创建了app01_userinfo表</span></span><br><span class="line">    name=models.CharField(max_length=<span class="number">32</span>) <span class="comment">#新建了name字段,varchar型</span></span><br><span class="line">    password=models.CharField(max_length=<span class="number">64</span>) <span class="comment">#新建了password字段,varchar型</span></span><br><span class="line">  	age=models.IntegerField() <span class="comment">#新建了age字段，为int型</span></span><br></pre></td></tr></table></figure>
<p>如果需要django帮我们去创建表，还需要2个命令:<br>终端输入:<br><code>python manage.py makemigrations</code>;<br><code>python manage.py migrate</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666027096258-f13fe152-b8e5-494f-8b24-b8db2a8073d9.png#averageHue=%232e2d2d&clientId=ua6ab0993-f51f-4&from=paste&height=101&id=u94d1e587&name=image.png&originHeight=126&originWidth=698&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16334&status=done&style=none&taskId=u1b05e54a-c062-43a7-85c5-311550e6209&title=&width=558.4" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666027108287-6b4bc945-b859-40b4-8616-39466a9463be.png#averageHue=%232f2e2d&clientId=ua6ab0993-f51f-4&from=paste&height=189&id=u5f744b8a&name=image.png&originHeight=236&originWidth=843&originalType=binary&ratio=1&rotation=0&showTitle=false&size=38875&status=done&style=none&taskId=uc1e69524-6ac8-43cd-8603-a9c33a045b2&title=&width=674.4" alt="image.png"><br>这边遇到了一些问题，如果出现<img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666027117948-12b1f50f-627f-4ba6-9736-436d144f14f0.png#averageHue=%232f2e2d&clientId=ua6ab0993-f51f-4&from=paste&height=59&id=u0270fbb7&name=image.png&originHeight=74&originWidth=660&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8593&status=done&style=none&taskId=u2bcf207f-946a-46f3-87ee-334ddbe88ed&title=&width=528" alt="image.png"><br><strong>就说明你的app目录下没有migration文件夹，并且里面要有init文件，我之前不小心弄出来了所以报错了！！！！</strong><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666027178878-6531dea5-a885-4312-82c9-921167a197c3.png#averageHue=%23131110&clientId=ua6ab0993-f51f-4&from=paste&height=264&id=ue3b884b7&name=image.png&originHeight=330&originWidth=435&originalType=binary&ratio=1&rotation=0&showTitle=false&size=26901&status=done&style=none&taskId=uc924ae09-01d4-4cff-aa02-510858560f9&title=&width=348" alt="image.png"><br>在mysql中可以看到出来了很多表，其中就包含了我们的<code>app01_userinfo</code><br>为什么会有其他的很多表呢？因为我们注册了很多app：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666027300316-179435d9-ad67-41d9-bb4f-675cec81cb00.png#averageHue=%232c2b2b&clientId=ua6ab0993-f51f-4&from=paste&height=185&id=u4fb12bb6&name=image.png&originHeight=231&originWidth=462&originalType=binary&ratio=1&rotation=0&showTitle=false&size=24312&status=done&style=none&taskId=u7f842350-d4cd-4193-ad41-59c6948e582&title=&width=369.6" alt="image.png"><br>django在注册表的时候，会去每个app的models.py文件下去查找，其他app里也有models.py，所以后面多出来了一些表</p>
<h3 id="增删改查"><a href="#增删改查" class="headerlink" title="增删改查"></a>增删改查</h3><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666077430021-a3e8cbd4-e9f8-4476-bff5-738804051a3f.png#averageHue=%2331302e&clientId=u29bc6d84-7fcc-4&from=paste&height=234&id=ue180da19&name=image.png&originHeight=292&originWidth=724&originalType=binary&ratio=1&rotation=0&showTitle=false&size=53824&status=done&style=none&taskId=ue58039f1-3081-48d8-bea9-93fa7f59ef3&title=&width=579.2" alt="image.png"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#新建数据 相当于 insert into <span class="title function_">app01_department</span><span class="params">(title)</span>values(<span class="string">&quot;娱乐部&quot;</span>)</span><br><span class="line">Department.objects.create( title=<span class="string">&quot;娱乐部&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>可以一次性给多个字段添加数据，后面加逗号分割<br>接下来我们来测试orm，首先添加一下orm路由和函数：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666077526801-6424e5e0-3b33-4f42-9e50-0b6ff5c1bf62.png#averageHue=%232e2d2c&clientId=u29bc6d84-7fcc-4&from=paste&height=283&id=u978d5c16&name=image.png&originHeight=354&originWidth=1486&originalType=binary&ratio=1&rotation=0&showTitle=false&size=98161&status=done&style=none&taskId=u38b915b0-b776-457c-bd4c-7feac8fc413&title=&width=1188.8" alt="image.png"><br>然后在views.py导入models.py：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666077754059-f0697c44-fe5d-4e2f-8638-2234db4bc28b.png#averageHue=%23302f2d&clientId=u29bc6d84-7fcc-4&from=paste&height=91&id=u58831d28&name=image.png&originHeight=114&originWidth=537&originalType=binary&ratio=1&rotation=0&showTitle=false&size=12814&status=done&style=none&taskId=ua8d80fd5-06ba-452c-926b-65af46bf453&title=&width=429.6" alt="image.png"><br>之后就用<code>models.Userinfo.xxxx</code>去进行增删改查操作<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666080614732-f1ff2253-193a-474a-bdea-f98be026a606.png#averageHue=%23718865&clientId=u28a3b05f-3482-4&from=paste&height=109&id=u29324109&name=image.png&originHeight=136&originWidth=689&originalType=binary&ratio=1&rotation=0&showTitle=false&size=23765&status=done&style=none&taskId=udc69866d-2045-4577-bbcc-8d953046c10&title=&width=551.2" alt="image.png"><br>再访问网址：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666077996722-dbbedde9-6bfc-4e58-b0a2-b415cc2f2fbf.png#averageHue=%23fcfee3&clientId=u29bc6d84-7fcc-4&from=paste&height=106&id=u88c62260&name=image.png&originHeight=132&originWidth=833&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7105&status=done&style=none&taskId=u2be4d18c-a785-478a-9617-dcd0c588aa2&title=&width=666.4" alt="image.png"><br>这里要注意一下，一定要把department表注册了哦<br>然后在数据库中查看：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666078084516-12918850-e110-4b14-ba38-72fab8378467.png#averageHue=%23131212&clientId=u29bc6d84-7fcc-4&from=paste&height=175&id=u10be9b72&name=image.png&originHeight=219&originWidth=692&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13412&status=done&style=none&taskId=u8049d1b7-3f9f-4558-82f2-360732435dd&title=&width=553.6" alt="image.png"><br>成功添加数据</p>
<ul>
<li><p>删除数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">models.Userinfo.objects.filter(id=<span class="number">2</span>).delete()#删除id=<span class="number">2</span>的用户</span><br><span class="line">models.Userinfo.objects.filter(id=<span class="number">3</span>).delete()#删除id=<span class="number">3</span>的用户</span><br><span class="line"># models.Userinfo.objects.all().delete() #删除所有用户</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666078476502-a7ee4c14-4203-4afb-bd1e-b4e746e1d809.png#averageHue=%23171615&clientId=u29bc6d84-7fcc-4&from=paste&height=273&id=ucc033731&name=image.png&originHeight=341&originWidth=576&originalType=binary&ratio=1&rotation=0&showTitle=false&size=19715&status=done&style=none&taskId=ua7d3bfb9-33cc-4130-83f6-ee956a1f0c9&title=&width=460.8" alt="image.png"></p>
</li>
<li><p>获取数据</p>
</li>
</ul>
<p>测试的表如下：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666078857735-93f9d89d-0da8-4322-bb58-03268030e7ea.png#averageHue=%23141211&clientId=u29bc6d84-7fcc-4&from=paste&height=117&id=u01d2df8d&name=image.png&originHeight=146&originWidth=423&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9384&status=done&style=none&taskId=ub37397a1-5525-4971-893b-db74a822d3c&title=&width=338.4" alt="image.png"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(models.Userinfo.objects.all()) #获取userinfo表里的所有数据</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666078930675-9c129878-8731-4898-87ce-51a305245d46.png#averageHue=%2333312f&clientId=u29bc6d84-7fcc-4&from=paste&height=34&id=u6e02f0e6&name=image.png&originHeight=43&originWidth=862&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10193&status=done&style=none&taskId=ucbf50f92-1c78-4c5e-ae79-6788d7ad335&title=&width=689.6" alt="image.png"><br>说明里面有两行数据，每一行都是一个对象，如何取数据呢？<br>用循环语句去获取<br>如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data=models.Userinfo.objects.<span class="built_in">all</span>() <span class="comment">#获取userinfo表里的所有数据</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    <span class="built_in">print</span>(i.<span class="built_in">id</span>,i.age,i.name,i.password)</span><br><span class="line"><span class="comment">#相当于 print(data[0].id,data[0].name)</span></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666079025504-049b8216-0d34-4cbf-b9a3-8e4e106ee915.png#averageHue=%23302d2c&clientId=u29bc6d84-7fcc-4&from=paste&height=72&id=uedde6abf&name=image.png&originHeight=90&originWidth=678&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10635&status=done&style=none&taskId=u9330dbc3-35da-4a50-8460-4b408a066b8&title=&width=542.4" alt="image.png"><br>还可以用filter筛选：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data=models.Userinfo.objects.<span class="built_in">filter</span>(<span class="built_in">id</span>=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>得到的也是一个对象，是第一行数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a=models.Userinfo.objects.<span class="built_in">filter</span>(<span class="built_in">id</span>=<span class="number">1</span>).first</span><br><span class="line"><span class="built_in">print</span>(a.<span class="built_in">id</span>)</span><br><span class="line"><span class="comment">#等价于</span></span><br><span class="line">a=models.Userinfo.objects.<span class="built_in">filter</span>(<span class="built_in">id</span>=<span class="number">1</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(a.<span class="built_in">id</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>修改数据<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">models.Userinfo.objects.<span class="built_in">filter</span>(<span class="built_in">id</span>=<span class="number">4</span>).update(name=<span class="string">&quot;heart&quot;</span>)</span><br></pre></td></tr></table></figure>
<img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666079479054-d0125000-ec09-40f6-a67f-fe8283671557.png#averageHue=%23121110&clientId=u29bc6d84-7fcc-4&from=paste&height=278&id=uff2f9472&name=image.png&originHeight=348&originWidth=645&originalType=binary&ratio=1&rotation=0&showTitle=false&size=20990&status=done&style=none&taskId=u262f6f68-aa61-4091-9c58-d2b1dab093c&title=&width=516" alt="image.png"></li>
</ul>
<h2 id="ORM案例-用户管理"><a href="#ORM案例-用户管理" class="headerlink" title="ORM案例-用户管理"></a>ORM案例-用户管理</h2><h3 id="功能1-展示用户列表"><a href="#功能1-展示用户列表" class="headerlink" title="功能1-展示用户列表"></a>功能1-展示用户列表</h3><p> <img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666079855286-7e61f9db-2443-4eee-891f-a0a74ca91d60.png#averageHue=%232f2f2e&clientId=u29bc6d84-7fcc-4&from=paste&height=206&id=udd98682b&name=image.png&originHeight=257&originWidth=1376&originalType=binary&ratio=1&rotation=0&showTitle=false&size=56762&status=done&style=none&taskId=ua38c41d0-a28d-479b-b69b-f099ecb15dc&title=&width=1100.8" alt="image.png"><br>新建一个infolist函数并添加路由<br>再写一个html文件如下：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666080378091-39e3a53e-7036-425f-8f8d-6b0539b510a1.png#averageHue=%232f2e2d&clientId=u28a3b05f-3482-4&from=paste&height=388&id=uc40f3864&name=image.png&originHeight=485&originWidth=1524&originalType=binary&ratio=1&rotation=0&showTitle=false&size=137803&status=done&style=none&taskId=ufea11c22-0b3e-4b97-be80-adb31bc4c62&title=&width=1219.2" alt="image.png"><br>源码我最后放<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666080428082-3f507899-8906-4835-8f59-b4f8ffd8ed21.png#averageHue=%23fafafa&clientId=u28a3b05f-3482-4&from=paste&height=204&id=u0d9af923&name=image.png&originHeight=255&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=25965&status=done&style=none&taskId=udcfa82a9-2e8a-4626-ae63-45113970a3a&title=&width=1536" alt="image.png"><br>可以看到成功显示！</p>
<h3 id="功能2-添加用户"><a href="#功能2-添加用户" class="headerlink" title="功能2-添加用户"></a>功能2-添加用户</h3><p>是自己手打的哦</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">adduser</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method==<span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> render(request,<span class="string">&quot;user_add.html&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> request.method==<span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username=request.POST.get(<span class="string">&quot;user&quot;</span>)</span><br><span class="line">        password=request.POST.get(<span class="string">&quot;pwd&quot;</span>)</span><br><span class="line">        age=request.POST.get(<span class="string">&quot;age&quot;</span>)</span><br><span class="line">        models.Userinfo.objects.create(name=username,password=password,age=age)</span><br><span class="line">        <span class="keyword">return</span> HttpResponse(<span class="string">&quot;添加成功！！&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>添加用户<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>添加用户<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">action</span>=<span class="string">&quot;/info/add/&quot;</span>&gt;</span></span><br><span class="line">      &#123;% csrf_token %&#125;</span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;用户名&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;pwd&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;密码&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;年龄&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;提交&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666083184088-ff793abf-a1f5-4546-a52d-b1b33e9bd2ec.png#averageHue=%23f7f7f6&clientId=u28a3b05f-3482-4&from=paste&height=145&id=u801236ff&name=image.png&originHeight=181&originWidth=886&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7740&status=done&style=none&taskId=u309a5f8c-edc8-4f65-8850-12f80f488cc&title=&width=708.8" alt="image.png"><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666083187074-7d4d6d06-c6f2-4fa9-bbf9-3d1b2e8ea8e8.png#averageHue=%23fdfddb&clientId=u28a3b05f-3482-4&from=paste&height=68&id=u2951ac3b&name=image.png&originHeight=85&originWidth=600&originalType=binary&ratio=1&rotation=0&showTitle=false&size=6145&status=done&style=none&taskId=ued4d478d-292d-453f-aef6-88f43908289&title=&width=480" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666083192017-f9753b59-699c-4255-9c5e-dc47cf2218f2.png#averageHue=%23f0efef&clientId=u28a3b05f-3482-4&from=paste&height=233&id=ub725d5ca&name=image.png&originHeight=291&originWidth=523&originalType=binary&ratio=1&rotation=0&showTitle=false&size=15739&status=done&style=none&taskId=ud707e90f-4400-477f-bf02-5d6bd196bdf&title=&width=418.4" alt="image.png"></p>
<p>进一步美化：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666083748756-4bce69a1-7212-44e9-ae36-e196c0a75934.png#averageHue=%232f2e2c&clientId=u28a3b05f-3482-4&from=paste&height=54&id=ud6f87abb&name=image.png&originHeight=68&originWidth=564&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10380&status=done&style=none&taskId=uf22b7c0b-d242-4654-b119-273551406eb&title=&width=451.2" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666083752530-7421c9cf-d39f-4328-80f8-ca31540fa99a.png#averageHue=%23f3f2f1&clientId=u28a3b05f-3482-4&from=paste&height=284&id=u8e07e38f&name=image.png&originHeight=355&originWidth=532&originalType=binary&ratio=1&rotation=0&showTitle=false&size=17243&status=done&style=none&taskId=u16d80a15-3019-45b9-93ec-7ff3c1987d4&title=&width=425.6" alt="image.png"></p>
<h3 id="功能3-删除用户"><a href="#功能3-删除用户" class="headerlink" title="功能3-删除用户"></a>功能3-删除用户</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">deluser</span>(<span class="params">request</span>):</span><br><span class="line">    uid=request.GET.get(<span class="string">&quot;uid&quot;</span>)</span><br><span class="line">    models.Userinfo.objects.<span class="built_in">filter</span>(<span class="built_in">id</span>=uid).delete()</span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">&quot;/info/list&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>用户列表<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Information<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://localhost:8000/info/add&quot;</span>&gt;</span>添加用户<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">th</span>&gt;</span>ID<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">th</span>&gt;</span>姓名<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">th</span>&gt;</span>密码<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">th</span>&gt;</span>年龄<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">        &#123;% for obj in data_list %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; obj.id &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; obj.name &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span>&gt;</span>&quot;&#123;&#123; obj.password &#125;&#125;&quot;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; obj.age &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://127.0.0.1:8000/info/del/?uid=&#123;&#123; obj.id &#125;&#125;&quot;</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        &#123;% endfor %&#125;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>至此就结束了：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666084662675-9b1db9e0-c94d-4dec-8e21-63a114265f59.png#averageHue=%23faf9f9&clientId=u28a3b05f-3482-4&from=paste&height=288&id=u4af1fa1c&name=image.png&originHeight=360&originWidth=1306&originalType=binary&ratio=1&rotation=0&showTitle=false&size=24153&status=done&style=none&taskId=u7e97d289-1364-49be-b073-197a8c3575e&title=&width=1044.8" alt="image.png"></p>
<h1 id="员工管理系统"><a href="#员工管理系统" class="headerlink" title="员工管理系统"></a>员工管理系统</h1><h2 id="创建项目和app"><a href="#创建项目和app" class="headerlink" title="创建项目和app"></a>创建项目和app</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666184779798-f8f27a4d-cbce-4de8-9143-bc5dc7652196.png#averageHue=%2352744a&clientId=u1c7fad2c-33c4-4&from=paste&height=519&id=u6bc413ba&name=image.png&originHeight=649&originWidth=1527&originalType=binary&ratio=1&rotation=0&showTitle=false&size=123388&status=done&style=none&taskId=u2ed43b8c-e0b8-428e-80c0-c2bcbcb62b6&title=&width=1221.6" alt="image.png">点run manage.py task:<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666184797430-f53ff68c-36fd-4c13-b3e1-7a8f9845bd50.png#averageHue=%23312d2c&clientId=u1c7fad2c-33c4-4&from=paste&height=121&id=u71f0b50d&name=image.png&originHeight=151&originWidth=635&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16900&status=done&style=none&taskId=ua42b1c68-3c0f-4e60-bf71-e907cce17ee&title=&width=508" alt="image.png"><br>输入<code>startapp app01</code>，在这之前也需要settings里<code>improt os</code>:<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666184877951-3852425c-8ac4-4a4d-a14f-2666817d2098.png#averageHue=%233d4249&clientId=u1c7fad2c-33c4-4&from=paste&height=273&id=ub0a82898&name=image.png&originHeight=341&originWidth=775&originalType=binary&ratio=1&rotation=0&showTitle=false&size=41694&status=done&style=none&taskId=u31e81c2a-5616-4038-9a2a-1646ecdb4c2&title=&width=620" alt="image.png"><br>创建成功QWQ<br>别忘了注册</p>
<h2 id="表结构的创建"><a href="#表结构的创建" class="headerlink" title="表结构的创建"></a>表结构的创建</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666188774862-ea473cc8-8379-4cf1-a10f-8bbc97b05a1b.png#averageHue=%232e2d2c&clientId=u1c7fad2c-33c4-4&from=paste&height=405&id=u699194ee&name=image.png&originHeight=506&originWidth=1188&originalType=binary&ratio=1&rotation=0&showTitle=false&size=100550&status=done&style=none&taskId=ua649773d-f5f9-4b86-8611-486c1ae26fc&title=&width=950.4" alt="image.png"><br>创建表的信息如上，foreignkey表示depart_id只可以在department中的id的值范围里取，另外在数据库中foreignkey会在depart后面自动加上一个_id，最后是depart_id<br>为什么Department里为什么没有id字段呢？这是因为django会自己帮你创建一个</p>
<p>但这个还不是最终的表，假如我们删除一个部门，那底下的用户是不是也该删除呢？<br>要在ForeignKey后面加：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666188853199-b4dcce84-25f4-44a9-8b47-6c81d81a7546.png#averageHue=%23333231&clientId=u1c7fad2c-33c4-4&from=paste&height=50&id=u70b5e383&name=image.png&originHeight=63&originWidth=950&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16444&status=done&style=none&taskId=u72c08031-e122-411c-aa77-1649457d42e&title=&width=760" alt="image.png"><br>另外如果我们不想删除这些部门的人，我们把他的部门ID滞空，可以这样写：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666189112061-2af49da0-cecc-469c-9922-254e7f6e7a8e.png#averageHue=%23312f2f&clientId=u1c7fad2c-33c4-4&from=paste&height=89&id=u4ec1febe&name=image.png&originHeight=111&originWidth=1117&originalType=binary&ratio=1&rotation=0&showTitle=false&size=27729&status=done&style=none&taskId=u44337b50-bbca-4efb-ac53-f709074f1f8&title=&width=893.6" alt="image.png"></p>
<p>再加上性别，最终的代码为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Department</span>(models.Model):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;部门表&#x27;&#x27;&#x27;</span></span><br><span class="line">    title=models.CharField(verbose_name=<span class="string">&quot;标题&quot;</span>,max_length=<span class="number">64</span>)</span><br><span class="line">    <span class="comment">#verbose_name表示备注信息一样</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserInfo</span>(models.Model):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;员工表&#x27;&#x27;&#x27;</span></span><br><span class="line">    name=models.CharField(verbose_name=<span class="string">&quot;名字&quot;</span>,max_length=<span class="number">32</span>)</span><br><span class="line">    password=models.CharField(verbose_name=<span class="string">&quot;密码&quot;</span>,max_length=<span class="number">64</span>)</span><br><span class="line">    age=models.IntegerField(verbose_name=<span class="string">&quot;年龄&quot;</span>)</span><br><span class="line">    account=models.DecimalField(verbose_name=<span class="string">&quot;账户余额&quot;</span>,max_digits=<span class="number">10</span>,decimal_places=<span class="number">2</span>,default=<span class="number">0</span>)</span><br><span class="line">    <span class="comment">#账户余额为小数，最大长度为10，小数点后面占2个，默认是0余额</span></span><br><span class="line">    create_time=models.DateTimeField(verbose_name=<span class="string">&quot;入职时期&quot;</span>)</span><br><span class="line">    <span class="comment">#表示日期类型</span></span><br><span class="line">    <span class="comment"># depart_id=models.CharField(verbose_name=&quot;所属部门&quot;,max_length=32)</span></span><br><span class="line">    <span class="comment"># depart_id=models.BigIntegerField(verbose_name=&quot;部门ID&quot;)</span></span><br><span class="line">    <span class="comment">#BigIntegerField表示大整数也就是long</span></span><br><span class="line">    <span class="comment">#无约束</span></span><br><span class="line">    <span class="comment"># depart=models.ForeignKey(to=&#x27;Department&#x27;,to_field=&#x27;id&#x27;,on_delete=models.CASCADE())</span></span><br><span class="line">    <span class="comment">#有约束，to表示与哪张表关联，to_field表示和表里什么字段关联,CASCADE表示的是级联删除</span></span><br><span class="line">    depart=models.ForeignKey(to=<span class="string">&#x27;Department&#x27;</span>,to_field=<span class="string">&#x27;id&#x27;</span>,null=<span class="literal">True</span>,blank=<span class="literal">True</span>,on_delete=models.SET_NULL)</span><br><span class="line">    <span class="comment">#null,blank=true,on_delete=models.SET_NULL表示这一列可以为空</span></span><br><span class="line">    gender_choice=(</span><br><span class="line">        (<span class="number">1</span>,<span class="string">&quot;男&quot;</span>),</span><br><span class="line">        (<span class="number">2</span>,<span class="string">&quot;女&quot;</span>)</span><br><span class="line">    )</span><br><span class="line">    gender=models.SmallIntegerField(verbose_name=<span class="string">&quot;性别&quot;</span>,choices=gender_choice)</span><br><span class="line">    <span class="comment">#这是DJango中做的约束，表示1代表男，2代表女，上面的滞空和级联都是数据库里的约束，这里表示以后输入1就代表男</span></span><br><span class="line">    <span class="comment">#Smallintergerfield表示小整数</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="MYSQL生成数据库"><a href="#MYSQL生成数据库" class="headerlink" title="MYSQL生成数据库"></a>MYSQL生成数据库</h2><p><code>create database OA</code>:<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666190199501-3ec417f8-6c47-48e6-b457-a8d908b6c48a.png#averageHue=%23161412&clientId=u1c7fad2c-33c4-4&from=paste&height=40&id=uec58991e&name=image.png&originHeight=50&originWidth=449&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5180&status=done&style=none&taskId=u90ab2722-75f7-494e-b2af-a1929237f3d&title=&width=359.2" alt="image.png"><br>再用django去创建一下表：<br>先修改配置文件连接mysql：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666190497984-b77b5913-5563-4542-a47b-4c549daff6a5.png#averageHue=%232c2c2c&clientId=u1c7fad2c-33c4-4&from=paste&height=230&id=u70ec63fa&name=image.png&originHeight=288&originWidth=784&originalType=binary&ratio=1&rotation=0&showTitle=false&size=28193&status=done&style=none&taskId=u7252af23-d0b2-4edf-9a8f-1958a471b22&title=&width=627.2" alt="image.png"><br>再运行指令即可：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666190796592-78128771-b300-4061-959c-10d7347e8973.png#averageHue=%232e2d2c&clientId=u1c7fad2c-33c4-4&from=paste&height=167&id=uf2beb1cd&name=image.png&originHeight=209&originWidth=900&originalType=binary&ratio=1&rotation=0&showTitle=false&size=31623&status=done&style=none&taskId=ua72a6429-c4ff-4c4e-a284-b0245cec80c&title=&width=720" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666190800899-4c95915d-3819-40da-8b0f-5ccede0f2abc.png#averageHue=%2312100f&clientId=u1c7fad2c-33c4-4&from=paste&height=262&id=u9a14f8f2&name=image.png&originHeight=328&originWidth=455&originalType=binary&ratio=1&rotation=0&showTitle=false&size=21975&status=done&style=none&taskId=u1b40a0d0-c4b7-4494-bc62-2ff489f40aa&title=&width=364" alt="image.png"></p>
<h2 id="部门列表展示"><a href="#部门列表展示" class="headerlink" title="部门列表展示"></a>部门列表展示</h2><p>先加入一些静态文件<br>然后准备个html文件，做页面展示：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">&#123;% load static %&#125;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&#123;% static &#x27;plugins/bootstrap-3.4.1/css/bootstrap.min.css&#x27; %&#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.navbar</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border-radius</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">nav</span> <span class="attr">class</span>=<span class="string">&quot;navbar navbar-default&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;navbar-header&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">class</span>=<span class="string">&quot;navbar-toggle collapsed&quot;</span> <span class="attr">data-toggle</span>=<span class="string">&quot;collapse&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">data-target</span>=<span class="string">&quot;#bs-example-navbar-collapse-1&quot;</span> <span class="attr">aria-expanded</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;sr-only&quot;</span>&gt;</span>Toggle navigation<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;icon-bar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;icon-bar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;icon-bar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;navbar-brand&quot;</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span> 联通用户管理系统 <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;collapse navbar-collapse&quot;</span> <span class="attr">id</span>=<span class="string">&quot;bs-example-navbar-collapse-1&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;nav navbar-nav&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/depart/list/&quot;</span>&gt;</span>部门管理<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/user/list/&quot;</span>&gt;</span>用户管理<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>Link<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;nav navbar-nav navbar-right&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;dropdown&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">class</span>=<span class="string">&quot;dropdown-toggle&quot;</span> <span class="attr">data-toggle</span>=<span class="string">&quot;dropdown&quot;</span> <span class="attr">role</span>=<span class="string">&quot;button&quot;</span> <span class="attr">aria-haspopup</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">                       <span class="attr">aria-expanded</span>=<span class="string">&quot;false&quot;</span>&gt;</span>Boogipop <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;caret&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;dropdown-menu&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>个人资料<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>我的信息<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span> <span class="attr">role</span>=<span class="string">&quot;separator&quot;</span> <span class="attr">class</span>=<span class="string">&quot;divider&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>注销<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;margin-bottom: 10px;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-success&quot;</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;glyphicon glyphicon-plus&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            新建部门</span><br><span class="line">        <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel panel-default&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- Default panel contents --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel-heading&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;glyphicon glyphicon-th-list&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          部门列表</span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- Table --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">&quot;table table-bordered&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>ID<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>部门名称<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">        &#123;% for data in Infolist%&#125;</span><br><span class="line">          <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; data.id &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; data.title &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary btn-xs&quot;</span>&gt;</span>编辑<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-danger btn-xs&quot;</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        &#123;% endfor %&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&#123;% static &#x27;js/jquery-3.6.0.min.js&#x27; %&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&#123;% static &#x27;plugins/bootstrap-3.4.1/js/bootstrap.min.js&#x27; %&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666193168343-08032da5-e22a-4491-9bcd-b2a4c9934198.png#averageHue=%232f2e2c&clientId=u1c7fad2c-33c4-4&from=paste&height=129&id=u5490a70d&name=image.png&originHeight=161&originWidth=598&originalType=binary&ratio=1&rotation=0&showTitle=false&size=19729&status=done&style=none&taskId=ud451cba6-911c-44c0-8bd5-07ff45848e8&title=&width=478.4" alt="image.png"><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666193174100-c0afae46-37ba-4c99-8747-368e590e8fca.png#averageHue=%232e2c2b&clientId=u1c7fad2c-33c4-4&from=paste&height=332&id=u9dcec972&name=image.png&originHeight=415&originWidth=584&originalType=binary&ratio=1&rotation=0&showTitle=false&size=55476&status=done&style=none&taskId=ufc657caa-b339-4f1d-970a-e4b3da201c3&title=&width=467.2" alt="image.png"><br>最后效果如下：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666255913802-46f4588b-64ce-458c-bcba-419b483c49f8.png#averageHue=%23fbfbfa&clientId=u81348cfa-82a0-4&from=paste&height=437&id=ufcfadff1&name=image.png&originHeight=546&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=43871&status=done&style=none&taskId=u233d2241-7cd0-4098-a57a-33f4d6c0a6f&title=&width=1536" alt="image.png"><br>还挺不错的哈</p>
<h2 id="数据库数据"><a href="#数据库数据" class="headerlink" title="数据库数据"></a>数据库数据</h2><p><code> insert into app_department(title) values(&quot;心理部&quot;);</code><br><code> insert into app01_department(title) values(&quot;CTF部&quot;);</code><br>然后在html页面添加模板语句：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666256203601-1fc9f4c6-575a-4746-886e-7a182f9d1407.png#averageHue=%232e2d2c&clientId=u81348cfa-82a0-4&from=paste&height=217&id=ua349a4e3&name=image.png&originHeight=271&originWidth=571&originalType=binary&ratio=1&rotation=0&showTitle=false&size=27332&status=done&style=none&taskId=u621d611c-15c6-414d-b56a-6169af5d736&title=&width=456.8" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666256208411-2c048848-9a0f-4f81-8b12-b2872334a703.png#averageHue=%23fbfbfa&clientId=u81348cfa-82a0-4&from=paste&height=337&id=u50dc2300&name=image.png&originHeight=421&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=33469&status=done&style=none&taskId=u10a13bb6-c315-452d-9ff7-746c43e5122&title=&width=1536" alt="image.png"><br>成功显示</p>
<h2 id="新建部门"><a href="#新建部门" class="headerlink" title="新建部门"></a>新建部门</h2><p>事先说好，这些模板都是在<a target="_blank" rel="noopener" href="https://v3.bootcss.com/css/#forms-horizontal">https://v3.bootcss.com/css/#forms-horizontal</a>直接拿的<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666256818432-0e6a76e3-5f1a-4f0f-b073-854e9c723a42.png#averageHue=%2331302d&clientId=u81348cfa-82a0-4&from=paste&height=34&id=u73032080&name=image.png&originHeight=42&originWidth=690&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8558&status=done&style=none&taskId=uc7c956ed-0b6f-42cc-96c9-96ce1a8f479&title=&width=552" alt="image.png"><br>先添加一条a标签，跳转到添加页面<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666256873778-d1717664-c902-46b1-b2ee-9244297600ce.png#averageHue=%2331302e&clientId=u81348cfa-82a0-4&from=paste&height=97&id=u53f558bc&name=image.png&originHeight=121&originWidth=554&originalType=binary&ratio=1&rotation=0&showTitle=false&size=18365&status=done&style=none&taskId=ua6075a88-9cca-4190-b722-526ddfbbd5e&title=&width=443.2" alt="image.png"><br>添加路由<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666256926922-896e29fa-15cf-48d9-8fc2-e537c5ac58f5.png#averageHue=%2335332f&clientId=u81348cfa-82a0-4&from=paste&height=68&id=u865622ab&name=image.png&originHeight=85&originWidth=494&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10413&status=done&style=none&taskId=u9c26dd48-47e2-4560-8a35-f109545e799&title=&width=395.2" alt="image.png"><br>添加函数<br>然后html页面从之前的部门列表界面，把导航条拿过来：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666258237956-ea4eb816-2dbc-416d-8ac2-b25b83be1637.png#averageHue=%23fcfcfc&clientId=u81348cfa-82a0-4&from=paste&height=306&id=u59c975c6&name=image.png&originHeight=383&originWidth=1751&originalType=binary&ratio=1&rotation=0&showTitle=false&size=15249&status=done&style=none&taskId=u8d6fb71c-8dbd-4e5a-a36c-64c39072e53&title=&width=1400.8" alt="image.png"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">&#123;% load static %&#125;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&#123;% static &#x27;plugins/bootstrap-3.4.1/css/bootstrap.min.css&#x27; %&#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.navbar</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border-radius</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">nav</span> <span class="attr">class</span>=<span class="string">&quot;navbar navbar-default&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;navbar-header&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">class</span>=<span class="string">&quot;navbar-toggle collapsed&quot;</span> <span class="attr">data-toggle</span>=<span class="string">&quot;collapse&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">data-target</span>=<span class="string">&quot;#bs-example-navbar-collapse-1&quot;</span> <span class="attr">aria-expanded</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;sr-only&quot;</span>&gt;</span>Toggle navigation<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;icon-bar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;icon-bar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;icon-bar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;navbar-brand&quot;</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span> 联通用户管理系统 <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;collapse navbar-collapse&quot;</span> <span class="attr">id</span>=<span class="string">&quot;bs-example-navbar-collapse-1&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;nav navbar-nav&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/depart/list/&quot;</span>&gt;</span>部门管理<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/user/list/&quot;</span>&gt;</span>用户管理<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>Link<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;nav navbar-nav navbar-right&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;dropdown&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">class</span>=<span class="string">&quot;dropdown-toggle&quot;</span> <span class="attr">data-toggle</span>=<span class="string">&quot;dropdown&quot;</span> <span class="attr">role</span>=<span class="string">&quot;button&quot;</span> <span class="attr">aria-haspopup</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">                       <span class="attr">aria-expanded</span>=<span class="string">&quot;false&quot;</span>&gt;</span>Boogipop <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;caret&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;dropdown-menu&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>个人资料<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>我的信息<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span> <span class="attr">role</span>=<span class="string">&quot;separator&quot;</span> <span class="attr">class</span>=<span class="string">&quot;divider&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>注销<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel panel-default&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel-heading&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">&quot;panel-title&quot;</span>&gt;</span>新建部门<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel-body&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> &gt;</span>标题<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;标题&quot;</span> <span class="attr">name</span>=<span class="string">&quot;title&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"> <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span>  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&#123;% static &#x27;js/jquery-3.6.0.min.js&#x27; %&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&#123;% static &#x27;plugins/bootstrap-3.4.1/js/bootstrap.min.js&#x27; %&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>


<h2 id="部门添加"><a href="#部门添加" class="headerlink" title="部门添加"></a>部门添加</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666258520425-158dd8ac-50ec-46e5-8515-69ca73c8b4d7.png#averageHue=%23312f2e&clientId=u81348cfa-82a0-4&from=paste&height=46&id=uf8850629&name=image.png&originHeight=58&originWidth=661&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7222&status=done&style=none&taskId=ue6975353-8a69-4fcc-8056-889322fc800&title=&width=528.8" alt="image.png"><br>设置一下提交方式，然后再改一下函数：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666258657253-650f0b9b-b82c-4a89-8fde-3b9b23ecb2dd.png#averageHue=%232f2e2d&clientId=u81348cfa-82a0-4&from=paste&height=262&id=ue9df5a8e&name=image.png&originHeight=328&originWidth=730&originalType=binary&ratio=1&rotation=0&showTitle=false&size=42892&status=done&style=none&taskId=ub10f89be-4562-436f-abad-dfdfd96c280&title=&width=584" alt="image.png"><br>测试：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666258678704-a39983df-825f-4fdf-a324-05cb4c095a27.png#averageHue=%23fcfcfc&clientId=u81348cfa-82a0-4&from=paste&height=212&id=u763e2e72&name=image.png&originHeight=265&originWidth=1659&originalType=binary&ratio=1&rotation=0&showTitle=false&size=11066&status=done&style=none&taskId=uc9011ae0-97bd-4c9b-8123-4a51d43ef23&title=&width=1327.2" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666258683365-01715996-fc45-41d7-b0e4-85fdd549a1e0.png#averageHue=%23fbfbfa&clientId=u81348cfa-82a0-4&from=paste&height=270&id=u9edd4512&name=image.png&originHeight=337&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=20028&status=done&style=none&taskId=uf9f108cd-785a-4b0b-ac25-c20ffbd3b64&title=&width=1536" alt="image.png"><br>成功添加！</p>
<h2 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666259229270-306b13cd-b26b-4302-9b9e-7f0f0aa062c3.png#averageHue=%232e2e2d&clientId=u81348cfa-82a0-4&from=paste&height=183&id=u98cae0e1&name=image.png&originHeight=229&originWidth=1458&originalType=binary&ratio=1&rotation=0&showTitle=false&size=50292&status=done&style=none&taskId=uafb7a4ef-e2e7-4e32-acb1-2a02046924a&title=&width=1166.4" alt="image.png"><br>添加函数跟路由</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary btn-xs&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://127.0.0.1:8000/depart/del/?uid=&#123;&#123; data.id &#125;&#125;&quot;</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>修改HTML代码<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666259374180-599c641a-f219-48dd-8926-e082abaae6d7.png#averageHue=%23fcfbfb&clientId=u81348cfa-82a0-4&from=paste&height=294&id=u28ac3572&name=image.png&originHeight=367&originWidth=1809&originalType=binary&ratio=1&rotation=0&showTitle=false&size=20564&status=done&style=none&taskId=ue1ace9c2-141c-4442-a7d4-4f2ff066a34&title=&width=1447.2" alt="image.png"><br>成功删除咯</p>
<h2 id="编辑"><a href="#编辑" class="headerlink" title="编辑"></a>编辑</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666282699330-b09b510a-3f2d-4303-b327-145cb3369ef0.png#averageHue=%232e2e2d&clientId=u24f5bbd9-89c7-4&from=paste&height=146&id=u1443c1cb&name=image.png&originHeight=182&originWidth=1412&originalType=binary&ratio=1&rotation=0&showTitle=false&size=36993&status=done&style=none&taskId=u7eae2f05-e4f9-45ca-9638-910ab8e1a95&title=&width=1129.6" alt="image.png"><br>添加路由和函数，以及html页面<br>接下来获取ID咱们就用一种不一样的方式：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666283529407-eb3c10f6-8ecf-4512-876a-7669b7a1ef00.png#averageHue=%23353432&clientId=u24f5bbd9-89c7-4&from=paste&height=57&id=u5f69efc0&name=image.png&originHeight=71&originWidth=563&originalType=binary&ratio=1&rotation=0&showTitle=false&size=12408&status=done&style=none&taskId=ua595e2ba-2fd8-442f-8649-1a61af8e6e6&title=&width=450.4" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666283532908-c8bc0d15-4912-47f8-9fce-044e0c434846.png#averageHue=%232e2d2b&clientId=u24f5bbd9-89c7-4&from=paste&height=33&id=u8b5f7742&name=image.png&originHeight=41&originWidth=596&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7252&status=done&style=none&taskId=uec34e46b-e7cd-47aa-a822-a02997307e4&title=&width=476.8" alt="image.png"><br>酱紫修改就是一种船新的方式，可以达到上面删除界面中同样的效果！<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666283766176-4c8ceabf-b022-48e6-abaf-94d2c7452d7d.png#averageHue=%23302e2d&clientId=u24f5bbd9-89c7-4&from=paste&height=138&id=u938e0d8a&name=image.png&originHeight=172&originWidth=627&originalType=binary&ratio=1&rotation=0&showTitle=false&size=26290&status=done&style=none&taskId=u8930f6e1-ac02-411a-92d4-8557c0aa7fc&title=&width=501.6" alt="image.png"><br>这样就可以拿到对应的数据：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666283787787-e3794f10-a321-4255-98e1-39c295842e71.png#averageHue=%231c4d85&clientId=u24f5bbd9-89c7-4&from=paste&height=42&id=u801c51ce&name=image.png&originHeight=52&originWidth=549&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4531&status=done&style=none&taskId=u0654e51f-ec30-44cc-ae27-f450d1092e6&title=&width=439.2" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666283781903-2e5c16d8-04c9-45d3-9958-62b9172fda88.png#averageHue=%23342e2d&clientId=u24f5bbd9-89c7-4&from=paste&height=119&id=ub5e6c2d2&name=image.png&originHeight=149&originWidth=779&originalType=binary&ratio=1&rotation=0&showTitle=false&size=24881&status=done&style=none&taskId=ued1736f7-7f67-467a-b99c-6b66f7b7253&title=&width=623.2" alt="image.png"><br>再往下这么写就可以出现默认值<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666283853691-367151b7-88dc-47c4-81ed-def0f947a589.png#averageHue=%232e2e2d&clientId=u24f5bbd9-89c7-4&from=paste&height=123&id=ue512c945&name=image.png&originHeight=154&originWidth=599&originalType=binary&ratio=1&rotation=0&showTitle=false&size=19247&status=done&style=none&taskId=u47f47cf4-010a-4cec-850b-fff8fde6a2a&title=&width=479.2" alt="image.png"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;标题&quot;</span> <span class="attr">name</span>=<span class="string">&quot;title&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;&#123; data.title &#125;&#125;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666283891372-c7872881-137e-4724-9121-997c91ce7478.png#averageHue=%23fcfcfc&clientId=u24f5bbd9-89c7-4&from=paste&height=215&id=u4db3b189&name=image.png&originHeight=269&originWidth=1627&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8815&status=done&style=none&taskId=u19cf6634-10b6-4b51-be66-4994934b77e&title=&width=1301.6" alt="image.png"><br>默认值已经出来了~<br>接下来要做的事情就是更新了，对提交的数据做出处理<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666284036639-f561663f-d87c-474e-b8d4-45a8bec1e0ea.png#averageHue=%2333312d&clientId=u24f5bbd9-89c7-4&from=paste&height=26&id=u2f328d80&name=image.png&originHeight=32&originWidth=259&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3831&status=done&style=none&taskId=u5cc7c2df-c87d-4cbf-a19c-40947af51d6&title=&width=207.2" alt="image.png">表单里不写action默认提交到当前页面</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> request.method==<span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">    obj=models.Department.objects.<span class="built_in">filter</span>(<span class="built_in">id</span>=nid).update(title=request.POST.get(<span class="string">&quot;title&quot;</span>))</span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">&#x27;/depart/list&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>这样就完成了修改功能<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666284243923-b15c027c-b2ed-48f8-b83c-f7b85438c019.png#averageHue=%23fcfcfb&clientId=u24f5bbd9-89c7-4&from=paste&height=160&id=u037a6aad&name=image.png&originHeight=200&originWidth=1621&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8593&status=done&style=none&taskId=u5040ae27-1c1a-4197-b71b-dfaf4a252e2&title=&width=1296.8" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666284248421-4a8fc314-74c1-4a35-b417-b9c79ca39ed4.png#averageHue=%23fcfbfa&clientId=u24f5bbd9-89c7-4&from=paste&height=196&id=ucd6e7a00&name=image.png&originHeight=245&originWidth=1820&originalType=binary&ratio=1&rotation=0&showTitle=false&size=21114&status=done&style=none&taskId=ud92cc768-6d4c-42c8-9659-e23bc3157dd&title=&width=1456" alt="image.png"><br>yaho~成功拉</p>
<h2 id="模板的继承"><a href="#模板的继承" class="headerlink" title="模板的继承"></a>模板的继承</h2><p>在django中，我们是可以html模板的，具体操作如何实现呢，接下来就来演示<br>先准备layout.html，内容就从depart_list.html直接复制过来：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666286809600-6ede2c34-6bea-4066-a5b4-bcacd8b3caf5.png#averageHue=%232e2e2c&clientId=u24f5bbd9-89c7-4&from=paste&height=202&id=u631a02b5&name=image.png&originHeight=253&originWidth=798&originalType=binary&ratio=1&rotation=0&showTitle=false&size=26464&status=done&style=none&taskId=uf22c93fb-c71f-436b-94ff-b0e00f57943&title=&width=638.4" alt="image.png"><br>重点看这里，这边是div分的区域，在这里可以进行继承：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666286893051-73ef358b-8def-411e-b884-46f371865875.png#averageHue=%232e2e2d&clientId=u24f5bbd9-89c7-4&from=paste&height=124&id=u758496c7&name=image.png&originHeight=155&originWidth=657&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13847&status=done&style=none&taskId=u138c7bad-d271-4450-94d4-da0d3832e57&title=&width=525.6" alt="image.png"><br>修改为这样，其中content是们自定义的，然后再修改depart_list.html:<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666286995684-533429d1-d323-4767-98be-bc4f6efb3e5b.png#averageHue=%23302f2d&clientId=u24f5bbd9-89c7-4&from=paste&height=151&id=u5bfd7dff&name=image.png&originHeight=189&originWidth=482&originalType=binary&ratio=1&rotation=0&showTitle=false&size=22338&status=done&style=none&taskId=u8ef7f41a-2e5e-44ed-8535-75121446afa&title=&width=385.6" alt="image.png"><br>layout也就是depart_list的模板，是父类,这样界面不会改变：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666287019218-a3a4d10a-0de8-458a-9b3e-f57316fbc753.png#averageHue=%23fcfbfb&clientId=u24f5bbd9-89c7-4&from=paste&height=428&id=u8ab3d5b5&name=image.png&originHeight=535&originWidth=1765&originalType=binary&ratio=1&rotation=0&showTitle=false&size=41819&status=done&style=none&taskId=u3a07c473-5a50-4bcb-9372-c8c11740fa8&title=&width=1412" alt="image.png"><br>同理也可以修改depart_edit页面：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666287253665-fdbdc42a-a17b-4746-a16d-cff34dbae3c6.png#averageHue=%2332312e&clientId=u24f5bbd9-89c7-4&from=paste&height=121&id=u38fa0f1a&name=image.png&originHeight=151&originWidth=520&originalType=binary&ratio=1&rotation=0&showTitle=false&size=19760&status=done&style=none&taskId=ueeb6d432-9a5c-46ef-bf5c-819d64e28e8&title=&width=416" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666287271806-e03c7762-9030-4e73-b3fa-b4ea279632b4.png#averageHue=%23fbfbfb&clientId=u24f5bbd9-89c7-4&from=paste&height=354&id=uee8484dc&name=image.png&originHeight=443&originWidth=1784&originalType=binary&ratio=1&rotation=0&showTitle=false&size=35918&status=done&style=none&taskId=ua277707f-4f9c-474f-a0b0-921e321c061&title=&width=1427.2" alt="image.png"><br>新建部门页面也是同理啊~<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666287401786-2f4dc92e-c4d2-4960-9fbb-1a2e9aa959d3.png#averageHue=%2395854d&clientId=u24f5bbd9-89c7-4&from=paste&height=125&id=u267dd038&name=image.png&originHeight=156&originWidth=716&originalType=binary&ratio=1&rotation=0&showTitle=false&size=26699&status=done&style=none&taskId=u60d3ea23-2c1a-4a45-87ee-c6588946995&title=&width=572.8" alt="image.png"><br>这很方便qwq！！！另外注意了，可以定义多个模板点，也就是多个block，修改content为其他的东西即可<br><code>block content</code>,<code>block content1</code>这样就行</p>
<h2 id="用户列表"><a href="#用户列表" class="headerlink" title="用户列表"></a>用户列表</h2><p>老方法先添加路由，函数，html：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666359524934-b75ae8f8-4207-4cb4-8b4b-340da28304e9.png#averageHue=%232f2f2d&clientId=u214229b3-686c-4&from=paste&height=148&id=u849222c9&name=image.png&originHeight=185&originWidth=1403&originalType=binary&ratio=1&rotation=0&showTitle=false&size=51745&status=done&style=none&taskId=u08df5e7c-a05a-4732-b997-381822e1631&title=&width=1122.4" alt="image.png"><br>再编辑一下html界面：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666359544335-0703910c-cdcf-40c7-87f2-452c4ba44475.png#averageHue=%232f2e2d&clientId=u214229b3-686c-4&from=paste&height=158&id=u9566e6f9&name=image.png&originHeight=197&originWidth=462&originalType=binary&ratio=1&rotation=0&showTitle=false&size=18316&status=done&style=none&taskId=uf8fa8392-eb04-4e4c-9f0e-91ddf2cabbf&title=&width=369.6" alt="image.png"><br>大致为这样：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666359557639-5823db6a-9015-4533-a52b-529ff64aa6f6.png#averageHue=%23fbfbfb&clientId=u214229b3-686c-4&from=paste&height=412&id=u66120a29&name=image.png&originHeight=515&originWidth=1800&originalType=binary&ratio=1&rotation=0&showTitle=false&size=48009&status=done&style=none&taskId=ue55582c4-daa6-4a10-b3b9-bb3bd3cba3e&title=&width=1440" alt="image.png"><br>然后修改一下部门列表里的超链接：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666359639755-1183fa40-a428-4db0-9ca4-2ab1a6a49fb1.png#averageHue=%2336342e&clientId=u214229b3-686c-4&from=paste&height=54&id=ue598afa7&name=image.png&originHeight=67&originWidth=504&originalType=binary&ratio=1&rotation=0&showTitle=false&size=11152&status=done&style=none&taskId=u0be53f95-cf16-4cc1-9453-150f5e8b417&title=&width=403.2" alt="image.png"><br>用户数据库信息如下：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666360248033-4736a9db-4bbb-477e-8a30-5294da9a0aaa.png#averageHue=%23151413&clientId=u214229b3-686c-4&from=paste&height=230&id=u985fc785&name=image.png&originHeight=288&originWidth=987&originalType=binary&ratio=1&rotation=0&showTitle=false&size=29254&status=done&style=none&taskId=u1606bfb2-de60-48ee-b56a-311b464afb3&title=&width=789.6" alt="image.png"><br>我们先手动插入几条数据：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">insert into app01_userinfo values(<span class="number">1</span>,<span class="string">&quot;boogipop&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="number">15</span>,<span class="string">&quot;100.00&quot;</span>,<span class="string">&quot;2018-10-15&quot;</span>,<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line">insert into app01_userinfo values(<span class="number">2</span>,<span class="string">&quot;kino&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="number">14</span>,<span class="string">&quot;120.00&quot;</span>,<span class="string">&quot;2018-12-15&quot;</span>,<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">insert into app01_userinfo values(<span class="number">3</span>,<span class="string">&quot;Alex&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="number">18</span>,<span class="string">&quot;130.00&quot;</span>,<span class="string">&quot;2018-11-15&quot;</span>,<span class="number">1</span>,<span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666360496597-3329fa4f-5c98-4abb-87c8-9e2b9cf77d44.png#averageHue=%23171614&clientId=u214229b3-686c-4&from=paste&height=147&id=u37e66b07&name=image.png&originHeight=184&originWidth=1041&originalType=binary&ratio=1&rotation=0&showTitle=false&size=15926&status=done&style=none&taskId=u68912fca-2a6f-4296-bb36-b8e1847ff99&title=&width=832.8" alt="image.png"><br>目前数据库就如上</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">userinfo=models.UserInfo.objects.<span class="built_in">all</span>()</span><br><span class="line"><span class="keyword">for</span> data <span class="keyword">in</span> userinfo:</span><br><span class="line">   <span class="built_in">print</span>(data.<span class="built_in">id</span>,data.name,data.password,data.age,data.account,data.create_time.strftime(<span class="string">&quot;%Y-%m-%d&quot;</span>),data.get_gender_display(),data.depart.title)</span><br><span class="line">    <span class="comment">#data.create_time.strftime(&quot;%Y-%m-%d&quot;)表示将datatime类型转换为字符串类型，略去后面的00000</span></span><br><span class="line">    <span class="comment">#ata.get_gender_display() 表示直接获得1对应的选择，也就是男或者女</span></span><br><span class="line">    <span class="comment">#data.depart.title 表示直接获得关联表的title，我们depart是foreignkey类型的</span></span><br></pre></td></tr></table></figure>
<p>函数如上：<img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666368081741-22e95c0e-26ea-4fb2-8f36-f46e120468a1.png#averageHue=%23333130&clientId=u214229b3-686c-4&from=paste&height=74&id=u25188f69&name=image.png&originHeight=93&originWidth=531&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13394&status=done&style=none&taskId=u9f42a944-ffb4-439d-aa6f-f7cd840479e&title=&width=424.8" alt="image.png"><br>数据都会打印出来，这样就获取了数据，接下来就展示出来<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666368702911-a83881a8-8822-49c9-a364-0c71e0ce100f.png#averageHue=%232e2d2c&clientId=u214229b3-686c-4&from=paste&height=253&id=uccf98c8f&name=image.png&originHeight=316&originWidth=770&originalType=binary&ratio=1&rotation=0&showTitle=false&size=48005&status=done&style=none&taskId=u8ba06bd2-e756-4b67-a8ba-71beb8bfcce&title=&width=616" alt="image.png"><br>这样写会有一些报错，因为那是python的函数，我们再html写会报错<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666369164537-42a541fa-333b-4e17-af80-1fdae8ae31c3.png#averageHue=%232f2e2c&clientId=u214229b3-686c-4&from=paste&height=222&id=ud533736a&name=image.png&originHeight=277&originWidth=862&originalType=binary&ratio=1&rotation=0&showTitle=false&size=43306&status=done&style=none&taskId=u4f0d89fe-dad9-47f7-875c-6cd228911a2&title=&width=689.6" alt="image.png"><br>django中默认会给你加括号，所以不需要括号，如果括号里有参数就用<code>|</code>隔开，data就表示参数</p>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666369182443-ea596bb9-8a3c-42a4-b357-197520db74f8.png#averageHue=%23fbf9f9&clientId=u214229b3-686c-4&from=paste&height=248&id=u3c60dcd4&name=image.png&originHeight=310&originWidth=1675&originalType=binary&ratio=1&rotation=0&showTitle=false&size=37217&status=done&style=none&taskId=u11912796-5fbd-40ff-89aa-3ba1b595efa&title=&width=1340" alt="image.png"><br>这样界面就出来了</p>
<h2 id="用户添加（原始方法）"><a href="#用户添加（原始方法）" class="headerlink" title="用户添加（原始方法）"></a>用户添加（原始方法）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666430794224-60ecd6ad-fcba-4499-8f6a-6eba074f37f8.png#averageHue=%232d2d2c&clientId=ud2f80d37-9515-4&from=paste&height=121&id=u42d84a64&name=image.png&originHeight=151&originWidth=1254&originalType=binary&ratio=1&rotation=0&showTitle=false&size=20865&status=done&style=none&taskId=u731d992f-5d34-45c8-a4a0-ec4d9c44418&title=&width=1003.2" alt="image.png"><br>路由！<br>html！：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666430861170-a558394e-c39e-4fd0-bb63-f3c004096669.png#averageHue=%23312f2d&clientId=ud2f80d37-9515-4&from=paste&height=413&id=u1f8e879b&name=image.png&originHeight=516&originWidth=786&originalType=binary&ratio=1&rotation=0&showTitle=false&size=81595&status=done&style=none&taskId=uab19d10c-ff6d-482b-88b3-80b45ede094&title=&width=628.8" alt="image.png"><br>user_list里的href！：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666430887294-b816048b-7aee-40ff-87dc-d800f733f4b3.png#averageHue=%2332312e&clientId=ud2f80d37-9515-4&from=paste&height=59&id=u64b79d1d&name=image.png&originHeight=74&originWidth=619&originalType=binary&ratio=1&rotation=0&showTitle=false&size=14905&status=done&style=none&taskId=u751aac97-1ea9-4990-9393-bea29287451&title=&width=495.2" alt="image.png"><br>最后的html界面如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends &#x27;layout.html&#x27; %&#125;</span><br><span class="line">&#123;% block content %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel panel-default&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel-heading&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">&quot;panel-title&quot;</span>&gt;</span>新建用户<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel-body&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">      &#123;% csrf_token %&#125;</span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> &gt;</span>名称<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;名称&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> &gt;</span>密码<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;密码&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> &gt;</span>年龄<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;年龄&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> &gt;</span>账户余额<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;账户余额&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> &gt;</span>入职时间<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;入职时间&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> &gt;</span>性别<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span>&gt;</span></span><br><span class="line">          &#123;% for choice in gender %&#125;</span><br><span class="line">          <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;&#123;&#123; choice.0 &#125;&#125;&quot;</span>&gt;</span>&#123;&#123;choice.1&#125;&#125;<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">          &#123;% endfor %&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> &gt;</span>部门<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span>&gt;</span></span><br><span class="line">          &#123;% for choice in departid %&#125;</span><br><span class="line">          <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;&#123;&#123; choice.id &#125;&#125;&quot;</span>&gt;</span>&#123;&#123; choice.title &#125;&#125;<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">          &#123;% endfor %&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span>  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>
<p>函数为：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666437158489-6eeb7cea-3580-4097-96af-bc480ae7236b.png#averageHue=%232f2e2d&clientId=ud2f80d37-9515-4&from=paste&height=130&id=ud174218e&name=image.png&originHeight=163&originWidth=679&originalType=binary&ratio=1&rotation=0&showTitle=false&size=25929&status=done&style=none&taskId=u03ad8ac2-9128-479d-92aa-e256b1de3aa&title=&width=543.2" alt="image.png"><br>这样就可以把所有用户展示出</p>
<h2 id="Form和ModelForm"><a href="#Form和ModelForm" class="headerlink" title="Form和ModelForm"></a>Form和ModelForm</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666441397692-be2d7eb9-e5fc-416d-ac45-a973e07f1f07.png#averageHue=%232a457b&clientId=ud2f80d37-9515-4&from=paste&height=202&id=uaaf2af31&name=image.png&originHeight=253&originWidth=767&originalType=binary&ratio=1&rotation=0&showTitle=false&size=129677&status=done&style=none&taskId=u05b9fdc8-95da-408d-bbd6-e94e4df224e&title=&width=613.6" alt="image.png"><br>假如我们按照如上操作获取参数，那么会有以下几个缺点</p>
<blockquote>
<p>参数校验繁琐<br>错误提示繁琐<br>页面每个字段都需要重新写一遍<br>如果有关联的数据，还要先取出来再循环得出，麻烦</p>
</blockquote>
<h3 id="初始Form"><a href="#初始Form" class="headerlink" title="初始Form"></a>初始Form</h3><p>form可以在上面的基础上进一步的去优化：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django <span class="keyword">import</span> forms</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyForm</span>(forms.Form):</span><br><span class="line">    user = forms.CharField(widget=forms.Input)</span><br><span class="line">    pwd = forms.CharFiled(widget=forms.Input)</span><br><span class="line">    email = forms.CharFiled(widget=forms.Input)</span><br><span class="line">    account = forms.CharFiled(widget=forms.Input)</span><br><span class="line">    create_time = forms.CharFiled(widget=forms.Input)</span><br><span class="line">    depart = forms.CharFiled(widget=forms.Input)</span><br><span class="line">    gender = forms.CharFiled(widget=forms.Input)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">user_add</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;GET&quot;</span>:</span><br><span class="line">        form = MyForm()</span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">&#x27;user_add.html&#x27;</span>,&#123;<span class="string">&quot;form&quot;</span>:form&#125;)</span><br></pre></td></tr></table></figure>
<p>views.py内容如上，我们只需在函数上边儿定义一个类，继承Form类即可<br>然后user，pwd这些怎么利用呢？HTML界面中这样写：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">  &#123;% for field in form%&#125;</span><br><span class="line">  &#123;&#123; field &#125;&#125;</span><br><span class="line">  &#123;% endfor %&#125;</span><br><span class="line">  <span class="comment">&lt;!-- &lt;input type=&quot;text&quot;  placeholder=&quot;姓名&quot; name=&quot;user&quot; /&gt; --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 上下等价 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    &#123;&#123; form.user &#125;&#125;</span><br><span class="line">    &#123;&#123; form.pwd &#125;&#125;</span><br><span class="line">    &#123;&#123; form.email &#125;&#125;</span><br><span class="line">    <span class="comment">&lt;!-- &lt;input type=&quot;text&quot;  placeholder=&quot;姓名&quot; name=&quot;user&quot; /&gt; --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这就相当于我们的input标签！是不是很赞</p>
<h3 id="ModelForm"><a href="#ModelForm" class="headerlink" title="ModelForm"></a>ModelForm</h3><p>可以理解为Form组件的升级版，这样会更加轻松：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django <span class="keyword">import</span> forms</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyForm</span>(forms.ModelForm):</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Meta</span>:</span><br><span class="line">        model = UserInfo</span><br><span class="line">        fields = [<span class="string">&quot;name&quot;</span>,<span class="string">&quot;password&quot;</span>,<span class="string">&quot;age&quot;</span>]</span><br><span class="line">        <span class="comment">#你想呈现什么内容，就往fields里面写</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">user_add</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;GET&quot;</span>:</span><br><span class="line">        form = MyForm()</span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">&#x27;user_add.html&#x27;</span>,&#123;<span class="string">&quot;form&quot;</span>:form&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;form method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">    &#123;% <span class="keyword">for</span> field <span class="keyword">in</span> form%&#125;</span><br><span class="line">    	&#123;&#123; field &#125;&#125;</span><br><span class="line">    &#123;% endfor %&#125;</span><br><span class="line">    &lt;!-- &lt;<span class="built_in">input</span> <span class="built_in">type</span>=<span class="string">&quot;text&quot;</span>  placeholder=<span class="string">&quot;姓名&quot;</span> name=<span class="string">&quot;user&quot;</span> /&gt; --&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>
<p>是不是更简洁了</p>
<h2 id="用户添加-ModelForm版本"><a href="#用户添加-ModelForm版本" class="headerlink" title="用户添加-ModelForm版本"></a>用户添加-ModelForm版本</h2><p><code>form.name.label</code>表示取一开始的verbose_name<br>实操如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;en&quot;</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&#123;% <span class="keyword">for</span> field <span class="keyword">in</span> form %&#125;</span><br><span class="line">&#123;&#123; field.label &#125;&#125;: &#123;&#123; field &#125;&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django <span class="keyword">import</span> forms</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Userform</span>(forms.ModelForm):</span><br><span class="line">   <span class="keyword">class</span> <span class="title class_">Meta</span>:</span><br><span class="line">      model=models.UserInfo</span><br><span class="line">      fields=[<span class="string">&quot;name&quot;</span>,<span class="string">&quot;password&quot;</span>,<span class="string">&quot;age&quot;</span>,<span class="string">&quot;account&quot;</span>,<span class="string">&quot;create_time&quot;</span>,<span class="string">&quot;gender&quot;</span>,<span class="string">&quot;depart&quot;</span>]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">user_modelform_add</span>(<span class="params">request</span>):</span><br><span class="line">   form=Userform()</span><br><span class="line">   <span class="keyword">return</span> render(request, <span class="string">&#x27;user_modelform_add.html&#x27;</span>,&#123;<span class="string">&quot;form&quot;</span>:form&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Department</span>(models.Model):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;部门表&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.title</span><br><span class="line">    title=models.CharField(verbose_name=<span class="string">&quot;标题&quot;</span>,max_length=<span class="number">64</span>)</span><br></pre></td></tr></table></figure>
<p>假如不使用str魔术方法的结果为：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666459432358-0c8339d4-9c11-4e9a-9986-45f68307da4d.png#averageHue=%23f6f4f2&clientId=u75d00690-ee99-4&from=paste&height=134&id=u5371e115&name=image.png&originHeight=167&originWidth=408&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9656&status=done&style=none&taskId=u023b68a8-29e9-4cc1-a82c-881a4430d7a&title=&width=326.4" alt="image.png"><br>这个原因是为什么应该懂吧，一行数据就是对象，用str魔术方法，让他print的时候输出title，最后效果如下：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666459474449-d8787cb5-96da-488f-8469-a6752d5e7028.png#averageHue=%23f8f8f7&clientId=u75d00690-ee99-4&from=paste&height=102&id=u4906b52c&name=image.png&originHeight=128&originWidth=1560&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8679&status=done&style=none&taskId=ua5aaa2ca-8796-4e5d-b73a-2dcd2dbc340&title=&width=1248" alt="image.png"><br>是不是很方便呢？</p>
<p>原理弄懂了就把他逐步完善一下：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666460038734-05a3e285-387b-4b4d-868c-f8e8790cb9e5.png#averageHue=%232f2e2c&clientId=u75d00690-ee99-4&from=paste&height=444&id=u16aece2f&name=image.png&originHeight=555&originWidth=773&originalType=binary&ratio=1&rotation=0&showTitle=false&size=83697&status=done&style=none&taskId=ub7578458-7b5c-432e-8195-19bb623b92c&title=&width=618.4" alt="image.png"><br>界面样式为：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666460055102-742644d6-1a8d-43f5-9113-0821a0754724.png#averageHue=%23fdfdfd&clientId=u75d00690-ee99-4&from=paste&height=430&id=uf2bb9f60&name=image.png&originHeight=537&originWidth=1693&originalType=binary&ratio=1&rotation=0&showTitle=false&size=21136&status=done&style=none&taskId=uf2a71a96-5e3c-4acc-90a0-d5bf9a82d6f&title=&width=1354.4" alt="image.png"><br>感觉有点丑啊<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666460735442-aaddce34-c33e-4e68-9387-0b412417d9c7.png#averageHue=%232d2c2b&clientId=u75d00690-ee99-4&from=paste&height=167&id=u273e5523&name=image.png&originHeight=209&originWidth=687&originalType=binary&ratio=1&rotation=0&showTitle=false&size=36939&status=done&style=none&taskId=ua4d13433-a509-4cff-8300-403db83590c&title=&width=549.6" alt="image.png"><br>定义widgets加载css：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666460749414-56b3c748-f1bd-4e3d-ba84-ad7fb8c2f832.png#averageHue=%23fcfcfc&clientId=u75d00690-ee99-4&from=paste&height=272&id=uaecd09bd&name=image.png&originHeight=340&originWidth=1507&originalType=binary&ratio=1&rotation=0&showTitle=false&size=11042&status=done&style=none&taskId=u2b17780a-042e-4354-95a9-5cbda1b6504&title=&width=1205.6" alt="image.png"><br>这样还是很麻烦：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666461138451-a815baaa-9b0c-47c2-a781-6f9e99decfae.png#averageHue=%23302f2e&clientId=u75d00690-ee99-4&from=paste&height=130&id=ude856392&name=image.png&originHeight=163&originWidth=595&originalType=binary&ratio=1&rotation=0&showTitle=false&size=24855&status=done&style=none&taskId=u9f302833-8712-4c0c-bf59-286fc69eeaa&title=&width=476" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666461012883-895399e0-bea5-4383-9557-f78864c28527.png#averageHue=%23343230&clientId=u75d00690-ee99-4&from=paste&height=153&id=u246475c4&name=image.png&originHeight=191&originWidth=928&originalType=binary&ratio=1&rotation=0&showTitle=false&size=55303&status=done&style=none&taskId=u75c4acf3-a377-4890-b65d-05e3260e147&title=&width=742.4" alt="image.png"><br>这里输出的name和field应该都不陌生吧<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666461191096-e069d54c-79f6-4349-8597-a5fbc27f4a5e.png#averageHue=%232f2f2e&clientId=u75d00690-ee99-4&from=paste&height=131&id=u50324613&name=image.png&originHeight=164&originWidth=646&originalType=binary&ratio=1&rotation=0&showTitle=false&size=27957&status=done&style=none&taskId=u3105a73e-115c-4049-8011-68ed3b88db3&title=&width=516.8" alt="image.png"><br>所以这样表示在field中都加上一个class<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666461244213-961b607b-bd33-4696-affb-149d7514c8ea.png#averageHue=%23fcfcfc&clientId=u75d00690-ee99-4&from=paste&height=650&id=u12ea7180&name=image.png&originHeight=812&originWidth=1502&originalType=binary&ratio=1&rotation=0&showTitle=false&size=27595&status=done&style=none&taskId=u9626dda0-4c81-49a7-a687-34613ce73b8&title=&width=1201.6" alt="image.png"><br>最后再加上一个placeholder在class后边儿：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666461460370-8f7916fb-5e43-41e8-9221-36134771f555.png#averageHue=%232d2c2b&clientId=u75d00690-ee99-4&from=paste&height=38&id=u58ac3a0d&name=image.png&originHeight=47&originWidth=523&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7766&status=done&style=none&taskId=u47194f39-40ab-46a8-8582-d9ce0c8c4ed&title=&width=418.4" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666461469327-0fca68c9-f0d3-410b-b8ce-8fefafb9a6c4.png#averageHue=%23fbfbfb&clientId=u75d00690-ee99-4&from=paste&height=648&id=u0ac193ae&name=image.png&originHeight=810&originWidth=1546&originalType=binary&ratio=1&rotation=0&showTitle=false&size=37674&status=done&style=none&taskId=u9e455067-8403-4233-869e-67d21581af6&title=&width=1236.8" alt="image.png"><br>继续完善</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">user_modelform_add</span>(<span class="params">request</span>):</span><br><span class="line">   <span class="keyword">if</span> request.method==<span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">      form=Userform()</span><br><span class="line">      <span class="keyword">return</span> render(request, <span class="string">&#x27;user_modelform_add.html&#x27;</span>,&#123;<span class="string">&quot;form&quot;</span>:form&#125;)</span><br><span class="line">   <span class="comment">#将提交的参数检验是否合法，若合法保存数据库</span></span><br><span class="line">   form=Userform(data=request.POST)</span><br><span class="line">   <span class="keyword">if</span> form.is_valid():</span><br><span class="line">      <span class="comment"># print(form.cleaned_data)#合法信息</span></span><br><span class="line">      form.save()<span class="comment">#自动将输入的参数保存到数据库中！</span></span><br><span class="line">      <span class="keyword">return</span> redirect(<span class="string">&#x27;/user/list/&#x27;</span>)</span><br><span class="line">   <span class="keyword">else</span>:</span><br><span class="line">      <span class="built_in">print</span>(form.errors)<span class="comment">#错误信息</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666462540590-4c851ae0-93a9-4e7b-961c-76761fa378df.png#averageHue=%23302e2d&clientId=u75d00690-ee99-4&from=paste&height=60&id=u6a80b537&name=image.png&originHeight=75&originWidth=1578&originalType=binary&ratio=1&rotation=0&showTitle=false&size=17857&status=done&style=none&taskId=u8a030a44-ed70-493e-a518-f92a43631fb&title=&width=1262.4" alt="image.png"><br>这里就是参数校验环节<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666462682325-dfe89ebb-fbaa-4e2f-9325-ac02d984fe5b.png#averageHue=%23fcfcfc&clientId=u75d00690-ee99-4&from=paste&height=606&id=u69efa350&name=image.png&originHeight=758&originWidth=1484&originalType=binary&ratio=1&rotation=0&showTitle=false&size=34798&status=done&style=none&taskId=u3599eb6c-4c11-40a7-addc-e6ca29514ad&title=&width=1187.2" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666462674860-82097d9f-ba1c-44ea-b48a-62a142c99f91.png#averageHue=%23faf9f8&clientId=u75d00690-ee99-4&from=paste&height=294&id=ue83dabff&name=image.png&originHeight=368&originWidth=1465&originalType=binary&ratio=1&rotation=0&showTitle=false&size=45232&status=done&style=none&taskId=u012b133b-96df-4936-85c8-56a37067069&title=&width=1172" alt="image.png"><br>成功完成添加用户</p>
<h2 id="设置错误信息"><a href="#设置错误信息" class="headerlink" title="设置错误信息"></a>设置错误信息</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django <span class="keyword">import</span> forms</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Userform</span>(forms.ModelForm):</span><br><span class="line">   <span class="comment">#名称至少3个字符</span></span><br><span class="line">   name=forms.CharField(min_length=<span class="number">3</span>,label=<span class="string">&#x27;名称&#x27;</span>)<span class="comment">#这里要重新添加label，这里相当于重写,这里重写不是代表重写数据库的字段</span></span><br><span class="line">   password=forms.CharField(min_length=<span class="number">8</span>,label=<span class="string">&#x27;密码&#x27;</span>)<span class="comment">#这里也可以添加正则</span></span><br><span class="line">   <span class="keyword">class</span> <span class="title class_">Meta</span>:</span><br><span class="line">      model=models.UserInfo</span><br><span class="line">      fields=[<span class="string">&quot;name&quot;</span>,<span class="string">&quot;password&quot;</span>,<span class="string">&quot;age&quot;</span>,<span class="string">&quot;account&quot;</span>,<span class="string">&quot;create_time&quot;</span>,<span class="string">&quot;gender&quot;</span>,<span class="string">&quot;depart&quot;</span>]</span><br><span class="line">      <span class="comment"># widgets=&#123;</span></span><br><span class="line">      <span class="comment">#    &quot;name&quot;: forms.TextInput(attrs=&#123;&quot;class&quot;: &quot;form-control&quot;&#125;),</span></span><br><span class="line">      <span class="comment">#    &quot;password&quot;: forms.PasswordInput(attrs=&#123;&quot;class&quot;: &quot;form-control&quot;&#125;),</span></span><br><span class="line">      <span class="comment">#    &quot;age&quot;: forms.TextInput(attrs=&#123;&quot;class&quot;: &quot;form-control&quot;&#125;),</span></span><br><span class="line">      <span class="comment"># &#125;</span></span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,*args,**kwargs</span>):</span><br><span class="line">      <span class="built_in">super</span>().__init__(*args,**kwargs)</span><br><span class="line">      <span class="comment">#super表示调用父类,这里表示在父类原有的基础上补充</span></span><br><span class="line">      <span class="comment">#循环体里找到所有插件，添加class</span></span><br><span class="line">      <span class="keyword">for</span> name,field <span class="keyword">in</span> self.fields.items():</span><br><span class="line">         field.widget.attrs=&#123;<span class="string">&quot;class&quot;</span>:<span class="string">&quot;form-control&quot;</span>,<span class="string">&quot;placeholder&quot;</span>:field.label&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">user_modelform_add</span>(<span class="params">request</span>):</span><br><span class="line">   <span class="keyword">if</span> request.method==<span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">      form=Userform()</span><br><span class="line">      <span class="keyword">return</span> render(request, <span class="string">&#x27;user_modelform_add.html&#x27;</span>,&#123;<span class="string">&quot;form&quot;</span>:form&#125;)</span><br><span class="line">   <span class="comment">#将提交的参数检验是否合法，若合法保存数据库</span></span><br><span class="line">   form=Userform(data=request.POST)</span><br><span class="line">   <span class="keyword">if</span> form.is_valid():</span><br><span class="line">      <span class="comment"># print(form.cleaned_data)#合法信息</span></span><br><span class="line">      form.save()<span class="comment">#自动将输入的参数保存到数据库中！</span></span><br><span class="line">      <span class="keyword">return</span> redirect(<span class="string">&#x27;/user/list/&#x27;</span>)</span><br><span class="line">   <span class="keyword">else</span>:</span><br><span class="line">      <span class="comment">#此form非彼form，这个form已经传了POST的参数，蕴含error信息</span></span><br><span class="line">      <span class="keyword">return</span> render(request,<span class="string">&#x27;user_modelform_add.html&#x27;</span>,&#123;<span class="string">&quot;form&quot;</span>:form&#125;)</span><br><span class="line">      <span class="comment"># print(form.errors)#错误信息</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666464012078-76dace28-8ece-4364-8d4b-77ccb486f590.png#averageHue=%23302e2d&clientId=u75d00690-ee99-4&from=paste&height=174&id=ua8bd8aed&name=image.png&originHeight=218&originWidth=687&originalType=binary&ratio=1&rotation=0&showTitle=false&size=33104&status=done&style=none&taskId=u35e6a0f5-b2ce-4569-a5ba-b20de178ea5&title=&width=549.6" alt="image.png"><br><code>filed.errors.0</code>表示错误信息的第一条，如果不加0结果会很乱<br>然后<code>novalidate</code>是不需要前端给我们验证参数是否为空，这是为了体验错误信息嘛</p>
<p>然后最后不顺眼的地方就是错误信息是英文，我们如何改为中文呢？<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666464216628-fca9487d-c83c-454f-8cc0-860d47216cf7.png#averageHue=%232c2c2b&clientId=u75d00690-ee99-4&from=paste&height=42&id=ue918fadf&name=image.png&originHeight=52&originWidth=329&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3328&status=done&style=none&taskId=uab44aa8a-4bc8-4a6e-b324-26632bd18a6&title=&width=263.2" alt="image.png"><br>改为:<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666464230069-8ec8c8a2-1b60-4854-bfdb-5345130f6186.png#averageHue=%2330302f&clientId=u75d00690-ee99-4&from=paste&height=38&id=u18f24f39&name=image.png&originHeight=47&originWidth=417&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3489&status=done&style=none&taskId=u6bae8e17-daa1-4d85-acfb-af138d730d8&title=&width=333.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666464248545-2ccc4950-9bf9-43f5-b6f4-9271eaeab956.png#averageHue=%23fdfcfc&clientId=u75d00690-ee99-4&from=paste&height=544&id=u8b935ef2&name=image.png&originHeight=680&originWidth=1482&originalType=binary&ratio=1&rotation=0&showTitle=false&size=33913&status=done&style=none&taskId=udab9e359-cdeb-41b0-a6ee-942aefbef3a&title=&width=1185.6" alt="image.png"><br>成功！</p>
<h2 id="用户编辑和删除"><a href="#用户编辑和删除" class="headerlink" title="用户编辑和删除"></a>用户编辑和删除</h2><p>咳咳，从现在开始就简短的写了，都很熟练了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">user_edit</span>(<span class="params">request,nid</span>):</span><br><span class="line">   row_obj = models.UserInfo.objects.<span class="built_in">filter</span>(<span class="built_in">id</span>=nid).first()  <span class="comment"># 取出第一个对象</span></span><br><span class="line">   <span class="keyword">if</span> request.method==<span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">      form = Userform(instance=row_obj)<span class="comment">#添加instance就可以输入的时候显示默认值</span></span><br><span class="line">      <span class="keyword">return</span> render(request,<span class="string">&#x27;user_edit.html&#x27;</span>,&#123;<span class="string">&quot;form&quot;</span>:form&#125;)</span><br><span class="line">   form=Userform(data=request.POST,instance=row_obj)</span><br><span class="line">   <span class="comment">#这儿的instance必须要加，表示是更新数据，而不是新增数据，要不然save无法识别</span></span><br><span class="line">   <span class="keyword">if</span> form.is_valid():</span><br><span class="line">      form.save()</span><br><span class="line">      <span class="comment">#默认保存的是输入的数据，如果想要增加输入以外的值</span></span><br><span class="line">      <span class="comment">#可以这样 form.instance.字段名=值，这个写在save上面</span></span><br><span class="line">      <span class="keyword">return</span> redirect(<span class="string">&#x27;/user/list/&#x27;</span>)</span><br><span class="line">   <span class="keyword">return</span> render(request,<span class="string">&#x27;user_edit.html&#x27;</span>,&#123;<span class="string">&quot;form&quot;</span>:form&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">user_del</span>(<span class="params">request,nid</span>):</span><br><span class="line">   models.UserInfo.objects.<span class="built_in">filter</span>(<span class="built_in">id</span>=nid).delete()</span><br><span class="line">   <span class="keyword">return</span> redirect(<span class="string">&#x27;/user/list/&#x27;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">path(<span class="string">&#x27;user/&lt;int:nid&gt;/edit/&#x27;</span>,views.user_edit),</span><br><span class="line">   path(<span class="string">&#x27;user/&lt;int:nid&gt;/del/&#x27;</span>,views.user_del),</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666597591301-b9adf1dd-86f2-4086-a98d-6f9b671873a9.png#averageHue=%232f2e2c&clientId=uc6b2f13a-78f3-4&from=paste&height=453&id=u682415da&name=image.png&originHeight=566&originWidth=730&originalType=binary&ratio=1&rotation=0&showTitle=false&size=86565&status=done&style=none&taskId=u10eff9c4-3dfd-4cf5-a1af-6e0536679a3&title=&width=584" alt="image.png"><br>页面就是直接抄user_add的，改一点文字就可以</p>
<h2 id="靓号管理-查看"><a href="#靓号管理-查看" class="headerlink" title="靓号管理-查看"></a>靓号管理-查看</h2><p>也是直接上路由,HTML,函数了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">pretty_list</span>(<span class="params">request</span>):</span><br><span class="line">   prettynum=models.pretty.objects.<span class="built_in">all</span>().order_by(<span class="string">&#x27;-level&#x27;</span>)</span><br><span class="line">   <span class="comment">#相当于select * from 表 order by level desc 倒序输出</span></span><br><span class="line">   <span class="keyword">return</span> render(request,<span class="string">&#x27;pretty_list.html&#x27;</span>,&#123;<span class="string">&quot;info&quot;</span>:prettynum&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">path(<span class="string">&#x27;pretty/list/&#x27;</span>,views.pretty_list),</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends &#x27;layout.html&#x27; %&#125;</span><br><span class="line">&#123;% block content %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;margin-bottom: 10px;&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-success&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/user/add/&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;glyphicon glyphicon-plus&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    新建靓号</span><br><span class="line">  <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel panel-default&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- Default panel contents --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel-heading&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;glyphicon glyphicon-th-list&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    靓号列表</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- Table --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">&quot;table table-bordered&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>ID<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>号码<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>价格<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>级别<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>状态<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">      &#123;% for data in info %&#125;</span><br><span class="line">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; data.id &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; data.mobile &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; data.price &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; data.get_level_display &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; data.get_status_display &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary btn-xs&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/user/&#123;&#123; data.id &#125;&#125;/edit/&quot;</span>&gt;</span>编辑<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-danger btn-xs&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/user/&#123;&#123; data.id &#125;&#125;/del/&quot;</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">      &#123;% endfor %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666610702562-a788a733-64d4-40f5-ac94-1235eb7fcdb5.png#averageHue=%2334322e&clientId=uc6b2f13a-78f3-4&from=paste&height=102&id=u76d0fa06&name=image.png&originHeight=127&originWidth=557&originalType=binary&ratio=1&rotation=0&showTitle=false&size=18699&status=done&style=none&taskId=u0a21c734-2884-4006-9cf7-b9ded5269e2&title=&width=445.6" alt="image.png"><br>修改了一点<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666610717666-29a0c703-488f-4755-aca8-b6e4f6009d8b.png#averageHue=%23fbfbfb&clientId=uc6b2f13a-78f3-4&from=paste&height=230&id=ubb74ba4c&name=image.png&originHeight=287&originWidth=1468&originalType=binary&ratio=1&rotation=0&showTitle=false&size=17041&status=done&style=none&taskId=ua947d748-b392-4a7c-bd6e-ce43f5e3a97&title=&width=1174.4" alt="image.png"></p>
<h2 id="新建靓号"><a href="#新建靓号" class="headerlink" title="新建靓号"></a>新建靓号</h2><ul>
<li><p>列表点击跳转：<code>/pretty/add/</code> </p>
</li>
<li><p>URL </p>
</li>
<li><p>ModelForm类 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">from django import forms</span><br><span class="line"></span><br><span class="line">class PrettyModelForm(forms.ModelForm):</span><br><span class="line">	...</span><br></pre></td></tr></table></figure>

</li>
<li><p>函数 </p>
<ul>
<li>实例化类的对象</li>
<li>通过render将对象传入到HTML中。</li>
<li>模板的循环展示所有的字段。</li>
</ul>
</li>
<li><p>点击提交 </p>
<ul>
<li>数据校验</li>
<li>保存到数据库</li>
<li>跳转回靓号列表</li>
</ul>
</li>
</ul>
<p>代码分别如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.core.validators <span class="keyword">import</span> RegexValidator</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Prettyadd</span>(forms.ModelForm):</span><br><span class="line">   mobile=forms.CharField(label=<span class="string">&#x27;号码&#x27;</span>,validators=[RegexValidator(<span class="string">r&#x27;^158[0-9]+$&#x27;</span>,<span class="string">&#x27;号码必须以158开头,并且至少4位数&#x27;</span>)])</span><br><span class="line">   <span class="keyword">class</span> <span class="title class_">Meta</span>:</span><br><span class="line">      model=models.pretty</span><br><span class="line">      fields=<span class="string">&#x27;__all__&#x27;</span><span class="comment">#就表示所有字段</span></span><br><span class="line">      <span class="comment"># exclude=[&#x27;id&#x27;]表示除了某个字段</span></span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,*args,**kwargs</span>):</span><br><span class="line">      <span class="built_in">super</span>().__init__(*args,**kwargs)</span><br><span class="line">      <span class="comment">#super表示调用父类,这里表示在父类原有的基础上补充</span></span><br><span class="line">      <span class="comment">#循环体里找到所有插件，添加class</span></span><br><span class="line">      <span class="keyword">for</span> name,field <span class="keyword">in</span> self.fields.items():</span><br><span class="line">         field.widget.attrs=&#123;<span class="string">&quot;class&quot;</span>:<span class="string">&quot;form-control&quot;</span>,<span class="string">&quot;placeholder&quot;</span>:field.label&#125;</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pretty_add</span>(<span class="params">request</span>):</span><br><span class="line">   <span class="keyword">if</span> request.method==<span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">      form=Prettyadd()</span><br><span class="line">      <span class="keyword">return</span> render(request,<span class="string">&#x27;pretty_add.html&#x27;</span>,&#123;<span class="string">&quot;form&quot;</span>:form&#125;)</span><br><span class="line">   form=Prettyadd(data=request.POST)</span><br><span class="line">   <span class="keyword">if</span> form.is_valid():</span><br><span class="line">      form.save()</span><br><span class="line">      <span class="keyword">return</span> redirect(<span class="string">&#x27;/pretty/list/&#x27;</span>)</span><br><span class="line">   <span class="keyword">else</span>:</span><br><span class="line">      <span class="keyword">return</span> render(request,<span class="string">&#x27;pretty_add.html&#x27;</span>,&#123;<span class="string">&quot;form&quot;</span>:form&#125;)</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666638108812-3d1c4f9b-163c-4bc9-ba29-c2db0cd0ae15.png#averageHue=%232f2d2c&clientId=u14641bb5-c2fb-4&from=paste&height=394&id=u5fcedefc&name=image.png&originHeight=492&originWidth=746&originalType=binary&ratio=1&rotation=0&showTitle=false&size=73647&status=done&style=none&taskId=ub4664fde-4877-4e62-bd3e-4214461a415&title=&width=596.8" alt="image.png"></p>
<ul>
<li>__all__表示所有子弹</li>
<li>RegexValidator可以正则匹配</li>
<li>exclude为除开某些字段外</li>
<li>正则限制了号码的输入</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666638169275-ee65f0bb-0626-4932-996d-9b329a4d2b0a.png#averageHue=%23fdfaf9&clientId=u14641bb5-c2fb-4&from=paste&height=88&id=u0a33088f&name=image.png&originHeight=110&originWidth=681&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7062&status=done&style=none&taskId=u369378f7-9bbe-4d9f-b916-68bd8058a4d&title=&width=544.8" alt="image.png"></p>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666638215554-681e42e6-97df-49c3-83b9-a08a4277c0a3.png#averageHue=%23fbfafa&clientId=u14641bb5-c2fb-4&from=paste&height=572&id=u49b51361&name=image.png&originHeight=715&originWidth=1607&originalType=binary&ratio=1&rotation=0&showTitle=false&size=62321&status=done&style=none&taskId=u8c84846b-67a0-446c-8a4f-92a9b8c1858&title=&width=1285.6" alt="image.png"><br>还有一种方法二<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666638419830-4fc01fd5-283c-47c8-8671-cdcf06e32991.png#averageHue=%2335322c&clientId=u14641bb5-c2fb-4&from=paste&height=564&id=u9a855fc5&name=image.png&originHeight=705&originWidth=1164&originalType=binary&ratio=1&rotation=0&showTitle=false&size=253622&status=done&style=none&taskId=uc6fbd12d-3d48-46da-805f-afe245807f1&title=&width=931.2" alt="image.png"><br>self.cleaned_data就是用户输入的，我们加一个if对他判断即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.core.exceptions <span class="keyword">import</span> ValidationError</span><br><span class="line"><span class="keyword">raise</span> ValidationError(<span class="string">&#x27;msg&#x27;</span>)就是抛出msg错误信息</span><br></pre></td></tr></table></figure>


<h2 id="靓号编辑和删除"><a href="#靓号编辑和删除" class="headerlink" title="靓号编辑和删除"></a>靓号编辑和删除</h2><ul>
<li>列表页面：&#x2F;pretty&#x2F;数字&#x2F;edit&#x2F;</li>
<li>URL</li>
<li>函数<ul>
<li>根据ID获取当前编辑的对象</li>
<li>ModelForm配合，默认显示数据。</li>
<li>提交修改。</li>
<li>不允许手机号重复</li>
</ul>
</li>
</ul>
<p>不允许重复：<br>添加函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># [obj,obj,obj]</span></span><br><span class="line">queryset = models.PrettyNum.objects.<span class="built_in">filter</span>(mobile=<span class="string">&quot;1888888888&quot;</span>)</span><br><span class="line"></span><br><span class="line">obj = models.PrettyNum.objects.<span class="built_in">filter</span>(mobile=<span class="string">&quot;1888888888&quot;</span>).first()</span><br><span class="line"></span><br><span class="line"><span class="comment"># True/False</span></span><br><span class="line">exists = models.PrettyNum.objects.<span class="built_in">filter</span>(mobile=<span class="string">&quot;1888888888&quot;</span>).exists()</span><br></pre></td></tr></table></figure>
<p>编辑函数(手机号不能存在）:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">排除自己以外，其他的数据是否手机号是否重复？</span><br><span class="line"></span><br><span class="line"><span class="comment"># id!=2 and mobile=&#x27;1888888888&#x27;</span></span><br><span class="line">models.PrettyNum.objects.<span class="built_in">filter</span>(mobile=<span class="string">&quot;1888888888&quot;</span>).exclude(<span class="built_in">id</span>=<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<p><code>mobile=forms.CharField(disabled=True,label=&#39;号码&#39;)</code>：<br>此条语句一出，就说明某个数据不能变动：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666719024161-1aa9d95c-63c8-4de9-9714-c07901a701a3.png#averageHue=%23f9f9f9&clientId=ueb3a0ee9-b135-4&from=paste&height=186&id=u638e9ce2&name=image.png&originHeight=232&originWidth=955&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9304&status=done&style=none&taskId=ua1fb2a07-e59c-4756-ab51-cd56dc5c9b7&title=&width=764" alt="image.png"></p>
<p>最后就简简单单的上个源码拉：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Prettyadd</span>(forms.ModelForm):</span><br><span class="line">   mobile=forms.CharField(label=<span class="string">&#x27;号码&#x27;</span>,validators=[RegexValidator(<span class="string">r&#x27;^158[0-9]+$&#x27;</span>,<span class="string">&#x27;号码必须以158开头,并且至少4位数&#x27;</span>)])</span><br><span class="line">   <span class="keyword">class</span> <span class="title class_">Meta</span>:</span><br><span class="line">      model=models.pretty</span><br><span class="line">      fields=<span class="string">&#x27;__all__&#x27;</span><span class="comment">#就表示所有字段</span></span><br><span class="line">      <span class="comment"># exclude=[&#x27;id&#x27;]表示除了某个字段</span></span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,*args,**kwargs</span>):</span><br><span class="line">      <span class="built_in">super</span>().__init__(*args,**kwargs)</span><br><span class="line">      <span class="comment">#super表示调用父类,这里表示在父类原有的基础上补充</span></span><br><span class="line">      <span class="comment">#循环体里找到所有插件，添加class</span></span><br><span class="line">      <span class="keyword">for</span> name,field <span class="keyword">in</span> self.fields.items():</span><br><span class="line">         field.widget.attrs=&#123;<span class="string">&quot;class&quot;</span>:<span class="string">&quot;form-control&quot;</span>,<span class="string">&quot;placeholder&quot;</span>:field.label&#125;</span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">clean_mobile</span>(<span class="params">self</span>):<span class="comment">#此处名字必须使用固定的，否则不行</span></span><br><span class="line">      <span class="string">&#x27;&#x27;&#x27;检测手机号是否重复   &#x27;&#x27;&#x27;</span></span><br><span class="line">      number=self.cleaned_data[<span class="string">&#x27;mobile&#x27;</span>]<span class="comment">#cleaned_data就是用户输入</span></span><br><span class="line">      exists=models.pretty.objects.<span class="built_in">filter</span>(mobile=number).exists()</span><br><span class="line">      <span class="keyword">if</span> exists:</span><br><span class="line">         <span class="keyword">raise</span> ValidationError(<span class="string">&#x27;手机号已存在&#x27;</span>)</span><br><span class="line">      <span class="keyword">return</span> number</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Prettyedit</span>(forms.ModelForm):</span><br><span class="line">   <span class="comment"># mobile=forms.CharField(disabled=True,label=&#x27;号码&#x27;)</span></span><br><span class="line">   <span class="comment">#不允许改动mobile数据</span></span><br><span class="line">   mobile=forms.CharField(label=<span class="string">&#x27;号码&#x27;</span>,validators=[RegexValidator(<span class="string">r&#x27;^158[0-9]+$&#x27;</span>,<span class="string">&#x27;号码必须以158开头,并且至少4位数&#x27;</span>)])</span><br><span class="line">   <span class="keyword">class</span> <span class="title class_">Meta</span>:</span><br><span class="line">      model=models.pretty</span><br><span class="line">      fields=[<span class="string">&#x27;mobile&#x27;</span>,<span class="string">&#x27;price&#x27;</span>,<span class="string">&#x27;level&#x27;</span>,<span class="string">&#x27;status&#x27;</span>]</span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,*args,**kwargs</span>):</span><br><span class="line">      <span class="built_in">super</span>().__init__(*args,**kwargs)</span><br><span class="line">      <span class="comment">#super表示调用父类,这里表示在父类原有的基础上补充</span></span><br><span class="line">      <span class="comment">#循环体里找到所有插件，添加class</span></span><br><span class="line">      <span class="keyword">for</span> name,field <span class="keyword">in</span> self.fields.items():</span><br><span class="line">         field.widget.attrs=&#123;<span class="string">&quot;class&quot;</span>:<span class="string">&quot;form-control&quot;</span>,<span class="string">&quot;placeholder&quot;</span>:field.label&#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">clean_mobile</span>(<span class="params">self</span>):  <span class="comment"># 此处名字必须使用固定的，否则不行</span></span><br><span class="line">      <span class="string">&#x27;&#x27;&#x27;检测手机号是否重复   &#x27;&#x27;&#x27;</span></span><br><span class="line">      number = self.cleaned_data[<span class="string">&#x27;mobile&#x27;</span>]  <span class="comment"># cleaned_data就是用户输入</span></span><br><span class="line">      <span class="comment">#self.instance.pk表示的是当前的id，由于这是在函数里没有nid</span></span><br><span class="line">      exists = models.pretty.objects.<span class="built_in">filter</span>(mobile=number).exclude(<span class="built_in">id</span>=self.instance.pk).exists()</span><br><span class="line">      <span class="keyword">if</span> exists:</span><br><span class="line">         <span class="keyword">raise</span> ValidationError(<span class="string">&#x27;手机号已存在&#x27;</span>)</span><br><span class="line">      <span class="keyword">return</span> number</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pretty_edit</span>(<span class="params">request,nid</span>):</span><br><span class="line">   row_obj = models.pretty.objects.<span class="built_in">filter</span>(<span class="built_in">id</span>=nid).first()</span><br><span class="line">   <span class="keyword">if</span> request.method == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">      form = Prettyedit(instance=row_obj)  <span class="comment"># 添加instance就可以输入的时候显示默认值</span></span><br><span class="line">      <span class="keyword">return</span> render(request, <span class="string">&#x27;pretty_edit.html&#x27;</span>, &#123;<span class="string">&quot;form&quot;</span>: form&#125;)</span><br><span class="line">   form = Prettyedit(data=request.POST, instance=row_obj)</span><br><span class="line">   <span class="comment"># 这儿的instance必须要加，表示是更新数据，而不是新增数据，要不然save无法识别</span></span><br><span class="line">   <span class="keyword">if</span> form.is_valid():</span><br><span class="line">      form.save()</span><br><span class="line">      <span class="comment"># 默认保存的是输入的数据，如果想要增加输入以外的值</span></span><br><span class="line">      <span class="comment"># 可以这样 form.instance.字段名=值，这个写在save上面</span></span><br><span class="line">      <span class="keyword">return</span> redirect(<span class="string">&#x27;/pretty/list/&#x27;</span>)</span><br><span class="line">   <span class="keyword">return</span> render(request, <span class="string">&#x27;pretty_edit.html&#x27;</span>, &#123;<span class="string">&quot;form&quot;</span>: form&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pretty_del</span>(<span class="params">request,nid</span>):</span><br><span class="line">   models.pretty.objects.<span class="built_in">filter</span>(<span class="built_in">id</span>=nid).delete()</span><br><span class="line">   <span class="keyword">return</span> redirect(<span class="string">&#x27;/pretty/list/&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends &#x27;layout.html&#x27; %&#125;</span><br><span class="line">&#123;% block content %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel panel-default&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel-heading&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">&quot;panel-title&quot;</span>&gt;</span>编辑用户<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel-body&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">novalidate</span>&gt;</span></span><br><span class="line">      &#123;% csrf_token %&#125;</span><br><span class="line">      &#123;% for field in form %&#125;</span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> &gt;</span>&#123;&#123; field.label &#125;&#125;<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        &#123;&#123;field&#125;&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;color: red;&quot;</span>&gt;</span>&#123;&#123; field.errors.0 &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      &#123;% endfor %&#125;</span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">path(&#x27;pretty/<span class="tag">&lt;<span class="name">int:nid</span>&gt;</span>/edit/&#x27;,views.pretty_edit),</span><br><span class="line">path(&#x27;pretty/<span class="tag">&lt;<span class="name">int:nid</span>&gt;</span>/del/&#x27;,views.pretty_del),</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666724763880-50434cd9-effa-4344-b8ef-be2c3ded569b.png#averageHue=%232e2d2c&clientId=uccd871d4-0752-4&from=paste&height=83&id=u6b6995f6&name=image.png&originHeight=104&originWidth=694&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16054&status=done&style=none&taskId=uab5ce457-c889-4521-857a-2a5e59a5372&title=&width=555.2" alt="image.png"></p>
<h2 id="搜索"><a href="#搜索" class="headerlink" title="搜索"></a>搜索</h2><p>先介绍一下其实filter还可以传入字典：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dict</span>=&#123;<span class="string">&quot;id&quot;</span>:<span class="number">1</span></span><br><span class="line">      ,<span class="string">&quot;name&quot;</span>:<span class="string">&quot;kino&quot;</span>&#125;</span><br><span class="line">models.pretty.objects.<span class="built_in">filter</span>(**<span class="built_in">dict</span>)</span><br></pre></td></tr></table></figure>
<p>这样也可以进行筛选<br>filter还有其他用法，还有其他的筛选用法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">models.pretty.objects.<span class="built_in">filter</span>(<span class="built_in">id</span>=<span class="number">1</span>)<span class="comment">#id=1</span></span><br><span class="line">models.pretty.objects.<span class="built_in">filter</span>(id__gt=<span class="number">12</span>)<span class="comment">#id&gt;12</span></span><br><span class="line">models.pretty.objects.<span class="built_in">filter</span>(id__gte=<span class="number">12</span>)<span class="comment">#id&gt;=12</span></span><br><span class="line">models.pretty.objects.<span class="built_in">filter</span>(id__lt=<span class="number">12</span>)<span class="comment">#id&lt;12</span></span><br><span class="line">models.pretty.objects.<span class="built_in">filter</span>(id__lte=<span class="number">12</span>)<span class="comment">#id&lt;=12</span></span><br><span class="line">models.pretty.objects.<span class="built_in">filter</span>(mobile__startwith=<span class="string">&quot;158&quot;</span>)<span class="comment">#以158开头的号码</span></span><br><span class="line">models.pretty.objects.<span class="built_in">filter</span>(mobile__endwith=<span class="string">&quot;666&quot;</span>)<span class="comment">#以158结尾的号码</span></span><br><span class="line">models.pretty.objects.<span class="built_in">filter</span>(mobile__contains=<span class="string">&quot;158666&quot;</span>)<span class="comment">#包含158666的号码</span></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666850243734-574147e1-22ae-4af9-904a-5700783ed721.png#averageHue=%232e2d2c&clientId=ufddcf4f6-310b-4&from=paste&height=142&id=u05862fb3&name=image.png&originHeight=178&originWidth=623&originalType=binary&ratio=1&rotation=0&showTitle=false&size=24280&status=done&style=none&taskId=u00418275-93db-4c8e-ad10-527a8d10a16&title=&width=498.4" alt="image.png"><br>这样可以来获取我们URL输入的，再检查，比如输入<code>?q=0</code>:<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666850266538-2b893438-a3dc-40f5-be14-c9c66411c3e3.png#averageHue=%23f9f8f8&clientId=ufddcf4f6-310b-4&from=paste&height=328&id=uc00adc60&name=image.png&originHeight=410&originWidth=1116&originalType=binary&ratio=1&rotation=0&showTitle=false&size=47083&status=done&style=none&taskId=ue4bb32d7-f667-4824-b399-503da4d223f&title=&width=892.8" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666850270087-2108ba1c-cb12-4306-ba05-91ee9c3205b5.png#averageHue=%23302e2d&clientId=ufddcf4f6-310b-4&from=paste&height=33&id=ud1362df8&name=image.png&originHeight=41&originWidth=509&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5298&status=done&style=none&taskId=u18186e8e-a3f7-4d76-8daf-d8fefe3c14d&title=&width=407.2" alt="image.png"><br>这里的if value并不是指的是value为0就不通过判断，而是判断是否为空<br>给源码了：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">pretty_list</span>(<span class="params">request</span>):</span><br><span class="line">   data=&#123;&#125;</span><br><span class="line">   value=request.GET.get(<span class="string">&#x27;q&#x27;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">   <span class="keyword">if</span> value:</span><br><span class="line">      data[<span class="string">&quot;mobile__contains&quot;</span>]=value</span><br><span class="line">   res=models.pretty.objects.<span class="built_in">filter</span>(**data)</span><br><span class="line">   prettynum=models.pretty.objects.<span class="built_in">filter</span>(**data).order_by(<span class="string">&#x27;-level&#x27;</span>)</span><br><span class="line">   <span class="comment">#相当于select * from 表 order by level desc 倒序输出</span></span><br><span class="line">   <span class="keyword">return</span> render(request,<span class="string">&#x27;pretty_list.html&#x27;</span>,&#123;<span class="string">&quot;info&quot;</span>:prettynum,<span class="string">&quot;search&quot;</span>:value&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;margin-bottom: 10px;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;clearfix&quot;</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-success&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/pretty/add/&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;glyphicon glyphicon-plus&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">               新建靓号</span><br><span class="line">           <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;float: right;width: 300px;&quot;</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;get&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;input-group&quot;</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">name</span>=<span class="string">&quot;q&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;Search for...&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;&#123; search &#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;input-group-btn&quot;</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-default&quot;</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;glyphicon glyphicon-search&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>也不难</p>
<h2 id="分页（原理）"><a href="#分页（原理）" class="headerlink" title="分页（原理）"></a>分页（原理）</h2><p>诶，四十多分钟的教学，看的头皮发麻，做开发的真难<br>首先先来讲一下整体思路吧，思路：</p>
<ul>
<li><p>URL传入一个参数page</p>
</li>
<li><p>根据page去配合filter筛选数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#假如有300条数据，一页只展示10条</span></span><br><span class="line">models.pretty.objects.<span class="built_in">all</span>()[<span class="number">0</span>:<span class="number">10</span>]</span><br></pre></td></tr></table></figure>
</li>
<li><p>再写一下分页框，直接去Bootstrap扒下来</p>
</li>
<li><p>最难的就是分页框里的判断了，首先确定当前页，然后在当前页高光，分页框以当前页为中心，左边五条，右边五条，这样的结构，这里面要写一些判断</p>
</li>
</ul>
<p>思路说完了就来实操吧，你已经会打水泥了来造房子吧！<br>这里比较繁琐就一步步介绍了，首先先添加300条数据来做测试：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666864375848-56602fda-dbb1-4a51-952d-ece701ec9a52.png#averageHue=%2331312f&clientId=u0f51dc14-467d-4&from=paste&height=67&id=u9bee7a15&name=image.png&originHeight=84&originWidth=739&originalType=binary&ratio=1&rotation=0&showTitle=false&size=12483&status=done&style=none&taskId=u778b1891-a27d-4052-b088-8a521dfffb6&title=&width=591.2" alt="image.png"><br>在这之后：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">page=<span class="built_in">int</span>(request.GET.get(<span class="string">&quot;page&quot;</span>,<span class="number">1</span>))<span class="comment">#这个1是默认值为1，也就是第一页</span></span><br><span class="line">   step=<span class="number">10</span><span class="comment">#设置一页展示多少行</span></span><br><span class="line">   start=(page-<span class="number">1</span>)*step</span><br><span class="line">   end=page*step</span><br><span class="line"></span><br><span class="line">   prettynum=models.pretty.objects.<span class="built_in">filter</span>(**data).order_by(<span class="string">&#x27;-level&#x27;</span>)[start:end]</span><br></pre></td></tr></table></figure>
<p>和思路里介绍的一样，那接下来就是设置分页框了，去bootstrap拿下来</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">nav</span> <span class="attr">aria-label</span>=<span class="string">&quot;Page navigation&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;pagination&quot;</span>&gt;</span></span><br><span class="line">            &#123;&#123; change &#125;&#125;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>再设置一下总页数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">page=<span class="built_in">int</span>(request.GET.get(<span class="string">&quot;page&quot;</span>,<span class="number">1</span>))<span class="comment">#这个1是默认值为1，也就是第一页</span></span><br><span class="line">   step=<span class="number">10</span><span class="comment">#设置一页展示多少行</span></span><br><span class="line">   start=(page-<span class="number">1</span>)*step</span><br><span class="line">   end=page*step</span><br><span class="line">   <span class="comment">#页码</span></span><br><span class="line">   page_str_list=[]</span><br><span class="line">   total_list=models.pretty.objects.<span class="built_in">all</span>().count()<span class="comment">#找出总数据条数</span></span><br><span class="line">   total_page,div=<span class="built_in">divmod</span>(total_list,step)</span><br><span class="line">   <span class="keyword">if</span> div!=<span class="number">0</span>:</span><br><span class="line">      total_page=total_page+<span class="number">1</span></span><br><span class="line">   <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,total_page+<span class="number">1</span>):</span><br><span class="line">      ele=<span class="string">&#x27;&lt;li&gt;&lt;a href=&quot;?page=&#123;&#125;&quot;&gt;&#123;&#125;&lt;/a&gt;&lt;/li&gt;&#x27;</span>.<span class="built_in">format</span>(i,i)</span><br><span class="line">      page_str_list.append(ele)</span><br><span class="line">      page_string=<span class="string">&quot;&quot;</span>.join(page_str_list)<span class="comment">#转化为字符串</span></span><br><span class="line">      page_string=mark_safe(page_string)<span class="comment">#变为HTML代码</span></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666872194517-7b01163e-a3ba-4459-9061-32165b02c674.png#averageHue=%23fdfdfd&clientId=u0f51dc14-467d-4&from=paste&height=132&id=u93d76694&name=image.png&originHeight=165&originWidth=988&originalType=binary&ratio=1&rotation=0&showTitle=false&size=12134&status=done&style=none&taskId=u3d25721c-c0a2-48ae-b749-57b97a509b6&title=&width=790.4" alt="image.png"><br>效果就如下了<br>下面是对分页效果的优化，展示11个页码，然后临界点问题，不能有负数<br>也直接拿源码了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">pretty_list</span>(<span class="params">request</span>):</span><br><span class="line">   <span class="comment"># for i in range(300):</span></span><br><span class="line">   <span class="comment">#    models.pretty.objects.create(mobile=&#x27;666&#x27;,price=&#x27;555&#x27;,level=1,status=2)</span></span><br><span class="line"></span><br><span class="line">   data=&#123;&#125;</span><br><span class="line">   value=request.GET.get(<span class="string">&#x27;q&#x27;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">   <span class="keyword">if</span> value:</span><br><span class="line">      data[<span class="string">&quot;mobile__contains&quot;</span>]=value</span><br><span class="line">   res=models.pretty.objects.<span class="built_in">filter</span>(**data)</span><br><span class="line"></span><br><span class="line">   page=<span class="built_in">int</span>(request.GET.get(<span class="string">&quot;page&quot;</span>,<span class="number">1</span>))<span class="comment">#这个1是默认值为1，也就是第一页</span></span><br><span class="line">   step=<span class="number">10</span><span class="comment">#设置一页展示多少行</span></span><br><span class="line">   start=(page-<span class="number">1</span>)*step</span><br><span class="line">   end=page*step</span><br><span class="line"></span><br><span class="line">   <span class="comment">#页码</span></span><br><span class="line">   page_str_list=[]</span><br><span class="line">   total_list=models.pretty.objects.<span class="built_in">all</span>().count()<span class="comment">#找出总数据条数</span></span><br><span class="line">   total_page,div=<span class="built_in">divmod</span>(total_list,step)</span><br><span class="line">   <span class="keyword">if</span> div!=<span class="number">0</span>:</span><br><span class="line">      total_page=total_page+<span class="number">1</span></span><br><span class="line">   <span class="comment">#前五页后五页</span></span><br><span class="line">   plus=<span class="number">5</span></span><br><span class="line">   start_page=page-plus <span class="keyword">if</span>(page-plus)&gt;<span class="number">1</span> <span class="keyword">else</span> <span class="number">1</span></span><br><span class="line">   end_page=page+plus+<span class="number">1</span> <span class="keyword">if</span>(page+plus+<span class="number">1</span>)&lt;total_page <span class="keyword">else</span> total_page</span><br><span class="line">   <span class="comment">#首页</span></span><br><span class="line">   up=<span class="string">&#x27;&lt;li&gt;&lt;a href=&quot;?page=1&quot;&gt;首页&lt;/a&gt;&lt;/li&gt;&#x27;</span></span><br><span class="line">   page_str_list.append(up)</span><br><span class="line">   <span class="comment">#上一页</span></span><br><span class="line">   <span class="keyword">if</span> page&gt;<span class="number">1</span>:</span><br><span class="line">      prev=<span class="string">&#x27;&lt;li&gt;&lt;a href=&quot;?page=&#123;&#125;&quot;&gt;上一页&lt;/a&gt;&lt;/li&gt;&#x27;</span>.<span class="built_in">format</span>(page-<span class="number">1</span>)</span><br><span class="line">   <span class="keyword">else</span>:</span><br><span class="line">      prev =<span class="string">&#x27;&lt;li&gt;&lt;a href=&quot;?page=1&quot;&gt;上一页&lt;/a&gt;&lt;/li&gt;&#x27;</span></span><br><span class="line">   page_str_list.append(prev)</span><br><span class="line"></span><br><span class="line">   <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(start_page,end_page+<span class="number">1</span>):</span><br><span class="line">      <span class="keyword">if</span> i==page:</span><br><span class="line">         ele=<span class="string">&#x27;&lt;li class=&quot;active&quot;&gt;&lt;a href=&quot;?page=&#123;&#125;&quot;&gt;&#123;&#125;&lt;/a&gt;&lt;/li&gt;&#x27;</span>.<span class="built_in">format</span>(i,i)</span><br><span class="line">      <span class="keyword">else</span>:</span><br><span class="line">         ele=<span class="string">&#x27;&lt;li&gt;&lt;a href=&quot;?page=&#123;&#125;&quot;&gt;&#123;&#125;&lt;/a&gt;&lt;/li&gt;&#x27;</span>.<span class="built_in">format</span>(i,i)</span><br><span class="line">      page_str_list.append(ele)</span><br><span class="line">      <span class="comment"># 下一页</span></span><br><span class="line">   <span class="keyword">if</span> page &lt; total_page:</span><br><span class="line">      suffix = <span class="string">&#x27;&lt;li&gt;&lt;a href=&quot;?page=&#123;&#125;&quot;&gt;下一页&lt;/a&gt;&lt;/li&gt;&#x27;</span>.<span class="built_in">format</span>(page + <span class="number">1</span>)</span><br><span class="line">   <span class="keyword">else</span>:</span><br><span class="line">      suffix = <span class="string">&#x27;&lt;li&gt;&lt;a href=&quot;?page=&#123;&#125;&quot;&gt;下一页&lt;/a&gt;&lt;/li&gt;&#x27;</span>.<span class="built_in">format</span>(total_page)</span><br><span class="line">   page_str_list.append(suffix)</span><br><span class="line">   page_string = <span class="string">&quot;&quot;</span>.join(page_str_list)  <span class="comment"># 转化为字符串</span></span><br><span class="line">   page_string=mark_safe(page_string)<span class="comment">#变为HTML代码</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   prettynum=models.pretty.objects.<span class="built_in">filter</span>(**data).order_by(<span class="string">&#x27;-level&#x27;</span>)[start:end]</span><br><span class="line">   <span class="comment">#相当于select * from 表 order by level desc 倒序输出</span></span><br></pre></td></tr></table></figure>


<h2 id="分页组件"><a href="#分页组件" class="headerlink" title="分页组件"></a>分页组件</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667030726775-47e5ea4b-14d5-44ef-a160-7e07f1db5aba.png#averageHue=%232d2d2c&clientId=u714e44b5-1024-4&from=paste&height=251&id=uf1c008f8&name=image.png&originHeight=314&originWidth=676&originalType=binary&ratio=1&rotation=0&showTitle=false&size=33643&status=done&style=none&taskId=u61992b0e-d181-4991-8486-df2c1ebbea2&title=&width=540.8" alt="image.png"><br>先把上题的再完善一下做个跳转<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667030750188-5d3c3c85-1629-4706-b6aa-248f73950ab3.png#averageHue=%23fefefd&clientId=u714e44b5-1024-4&from=paste&height=131&id=u01c33eac&name=image.png&originHeight=164&originWidth=1095&originalType=binary&ratio=1&rotation=0&showTitle=false&size=6713&status=done&style=none&taskId=u5b72b0c6-af6e-4ad0-9dcc-3b0acb075a9&title=&width=876" alt="image.png"></p>
<ul>
<li><strong>小BUG</strong>：</li>
</ul>
<p>做好基本分页后，会发现点了另一页之后参数p就会被page覆盖，这2个参数是不能同时存在的QWQ<br>首先要知道一些函数:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">test=request.GET</span><br><span class="line">test._mutable=<span class="literal">True</span></span><br><span class="line">test.setlist(<span class="string">&#x27;xx&#x27;</span>,[<span class="number">11</span>,<span class="number">12</span>])</span><br><span class="line"><span class="built_in">print</span>(test)</span><br><span class="line"><span class="built_in">print</span>(test.urlencode())</span><br></pre></td></tr></table></figure>
<p>通常来说request.GET是获得GET所有的参数，是个字典，之后是不能使用setlist去添加参数的，要用_mutable，开启这个选项之后就可以添加<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667042065134-947f344e-7b98-4cdc-b6f6-29ec160864a4.png#averageHue=%23333130&clientId=u714e44b5-1024-4&from=paste&height=173&id=u885f7be8&name=image.png&originHeight=216&originWidth=991&originalType=binary&ratio=1&rotation=0&showTitle=false&size=42924&status=done&style=none&taskId=uf52a9133-8c50-4cb7-b385-a5c130d5442&title=&width=792.8" alt="image.png"><br>接下来直接上源码，可能有点绕，我绕了好久啊。。。<br>真的发现开发其实挺难的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">分页组件</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">from</span> django.utils.safestring <span class="keyword">import</span> mark_safe <span class="comment">#mark_safe模块可以让字符串变为HTML代码</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">jump</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,request,queryset,step=<span class="number">10</span>,page_param=<span class="string">&quot;page&quot;</span>,plus=<span class="number">5</span></span>):</span><br><span class="line">        query_dict=request.GET</span><br><span class="line">        query_dict._mutable=<span class="literal">True</span></span><br><span class="line">        self.query_dict=query_dict</span><br><span class="line">        page=request.GET.get(page_param,<span class="string">&quot;1&quot;</span>)<span class="comment">#这里的1一定要用字符串，因为isdecimal需要字符串类型</span></span><br><span class="line">        <span class="keyword">if</span> page.isdecimal():</span><br><span class="line">            page=<span class="built_in">int</span>(page)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            page=<span class="number">1</span></span><br><span class="line">        self.step=step</span><br><span class="line">        self.page=page</span><br><span class="line">        self.page_param=page_param</span><br><span class="line">        self.start = (page - <span class="number">1</span>) * step</span><br><span class="line">        self.end = page * step</span><br><span class="line">        self.queryset=queryset[self.start:self.end]</span><br><span class="line">        self.plus=plus</span><br><span class="line">        total_list=queryset.count()</span><br><span class="line">        <span class="built_in">print</span>(queryset)</span><br><span class="line">        total_page,div=<span class="built_in">divmod</span>(total_list,step)</span><br><span class="line">        <span class="keyword">if</span> div:</span><br><span class="line">            self.total_page=total_page+<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.total_page=total_page</span><br><span class="line">        <span class="built_in">print</span>(self.total_page, total_list,div)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">HTMl</span>(<span class="params">self</span>):</span><br><span class="line">        page_str_list = []</span><br><span class="line">        <span class="comment"># 前五页后五页</span></span><br><span class="line">        start_page = self.page - self.plus <span class="keyword">if</span> (self.page - self.plus) &gt; <span class="number">1</span> <span class="keyword">else</span> <span class="number">1</span></span><br><span class="line">        end_page = self.page + self.plus + <span class="number">1</span> <span class="keyword">if</span> (self.page + self.plus + <span class="number">1</span>) &lt; self.total_page <span class="keyword">else</span> self.total_page</span><br><span class="line">        <span class="comment"># 首页</span></span><br><span class="line">        <span class="built_in">print</span>(end_page)</span><br><span class="line">        self.query_dict.setlist(self.page_param,[<span class="number">1</span>])</span><br><span class="line">        up = <span class="string">&#x27;&lt;li&gt;&lt;a href=&quot;?&#123;&#125;&quot;&gt;首页&lt;/a&gt;&lt;/li&gt;&#x27;</span>.<span class="built_in">format</span>(self.query_dict.urlencode())</span><br><span class="line">        page_str_list.append(up)</span><br><span class="line">        <span class="comment"># 上一页</span></span><br><span class="line">        <span class="keyword">if</span> self.page &gt; <span class="number">1</span>:</span><br><span class="line">            self.query_dict.setlist(self.page_param, [self.page - <span class="number">1</span>])</span><br><span class="line">            prev = <span class="string">&#x27;&lt;li&gt;&lt;a href=&quot;?&#123;&#125;&quot;&gt;上一页&lt;/a&gt;&lt;/li&gt;&#x27;</span>.<span class="built_in">format</span>(self.query_dict.urlencode())</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.query_dict.setlist(self.page_param, [<span class="number">1</span>])</span><br><span class="line">            prev = <span class="string">&#x27;&lt;li&gt;&lt;a href=&quot;?&#123;&#125;&quot;&gt;上一页&lt;/a&gt;&lt;/li&gt;&#x27;</span>.<span class="built_in">format</span>(self.query_dict.urlencode())</span><br><span class="line">        page_str_list.append(prev)</span><br><span class="line">        <span class="built_in">print</span>(self.page,self.plus,start_page,end_page)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(start_page, end_page + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> i == self.page:</span><br><span class="line">                self.query_dict.setlist(self.page_param,[i])</span><br><span class="line">                ele = <span class="string">&#x27;&lt;li class=&quot;active&quot;&gt;&lt;a href=&quot;?&#123;&#125;&quot;&gt;&#123;&#125;&lt;/a&gt;&lt;/li&gt;&#x27;</span>.<span class="built_in">format</span>(self.query_dict.urlencode(), i)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.query_dict.setlist(self.page_param,[i])</span><br><span class="line">                ele = <span class="string">&#x27;&lt;li&gt;&lt;a href=&quot;?&#123;&#125;&quot;&gt;&#123;&#125;&lt;/a&gt;&lt;/li&gt;&#x27;</span>.<span class="built_in">format</span>(self.query_dict.urlencode(), i)</span><br><span class="line">            page_str_list.append(ele)</span><br><span class="line">            <span class="comment"># 下一页</span></span><br><span class="line">        <span class="keyword">if</span> self.page &lt; self.total_page:</span><br><span class="line">            self.query_dict.setlist(self.page_param, [self.page+<span class="number">1</span>])</span><br><span class="line">            suffix = <span class="string">&#x27;&lt;li&gt;&lt;a href=&quot;?&#123;&#125;&quot;&gt;下一页&lt;/a&gt;&lt;/li&gt;&#x27;</span>.<span class="built_in">format</span>(self.query_dict.urlencode())</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.query_dict.setlist(self.page_param, [self.total_page])</span><br><span class="line">            suffix = <span class="string">&#x27;&lt;li&gt;&lt;a href=&quot;?&#123;&#125;&quot;&gt;下一页&lt;/a&gt;&lt;/li&gt;&#x27;</span>.<span class="built_in">format</span>(self.query_dict.urlencode())</span><br><span class="line">        page_str_list.append(suffix)</span><br><span class="line">        jump = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">           &lt;li&gt;</span></span><br><span class="line"><span class="string">                      &lt;form method=&quot;get&quot; style=&quot;float: left;margin-left: -1px&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;input-group&quot; style=&quot;width: 200px&quot;&gt;</span></span><br><span class="line"><span class="string">                        &lt;input type=&quot;text&quot; name=&quot;page&quot; class=&quot;form-control&quot; placeholder=&quot;页码&quot;&gt;</span></span><br><span class="line"><span class="string">                        &lt;span class=&quot;input-group-btn&quot;&gt;</span></span><br><span class="line"><span class="string">                            &lt;button class=&quot;btn btn-default&quot; tyoe=&quot;submit&quot;&gt;跳转&lt;/button&gt;</span></span><br><span class="line"><span class="string">                        &lt;/span&gt;</span></span><br><span class="line"><span class="string">                    &lt;/div&gt;</span></span><br><span class="line"><span class="string">                    &lt;/form&gt;</span></span><br><span class="line"><span class="string">                  &lt;/li&gt;</span></span><br><span class="line"><span class="string">           &#x27;&#x27;&#x27;</span></span><br><span class="line">        page_str_list.append(jump)</span><br><span class="line">        page_string = <span class="string">&quot;&quot;</span>.join(page_str_list)  <span class="comment"># 转化为字符串</span></span><br><span class="line">        page_string = mark_safe(page_string)  <span class="comment"># 变为HTML代码</span></span><br><span class="line">        <span class="keyword">return</span> page_string</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">pretty_list</span>(<span class="params">request</span>):</span><br><span class="line">   <span class="comment"># for i in range(300):</span></span><br><span class="line">   <span class="comment">#    models.pretty.objects.create(mobile=&#x27;666&#x27;,price=&#x27;555&#x27;,level=1,status=2)</span></span><br><span class="line">   data=&#123;&#125;</span><br><span class="line">   value=request.GET.get(<span class="string">&#x27;q&#x27;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">   <span class="keyword">if</span> value:</span><br><span class="line">      data[<span class="string">&quot;mobile__contains&quot;</span>]=value</span><br><span class="line">   res=models.pretty.objects.<span class="built_in">filter</span>(**data)</span><br><span class="line">   <span class="comment">#开始使用自己做的组件</span></span><br><span class="line">   prettynum=models.pretty.objects.<span class="built_in">filter</span>(**data).order_by(<span class="string">&#x27;-level&#x27;</span>)</span><br><span class="line">   jump_obj=jump(request,prettynum,step=<span class="number">15</span>)</span><br><span class="line">   queryset=jump_obj.queryset</span><br><span class="line">   page_string=jump_obj.HTMl()</span><br><span class="line">   content=&#123;</span><br><span class="line">      <span class="string">&quot;info&quot;</span>:queryset,<span class="comment">#数据</span></span><br><span class="line">      <span class="string">&quot;search&quot;</span>:value,<span class="comment">#检索</span></span><br><span class="line">      <span class="string">&quot;change&quot;</span>:page_string<span class="comment">#分页</span></span><br><span class="line">   &#125;</span><br><span class="line">   <span class="comment">#相当于select * from 表 order by level desc 倒序输出</span></span><br><span class="line">   <span class="keyword">return</span> render(request,<span class="string">&#x27;pretty_list.html&#x27;</span>,content)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">user_list</span>(<span class="params">request</span>):</span><br><span class="line">   <span class="string">&#x27;&#x27;&#x27;用户列表&#x27;&#x27;&#x27;</span></span><br><span class="line">   <span class="comment">#获取用户信息</span></span><br><span class="line">   userinfo=models.UserInfo.objects.<span class="built_in">all</span>()</span><br><span class="line">   page_object=jump(request,userinfo,<span class="number">5</span>)</span><br><span class="line">   content=&#123;</span><br><span class="line">      <span class="string">&quot;userinfo&quot;</span>:page_object.queryset,</span><br><span class="line">      <span class="string">&quot;page_string&quot;</span>:page_object.HTMl()</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment"># for data in userinfo:</span></span><br><span class="line">      <span class="comment">#print(data.id,data.name,data.password,data.age,data.account,data.create_time.strftime(&quot;%Y-%m-%d&quot;),data.get_gender_display(),data.depart.title)</span></span><br><span class="line">       <span class="comment">#data.create_time.strftime(&quot;%Y-%m-%d&quot;)表示将datatime类型转换为字符串类型，略去后面的00000</span></span><br><span class="line">       <span class="comment">#ata.get_gender_display() 表示直接获得1对应的选择，也就是男或者女</span></span><br><span class="line">       <span class="comment">#data.depart.title 表示直接获得关联表的title，我们depart是foreignkey类型的</span></span><br><span class="line">   <span class="keyword">return</span> render(request,<span class="string">&#x27;user_list.html&#x27;</span>,content)</span><br></pre></td></tr></table></figure>
<p>用户页表的html：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667049291540-1bdcd2ed-ed12-4949-8bff-893907c958b1.png#averageHue=%232f2e2d&clientId=u675e07bc-9752-4&from=paste&height=150&id=uc57a2d7f&name=image.png&originHeight=187&originWidth=482&originalType=binary&ratio=1&rotation=0&showTitle=false&size=18841&status=done&style=none&taskId=uda4c07ec-bf24-4af4-b5f3-91e2c6a9578&title=&width=385.6" alt="image.png"><br>最终展示：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667049300629-054eb3bb-6f57-485c-9b2a-81eb0f50eee3.png#averageHue=%23fbfafa&clientId=u675e07bc-9752-4&from=paste&height=556&id=ucb7048e5&name=image.png&originHeight=695&originWidth=1680&originalType=binary&ratio=1&rotation=0&showTitle=false&size=87281&status=done&style=none&taskId=u7b6152e4-1741-4485-b10f-42097cf633f&title=&width=1344" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667049309243-7493a8aa-554a-4679-b160-bf2d27c59ddc.png#averageHue=%23fbfafa&clientId=u675e07bc-9752-4&from=paste&height=777&id=u5ae52286&name=image.png&originHeight=971&originWidth=1765&originalType=binary&ratio=1&rotation=0&showTitle=false&size=113121&status=done&style=none&taskId=u802dd4fb-45fb-4c0a-b1de-6d49d138a66&title=&width=1412" alt="image.png"></p>
<h2 id="时间挂件"><a href="#时间挂件" class="headerlink" title="时间挂件"></a>时间挂件</h2><p>首先先引入时间插件<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667050885812-dbbe44a1-f7f6-4473-aa03-900eacb0d922.png#averageHue=%23fcfbfa&clientId=u675e07bc-9752-4&from=paste&height=75&id=ub143dd3b&name=image.png&originHeight=94&originWidth=755&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7013&status=done&style=none&taskId=uc8c7fdbe-7cb0-4dec-b314-cd5e1c3f26b&title=&width=604" alt="image.png"><br>这东西去官网下载吧，之后再更改一下模板文件和用户添加文件就好了：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667050910894-c98154d5-ed2f-4772-acdc-fdd5d17cab58.png#averageHue=%23302e2c&clientId=u675e07bc-9752-4&from=paste&height=90&id=u6a5edf63&name=image.png&originHeight=113&originWidth=488&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13701&status=done&style=none&taskId=u5c1ef8e1-922b-4cdf-9ca3-7f7bb88b390&title=&width=390.4" alt="image.png"><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667050914543-c52fce15-9349-4194-b116-906b109a614e.png#averageHue=%2332302d&clientId=u675e07bc-9752-4&from=paste&height=86&id=u1b90c8e9&name=image.png&originHeight=107&originWidth=401&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16802&status=done&style=none&taskId=u2b035022-bab7-4830-a53e-40e39b1786a&title=&width=320.8" alt="image.png"><br>模板文件多添加2个block分别来放css和js文件,js的block一定放下面，因为有定义函数<br>用户编辑页面：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends &#x27;layout.html&#x27; %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% load static %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block css %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&#123;% static &#x27;plugins/bootstrap-datepicker/css/bootstrap-datepicker.min.css&#x27; %&#125;&quot;</span>&gt;</span></span><br><span class="line">&#123;% endblock %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block content %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel panel-default&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel-heading&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">&quot;panel-title&quot;</span>&gt;</span>ModelForm新建用户<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel-body&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">novalidate</span>&gt;</span></span><br><span class="line">    &#123;% csrf_token %&#125;</span><br><span class="line">    &#123;% for field in form %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> &gt;</span>&#123;&#123; field.label &#125;&#125;<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        &#123;&#123;field&#125;&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;color: red;&quot;</span>&gt;</span>&#123;&#123; field.errors.0 &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    &#123;% endfor %&#125;</span><br><span class="line"> <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endblock %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block js %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&#123;% static &#x27;plugins/bootstrap-datepicker/js/bootstrap-datepicker.js&#x27; %&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&#123;% static &#x27;plugins/bootstrap-datepicker/locales/bootstrap-datepicker.zh-CN.min.js&#x27; %&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        $(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            $(<span class="string">&#x27;#id_create_time&#x27;</span>).<span class="title function_">datepicker</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">format</span>: <span class="string">&#x27;yyyy-mm-dd&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">startDate</span>: <span class="string">&#x27;0&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">language</span>: <span class="string">&quot;zh-CN&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">autoclose</span>: <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">            &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        &#125;)</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667050993843-847b20fe-5aa5-4d66-9d9b-67a6a68909e6.png#averageHue=%232d2c2b&clientId=u675e07bc-9752-4&from=paste&height=123&id=u9d494a9a&name=image.png&originHeight=154&originWidth=459&originalType=binary&ratio=1&rotation=0&showTitle=false&size=15826&status=done&style=none&taskId=u68aa686a-ccbd-4048-af50-422934477e2&title=&width=367.2" alt="image.png"><br>这里的<code>id_create_time</code>是django的modelform模板自己默认的值：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667051026931-ec7fff2f-18c4-4f71-9cf8-c3f412ce63f9.png#averageHue=%23c79b5e&clientId=u675e07bc-9752-4&from=paste&height=59&id=u98f39892&name=image.png&originHeight=74&originWidth=1087&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9059&status=done&style=none&taskId=u1a98ee06-c504-460a-92f0-099a3e79560&title=&width=869.6" alt="image.png"></p>
<h2 id="Bootstrap样式父类"><a href="#Bootstrap样式父类" class="headerlink" title="Bootstrap样式父类"></a>Bootstrap样式父类</h2><p>之前我们给输入框添加属性是通过添加插件：</p>
<ul>
<li><p>ModelForm可以把我们生成HTML标签：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">UserModelForm</span>(forms.ModelForm):</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Meta</span>:</span><br><span class="line">        model = models.UserInfo</span><br><span class="line">        fields = [<span class="string">&quot;name&quot;</span>, <span class="string">&quot;password&quot;</span>,]</span><br><span class="line"></span><br><span class="line">form = UserModelForm()</span><br></pre></td></tr></table></figure>
</li>
<li><p>定义插件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">UserModelForm</span>(forms.ModelForm):</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Meta</span>:</span><br><span class="line">        model = models.UserInfo</span><br><span class="line">        fields = [<span class="string">&quot;name&quot;</span>, <span class="string">&quot;password&quot;</span>,]</span><br><span class="line">        widgets = &#123;</span><br><span class="line">            <span class="string">&quot;name&quot;</span>: forms.TextInput(attrs=&#123;<span class="string">&quot;class&quot;</span>: <span class="string">&quot;form-control&quot;</span>&#125;),</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: forms.PasswordInput(attrs=&#123;<span class="string">&quot;class&quot;</span>: <span class="string">&quot;form-control&quot;</span>&#125;),</span><br><span class="line">            <span class="string">&quot;age&quot;</span>: forms.TextInput(attrs=&#123;<span class="string">&quot;class&quot;</span>: <span class="string">&quot;form-control&quot;</span>&#125;),</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserModelForm</span>(forms.ModelForm):</span><br><span class="line">    name = forms.CharField(</span><br><span class="line">        min_length=<span class="number">3</span>,</span><br><span class="line">        label=<span class="string">&quot;用户名&quot;</span>,</span><br><span class="line">        widget=forms.TextInput(attrs=&#123;<span class="string">&quot;class&quot;</span>: <span class="string">&quot;form-control&quot;</span>&#125;)</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Meta</span>:</span><br><span class="line">        model = models.UserInfo</span><br><span class="line">        fields = [<span class="string">&quot;name&quot;</span>, <span class="string">&quot;password&quot;</span>, <span class="string">&quot;age&quot;</span>]</span><br></pre></td></tr></table></figure>
</li>
<li><p>重新定义的init方法，批量设置：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">UserModelForm</span>(forms.ModelForm):</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Meta</span>:</span><br><span class="line">        model = models.UserInfo</span><br><span class="line">        fields = [<span class="string">&quot;name&quot;</span>, <span class="string">&quot;password&quot;</span>, <span class="string">&quot;age&quot;</span>,]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, *args, **kwargs</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__(*args, **kwargs)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 循环ModelForm中的所有字段，给每个字段的插件设置</span></span><br><span class="line">        <span class="keyword">for</span> name, field <span class="keyword">in</span> self.fields.items():</span><br><span class="line">			field.widget.attrs = &#123;</span><br><span class="line">                <span class="string">&quot;class&quot;</span>: <span class="string">&quot;form-control&quot;</span>, </span><br><span class="line">                <span class="string">&quot;placeholder&quot;</span>: field.label</span><br></pre></td></tr></table></figure>
</li>
<li><p>自定义类：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">BootStrapModelForm</span>(forms.ModelForm):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, *args, **kwargs</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__(*args, **kwargs)</span><br><span class="line">        <span class="comment"># 循环ModelForm中的所有字段，给每个字段的插件设置</span></span><br><span class="line">        <span class="keyword">for</span> name, field <span class="keyword">in</span> self.fields.items():</span><br><span class="line">            <span class="comment"># 字段中有属性，保留原来的属性，没有属性，才增加。</span></span><br><span class="line">            <span class="keyword">if</span> field.widget.attrs:</span><br><span class="line">				field.widget.attrs[<span class="string">&quot;class&quot;</span>] = <span class="string">&quot;form-control&quot;</span></span><br><span class="line">				field.widget.attrs[<span class="string">&quot;placeholder&quot;</span>] = field.label</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                field.widget.attrs = &#123;</span><br><span class="line">                    <span class="string">&quot;class&quot;</span>: <span class="string">&quot;form-control&quot;</span>, </span><br><span class="line">                    <span class="string">&quot;placeholder&quot;</span>: field.label</span><br><span class="line">                &#125;</span><br></pre></td></tr></table></figure>
<p>以后写的时候直接下面：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">UserEditModelForm</span>(<span class="title class_ inherited__">BootStrapModelForm</span>):</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Meta</span>:</span><br><span class="line">        model = models.UserInfo</span><br><span class="line">        fields = [<span class="string">&quot;name&quot;</span>, <span class="string">&quot;password&quot;</span>, <span class="string">&quot;age&quot;</span>,]</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="拆分功能（优化）"><a href="#拆分功能（优化）" class="headerlink" title="拆分功能（优化）"></a>拆分功能（优化）</h2><p>知道了上面的自定义类，我们就来优化一下：<br>首先先创建父类模板<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667052806226-78659909-e969-4a12-8c72-0bbe3c0dc17c.png#averageHue=%2331302e&clientId=u675e07bc-9752-4&from=paste&height=349&id=u526450ca&name=image.png&originHeight=436&originWidth=669&originalType=binary&ratio=1&rotation=0&showTitle=false&size=60485&status=done&style=none&taskId=u9a645636-60c8-4f67-8333-6fa8876505b&title=&width=535.2" alt="image.png"><br>再将之前定义的ModelForm类里的init方法删干净，继承BootStrapModelForm<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667052850150-ff6973c0-7db6-44ed-9041-720685f474ce.png#averageHue=%23312f2e&clientId=u675e07bc-9752-4&from=paste&height=198&id=u52752a9a&name=image.png&originHeight=247&originWidth=695&originalType=binary&ratio=1&rotation=0&showTitle=false&size=40529&status=done&style=none&taskId=u611b6186-5649-4664-8380-ef734ec1d91&title=&width=556" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667052858065-0fe471fd-b36f-4a89-81f5-5ea8ae34f5e5.png#averageHue=%23312f2e&clientId=u675e07bc-9752-4&from=paste&height=138&id=u45a9700e&name=image.png&originHeight=172&originWidth=641&originalType=binary&ratio=1&rotation=0&showTitle=false&size=27057&status=done&style=none&taskId=uf28db220-5fc2-466a-a7bb-d2b4148aa75&title=&width=512.8" alt="image.png"><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667052868180-2320cc12-1a1f-498c-bb11-9c6f6a19a7c7.png#averageHue=%2332302e&clientId=u675e07bc-9752-4&from=paste&height=165&id=u51495b50&name=image.png&originHeight=206&originWidth=646&originalType=binary&ratio=1&rotation=0&showTitle=false&size=33819&status=done&style=none&taskId=u99a5e4f0-4095-464f-9d91-f9cc9cef5c1&title=&width=516.8" alt="image.png"></p>
<p>这样算是完成了第一部的封装，我们看一下views.py的缩略图：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667052966602-6033aaaf-c41c-4a9d-be76-fd4a5e5a4338.png#averageHue=%232f2e2d&clientId=u675e07bc-9752-4&from=paste&height=418&id=u15c05985&name=image.png&originHeight=523&originWidth=651&originalType=binary&ratio=1&rotation=0&showTitle=false&size=58169&status=done&style=none&taskId=ude6e796e-0ec2-4d56-aa92-62a863002d2&title=&width=520.8" alt="image.png"><br>会发现还是有一些类，我们的类可以单独的去放在一个文件内，就比如是forms.py内，这样可以更加简介：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667053096726-768e10e1-1206-4d80-a2e7-fbdd7a8b224a.png#averageHue=%23302f2d&clientId=u675e07bc-9752-4&from=paste&height=327&id=ua94c53f3&name=image.png&originHeight=409&originWidth=715&originalType=binary&ratio=1&rotation=0&showTitle=false&size=62919&status=done&style=none&taskId=u2645a8ec-3fbb-4c41-88f8-5ec3e4a6b6b&title=&width=572" alt="image.png"><br>灰色的没用到的模块就删除掉<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667053276416-53b169db-5b5e-47ec-abf9-581ec401a2ad.png#averageHue=%23302f2d&clientId=u675e07bc-9752-4&from=paste&height=406&id=u871d59fc&name=image.png&originHeight=507&originWidth=695&originalType=binary&ratio=1&rotation=0&showTitle=false&size=65993&status=done&style=none&taskId=u5a8d3691-45c7-48fd-9ccd-d0dc46061bf&title=&width=556" alt="image.png"><br>现在只剩下了函数，我们的函数也可以进一步进行拆分，就比如放在views文件夹内：<br>里面分别放置User，Pretty，depart这三个模块的py文件：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667053530367-50f17bbb-981b-4067-9fd7-498cef3a2380.png#averageHue=%23465843&clientId=u675e07bc-9752-4&from=paste&height=350&id=ucd59200a&name=image.png&originHeight=438&originWidth=1189&originalType=binary&ratio=1&rotation=0&showTitle=false&size=86885&status=done&style=none&taskId=u51cea2af-3c90-4339-980e-472ea353f0c&title=&width=951.2" alt="image.png"><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667053535566-476a6b43-f8ab-4401-946c-a5d37bcfe225.png#averageHue=%232f2d2c&clientId=u675e07bc-9752-4&from=paste&height=329&id=u0bd4537a&name=image.png&originHeight=411&originWidth=652&originalType=binary&ratio=1&rotation=0&showTitle=false&size=43414&status=done&style=none&taskId=u06c7305b-83e3-4750-b5f5-6a0c3013db6&title=&width=521.6" alt="image.png"><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667053538057-c4035495-93f9-4398-b515-10505e8a849c.png#averageHue=%23302f2d&clientId=u675e07bc-9752-4&from=paste&height=296&id=u62de3c17&name=image.png&originHeight=370&originWidth=721&originalType=binary&ratio=1&rotation=0&showTitle=false&size=51124&status=done&style=none&taskId=u5b9accf2-c058-4d80-a224-2a8d8d0cb39&title=&width=576.8" alt="image.png"><br>views的py文件就删除了，接下来需要改的也就只是路由：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667053756574-ba762fa7-96f1-491e-aa6f-6db074813761.png#averageHue=%23302e2d&clientId=u675e07bc-9752-4&from=paste&height=442&id=uf324d0b0&name=image.png&originHeight=553&originWidth=713&originalType=binary&ratio=1&rotation=0&showTitle=false&size=79741&status=done&style=none&taskId=u6b09ec6a-3a21-47f9-a773-d254f80f940&title=&width=570.4" alt="image.png"><br>之后页面还是照常运行QWQ<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667060669529-1fdfb8f3-caf4-42c6-9e05-d4194b6dcda4.png#averageHue=%23fbf9f9&clientId=uf24b1094-8fbb-4&from=paste&height=616&id=ua5d56408&name=image.png&originHeight=770&originWidth=1800&originalType=binary&ratio=1&rotation=0&showTitle=false&size=96978&status=done&style=none&taskId=u56ae8dae-c31f-4390-a7b7-f01da3a2ae1&title=&width=1440" alt="image.png"></p>
<h2 id="管理员数据库"><a href="#管理员数据库" class="headerlink" title="管理员数据库"></a>管理员数据库</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667127282882-f4b1c3f2-4296-4618-b08a-ffccdd56a7a6.png#averageHue=%2333312f&clientId=ue6c34f64-35ad-4&from=paste&height=89&id=u8735e304&name=image.png&originHeight=111&originWidth=604&originalType=binary&ratio=1&rotation=0&showTitle=false&size=18928&status=done&style=none&taskId=uafbef55f-be48-4325-a9cb-88b1df335be&title=&width=483.2" alt="image.png"><br><code>makemigrations+migrate</code>创建数据库</p>
<h2 id="管理员列表"><a href="#管理员列表" class="headerlink" title="管理员列表"></a>管理员列表</h2><p>先自行插入数据库两条数据</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends &#x27;layout.html&#x27; %&#125;</span><br><span class="line">&#123;% block content %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;margin-bottom: 10px;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;clearfix&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-success&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/admin/add/&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;glyphicon glyphicon-plus&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                新建管理员</span><br><span class="line">            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;float: right;width: 300px;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;get&quot;</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;input-group&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">name</span>=<span class="string">&quot;q&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;Search for...&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;&#123; search &#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;input-group-btn&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-default&quot;</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;glyphicon glyphicon-search&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel panel-default&quot;</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- Default panel contents --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel-heading&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;glyphicon glyphicon-th-list&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">              管理员列表</span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">          <span class="comment">&lt;!-- Table --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">&quot;table table-bordered&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>ID<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>用户名<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>密码<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">            &#123;% for data in info %&#125;</span><br><span class="line">              <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; data.id &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; data.username &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>******<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary btn-xs&quot;</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>编辑<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-danger btn-xs&quot;</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            &#123;% endfor %&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">nav</span> <span class="attr">aria-label</span>=<span class="string">&quot;Page navigation&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;pagination&quot;</span>&gt;</span></span><br><span class="line">            &#123;&#123; change &#125;&#125;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> redirect,render</span><br><span class="line"><span class="keyword">from</span> app01 <span class="keyword">import</span> models</span><br><span class="line"><span class="keyword">from</span> app01.utils.Jumpage <span class="keyword">import</span> jump</span><br><span class="line"><span class="keyword">from</span> app01.utils.forms <span class="keyword">import</span> AdminForm</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">admin_list</span>(<span class="params">request</span>):</span><br><span class="line">    search=&#123;&#125;</span><br><span class="line">    value=request.GET.get(<span class="string">&#x27;q&#x27;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> value:</span><br><span class="line">        search[<span class="string">&#x27;username__contains&#x27;</span>]=value</span><br><span class="line">    data=models.Admin.objects.<span class="built_in">filter</span>(**search)</span><br><span class="line">    Jumpage=jump(request,data)</span><br><span class="line">    content=&#123;</span><br><span class="line">        <span class="string">&quot;info&quot;</span>:Jumpage.queryset,</span><br><span class="line">        <span class="string">&quot;change&quot;</span>:Jumpage.HTMl(),</span><br><span class="line">        <span class="string">&quot;search&quot;</span>:value,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> render(request,<span class="string">&#x27;admin_list.html&#x27;</span>,content)</span><br></pre></td></tr></table></figure>


<h2 id="添加管理员"><a href="#添加管理员" class="headerlink" title="添加管理员"></a>添加管理员</h2><p>添加管理员需要以下几个步骤：</p>
<ul>
<li>添加路由</li>
<li>添加html界面</li>
<li>添加class类</li>
<li>添加函数，函数内要引入，搜索框，分页框</li>
</ul>
<p>我们还会发现，不管是我们的user，pretty还是admin的添加界面，用的都是同一个模板，所以为了避免文件过多，我们就添加一个公用模板<code>add.html</code>：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends &#x27;layout.html&#x27; %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block content %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel panel-default&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel-heading&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">&quot;panel-title&quot;</span>&gt;</span>&#123;&#123; title &#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel-body&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">novalidate</span>&gt;</span></span><br><span class="line">    &#123;% csrf_token %&#125;</span><br><span class="line">    &#123;% for field in form %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> &gt;</span>&#123;&#123; field.label &#125;&#125;<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        &#123;&#123;field&#125;&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;color: red;&quot;</span>&gt;</span>&#123;&#123; field.errors.0 &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    &#123;% endfor %&#125;</span><br><span class="line"> <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>
<p>函数就长这样：跟我们之前说好的用法一样</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">admin_add</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">        form = AdminForm()</span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">&#x27;add.html&#x27;</span>, &#123;<span class="string">&quot;form&quot;</span>: form,<span class="string">&quot;title&quot;</span>:<span class="string">&quot;新建管理员&quot;</span>&#125;)</span><br><span class="line">    form = AdminForm(data=request.POST)</span><br><span class="line">    <span class="keyword">if</span> form.is_valid():</span><br><span class="line">        form.save()</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;/admin/list/&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">&#x27;add.html&#x27;</span>, &#123;<span class="string">&quot;form&quot;</span>: form,<span class="string">&quot;title&quot;</span>:<span class="string">&quot;新建管理员&quot;</span>&#125;)</span><br></pre></td></tr></table></figure>
<p>效果如下：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667140625428-9eeb3b38-0206-47c0-8550-2c173587ac0f.png#averageHue=%23fcfcfc&clientId=u03c99398-760d-4&from=paste&height=300&id=ue4b8f61e&name=image.png&originHeight=375&originWidth=1112&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10734&status=done&style=none&taskId=u65f6befa-b5ba-45ee-93a0-06e0c3c7719&title=&width=889.6" alt="image.png"><br><strong>确认密码</strong>：<br>新建密码应该还要有个确认密码才标准对吧，然后密码输入的时候不能被看见输入了什么东西，所以我们来创建！<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667141467157-cbabf06c-ffee-4a33-8c0a-2685eb568197.png#averageHue=%23343230&clientId=u03c99398-760d-4&from=paste&height=57&id=u1e363b9a&name=image.png&originHeight=71&originWidth=574&originalType=binary&ratio=1&rotation=0&showTitle=false&size=12859&status=done&style=none&taskId=uce71494b-13b8-4061-a22a-981ec0cf955&title=&width=459.2" alt="image.png"><br>只需要在类里添加个字段即可，然后设置不可见就用插件widgets<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667141573867-fe53acec-c70f-4ca4-a561-472969e41b31.png#averageHue=%23322f2d&clientId=u03c99398-760d-4&from=paste&height=34&id=u93a1d27d&name=image.png&originHeight=42&originWidth=292&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5892&status=done&style=none&taskId=u78c5ad0a-d1ca-4cbf-8071-f688e2f16cc&title=&width=233.6" alt="image.png"><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667141579036-11c44b8c-097d-4804-825d-ef67bdf3e617.png#averageHue=%232d2d2c&clientId=u03c99398-760d-4&from=paste&height=90&id=uecfee995&name=image.png&originHeight=112&originWidth=595&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13964&status=done&style=none&taskId=ub73d3b1e-2f0b-4b1b-81bb-9eff51a5490&title=&width=476" alt="image.png"><br>添加一下字段即可，最终效果：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667141602362-fdc6b605-99a1-46c0-b37f-06a7033a4798.png#averageHue=%23fcfcfc&clientId=u03c99398-760d-4&from=paste&height=282&id=uef7beaf9&name=image.png&originHeight=352&originWidth=1661&originalType=binary&ratio=1&rotation=0&showTitle=false&size=15490&status=done&style=none&taskId=ufd0463f8-9a7c-440b-bdc5-57f28cd3293&title=&width=1328.8" alt="image.png"><br>接下来添加验证2次输入是否一致：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">clean_confirm_passwd</span>(<span class="params">self</span>): <span class="comment">#添加Hook钩子函数验证</span></span><br><span class="line">     pwd=self.cleaned_data[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">     password=self.cleaned_data[<span class="string">&#x27;confirm_passwd&#x27;</span>]</span><br><span class="line">     <span class="keyword">if</span> pwd==password:</span><br><span class="line">        <span class="keyword">return</span> pwd</span><br><span class="line">     <span class="keyword">raise</span> ValidationError(<span class="string">&#x27;两次输入的密码不一致！&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667142305875-ed6f8a51-8aaf-42f3-80bd-b282ecf5d001.png#averageHue=%23fdfcfc&clientId=u03c99398-760d-4&from=paste&height=319&id=u6a2f5506&name=image.png&originHeight=399&originWidth=1695&originalType=binary&ratio=1&rotation=0&showTitle=false&size=20254&status=done&style=none&taskId=u62761796-0886-44a4-b0b6-4500ed9ba6c&title=&width=1356" alt="image.png"></p>
<p>最后为了安全性，我们一般对输入的密码进行加盐md5加密！，现在让我们来实现<br>首页的clean_xxx的意思都知道，是个HOOK函数，对指定输入的参数检验的，利用这个函数来进行加密和判断</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.conf <span class="keyword">import</span> settings  <span class="comment">#来拿secret_key当盐值</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">md5</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="built_in">str</span>=data+settings.SECRET_KEY</span><br><span class="line">    md5=hashlib.md5(<span class="built_in">str</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">    <span class="keyword">return</span> md5</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这就是我们的md5加密,hashlib.md5里必须放一个字节型的，所以要encode<br>里面的SECRET_KEY是django自动生成的：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667147900034-f19e2aa4-2bc0-4928-a70c-bf308fb63b11.png#averageHue=%2332312f&clientId=u03c99398-760d-4&from=paste&height=42&id=u8a894121&name=image.png&originHeight=53&originWidth=948&originalType=binary&ratio=1&rotation=0&showTitle=false&size=18019&status=done&style=none&taskId=ue9648133-aec5-484c-ad60-e64595dc46e&title=&width=758.4" alt="image.png"><br>接下来就是修改函数了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> app01.utils.md5 <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">clean_confirm_passwd</span>(<span class="params">self</span>): <span class="comment">#添加Hook钩子函数验证</span></span><br><span class="line">      pwd=self.cleaned_data[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">      <span class="built_in">print</span>(self.cleaned_data)</span><br><span class="line">      password=self.cleaned_data[<span class="string">&#x27;confirm_passwd&#x27;</span>]</span><br><span class="line">      <span class="keyword">if</span> pwd!=md5(password):</span><br><span class="line">         <span class="keyword">raise</span> ValidationError(<span class="string">&#x27;两次输入的密码不一致！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">clean_password</span>(<span class="params">self</span>):</span><br><span class="line">      pwd=self.cleaned_data[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">      <span class="keyword">return</span> md5(pwd)</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667148116963-eae7f684-0474-4711-a771-e869a14bee4e.png#averageHue=%23fdfafa&clientId=u03c99398-760d-4&from=paste&height=62&id=u85237b8f&name=image.png&originHeight=77&originWidth=1278&originalType=binary&ratio=1&rotation=0&showTitle=false&size=6248&status=done&style=none&taskId=u07050203-2f19-45bd-91bc-b7b9a1b09a4&title=&width=1022.4" alt="image.png"><br>在数据库看看：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667148128007-8215fe14-f9c0-4fe4-85fa-2bdd943ba0ac.png#averageHue=%231c1a1a&clientId=u03c99398-760d-4&from=paste&height=184&id=u9cd4281c&name=image.png&originHeight=230&originWidth=855&originalType=binary&ratio=1&rotation=0&showTitle=false&size=19228&status=done&style=none&taskId=u38e42d8b-32b1-4369-80b4-7792791b9b8&title=&width=684" alt="image.png"><br>成功加盐加密！告一段落</p>
<h2 id="编辑和删除和重置密码管理员"><a href="#编辑和删除和重置密码管理员" class="headerlink" title="编辑和删除和重置密码管理员"></a>编辑和删除和重置密码管理员</h2><p>这个就照葫芦画瓢就好了，我们之前在新建靓号的时候已经做过很多次了，要求大致如下</p>
<ul>
<li>id不存在跳转错误页面</li>
<li>成功编辑用户名</li>
<li>不能存在同样的用户名</li>
<li>成功重置密码，重置的密码不可以和之前一样</li>
<li>删除就没啥好说的，一模一样</li>
</ul>
<p>先来编辑一下管理员吧：</p>
<ul>
<li>类</li>
<li>URL</li>
<li>函数</li>
<li>html<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends <span class="string">&#x27;layout.html&#x27;</span> %&#125;</span><br><span class="line">&#123;% block content %&#125;</span><br><span class="line">&lt;div <span class="keyword">class</span>=<span class="string">&quot;alert alert-danger&quot;</span> role=<span class="string">&quot;alert&quot;</span>&gt;&#123;&#123; msg &#125;&#125;&lt;/div&gt;</span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AdminEditForm</span>(<span class="title">BootStrapModelForm</span>):</span></span><br><span class="line"><span class="class">   <span class="title">class</span> <span class="title">Meta</span>:</span></span><br><span class="line"><span class="class">      <span class="title">model</span>=<span class="title">models</span>.<span class="title">Admin</span></span></span><br><span class="line"><span class="class">      <span class="title">fields</span>=[&#x27;<span class="title">username</span>&#x27;]</span></span><br><span class="line"><span class="class">   <span class="title">def</span> <span class="title">clean_username</span>(<span class="title">self</span>):</span></span><br><span class="line"><span class="class">      <span class="title">name</span>=<span class="title">self</span>.<span class="title">cleaned_data</span>[&#x27;<span class="title">username</span>&#x27;]</span></span><br><span class="line"><span class="class">      <span class="title">exists</span> = <span class="title">models</span>.<span class="title">Admin</span>.<span class="title">objects</span>.<span class="title">filter</span>(<span class="title">username</span>=<span class="title">name</span>).<span class="title">exclude</span>(<span class="title">id</span>=<span class="title">self</span>.<span class="title">instance</span>.<span class="title">pk</span>).<span class="title">exists</span>()</span></span><br><span class="line"><span class="class">      <span class="title">if</span> <span class="title">exists</span>:</span></span><br><span class="line"><span class="class">         <span class="title">raise</span> <span class="title">ValidationError</span>(&#x27;用户名已存在&#x27;)</span></span><br><span class="line"><span class="class">      <span class="title">return</span> <span class="title">name</span></span></span><br><span class="line"><span class="class">   </span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">admin_edit</span>(<span class="params">request,nid</span>):</span><br><span class="line">    row_obj=models.Admin.objects.<span class="built_in">filter</span>(<span class="built_in">id</span>=nid).first()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> row_obj:</span><br><span class="line">        <span class="keyword">return</span> render(request,<span class="string">&#x27;error.html&#x27;</span>,&#123;<span class="string">&quot;msg&quot;</span>:<span class="string">&quot;不存在的数据&quot;</span>&#125;)</span><br><span class="line">    <span class="keyword">if</span> request.method==<span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">        form=AdminEditForm(instance=row_obj)</span><br><span class="line">        content=&#123;</span><br><span class="line">            <span class="string">&#x27;title&#x27;</span>:<span class="string">&#x27;编辑用户名&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;form&#x27;</span>:form</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> render(request,<span class="string">&#x27;add.html&#x27;</span>,content)</span><br><span class="line">    form=AdminEditForm(data=request.POST,instance=row_obj)</span><br><span class="line">    <span class="keyword">if</span> form.is_valid():</span><br><span class="line">        form.save()</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;/admin/list/&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> render(request,<span class="string">&#x27;add.html&#x27;</span>,&#123;<span class="string">&quot;form&quot;</span>:form,<span class="string">&quot;title&quot;</span>:<span class="string">&quot;编辑用户名&quot;</span>&#125;)</span><br></pre></td></tr></table></figure>
这波就设置完了修改用户名的界面和错误界面：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667152752435-d956a1cc-bf25-4c9c-b8d6-01c5824943ac.png#averageHue=%23fcfcfc&clientId=uda161528-17d2-4&from=paste&height=237&id=u53faa936&name=image.png&originHeight=296&originWidth=1198&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10340&status=done&style=none&taskId=u4f323d0d-eb8b-4f19-b8b5-28fd01dca31&title=&width=958.4" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667152778005-b8dd03b4-c629-40d8-ad22-6794a9621b50.png#averageHue=%23d0b698&clientId=uda161528-17d2-4&from=paste&height=221&id=u0f1c804f&name=image.png&originHeight=276&originWidth=1210&originalType=binary&ratio=1&rotation=0&showTitle=false&size=30595&status=done&style=none&taskId=u1bad64f1-c634-46eb-be29-c9ed999ed87&title=&width=968" alt="image.png"></li>
</ul>
<p>接下来设置一下删除界面，这就很简单了:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">admin_del</span>(<span class="params">request,nid</span>):</span><br><span class="line">    models.Admin.objects.<span class="built_in">filter</span>(<span class="built_in">id</span>=nid).delete()</span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">&#x27;/admin/list/&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>最后就是重置一下密码了，这也是比较有难度的</p>
<h2 id="Cookie和Session"><a href="#Cookie和Session" class="headerlink" title="Cookie和Session"></a>Cookie和Session</h2><p>老生常谈<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667196222728-45f41a91-4b8e-4cd5-b3eb-932ed4129a5a.png#averageHue=%23f7f7f7&clientId=u2901b697-993b-4&from=paste&height=446&id=ubd99d750&name=image.png&originHeight=558&originWidth=1533&originalType=binary&ratio=1&rotation=0&showTitle=false&size=111889&status=done&style=none&taskId=u6b004c2a-5115-4954-84da-148bea21044&title=&width=1226.4" alt="image.png"></p>
<h2 id="用户认证-基本实现方式"><a href="#用户认证-基本实现方式" class="headerlink" title="用户认证-基本实现方式"></a>用户认证-基本实现方式</h2><p>先添加路由，页面和函数，内容如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">LoginForm</span>(forms.Form):</span><br><span class="line">    username=forms.CharField(label=<span class="string">&#x27;用户名&#x27;</span>,widget=forms.TextInput(attrs=&#123;<span class="string">&quot;class&quot;</span>:<span class="string">&quot;form-control&quot;</span>&#125;))</span><br><span class="line">    password=forms.CharField(label=<span class="string">&#x27;密码&#x27;</span>,widget=forms.PasswordInput(attrs=&#123;<span class="string">&quot;class&quot;</span>:<span class="string">&quot;form-control&quot;</span>&#125;))</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>(<span class="params">request</span>):</span><br><span class="line">    form=LoginForm()</span><br><span class="line">    <span class="keyword">return</span> render(request,<span class="string">&#x27;login.html&#x27;</span>,&#123;<span class="string">&quot;form&quot;</span>:form&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&#123;% load static %&#125;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&#123;% static &#x27;plugins/bootstrap-3.4.1/css/bootstrap.min.css&#x27; %&#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.account</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">400px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#dddddd</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">box-shadow</span>: <span class="number">5px</span> <span class="number">5px</span> <span class="number">20px</span> <span class="number">#aaa</span>;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin-left</span>: auto;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin-right</span>: auto;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin-top</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">padding</span>: <span class="number">20px</span> <span class="number">40px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.account</span> <span class="selector-tag">h2</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin-top</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;account&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>用户登录<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">novalidate</span>&gt;</span></span><br><span class="line">        &#123;% csrf_token %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>用户名<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            &#123;&#123; form.username &#125;&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;color: red;&quot;</span>&gt;</span>&#123;&#123; form.username.errors.0 &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>密码<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            &#123;&#123; form.password &#125;&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;color: red;&quot;</span>&gt;</span>&#123;&#123; form.password.errors.0 &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;登 录&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667214698158-3271f96c-2e3d-4438-b2da-afd4975dbe26.png#averageHue=%23fdfdfd&clientId=ud3857263-e6d8-4&from=paste&height=542&id=u50fc3199&name=image.png&originHeight=677&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=36602&status=done&style=none&taskId=uc97af762-f099-4067-adcd-ec7699277c7&title=&width=1536" alt="image.png"><br>加入我们字段很多的话，我们也是可以直接把BootstrapModelForm类的init方法拿过来的，即使一个是form一个是modelform</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">LoginForm</span>(forms.Form):</span><br><span class="line">    username=forms.CharField(label=<span class="string">&#x27;用户名&#x27;</span>,widget=forms.TextInput)</span><br><span class="line">    password=forms.CharField(label=<span class="string">&#x27;密码&#x27;</span>,widget=forms.PasswordInput)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, *args, **kwargs</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__(*args, **kwargs)</span><br><span class="line">        <span class="comment"># 循环ModelForm中的所有字段，给每个字段的插件设置</span></span><br><span class="line">        <span class="keyword">for</span> name, field <span class="keyword">in</span> self.fields.items():</span><br><span class="line">            <span class="comment"># 字段中有属性，保留原来的属性，没有属性，才增加。</span></span><br><span class="line">            <span class="keyword">if</span> field.widget.attrs:</span><br><span class="line">                field.widget.attrs[<span class="string">&quot;class&quot;</span>] = <span class="string">&quot;form-control&quot;</span></span><br><span class="line">                field.widget.attrs[<span class="string">&quot;placeholder&quot;</span>] = field.label</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                field.widget.attrs = &#123;</span><br><span class="line">                    <span class="string">&quot;class&quot;</span>: <span class="string">&quot;form-control&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;placeholder&quot;</span>: field.label&#125;</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>(<span class="params">request</span>):</span><br><span class="line">    form=LoginForm()</span><br><span class="line">    <span class="keyword">return</span> render(request,<span class="string">&#x27;login.html&#x27;</span>,&#123;<span class="string">&quot;form&quot;</span>:form&#125;)</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667214804312-bc6b6bd7-8c51-492f-bae1-4f6d7990b39c.png#averageHue=%23fdfdfd&clientId=ud3857263-e6d8-4&from=paste&height=406&id=u04935cec&name=image.png&originHeight=507&originWidth=1418&originalType=binary&ratio=1&rotation=0&showTitle=false&size=20819&status=done&style=none&taskId=u88dc013f-b98f-46bc-9689-81a4a09fcee&title=&width=1134.4" alt="image.png"><br>都是可以滴~<br>然后关于BootStrapModelForm类，我们可以进一步简化，由于我们这次用的是forms，所以用不了ModelForm，那我们再创建一个Form用的就好了：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667216926631-63ee323e-dfc0-422c-b716-b8d51793d293.png#averageHue=%232e2d2c&clientId=ud3857263-e6d8-4&from=paste&height=293&id=ud0032be0&name=image.png&originHeight=366&originWidth=617&originalType=binary&ratio=1&rotation=0&showTitle=false&size=52664&status=done&style=none&taskId=u66904791-4ca5-4657-87e1-5e8d6247ff2&title=&width=493.6" alt="image.png"><br>然后init重复了，我们再定义一个类来放init，再让我们BoostarpModelForm和BootstapForm都继承这个类就好：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667217039316-abfd93a1-bf68-4459-8522-e6d9e1a53095.png#averageHue=%232f2f2e&clientId=ud3857263-e6d8-4&from=paste&height=402&id=u6acd63f2&name=image.png&originHeight=502&originWidth=643&originalType=binary&ratio=1&rotation=0&showTitle=false&size=67633&status=done&style=none&taskId=u9d446379-4503-4c44-bda2-fc0b165ee17&title=&width=514.4" alt="image.png"><br>们的页面仍然是一样的</p>
<p>设置错误信息：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667217209669-d36bf8aa-afc6-4155-96c3-83df720060bf.png#averageHue=%232f2e2d&clientId=ud3857263-e6d8-4&from=paste&height=178&id=u30b9a340&name=image.png&originHeight=222&originWidth=638&originalType=binary&ratio=1&rotation=0&showTitle=false&size=36063&status=done&style=none&taskId=u867d81de-676e-415b-aa97-decb854b6b1&title=&width=510.4" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667217216512-32bbeb0a-5499-448b-bddd-ba4a9f9290d9.png#averageHue=%23fbf8f8&clientId=ud3857263-e6d8-4&from=paste&height=88&id=u66601d01&name=image.png&originHeight=110&originWidth=540&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4879&status=done&style=none&taskId=u1ec4d4cd-4f10-45c5-ba63-9cb4a50f60f&title=&width=432" alt="image.png"></p>
<p>为什么会有必填呢，因为我们的LoginForm类定义的字段里其实默认有个<code>require</code>参数，他默认为True：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667217269130-53b0686e-c4bf-4409-b235-761ded39d5ca.png#averageHue=%23343329&clientId=ud3857263-e6d8-4&from=paste&height=47&id=u45ae325c&name=image.png&originHeight=59&originWidth=511&originalType=binary&ratio=1&rotation=0&showTitle=false&size=32920&status=done&style=none&taskId=u9b436684-c357-46a9-b214-e47be72cc72&title=&width=408.8" alt="image.png"></p>
<p>接下来就来验证输入的密码是否和输入的密码一样：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667222118783-52ff7c2b-8c9a-4c68-bb72-a8af37505243.png#averageHue=%232f2e2c&clientId=ud3857263-e6d8-4&from=paste&height=79&id=uab38524d&name=image.png&originHeight=99&originWidth=557&originalType=binary&ratio=1&rotation=0&showTitle=false&size=17480&status=done&style=none&taskId=ue8a7c7b1-f609-4dad-a61c-0601ff40fef&title=&width=445.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667222121382-e997c6b5-5227-4732-9961-737b8f2db08e.png#averageHue=%232f2e2d&clientId=ud3857263-e6d8-4&from=paste&height=289&id=u6d797634&name=image.png&originHeight=361&originWidth=681&originalType=binary&ratio=1&rotation=0&showTitle=false&size=65892&status=done&style=none&taskId=u8176da57-0358-4c0a-ac58-ee67d1099e7&title=&width=544.8" alt="image.png"><br>接下来就是添加session了<br>只要写上一句<code>request.session[&#39;info&#39;]=xxx</code>,django就会处理：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667222246765-767f8d90-9d16-414c-a4f7-ddd51cef7215.png#averageHue=%23f6f6f6&clientId=ud3857263-e6d8-4&from=paste&height=450&id=u44fb6648&name=image.png&originHeight=562&originWidth=1495&originalType=binary&ratio=1&rotation=0&showTitle=false&size=116657&status=done&style=none&taskId=u191fa9c3-a444-4b29-ab94-d10721f5c7c&title=&width=1196" alt="image.png"><br>首先返回客户端一个session，然后再服务端储存这个session的值为<code>info=xxxx</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">request.session[<span class="string">&#x27;info&#x27;</span>]= &#123;<span class="string">&quot;id&quot;</span>:row_obj.<span class="built_in">id</span>,<span class="string">&quot;name&quot;</span>:row_obj.username&#125;<span class="comment">#存储了用户名，id到session中</span></span><br><span class="line"> <span class="keyword">return</span> redirect(<span class="string">&#x27;/admin/list/&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667222622197-4424c9fc-0d73-4514-ac0f-bd3c8b586c0a.png#averageHue=%23edeeef&clientId=ud3857263-e6d8-4&from=paste&height=87&id=ud502fe1f&name=image.png&originHeight=109&originWidth=1031&originalType=binary&ratio=1&rotation=0&showTitle=false&size=12030&status=done&style=none&taskId=u754c76ed-ef93-4b4c-814b-183c71633d1&title=&width=824.8" alt="image.png"><br>然后服务端的session数据存到数据库里了：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667222697854-46c4e2bb-8416-4782-baba-a73c7ea480db.png#averageHue=%230f0f0e&clientId=ud3857263-e6d8-4&from=paste&height=267&id=u89901c9f&name=image.png&originHeight=334&originWidth=1702&originalType=binary&ratio=1&rotation=0&showTitle=false&size=30317&status=done&style=none&taskId=u9544e4cb-b596-4e10-98b4-06d6aba7c2a&title=&width=1361.6" alt="image.png"><br>expire_date表示到期时间<br>现在是如果有些没有登录，就需要设置权限了：<br>这时候要在adminlist页面判断session了，下一P就讲中间件来处理这个</p>
<h2 id="用户认证-中间件处理权限"><a href="#用户认证-中间件处理权限" class="headerlink" title="用户认证-中间件处理权限"></a>用户认证-中间件处理权限</h2><p>可以再django内部检查用户有没有登录</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">info=request.session[<span class="string">&#x27;info&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(info)</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667223984851-b26c0812-f694-423c-a474-0ef004f3e741.png#averageHue=%23322e2d&clientId=u384109f1-a10e-4&from=paste&height=69&id=u556cf538&name=image.png&originHeight=86&originWidth=705&originalType=binary&ratio=1&rotation=0&showTitle=false&size=14270&status=done&style=none&taskId=u8ed46864-2d6e-4240-82b1-357a23d45c5&title=&width=564" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667378600595-96e53072-b113-4dcc-a676-270047c46979.png#averageHue=%2333302f&clientId=u3f74aa74-1efc-4&from=paste&height=32&id=u988b5af7&name=image.png&originHeight=40&originWidth=838&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8473&status=done&style=none&taskId=ud803495d-a562-4f22-9145-392ad903f46&title=&width=670.4" alt="image.png"><br>如果我们已经登录了，会返回sessionid，然后后台会获得数据<br>如果没有：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667224023621-2425d05b-5176-411a-b184-98aad5b90525.png#averageHue=%23c5e7bc&clientId=u384109f1-a10e-4&from=paste&height=203&id=ua3a10f98&name=image.png&originHeight=254&originWidth=1199&originalType=binary&ratio=1&rotation=0&showTitle=false&size=29185&status=done&style=none&taskId=ubc9acc63-9764-4fd3-bdfb-f3b088e0e69&title=&width=959.2" alt="image.png"><br>这就是个雷区了，假如我们<code>info=request.session[&#39;info&#39;]</code>，假如没有session是不会返回none的，所以要改成<code>info=request.session.get(&#39;info&#39;)</code>，这样就不会报错了</p>
<p>我们发现还有一个问题，就是并没有进行鉴权，一般来说我们进行鉴权的流程如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">info = request.session[<span class="string">&#x27;info&#x27;</span>]</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> info:</span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">&#x27;/login/&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>这样没登录的用户就会跳转到登录界面了，我们的设计理念就是假如没有登录，不能使用所有功能，一律跳转到登录界面，如果用上述方法鉴权，那要复制粘贴20多份，一个函数一份，就很麻烦，对于这个问题，django给出了答案，那就是中间件了，在django中，中间件就是一个类<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667232791482-55985caf-6a5e-45d5-8a88-c174b9ac37f6.png#averageHue=%23f9f8f8&clientId=u974c8ae5-7053-4&from=paste&height=547&id=Y3qPq&name=image.png&originHeight=684&originWidth=1359&originalType=binary&ratio=1&rotation=0&showTitle=false&size=169377&status=done&style=none&taskId=u5d87c7e0-797e-498e-b9b0-022068fa05b&title=&width=1087.2" alt="image.png"><br>我们先创建一个<code>MiddleWare</code>文件夹来存放中间件类，创建auth.py文件，内容如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.utils.deprecation <span class="keyword">import</span> MiddlewareMixin</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">M1</span>(<span class="title class_ inherited__">MiddlewareMixin</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">process_request</span>(<span class="params">self,request</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;M1 in&#x27;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">process_response</span>(<span class="params">self,request,response</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;M1 Out&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> response</span><br><span class="line">    <span class="comment">#如果方法没有返回值就返回none</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">M2</span>(<span class="title class_ inherited__">MiddlewareMixin</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">process_request</span>(<span class="params">self, request</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;M2 in&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">process_response</span>(<span class="params">self, request,response</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;M2 Out&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> response</span><br></pre></td></tr></table></figure>
<p>和app，数据库一样，中间件也是要去注册的：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667235269810-917631b3-fde2-4ab1-a25f-e3d917e5e2d3.png#averageHue=%232f2e2e&clientId=u31575547-57af-4&from=paste&height=71&id=u7112a8bc&name=image.png&originHeight=89&originWidth=447&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7608&status=done&style=none&taskId=u397d2eab-5823-4c78-b47c-67db0b531fb&title=&width=357.6" alt="image.png"><br>这样的话我们随便访问一个界面：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667235285599-d97b8cb7-2ff7-4f2f-bdac-14891aac8413.png#averageHue=%232d2c2b&clientId=u31575547-57af-4&from=paste&height=93&id=u43224b13&name=image.png&originHeight=116&originWidth=595&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7555&status=done&style=none&taskId=u0fbb0b75-5fbb-41b3-b3fe-cc0c3d4ee3f&title=&width=476" alt="image.png"><br>流程就是上面的图片所对应的，这样我们就对中间件有个比较好的认知了，我们删掉一个，目前一个就够了<br> 接下来就写个鉴权的中间件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.utils.deprecation <span class="keyword">import</span> MiddlewareMixin</span><br><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> redirect</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Auth</span>(<span class="title class_ inherited__">MiddlewareMixin</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">process_request</span>(<span class="params">self,request</span>):</span><br><span class="line">        info=request.session.get(<span class="string">&#x27;info&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> info:</span><br><span class="line">            <span class="keyword">return</span> </span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;/login/&#x27;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">process_response</span>(<span class="params">self,request,response</span>):</span><br><span class="line">        <span class="keyword">return</span> response</span><br><span class="line">    <span class="comment">#如果方法没有返回值就返回none</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>但是这里会有个小BUG：<br>在未登入的状态下访问一个页面：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667235843335-5039c3b4-df90-4770-85e4-f6cce8b86df9.png#averageHue=%233a2e2d&clientId=u31575547-57af-4&from=paste&height=250&id=u228e3175&name=image.png&originHeight=312&originWidth=689&originalType=binary&ratio=1&rotation=0&showTitle=false&size=52272&status=done&style=none&taskId=u7e9c333a-b228-45fa-9f6a-c349bd86a6f&title=&width=551.2" alt="image.png"><br>会无限重定向，仔细想想也是，因为既然没登录，每次重定向都又要再次经过中间件，我们重定向的模式图：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1666000130429-1c9226a5-dd50-49f1-a385-3e9f15c8aca5.png#averageHue=%23fcfcfc&from=url&id=F8rx2&originHeight=542&originWidth=1300&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title="><br>是第二种方式，会一直重复去递归，为了解决这个问题，就得去写个白名单，也就是不需要登录就可以访问的界面：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.utils.deprecation <span class="keyword">import</span> MiddlewareMixin</span><br><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> redirect</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Auth</span>(<span class="title class_ inherited__">MiddlewareMixin</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">process_request</span>(<span class="params">self,request</span>): <span class="comment">#固定函数名</span></span><br><span class="line">        <span class="comment">#排除不需要登录就能访问的页面，防止无限302</span></span><br><span class="line">        <span class="comment">#request.path_info获取当前url</span></span><br><span class="line">        <span class="keyword">if</span> request.path_info==<span class="string">&#x27;/login/&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        info=request.session.get(<span class="string">&#x27;info&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> info:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;/login/&#x27;</span>)<span class="comment">#有bug</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">process_response</span>(<span class="params">self,request,response</span>):<span class="comment">#固定函数名</span></span><br><span class="line">        <span class="keyword">return</span> response <span class="comment">#必须有response否则报错</span></span><br><span class="line">    <span class="comment">#如果方法没有返回值就返回none</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>告一段落</p>
<h2 id="账号注销"><a href="#账号注销" class="headerlink" title="账号注销"></a>账号注销</h2><p>其实很简单，就是一个指令<code>request.sesssion.clear()</code>就可以清除当前的session，和之前的删除用户是一个原理：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">logout</span>(<span class="params">request</span>):</span><br><span class="line">    request.session.clear()</span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">&#x27;/login/&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667377004637-473f24f7-521b-47d0-859c-992a7b80f12d.png#averageHue=%2333312d&clientId=u3f74aa74-1efc-4&from=paste&height=48&id=u6ef52d3e&name=image.png&originHeight=60&originWidth=458&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10012&status=done&style=none&taskId=u7bd0b456-500c-462a-8ad4-14d5f6f6c62&title=&width=366.4" alt="image.png"><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667377007734-1a3c0cf7-d127-4dbf-87f1-b975e5d8ba33.png#averageHue=%2331302f&clientId=u3f74aa74-1efc-4&from=paste&height=46&id=ude8ad6af&name=image.png&originHeight=57&originWidth=381&originalType=binary&ratio=1&rotation=0&showTitle=false&size=6375&status=done&style=none&taskId=uf40639e9-a3e4-406c-9afa-eb9ab054f2b&title=&width=304.8" alt="image.png"><br>还有一个小地方，就是我们登录后要显示用户名，这下我们一直没用着的request起作用了<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667377066814-4d20a5b2-4ceb-4a9d-a401-62517806de13.png#averageHue=%2333312f&clientId=u3f74aa74-1efc-4&from=paste&height=36&id=u08553be2&name=image.png&originHeight=45&originWidth=627&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9982&status=done&style=none&taskId=u60028a07-a153-4350-a282-18a1d0a4b18&title=&width=501.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667377077869-74996caa-adc0-4052-bacc-074dd8a8d36b.png#averageHue=%23fcfbfb&clientId=u3f74aa74-1efc-4&from=paste&height=456&id=u85a4fa51&name=image.png&originHeight=570&originWidth=1913&originalType=binary&ratio=1&rotation=0&showTitle=false&size=51297&status=done&style=none&taskId=u22b3eef2-373a-4649-83b6-f071772f880&title=&width=1530.4" alt="image.png"></p>
<h2 id="图片验证码（显示）"><a href="#图片验证码（显示）" class="headerlink" title="图片验证码（显示）"></a>图片验证码（显示）</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;id_code&quot;</span>&gt;</span>图片验证码<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;row&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-xs-7&quot;</span>&gt;</span></span><br><span class="line">                    &#123;&#123; form.code &#125;&#125;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;color: red;&quot;</span>&gt;</span>&#123;&#123; form.code.errors.0 &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-xs-5&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">img</span> <span class="attr">id</span>=<span class="string">&quot;image_code&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&#123;%static &#x27;img/code.jpg&#x27; &quot;</span>%&#125;&quot; <span class="attr">style</span>=<span class="string">&quot;width: 125px;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>先加一下验证码的HTML代码：再把验证码图片拿过来大致就有个效果：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667321459974-e440f5e9-8869-4f62-a768-b4bf8c0de25f.png#averageHue=%23f6f6f6&clientId=ue9a3020f-4764-4&from=paste&height=340&id=uc519fbf2&name=image.png&originHeight=425&originWidth=530&originalType=binary&ratio=1&rotation=0&showTitle=false&size=46774&status=done&style=none&taskId=uafebc701-a973-44db-ad3c-3b931ae03cb&title=&width=424" alt="image.png"><br>但是这样肯定是不可以的，我们的验证码应该是动态的，这时候就得用找pillow模块去生成验证码了，<code>pip insatll pillow</code>即可安装该模块，然后该模块的一些用法：<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xuyaping/p/7155088.html">https://www.cnblogs.com/xuyaping/p/7155088.html</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">img = Image.new(mode=<span class="string">&#x27;RGB&#x27;</span>, size=(<span class="number">120</span>, <span class="number">30</span>), color=(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存在本地</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;code.png&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    img.save(f, <span class="built_in">format</span>=<span class="string">&#x27;png&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667321825889-ac7b67e1-6b6f-4918-bdeb-76def0438f87.png#averageHue=%23566264&clientId=ue9a3020f-4764-4&from=paste&height=261&id=u6fccca0b&name=image.png&originHeight=326&originWidth=653&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3203&status=done&style=none&taskId=ue4aded57-f7ca-4148-983e-19452b5f040&title=&width=522.4" alt="image.png"><br>就创建了一个图片<br>接下来一些功能自己跟着博客学一下就好了，接下来直接把生成随机验证码的函数拿过来：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image,ImageFont,ImageFilter,ImageDraw</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_code</span>(<span class="params">width=<span class="number">120</span>, height=<span class="number">30</span>, char_length=<span class="number">5</span>, font_file=<span class="string">&#x27;Badaboom BB.TTF&#x27;</span>, font_size=<span class="number">28</span></span>):</span><br><span class="line">    code = []</span><br><span class="line">    img = Image.new(mode=<span class="string">&#x27;RGB&#x27;</span>, size=(width, height), color=(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>))</span><br><span class="line">    draw = ImageDraw.Draw(img, mode=<span class="string">&#x27;RGB&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rndChar</span>():</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        生成随机字母</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">chr</span>(random.randint(<span class="number">65</span>, <span class="number">90</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rndColor</span>():</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        生成随机颜色</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> (random.randint(<span class="number">0</span>, <span class="number">255</span>), random.randint(<span class="number">10</span>, <span class="number">255</span>), random.randint(<span class="number">64</span>, <span class="number">255</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 写文字</span></span><br><span class="line">    font = ImageFont.truetype(font_file, font_size)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(char_length):</span><br><span class="line">        char = rndChar()</span><br><span class="line">        code.append(char)</span><br><span class="line">        h = random.randint(<span class="number">0</span>, <span class="number">4</span>)</span><br><span class="line">        draw.text([i * width / char_length, h], char, font=font, fill=rndColor())</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 写干扰点</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>):</span><br><span class="line">        draw.point([random.randint(<span class="number">0</span>, width), random.randint(<span class="number">0</span>, height)], fill=rndColor())</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 写干扰圆圈</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>):</span><br><span class="line">        draw.point([random.randint(<span class="number">0</span>, width), random.randint(<span class="number">0</span>, height)], fill=rndColor())</span><br><span class="line">        x = random.randint(<span class="number">0</span>, width)</span><br><span class="line">        y = random.randint(<span class="number">0</span>, height)</span><br><span class="line">        draw.arc((x, y, x + <span class="number">4</span>, y + <span class="number">4</span>), <span class="number">0</span>, <span class="number">90</span>, fill=rndColor())</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 画干扰线</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        x1 = random.randint(<span class="number">0</span>, width)</span><br><span class="line">        y1 = random.randint(<span class="number">0</span>, height)</span><br><span class="line">        x2 = random.randint(<span class="number">0</span>, width)</span><br><span class="line">        y2 = random.randint(<span class="number">0</span>, height)</span><br><span class="line"></span><br><span class="line">        draw.line((x1, y1, x2, y2), fill=rndColor())</span><br><span class="line"></span><br><span class="line">    img = img.<span class="built_in">filter</span>(ImageFilter.EDGE_ENHANCE_MORE)</span><br><span class="line">    <span class="keyword">return</span> img, <span class="string">&#x27;&#x27;</span>.join(code)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 1. 直接打开</span></span><br><span class="line">    img,code = check_code()</span><br><span class="line">    <span class="built_in">print</span>(img)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 写入文件</span></span><br><span class="line"><span class="comment"># img,code = check_code()</span></span><br><span class="line"><span class="comment"># with open(&#x27;code.png&#x27;,&#x27;wb&#x27;) as f:</span></span><br><span class="line"><span class="comment">#     img.save(f,format=&#x27;png&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 写入内存(Python3)</span></span><br><span class="line"><span class="comment"># from io import BytesIO</span></span><br><span class="line"><span class="comment"># stream = BytesIO()</span></span><br><span class="line"><span class="comment"># img.save(stream, &#x27;png&#x27;)</span></span><br><span class="line"><span class="comment"># stream.getvalue()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 写入内存（Python2）</span></span><br><span class="line"><span class="comment"># import StringIO</span></span><br><span class="line"><span class="comment"># stream = StringIO.StringIO()</span></span><br><span class="line"><span class="comment"># img.save(stream, &#x27;png&#x27;)</span></span><br><span class="line"><span class="comment"># stream.getvalue()</span></span><br></pre></td></tr></table></figure>
<p>大致的意思挺好看懂的，之后我们来看看返回值给了些什么：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667322751564-aa48c1c2-5118-4e4e-8d7c-69a2959733e3.png#averageHue=%23947b5d&clientId=ue9a3020f-4764-4&from=paste&height=63&id=u642f6217&name=image.png&originHeight=79&originWidth=866&originalType=binary&ratio=1&rotation=0&showTitle=false&size=15426&status=done&style=none&taskId=ud008c2ab-8041-4d72-9bbe-3342febf27c&title=&width=692.8" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667322755122-d999cfa6-e866-4e42-bb7a-e4b4c0056321.png#averageHue=%2327c8a5&clientId=ue9a3020f-4764-4&from=paste&height=217&id=u070ddf42&name=image.png&originHeight=271&originWidth=700&originalType=binary&ratio=1&rotation=0&showTitle=false&size=11882&status=done&style=none&taskId=u39f7bbd0-9974-4c3d-a0de-0547ec45914&title=&width=560" alt="image.png"><br>还挺好的是吧，接下来就是如何让他放在浏览器里了<br>接下来吧HTML中加载图片的地址改为一个URL，一个路由：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667322918452-d90026ce-cd0f-4e17-90ee-d85848f51b3f.png#averageHue=%23302f2c&clientId=ue9a3020f-4764-4&from=paste&height=50&id=u7ab31ebc&name=image.png&originHeight=63&originWidth=453&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8972&status=done&style=none&taskId=ue6527d69-991a-446f-b285-6de44272251&title=&width=362.4" alt="image.png"><br>之后编写函数：<br>同样的，验证码也是我们不登录也能查看的，所以得改一下验证系统：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667324240922-fc53302b-8373-4e66-a93e-b92cebc3cde7.png#averageHue=%23302e2d&clientId=ue9a3020f-4764-4&from=paste&height=31&id=u53069f4f&name=image.png&originHeight=39&originWidth=532&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7753&status=done&style=none&taskId=u6c964cc3-e269-4359-97e8-dd7cdbf4d6f&title=&width=425.6" alt="image.png"><br>将之前的函数内容复制到：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667324179917-f91ef4f6-10ac-4734-a1c5-be9aa51e5cb1.png#averageHue=%23363d43&clientId=ue9a3020f-4764-4&from=paste&height=138&id=ua61ff961&name=image.png&originHeight=172&originWidth=473&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9742&status=done&style=none&taskId=ub1e5a61b-3128-4a72-ae63-6f46462b7e7&title=&width=378.4" alt="image.png"><br><strong>字体要留在根目录要记得，坑区</strong><br>定义一个函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">image_code</span>(<span class="params">request</span>):</span><br><span class="line">    img,code_str=check_code()</span><br><span class="line">    <span class="comment"># 3. 写入内存(Python3)</span></span><br><span class="line">    stream = BytesIO()</span><br><span class="line">    img.save(stream, <span class="string">&#x27;png&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> HttpResponse(stream.getvalue())</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667324251624-08e503cc-5add-4cd9-9e20-5c5552c51b36.png#averageHue=%23fafafa&clientId=ue9a3020f-4764-4&from=paste&height=361&id=u8b1d74d2&name=image.png&originHeight=451&originWidth=771&originalType=binary&ratio=1&rotation=0&showTitle=false&size=33553&status=done&style=none&taskId=u03d3ec71-cae0-4bdd-9c80-00c8b5cc44f&title=&width=616.8" alt="image.png"><br>最后的效果就挺不错了</p>
<h2 id="图片验证码（校验）"><a href="#图片验证码（校验）" class="headerlink" title="图片验证码（校验）"></a>图片验证码（校验）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1667388313842-5534310f-7cb2-4152-b2cd-0f2573908ae2.png#averageHue=%23312f2d&clientId=u3f74aa74-1efc-4&from=paste&height=110&id=u5546b843&name=image.png&originHeight=138&originWidth=721&originalType=binary&ratio=1&rotation=0&showTitle=false&size=32694&status=done&style=none&taskId=uf2c02ce4-042b-4466-b5fe-37deaccc4e5&title=&width=576.8" alt="image.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method==<span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">        form=LoginForm()</span><br><span class="line">        <span class="keyword">return</span> render(request,<span class="string">&#x27;login.html&#x27;</span>,&#123;<span class="string">&quot;form&quot;</span>:form&#125;)</span><br><span class="line">    form=LoginForm(data=request.POST)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> form.is_valid():</span><br><span class="line">        input_code = form.cleaned_data.pop(<span class="string">&#x27;code&#x27;</span>)</span><br><span class="line">        <span class="comment"># pop是为了提出code这个字段，因为数据库中没有code，要不然下文filter内就会报错</span></span><br><span class="line">        code = request.session.get(<span class="string">&#x27;image_code&#x27;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> code.upper() != input_code.upper():</span><br><span class="line">            form.add_error(<span class="string">&#x27;code&#x27;</span>, <span class="string">&#x27;验证码错误&#x27;</span>)  <span class="comment"># 手动添加错误信息</span></span><br><span class="line">            <span class="keyword">return</span> render(request, <span class="string">&#x27;login.html&#x27;</span>, &#123;<span class="string">&quot;form&quot;</span>: form&#125;)</span><br><span class="line">        row_obj=models.Admin.objects.<span class="built_in">filter</span>(**form.cleaned_data).first()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> row_obj:</span><br><span class="line">            form.add_error(<span class="string">&#x27;password&#x27;</span>,<span class="string">&#x27;用户名或密码错误&#x27;</span>)<span class="comment">#手动添加错误信息</span></span><br><span class="line">            <span class="keyword">return</span> render(request,<span class="string">&#x27;login.html&#x27;</span>,&#123;<span class="string">&quot;form&quot;</span>:form&#125;)</span><br><span class="line">        request.session[<span class="string">&#x27;info&#x27;</span>]= &#123;<span class="string">&quot;id&quot;</span>:row_obj.<span class="built_in">id</span>,<span class="string">&quot;name&quot;</span>:row_obj.username&#125;<span class="comment">#存储了用户名，id到session中</span></span><br><span class="line">        request.session.set_expiry(<span class="number">60</span>*<span class="number">60</span>*<span class="number">24</span>*<span class="number">7</span>)<span class="comment">#因为前面设置了60s过期，这里要重新设置，不然这个也会过期</span></span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;/admin/list/&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> render(request,<span class="string">&#x27;login.html&#x27;</span>,&#123;<span class="string">&quot;form&quot;</span>:form&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">image_code</span>(<span class="params">request</span>):</span><br><span class="line">    img,code_str=check_code()</span><br><span class="line">    <span class="comment"># 3. 写入内存(Python3)</span></span><br><span class="line">    stream = BytesIO()</span><br><span class="line">    img.save(stream, <span class="string">&#x27;png&#x27;</span>)</span><br><span class="line">    request.session[<span class="string">&#x27;image_code&#x27;</span>]=code_str</span><br><span class="line">    request.session.set_expiry(<span class="number">60</span>)<span class="comment">#设置session的过期时间为60s</span></span><br><span class="line">    <span class="keyword">return</span> HttpResponse(stream.getvalue())</span><br></pre></td></tr></table></figure>



<h2 id="ajax"><a href="#ajax" class="headerlink" title="ajax"></a>ajax</h2><p>暂时只能到这了，这里有点就涉及盲区了，没学过前端啊</p>

    </div>

    
    <div class="about">
        <h1>About this Post</h1>
        <div class="details">
            <p>This post is written by Boogipop, licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
        </div>
        
        <p class="tags">
            
            <i class="icon"></i>
            <a href="/tags/开发/" class="tag">#开发</a>
        </p>
        
    </div>
    

    <div class="container post-prev-next">
        
        <a href="/2023/03/02/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%9F%BA%E4%BA%8EH1ve%E7%9A%84%E5%8A%A8%E6%80%81%E9%9D%B6%E5%9C%BA%E6%90%AD%E5%BB%BA/" class="next">
            <div>
                <div class="text">
                    <p class="label">Next</p>
                    <h3 class="title">记一次基于H1VE的动态靶场搭建</h3>
                </div>
            </div>
        </a>
        
        
        <a href="/2023/03/02/Node.js/" class="prev">
            <div>
                <div class="text">
                    <p class="label">Previous</p>
                    <h3 class="title">Node.Js</>
                </div>
            </div>
        </a>
        
    </div>

    
        
        
        <script src="https://giscus.app/client.js" data-repo="Boogipop/Boogipop.github.io" data-repo-id="R_kgDOIFi78g" data-category="Announcements" data-category-id="DIC_kwDOIFi78s4Cav9f" data-mapping="pathname" data-strict="1" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script>
        
    
</article>

        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h2 class="title">Blog</h2>
                
                <a href="/" class="item">Blog</a>
                
                <a href="/archives" class="item">Archives</a>
                
                <a href="/tags" class="item">Tags</a>
                
                <a href="/categories" class="item">Categories</a>
                
                <a href="/search" class="item">Search</a>
                
                <a href="/friends" class="item">Friends</a>
                
                <a href="/about" class="item">About</a>
                
                <a href="/atom.xml" class="item">RSS</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Projects</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/rsa-cli" class="item">RSA CLI</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/hexo-theme-cupertino" class="item">Hexo Theme Cupertino</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/a-calendar" class="item">A Calendar</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/auto-mirroring-bucket" class="item">Auto Mirroring Bucket</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Me</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom" class="item">GitHub</a>
                
                <a target="_blank" rel="noopener" href="https://codepen.io/mrwillcom" class="item">CodePen</a>
                
                <a target="_blank" rel="noopener" href="https://www.patreon.com/MrWillCom" class="item">Patreon</a>
                
                <a target="_blank" rel="noopener" href="https://noc.social/@MrWillCom" class="item">Mastodon</a>
                
                <a target="_blank" rel="noopener" href="https://discord.gg/UKuFDjcfY8" class="item">Discord</a>
                
                <a href="mailto:mr.will.com@outlook.com" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2024 Boogipop<br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> </span>
        
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
        
        

        
        <script src="https://unpkg.com/scrollreveal"></script>
		
        <script>
            window.addEventListener('load', () => {
                ScrollReveal({ delay: 250, reset: true, easing: 'cubic-bezier(0, 0, 0, 1)' })
                ScrollReveal().reveal('.post-list-item .cover-img img')
                ScrollReveal().reveal('.post-list-item, .card, .content p img, .content .block-large img', { distance: '60px', origin: 'bottom', duration: 800 })
            })
        </script>
        
    </body>
</html>